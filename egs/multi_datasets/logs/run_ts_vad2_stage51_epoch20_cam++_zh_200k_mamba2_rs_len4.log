2025-02-14 09:43:15,282 (train_accelerate_ddp:857) INFO: params: {'best_train_loss': inf, 'best_valid_loss': inf, 'best_train_der': inf, 'best_valid_der': inf, 'best_train_epoch': -1, 'best_valid_epoch': -1, 'batch_idx_train': 0, 'log_interval': 500, 'reset_interval': 200, 'valid_interval': 500, 'batch_size': 64, 'verbose': 1, 'world_size': 2, 'tensorboard': True, 'num_epochs': 20, 'max_updates': 40000, 'warmup_updates': 4000, 'freeze_updates': 4000, 'start_batch': 0, 'start_epoch': 1, 'seed': 1337, 'exp_dir': PosixPath('/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4'), 'save_every_n': 1500, 'keep_last_k': 1, 'keep_last_epoch': 1, 'grad_clip': True, 'feature_grad_mult': 0.1, 'lr': 0.0001, 'average_period': 200, 'train_on_average': False, 'musan_path': '/mntcephfs/lee_dataset/asr/musan', 'rir_path': '/mntcephfs/lee_dataset/asr/RIRS_NOISES', 'spk_path': '/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/data/alimeeting_ami_aishell_4', 'speaker_embedding_name_dir': 'cam++_zh-cn_200k_feature_dir', 'data_dir': '/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/data/alimeeting_ami_aishell_4', 'dataset_name': 'alimeeting_ami_aishell_4', 'max_num_speaker': 7, 'speech_encoder_path': '/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/zh/modelscope/speech_campplus_sv_zh-cn_16k-common/campplus_cn_common.bin', 'select_encoder_layer_nums': 6, 'wavlm_fuse_feat_post_norm': False, 'speech_encoder_config': '/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/wav-bert2.0/config.json', 'num_transformer_layer': 2, 'd_state': 256, 'expand': 4, 'speech_encoder_type': 'CAM++', 'speaker_embed_dim': 192, 'rs_len': 4, 'segment_shift': 2, 'single_backend_type': 'mamba2', 'multi_backend_type': 'transformer', 'do_finetune': False, 'init_modules': None, 'finetune_ckpt': None}
2025-02-14 09:43:15,283 (train_accelerate_ddp:857) INFO: params: {'best_train_loss': inf, 'best_valid_loss': inf, 'best_train_der': inf, 'best_valid_der': inf, 'best_train_epoch': -1, 'best_valid_epoch': -1, 'batch_idx_train': 0, 'log_interval': 500, 'reset_interval': 200, 'valid_interval': 500, 'batch_size': 64, 'verbose': 1, 'world_size': 2, 'tensorboard': True, 'num_epochs': 20, 'max_updates': 40000, 'warmup_updates': 4000, 'freeze_updates': 4000, 'start_batch': 0, 'start_epoch': 1, 'seed': 1337, 'exp_dir': PosixPath('/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4'), 'save_every_n': 1500, 'keep_last_k': 1, 'keep_last_epoch': 1, 'grad_clip': True, 'feature_grad_mult': 0.1, 'lr': 0.0001, 'average_period': 200, 'train_on_average': False, 'musan_path': '/mntcephfs/lee_dataset/asr/musan', 'rir_path': '/mntcephfs/lee_dataset/asr/RIRS_NOISES', 'spk_path': '/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/data/alimeeting_ami_aishell_4', 'speaker_embedding_name_dir': 'cam++_zh-cn_200k_feature_dir', 'data_dir': '/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/data/alimeeting_ami_aishell_4', 'dataset_name': 'alimeeting_ami_aishell_4', 'max_num_speaker': 7, 'speech_encoder_path': '/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/zh/modelscope/speech_campplus_sv_zh-cn_16k-common/campplus_cn_common.bin', 'select_encoder_layer_nums': 6, 'wavlm_fuse_feat_post_norm': False, 'speech_encoder_config': '/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/wav-bert2.0/config.json', 'num_transformer_layer': 2, 'd_state': 256, 'expand': 4, 'speech_encoder_type': 'CAM++', 'speaker_embed_dim': 192, 'rs_len': 4, 'segment_shift': 2, 'single_backend_type': 'mamba2', 'multi_backend_type': 'transformer', 'do_finetune': False, 'init_modules': None, 'finetune_ckpt': None}
2025-02-14 09:43:15,289 (train_accelerate_ddp:873) INFO: data_cfg: TSVADDataConfig(data_dir='/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/data/alimeeting_ami_aishell_4', ts_len=6000, rs_len=4, segment_shift=2, spk_path='/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/data/alimeeting_ami_aishell_4', speech_encoder_type='CAM++', speaker_embedding_name_dir='cam++_zh-cn_200k_feature_dir', speaker_embed_dim=192, noise_ratio=0.8, zero_ratio=0.3, sample_rate=16000, max_num_speaker=7, dataset_name='alimeeting', embed_input=False, embed_len=1, embed_shift=0.4, label_rate=25, random_channel=False, random_mask_speaker_prob=0.0, random_mask_speaker_step=0, musan_path='/mntcephfs/lee_dataset/asr/musan', rir_path='/mntcephfs/lee_dataset/asr/RIRS_NOISES')
2025-02-14 09:43:15,289 (train_accelerate_ddp:873) INFO: data_cfg: TSVADDataConfig(data_dir='/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/data/alimeeting_ami_aishell_4', ts_len=6000, rs_len=4, segment_shift=2, spk_path='/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/data/alimeeting_ami_aishell_4', speech_encoder_type='CAM++', speaker_embedding_name_dir='cam++_zh-cn_200k_feature_dir', speaker_embed_dim=192, noise_ratio=0.8, zero_ratio=0.3, sample_rate=16000, max_num_speaker=7, dataset_name='alimeeting', embed_input=False, embed_len=1, embed_shift=0.4, label_rate=25, random_channel=False, random_mask_speaker_prob=0.0, random_mask_speaker_step=0, musan_path='/mntcephfs/lee_dataset/asr/musan', rir_path='/mntcephfs/lee_dataset/asr/RIRS_NOISES')
  0%|          | 0/145 [00:00<?, ?it/s]  0%|          | 0/145 [00:00<?, ?it/s] 23%|██▎       | 34/145 [00:00<00:00, 338.53it/s] 28%|██▊       | 41/145 [00:00<00:00, 407.60it/s] 52%|█████▏    | 76/145 [00:00<00:00, 380.90it/s] 60%|██████    | 87/145 [00:00<00:00, 432.95it/s] 86%|████████▌ | 125/145 [00:00<00:00, 426.67it/s]100%|██████████| 145/145 [00:00<00:00, 416.26it/s]
2025-02-14 09:43:15,692 (ts_vad_dataset:152) INFO: model expect fbank as input , fbank_input should be True !!!
2025-02-14 09:43:15,693 (ts_vad_dataset:160) INFO: loaded sentence=35332, shortest sent=640.0, longest sent=64000.0, rs_len=4, segment_shift=2,  rir=False, musan=False, noise_ratio=0.8, zero_ratio=0.3 
 96%|█████████▌| 139/145 [00:00<00:00, 471.60it/s]100%|██████████| 145/145 [00:00<00:00, 458.66it/s]
2025-02-14 09:43:15,747 (ts_vad_dataset:152) INFO: model expect fbank as input , fbank_input should be True !!!
2025-02-14 09:43:15,748 (ts_vad_dataset:160) INFO: loaded sentence=35332, shortest sent=640.0, longest sent=64000.0, rs_len=4, segment_shift=2,  rir=False, musan=False, noise_ratio=0.8, zero_ratio=0.3 
  0%|          | 0/2080 [00:00<?, ?it/s]  0%|          | 0/2080 [00:00<?, ?it/s]  1%|          | 22/2080 [00:00<00:09, 211.19it/s]  1%|▏         | 28/2080 [00:00<00:16, 122.54it/s]  2%|▏         | 44/2080 [00:00<00:15, 133.77it/s]  3%|▎         | 63/2080 [00:00<00:09, 209.65it/s]  3%|▎         | 72/2080 [00:00<00:11, 182.51it/s]  4%|▍         | 89/2080 [00:00<00:08, 224.73it/s]  5%|▍         | 95/2080 [00:00<00:10, 197.75it/s]  6%|▌         | 118/2080 [00:00<00:07, 246.03it/s]  6%|▌         | 125/2080 [00:00<00:08, 230.10it/s]  7%|▋         | 145/2080 [00:00<00:11, 173.25it/s]  7%|▋         | 150/2080 [00:00<00:11, 163.58it/s]  8%|▊         | 169/2080 [00:00<00:10, 188.90it/s]  8%|▊         | 176/2080 [00:00<00:10, 185.17it/s] 10%|▉         | 201/2080 [00:00<00:08, 221.38it/s] 10%|▉         | 206/2080 [00:01<00:09, 207.67it/s] 11%|█         | 227/2080 [00:01<00:08, 229.36it/s] 11%|█▏        | 237/2080 [00:01<00:07, 233.89it/s] 12%|█▏        | 257/2080 [00:01<00:07, 246.95it/s] 13%|█▎        | 267/2080 [00:01<00:07, 250.29it/s] 14%|█▍        | 288/2080 [00:01<00:06, 263.46it/s] 14%|█▍        | 294/2080 [00:01<00:11, 161.94it/s] 15%|█▌        | 316/2080 [00:01<00:10, 168.64it/s] 16%|█▌        | 324/2080 [00:01<00:09, 189.46it/s] 17%|█▋        | 348/2080 [00:01<00:08, 197.70it/s] 17%|█▋        | 357/2080 [00:01<00:07, 220.47it/s] 18%|█▊        | 381/2080 [00:01<00:07, 225.53it/s] 19%|█▊        | 388/2080 [00:01<00:07, 239.68it/s] 20%|█▉        | 411/2080 [00:01<00:06, 242.19it/s] 20%|██        | 420/2080 [00:01<00:06, 259.57it/s] 21%|██▏       | 445/2080 [00:02<00:06, 265.17it/s] 22%|██▏       | 452/2080 [00:02<00:05, 275.09it/s] 23%|██▎       | 481/2080 [00:02<00:05, 289.95it/s] 24%|██▎       | 490/2080 [00:02<00:05, 303.54it/s] 25%|██▍       | 513/2080 [00:02<00:05, 295.97it/s] 25%|██▌       | 523/2080 [00:02<00:05, 300.32it/s] 26%|██▌       | 545/2080 [00:02<00:05, 281.14it/s] 27%|██▋       | 555/2080 [00:02<00:05, 285.15it/s] 28%|██▊       | 579/2080 [00:02<00:08, 173.30it/s] 28%|██▊       | 585/2080 [00:02<00:08, 173.00it/s] 30%|██▉       | 615/2080 [00:02<00:07, 206.44it/s] 30%|██▉       | 620/2080 [00:02<00:07, 205.48it/s] 31%|███▏      | 651/2080 [00:02<00:06, 237.79it/s] 31%|███▏      | 654/2080 [00:02<00:06, 233.17it/s] 33%|███▎      | 681/2080 [00:03<00:06, 228.92it/s] 33%|███▎      | 683/2080 [00:03<00:06, 227.40it/s] 35%|███▍      | 718/2080 [00:03<00:05, 260.59it/s] 35%|███▍      | 723/2080 [00:03<00:05, 266.12it/s] 36%|███▋      | 756/2080 [00:03<00:04, 289.16it/s] 37%|███▋      | 762/2080 [00:03<00:04, 296.16it/s] 38%|███▊      | 793/2080 [00:03<00:04, 309.87it/s] 38%|███▊      | 798/2080 [00:03<00:04, 311.35it/s] 40%|███▉      | 831/2080 [00:03<00:03, 327.44it/s] 40%|████      | 834/2080 [00:03<00:03, 323.79it/s] 42%|████▏     | 866/2080 [00:03<00:03, 333.22it/s] 42%|████▏     | 869/2080 [00:03<00:03, 328.45it/s] 43%|████▎     | 904/2080 [00:03<00:03, 344.85it/s] 44%|████▎     | 908/2080 [00:03<00:03, 345.52it/s] 45%|████▌     | 943/2080 [00:03<00:03, 356.72it/s] 46%|████▌     | 947/2080 [00:03<00:03, 356.99it/s] 47%|████▋     | 983/2080 [00:03<00:02, 367.32it/s] 47%|████▋     | 987/2080 [00:03<00:02, 368.51it/s] 49%|████▉     | 1025/2080 [00:04<00:02, 370.91it/s] 49%|████▉     | 1021/2080 [00:03<00:02, 358.55it/s] 51%|█████▏    | 1067/2080 [00:04<00:02, 384.92it/s] 51%|█████     | 1062/2080 [00:04<00:02, 372.60it/s] 53%|█████▎    | 1107/2080 [00:04<00:02, 387.28it/s] 53%|█████▎    | 1101/2080 [00:04<00:02, 377.09it/s] 55%|█████▌    | 1146/2080 [00:04<00:02, 382.54it/s] 55%|█████▍    | 1139/2080 [00:04<00:02, 371.97it/s] 57%|█████▋    | 1185/2080 [00:04<00:02, 383.04it/s] 57%|█████▋    | 1177/2080 [00:04<00:02, 374.30it/s] 59%|█████▉    | 1230/2080 [00:04<00:02, 402.12it/s] 59%|█████▊    | 1221/2080 [00:04<00:02, 391.62it/s] 61%|██████    | 1271/2080 [00:04<00:02, 395.14it/s] 61%|██████    | 1261/2080 [00:04<00:02, 377.86it/s] 63%|██████▎   | 1314/2080 [00:04<00:01, 405.13it/s] 63%|██████▎   | 1302/2080 [00:04<00:02, 386.18it/s] 65%|██████▌   | 1360/2080 [00:04<00:01, 421.20it/s] 65%|██████▍   | 1346/2080 [00:04<00:01, 399.56it/s] 67%|██████▋   | 1403/2080 [00:04<00:01, 419.66it/s] 67%|██████▋   | 1389/2080 [00:04<00:01, 407.68it/s] 69%|██████▉   | 1430/2080 [00:05<00:01, 401.04it/s] 70%|██████▉   | 1446/2080 [00:05<00:01, 389.99it/s] 72%|███████▏  | 1488/2080 [00:05<00:01, 397.53it/s] 71%|███████   | 1471/2080 [00:05<00:01, 376.27it/s] 74%|███████▎  | 1529/2080 [00:05<00:01, 399.84it/s] 73%|███████▎  | 1509/2080 [00:05<00:01, 372.28it/s] 76%|███████▌  | 1578/2080 [00:05<00:01, 423.67it/s] 75%|███████▍  | 1554/2080 [00:05<00:01, 394.00it/s] 78%|███████▊  | 1621/2080 [00:05<00:01, 416.96it/s] 77%|███████▋  | 1594/2080 [00:05<00:01, 395.06it/s] 80%|████████  | 1668/2080 [00:05<00:00, 431.49it/s] 79%|███████▉  | 1638/2080 [00:05<00:01, 403.49it/s] 81%|████████  | 1684/2080 [00:05<00:00, 417.76it/s] 82%|████████▏ | 1712/2080 [00:05<00:00, 400.28it/s] 85%|████████▍ | 1760/2080 [00:05<00:00, 422.42it/s] 83%|████████▎ | 1726/2080 [00:05<00:00, 375.38it/s] 87%|████████▋ | 1803/2080 [00:05<00:00, 424.54it/s] 85%|████████▌ | 1774/2080 [00:05<00:00, 401.88it/s] 89%|████████▉ | 1851/2080 [00:06<00:00, 433.15it/s] 87%|████████▋ | 1816/2080 [00:05<00:00, 402.36it/s] 91%|█████████▏| 1899/2080 [00:06<00:00, 444.14it/s] 89%|████████▉ | 1857/2080 [00:06<00:00, 403.78it/s] 93%|█████████▎| 1944/2080 [00:06<00:00, 440.55it/s] 91%|█████████▏| 1903/2080 [00:06<00:00, 419.23it/s] 96%|█████████▌| 1993/2080 [00:06<00:00, 452.57it/s] 94%|█████████▎| 1946/2080 [00:06<00:00, 418.48it/s] 98%|█████████▊| 2042/2080 [00:06<00:00, 461.97it/s] 96%|█████████▌| 1992/2080 [00:06<00:00, 428.07it/s]100%|██████████| 2080/2080 [00:06<00:00, 319.65it/s]
 98%|█████████▊| 2038/2080 [00:06<00:00, 436.69it/s]2025-02-14 09:43:22,749 (ts_vad_dataset:152) INFO: model expect fbank as input , fbank_input should be True !!!
2025-02-14 09:43:22,760 (ts_vad_dataset:160) INFO: loaded sentence=526485, shortest sent=48640.0, longest sent=64000.0, rs_len=4, segment_shift=2,  rir=True, musan=True, noise_ratio=0.8, zero_ratio=0.3 
2025-02-14 09:43:22,760 (train_accelerate_ddp:908) INFO: The scale window is set to 8192.
100%|██████████| 2080/2080 [00:06<00:00, 316.01it/s]
2025-02-14 09:43:22,782 (ts_vad_dataset:152) INFO: model expect fbank as input , fbank_input should be True !!!
2025-02-14 09:43:22,793 (ts_vad_dataset:160) INFO: loaded sentence=526485, shortest sent=48640.0, longest sent=64000.0, rs_len=4, segment_shift=2,  rir=True, musan=True, noise_ratio=0.8, zero_ratio=0.3 
2025-02-14 09:43:22,793 (train_accelerate_ddp:908) INFO: The scale window is set to 8192.
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/accelerate/accelerator.py:494: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  self.scaler = torch.cuda.amp.GradScaler(**kwargs)
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/accelerate/accelerator.py:494: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  self.scaler = torch.cuda.amp.GradScaler(**kwargs)
2025-02-14 09:43:22,885 (train_accelerate_ddp:946) INFO: model_cfg: TSVADConfig(speech_encoder_path='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/zh/modelscope/speech_campplus_sv_zh-cn_16k-common/campplus_cn_common.bin', speech_encoder_type='CAM++', freeze_speech_encoder_updates=4000, num_attention_head=4, num_transformer_layer=2, transformer_embed_dim=384, transformer_ffn_embed_dim=1536, speaker_embed_dim=192, dropout=0.1, use_spk_embed=True, feature_grad_mult=0.1, whisper_n_mels=80, select_encoder_layer_nums=6, wavlm_fuse_feat_post_norm=False, speech_encoder_config='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/wav-bert2.0/config.json', single_backend_type='mamba2', multi_backend_type='transformer', d_state=256, expand=4)
2025-02-14 09:43:22,885 (other:349) WARNING: Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
self.wavlm_fuse_feat_post_norm: False
2025-02-14 09:43:22,885 (train_accelerate_ddp:946) INFO: model_cfg: TSVADConfig(speech_encoder_path='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/zh/modelscope/speech_campplus_sv_zh-cn_16k-common/campplus_cn_common.bin', speech_encoder_type='CAM++', freeze_speech_encoder_updates=4000, num_attention_head=4, num_transformer_layer=2, transformer_embed_dim=384, transformer_ffn_embed_dim=1536, speaker_embed_dim=192, dropout=0.1, use_spk_embed=True, feature_grad_mult=0.1, whisper_n_mels=80, select_encoder_layer_nums=6, wavlm_fuse_feat_post_norm=False, speech_encoder_config='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/wav-bert2.0/config.json', single_backend_type='mamba2', multi_backend_type='transformer', d_state=256, expand=4)
self.wavlm_fuse_feat_post_norm: False
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/model.py:953: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loadedState = torch.load(model_path, map_location=device)
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/model.py:953: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loadedState = torch.load(model_path, map_location=device)
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
2025-02-14 09:43:23,264 (train_accelerate_ddp:949) INFO: model: TSVADModel(
  (rs_dropout): Dropout(p=0.1, inplace=False)
  (speech_encoder): CAMPPlus(
    (head): FCM(
      (conv1): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (layer1): Sequential(
        (0): BasicResBlock(
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(2, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (shortcut): Sequential(
            (0): Conv2d(32, 32, kernel_size=(1, 1), stride=(2, 1), bias=False)
            (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicResBlock(
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (shortcut): Sequential()
        )
      )
      (layer2): Sequential(
        (0): BasicResBlock(
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(2, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (shortcut): Sequential(
            (0): Conv2d(32, 32, kernel_size=(1, 1), stride=(2, 1), bias=False)
            (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicResBlock(
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (shortcut): Sequential()
        )
      )
      (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(2, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (xvector): Sequential(
      (tdnn): TDNNLayer(
        (linear): Conv1d(320, 128, kernel_size=(5,), stride=(2,), padding=(2,), bias=False)
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
      )
      (block1): CAMDenseTDNNBlock(
        (0): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (1): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(160, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (2): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(192, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (3): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(224, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (4): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(256, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (5): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(288, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (6): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(320, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (7): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(352, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(352, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (8): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(384, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (9): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(416, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(416, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (10): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(448, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (11): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(480, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(480, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
      )
      (transit1): TransitLayer(
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
        (linear): Conv1d(512, 256, kernel_size=(1,), stride=(1,), bias=False)
      )
      (block2): CAMDenseTDNNBlock(
        (0): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(256, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (1): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(288, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (2): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(320, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (3): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(352, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(352, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (4): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(384, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (5): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(416, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(416, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (6): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(448, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (7): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(480, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(480, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (8): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(512, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (9): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(544, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(544, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (10): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(576, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (11): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(608, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(608, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (12): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(640, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (13): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(672, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(672, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (14): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(704, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(704, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (15): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(736, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(736, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (16): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(768, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (17): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(800, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(800, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (18): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(832, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(832, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (19): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(864, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(864, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (20): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(896, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(896, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (21): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(928, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(928, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (22): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(960, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(960, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (23): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(992, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(992, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
      )
      (transit2): TransitLayer(
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
        (linear): Conv1d(1024, 512, kernel_size=(1,), stride=(1,), bias=False)
      )
      (block3): CAMDenseTDNNBlock(
        (0): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(512, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (1): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(544, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(544, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (2): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(576, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (3): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(608, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(608, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (4): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(640, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (5): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(672, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(672, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (6): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(704, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(704, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (7): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(736, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(736, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (8): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(768, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (9): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(800, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(800, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (10): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(832, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(832, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (11): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(864, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(864, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (12): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(896, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(896, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (13): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(928, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(928, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (14): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(960, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(960, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (15): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(992, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(992, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
      )
      (transit3): TransitLayer(
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
        (linear): Conv1d(1024, 512, kernel_size=(1,), stride=(1,), bias=False)
      )
      (out_nonlinear): Sequential(
        (batchnorm): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (stats): StatsPool()
      (dense): DenseLayer(
        (linear): Conv1d(1024, 192, kernel_size=(1,), stride=(1,), bias=False)
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(192, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
        )
      )
    )
  )
  (speech_down_or_up): Sequential(
    (0): Conv1d(512, 192, kernel_size=(5,), stride=(2,), padding=(2,))
    (1): BatchNorm1D(
      (bn): BatchNorm1d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (2): ReLU()
  )
  (pos_encoder): PositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (single_backend): Mamba2BlockV2(
    (forward_blocks): ModuleList(
      (0-1): 2 x Block(
        (norm): RMSNorm()
        (mixer): Mamba2(
          (in_proj): Linear(in_features=384, out_features=3608, bias=False)
          (conv1d): Conv1d(2048, 2048, kernel_size=(4,), stride=(1,), padding=(3,), groups=2048)
          (act): SiLU()
          (norm): RMSNorm()
          (out_proj): Linear(in_features=1536, out_features=384, bias=False)
        )
      )
    )
    (backward_blocks): ModuleList(
      (0-1): 2 x Block(
        (norm): RMSNorm()
        (mixer): Mamba2(
          (in_proj): Linear(in_features=384, out_features=3608, bias=False)
          (conv1d): Conv1d(2048, 2048, kernel_size=(4,), stride=(1,), padding=(3,), groups=2048)
          (act): SiLU()
          (norm): RMSNorm()
          (out_proj): Linear(in_features=1536, out_features=384, bias=False)
        )
      )
    )
  )
  (backend_down): Sequential(
    (0): Conv1d(5376, 384, kernel_size=(5,), stride=(1,), padding=(2,))
    (1): BatchNorm1D(
      (bn): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (2): ReLU()
  )
  (multi_backend): TransformerEncoder(
    (layers): ModuleList(
      (0-1): 2 x TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=384, out_features=384, bias=True)
        )
        (linear1): Linear(in_features=384, out_features=1536, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=1536, out_features=384, bias=True)
        (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc): Linear(in_features=384, out_features=7, bias=True)
)
2025-02-14 09:43:23,265 (train_accelerate_ddp:949) INFO: model: TSVADModel(
  (rs_dropout): Dropout(p=0.1, inplace=False)
  (speech_encoder): CAMPPlus(
    (head): FCM(
      (conv1): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (layer1): Sequential(
        (0): BasicResBlock(
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(2, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (shortcut): Sequential(
            (0): Conv2d(32, 32, kernel_size=(1, 1), stride=(2, 1), bias=False)
            (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicResBlock(
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (shortcut): Sequential()
        )
      )
      (layer2): Sequential(
        (0): BasicResBlock(
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(2, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (shortcut): Sequential(
            (0): Conv2d(32, 32, kernel_size=(1, 1), stride=(2, 1), bias=False)
            (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicResBlock(
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (shortcut): Sequential()
        )
      )
      (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(2, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (xvector): Sequential(
      (tdnn): TDNNLayer(
        (linear): Conv1d(320, 128, kernel_size=(5,), stride=(2,), padding=(2,), bias=False)
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
      )
      (block1): CAMDenseTDNNBlock(
        (0): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (1): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(160, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (2): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(192, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (3): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(224, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (4): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(256, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (5): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(288, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (6): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(320, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (7): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(352, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(352, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (8): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(384, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (9): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(416, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(416, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (10): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(448, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (11): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(480, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(480, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
      )
      (transit1): TransitLayer(
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
        (linear): Conv1d(512, 256, kernel_size=(1,), stride=(1,), bias=False)
      )
      (block2): CAMDenseTDNNBlock(
        (0): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(256, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (1): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(288, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (2): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(320, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (3): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(352, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(352, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (4): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(384, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (5): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(416, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(416, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (6): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(448, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (7): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(480, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(480, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (8): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(512, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (9): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(544, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(544, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (10): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(576, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (11): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(608, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(608, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (12): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(640, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (13): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(672, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(672, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (14): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(704, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(704, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (15): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(736, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(736, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (16): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(768, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (17): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(800, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(800, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (18): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(832, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(832, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (19): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(864, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(864, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (20): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(896, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(896, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (21): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(928, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(928, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (22): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(960, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(960, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (23): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(992, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(992, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
      )
      (transit2): TransitLayer(
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
        (linear): Conv1d(1024, 512, kernel_size=(1,), stride=(1,), bias=False)
      )
      (block3): CAMDenseTDNNBlock(
        (0): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(512, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (1): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(544, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(544, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (2): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(576, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (3): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(608, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(608, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (4): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(640, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (5): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(672, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(672, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (6): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(704, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(704, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (7): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(736, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(736, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (8): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(768, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (9): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(800, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(800, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (10): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(832, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(832, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (11): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(864, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(864, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (12): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(896, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(896, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (13): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(928, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(928, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (14): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(960, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(960, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (15): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(992, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(992, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
      )
      (transit3): TransitLayer(
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
        (linear): Conv1d(1024, 512, kernel_size=(1,), stride=(1,), bias=False)
      )
      (out_nonlinear): Sequential(
        (batchnorm): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (stats): StatsPool()
      (dense): DenseLayer(
        (linear): Conv1d(1024, 192, kernel_size=(1,), stride=(1,), bias=False)
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(192, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
        )
      )
    )
  )
  (speech_down_or_up): Sequential(
    (0): Conv1d(512, 192, kernel_size=(5,), stride=(2,), padding=(2,))
    (1): BatchNorm1D(
      (bn): BatchNorm1d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (2): ReLU()
  )
  (pos_encoder): PositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (single_backend): Mamba2BlockV2(
    (forward_blocks): ModuleList(
      (0-1): 2 x Block(
        (norm): RMSNorm()
        (mixer): Mamba2(
          (in_proj): Linear(in_features=384, out_features=3608, bias=False)
          (conv1d): Conv1d(2048, 2048, kernel_size=(4,), stride=(1,), padding=(3,), groups=2048)
          (act): SiLU()
          (norm): RMSNorm()
          (out_proj): Linear(in_features=1536, out_features=384, bias=False)
        )
      )
    )
    (backward_blocks): ModuleList(
      (0-1): 2 x Block(
        (norm): RMSNorm()
        (mixer): Mamba2(
          (in_proj): Linear(in_features=384, out_features=3608, bias=False)
          (conv1d): Conv1d(2048, 2048, kernel_size=(4,), stride=(1,), padding=(3,), groups=2048)
          (act): SiLU()
          (norm): RMSNorm()
          (out_proj): Linear(in_features=1536, out_features=384, bias=False)
        )
      )
    )
  )
  (backend_down): Sequential(
    (0): Conv1d(5376, 384, kernel_size=(5,), stride=(1,), padding=(2,))
    (1): BatchNorm1D(
      (bn): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (2): ReLU()
  )
  (multi_backend): TransformerEncoder(
    (layers): ModuleList(
      (0-1): 2 x TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=384, out_features=384, bias=True)
        )
        (linear1): Linear(in_features=384, out_features=1536, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=1536, out_features=384, bias=True)
        (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc): Linear(in_features=384, out_features=7, bias=True)
)
2025-02-14 09:43:23,266 (train_accelerate_ddp:951) INFO: Number of model parameters: 29165447
2025-02-14 09:43:23,267 (train_accelerate_ddp:951) INFO: Number of model parameters: 29165447
pgpu27:192868:192868 [0] NCCL INFO Bootstrap : Using ib1:20.20.20.27<0>
pgpu27:192868:192868 [0] NCCL INFO NET/Plugin : dlerror=libnccl-net.so: cannot open shared object file: No such file or directory No plugin found (libnccl-net.so), using internal implementation
pgpu27:192868:192868 [0] NCCL INFO cudaDriverVersion 12000
NCCL version 2.20.5+cuda11.0
pgpu27:192869:192869 [1] NCCL INFO cudaDriverVersion 12000
pgpu27:192869:192869 [1] NCCL INFO Bootstrap : Using ib1:20.20.20.27<0>
pgpu27:192869:192869 [1] NCCL INFO NET/Plugin : dlerror=libnccl-net.so: cannot open shared object file: No such file or directory No plugin found (libnccl-net.so), using internal implementation
pgpu27:192869:192929 [1] NCCL INFO NET/IB : Using [0]mlx5_0:1/RoCE [1]mlx5_1:1/IB [2]mlx5_3:1/IB [RO]; OOB ib1:20.20.20.27<0>
pgpu27:192869:192929 [1] NCCL INFO Using non-device net plugin version 0
pgpu27:192869:192929 [1] NCCL INFO Using network IB
pgpu27:192868:192930 [0] NCCL INFO NET/IB : Using [0]mlx5_0:1/RoCE [1]mlx5_1:1/IB [2]mlx5_3:1/IB [RO]; OOB ib1:20.20.20.27<0>
pgpu27:192868:192930 [0] NCCL INFO Using non-device net plugin version 0
pgpu27:192868:192930 [0] NCCL INFO Using network IB
pgpu27:192868:192930 [0] NCCL INFO comm 0x555578f23350 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 63000 commId 0x27548203cf3df153 - Init START
pgpu27:192869:192929 [1] NCCL INFO comm 0x55557b0f9640 rank 1 nranks 2 cudaDev 1 nvmlDev 1 busId 68000 commId 0x27548203cf3df153 - Init START
pgpu27:192869:192929 [1] NCCL INFO Setting affinity for GPU 1 to 3f,00000000,00000000,00000000,0000023e
pgpu27:192868:192930 [0] NCCL INFO Setting affinity for GPU 0 to 3f,00000000,00000000,00000000,0000023e
pgpu27:192869:192929 [1] NCCL INFO comm 0x55557b0f9640 rank 1 nRanks 2 nNodes 1 localRanks 2 localRank 1 MNNVL 0
pgpu27:192868:192930 [0] NCCL INFO comm 0x555578f23350 rank 0 nRanks 2 nNodes 1 localRanks 2 localRank 0 MNNVL 0
pgpu27:192868:192930 [0] NCCL INFO Channel 00/16 :    0   1
pgpu27:192868:192930 [0] NCCL INFO Channel 01/16 :    0   1
pgpu27:192868:192930 [0] NCCL INFO Channel 02/16 :    0   1
pgpu27:192868:192930 [0] NCCL INFO Channel 03/16 :    0   1
pgpu27:192868:192930 [0] NCCL INFO Channel 04/16 :    0   1
pgpu27:192869:192929 [1] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] -1/-1/-1->1->0 [2] -1/-1/-1->1->0 [3] -1/-1/-1->1->0 [4] 0/-1/-1->1->-1 [5] 0/-1/-1->1->-1 [6] 0/-1/-1->1->-1 [7] 0/-1/-1->1->-1 [8] -1/-1/-1->1->0 [9] -1/-1/-1->1->0 [10] -1/-1/-1->1->0 [11] -1/-1/-1->1->0 [12] 0/-1/-1->1->-1 [13] 0/-1/-1->1->-1 [14] 0/-1/-1->1->-1 [15] 0/-1/-1->1->-1
pgpu27:192868:192930 [0] NCCL INFO Channel 05/16 :    0   1
pgpu27:192869:192929 [1] NCCL INFO P2P Chunksize set to 524288
pgpu27:192868:192930 [0] NCCL INFO Channel 06/16 :    0   1
pgpu27:192868:192930 [0] NCCL INFO Channel 07/16 :    0   1
pgpu27:192868:192930 [0] NCCL INFO Channel 08/16 :    0   1
pgpu27:192868:192930 [0] NCCL INFO Channel 09/16 :    0   1
pgpu27:192868:192930 [0] NCCL INFO Channel 10/16 :    0   1
pgpu27:192868:192930 [0] NCCL INFO Channel 11/16 :    0   1
pgpu27:192868:192930 [0] NCCL INFO Channel 12/16 :    0   1
pgpu27:192868:192930 [0] NCCL INFO Channel 13/16 :    0   1
pgpu27:192868:192930 [0] NCCL INFO Channel 14/16 :    0   1
pgpu27:192868:192930 [0] NCCL INFO Channel 15/16 :    0   1
pgpu27:192868:192930 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1 [2] 1/-1/-1->0->-1 [3] 1/-1/-1->0->-1 [4] -1/-1/-1->0->1 [5] -1/-1/-1->0->1 [6] -1/-1/-1->0->1 [7] -1/-1/-1->0->1 [8] 1/-1/-1->0->-1 [9] 1/-1/-1->0->-1 [10] 1/-1/-1->0->-1 [11] 1/-1/-1->0->-1 [12] -1/-1/-1->0->1 [13] -1/-1/-1->0->1 [14] -1/-1/-1->0->1 [15] -1/-1/-1->0->1
pgpu27:192868:192930 [0] NCCL INFO P2P Chunksize set to 524288
pgpu27:192869:192929 [1] NCCL INFO Channel 00/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu27:192868:192930 [0] NCCL INFO Channel 00/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu27:192869:192929 [1] NCCL INFO Channel 01/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu27:192868:192930 [0] NCCL INFO Channel 01/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu27:192869:192929 [1] NCCL INFO Channel 02/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu27:192868:192930 [0] NCCL INFO Channel 02/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu27:192869:192929 [1] NCCL INFO Channel 03/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu27:192868:192930 [0] NCCL INFO Channel 03/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu27:192869:192929 [1] NCCL INFO Channel 04/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu27:192868:192930 [0] NCCL INFO Channel 04/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu27:192869:192929 [1] NCCL INFO Channel 05/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu27:192868:192930 [0] NCCL INFO Channel 05/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu27:192869:192929 [1] NCCL INFO Channel 06/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu27:192868:192930 [0] NCCL INFO Channel 06/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu27:192869:192929 [1] NCCL INFO Channel 07/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu27:192868:192930 [0] NCCL INFO Channel 07/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu27:192869:192929 [1] NCCL INFO Channel 08/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu27:192868:192930 [0] NCCL INFO Channel 08/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu27:192869:192929 [1] NCCL INFO Channel 09/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu27:192868:192930 [0] NCCL INFO Channel 09/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu27:192869:192929 [1] NCCL INFO Channel 10/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu27:192868:192930 [0] NCCL INFO Channel 10/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu27:192869:192929 [1] NCCL INFO Channel 11/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu27:192868:192930 [0] NCCL INFO Channel 11/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu27:192869:192929 [1] NCCL INFO Channel 12/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu27:192868:192930 [0] NCCL INFO Channel 12/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu27:192869:192929 [1] NCCL INFO Channel 13/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu27:192868:192930 [0] NCCL INFO Channel 13/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu27:192869:192929 [1] NCCL INFO Channel 14/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu27:192868:192930 [0] NCCL INFO Channel 14/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu27:192869:192929 [1] NCCL INFO Channel 15/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu27:192868:192930 [0] NCCL INFO Channel 15/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu27:192869:192929 [1] NCCL INFO Connected all rings
pgpu27:192869:192929 [1] NCCL INFO Connected all trees
pgpu27:192868:192930 [0] NCCL INFO Connected all rings
pgpu27:192869:192929 [1] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
pgpu27:192869:192929 [1] NCCL INFO 16 coll channels, 0 collnet channels, 0 nvls channels, 16 p2p channels, 16 p2p channels per peer
pgpu27:192868:192930 [0] NCCL INFO Connected all trees
pgpu27:192868:192930 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
pgpu27:192868:192930 [0] NCCL INFO 16 coll channels, 0 collnet channels, 0 nvls channels, 16 p2p channels, 16 p2p channels per peer
pgpu27:192868:192930 [0] NCCL INFO comm 0x555578f23350 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 63000 commId 0x27548203cf3df153 - Init COMPLETE
pgpu27:192869:192929 [1] NCCL INFO comm 0x55557b0f9640 rank 1 nranks 2 cudaDev 1 nvmlDev 1 busId 68000 commId 0x27548203cf3df153 - Init COMPLETE
2025-02-14 09:43:26,002 (train_accelerate_ddp:1032) INFO: start training from epoch 1
2025-02-14 09:43:26,003 (train_accelerate_ddp:1033) INFO: Train set grouped total_num_itrs = 4114
2025-02-14 09:43:26,003 (train_accelerate_ddp:1032) INFO: start training from epoch 1
2025-02-14 09:43:26,003 (train_accelerate_ddp:1033) INFO: Train set grouped total_num_itrs = 4114
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/ts_vad_dataset.py:392: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  feature = torch.load(path, map_location="cpu")
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/ts_vad_dataset.py:392: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  feature = torch.load(path, map_location="cpu")
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/ts_vad_dataset.py:398: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  feature = torch.load(path, map_location="cpu")
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/ts_vad_dataset.py:398: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  feature = torch.load(path, map_location="cpu")
2025-02-14 09:43:54,115 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 0, num_updates: 0, {'loss': 0.7481842041015625, 'DER': 3.046928201332346, 'ACC': np.float64(0.4663839285714285), 'MI': 0.009030347890451517, 'FA': 2.545817912657291, 'CF': 0.492079940784604}, batch size: 64, grad_norm: 2.533700942993164, grad_scale: , lr: 5.00e-08, 
2025-02-14 09:43:54,115 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 0, num_updates: 0, {'loss': 0.7348166704177856, 'DER': 2.834570668160807, 'ACC': np.float64(0.47957589285714286), 'MI': 0.008544614091609469, 'FA': 2.3947331559041882, 'CF': 0.4312928981650091}, batch size: 64, grad_norm: 2.533700942993164, grad_scale: , lr: 5.00e-08, 
2025-02-14 09:53:31,784 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 500, num_updates: 500, {'loss': 0.3239254355430603, 'DER': 0.7830558938963323, 'ACC': np.float64(0.8687053571428571), 'MI': 0.7528758966030586, 'FA': 0.01718771146298552, 'CF': 0.012992285830288266}, batch size: 64, grad_norm: 0.44127219915390015, grad_scale: , lr: 2.51e-05, 
2025-02-14 09:53:31,785 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 500, num_updates: 500, {'loss': 0.334788054227829, 'DER': 0.8409157616671559, 'ACC': np.float64(0.8615848214285714), 'MI': 0.7060463751100675, 'FA': 0.06574699148811271, 'CF': 0.06912239506897563}, batch size: 64, grad_norm: 0.44127219915390015, grad_scale: , lr: 2.51e-05, 
2025-02-14 09:53:31,785 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 09:53:31,785 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 09:54:03,858 (model:925) WARNING: All labels are zero
2025-02-14 09:54:04,556 (model:925) WARNING: All labels are zero
2025-02-14 09:54:04,950 (model:925) WARNING: All labels are zero
2025-02-14 09:55:03,126 (model:925) WARNING: All labels are zero
2025-02-14 09:55:10,834 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 500,  validation: loss=0.3282, DER=0.9805, ACC=0.8506, MI=0.9708, FA=0.0003856, CF=0.009334, over 0.00 frames. 
2025-02-14 09:55:10,835 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 3900MB
2025-02-14 09:55:11,894 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 500,  validation: loss=0.3292, DER=0.983, ACC=0.848, MI=0.972, FA=0.000235, CF=0.01076, over 0.00 frames. 
2025-02-14 09:55:11,895 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 3900MB
2025-02-14 10:03:44,426 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 1000, num_updates: 1000, {'loss': 0.2783156633377075, 'DER': 0.725609756097561, 'ACC': np.float64(0.8705357142857143), 'MI': 0.5101626016260162, 'FA': 0.09901277584204414, 'CF': 0.11643437862950058}, batch size: 64, grad_norm: 0.46207353472709656, grad_scale: , lr: 5.00e-05, 
2025-02-14 10:03:44,427 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 10:03:44,427 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 1000, num_updates: 1000, {'loss': 0.25672447681427, 'DER': 0.6592693236714976, 'ACC': np.float64(0.8838616071428571), 'MI': 0.4414251207729469, 'FA': 0.0916364734299517, 'CF': 0.12620772946859904}, batch size: 64, grad_norm: 0.46207353472709656, grad_scale: , lr: 5.00e-05, 
2025-02-14 10:03:44,427 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 10:04:16,260 (model:925) WARNING: All labels are zero
2025-02-14 10:04:16,263 (model:925) WARNING: All labels are zero
2025-02-14 10:04:16,649 (model:925) WARNING: All labels are zero
2025-02-14 10:05:14,743 (model:925) WARNING: All labels are zero
2025-02-14 10:05:22,401 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 1000,  validation: loss=0.2921, DER=0.8482, ACC=0.8567, MI=0.7299, FA=0.01645, CF=0.1018, over 0.00 frames. 
2025-02-14 10:05:22,401 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 3900MB
2025-02-14 10:05:23,410 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 1000,  validation: loss=0.2913, DER=0.8395, ACC=0.8562, MI=0.7226, FA=0.01533, CF=0.1016, over 0.00 frames. 
2025-02-14 10:05:23,411 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 3900MB
2025-02-14 10:13:52,666 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-1500.pt
2025-02-14 10:13:53,040 (checkpoint:355) WARNING: No checkpoints found in /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4
2025-02-14 10:13:53,814 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 1500, num_updates: 1500, {'loss': 0.21064019203186035, 'DER': 0.4737120211360634, 'ACC': np.float64(0.9014285714285714), 'MI': 0.2939233817701453, 'FA': 0.07014531043593131, 'CF': 0.1096433289299868}, batch size: 64, grad_norm: 0.4137887954711914, grad_scale: , lr: 7.50e-05, 
2025-02-14 10:13:53,814 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 10:13:53,814 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 1500, num_updates: 1500, {'loss': 0.22959914803504944, 'DER': 0.5913490623109497, 'ACC': np.float64(0.8914732142857144), 'MI': 0.32274652147610405, 'FA': 0.12462189957652753, 'CF': 0.14398064125831822}, batch size: 64, grad_norm: 0.4137887954711914, grad_scale: , lr: 7.50e-05, 
2025-02-14 10:13:53,814 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 10:14:25,550 (model:925) WARNING: All labels are zero
2025-02-14 10:14:25,917 (model:925) WARNING: All labels are zero
2025-02-14 10:14:26,311 (model:925) WARNING: All labels are zero
2025-02-14 10:15:23,612 (model:925) WARNING: All labels are zero
2025-02-14 10:15:31,205 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 1500,  validation: loss=0.2438, DER=0.6346, ACC=0.8828, MI=0.4305, FA=0.06422, CF=0.1398, over 0.00 frames. 
2025-02-14 10:15:31,206 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 3900MB
2025-02-14 10:15:33,609 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 1500,  validation: loss=0.2442, DER=0.6358, ACC=0.8827, MI=0.4365, FA=0.06801, CF=0.1313, over 0.00 frames. 
2025-02-14 10:15:33,609 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 3900MB
2025-02-14 10:23:58,961 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 2000, num_updates: 2000, {'loss': 0.21274109184741974, 'DER': 0.5219945766797228, 'ACC': np.float64(0.9004017857142856), 'MI': 0.2612232600180777, 'FA': 0.11057547454052426, 'CF': 0.15019584212112083}, batch size: 64, grad_norm: 0.5257411003112793, grad_scale: , lr: 1.00e-04, 
2025-02-14 10:23:58,961 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 2000, num_updates: 2000, {'loss': 0.2550666630268097, 'DER': 0.5608914450035946, 'ACC': np.float64(0.88734375), 'MI': 0.30496046010064704, 'FA': 0.09115744069015097, 'CF': 0.16477354421279655}, batch size: 64, grad_norm: 0.5257411003112793, grad_scale: , lr: 1.00e-04, 
2025-02-14 10:23:58,962 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 10:23:58,962 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 10:24:30,614 (model:925) WARNING: All labels are zero
2025-02-14 10:24:30,981 (model:925) WARNING: All labels are zero
2025-02-14 10:24:31,377 (model:925) WARNING: All labels are zero
2025-02-14 10:25:28,547 (model:925) WARNING: All labels are zero
2025-02-14 10:25:36,141 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 2000,  validation: loss=0.2059, DER=0.492, ACC=0.9043, MI=0.2178, FA=0.1415, CF=0.1327, over 0.00 frames. 
2025-02-14 10:25:36,141 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 3900MB
2025-02-14 10:25:38,378 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 2000,  validation: loss=0.2095, DER=0.4959, ACC=0.9021, MI=0.2192, FA=0.1416, CF=0.1351, over 0.00 frames. 
2025-02-14 10:25:38,378 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 3900MB
2025-02-14 10:34:19,214 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 2500, num_updates: 2500, {'loss': 0.22065521776676178, 'DER': 0.5162241887905604, 'ACC': np.float64(0.9023660714285714), 'MI': 0.336283185840708, 'FA': 0.08175305520438264, 'CF': 0.09818794774546986}, batch size: 64, grad_norm: 0.38787493109703064, grad_scale: , lr: 9.72e-05, 
2025-02-14 10:34:19,215 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 2500, num_updates: 2500, {'loss': 0.1945299655199051, 'DER': 0.4406412478336222, 'ACC': np.float64(0.9141294642857143), 'MI': 0.24234546504910456, 'FA': 0.08333333333333333, 'CF': 0.11496244945118429}, batch size: 64, grad_norm: 0.38787493109703064, grad_scale: , lr: 9.72e-05, 
2025-02-14 10:34:19,215 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 10:34:19,215 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 10:34:51,037 (model:925) WARNING: All labels are zero
2025-02-14 10:34:51,545 (model:925) WARNING: All labels are zero
2025-02-14 10:34:51,942 (model:925) WARNING: All labels are zero
2025-02-14 10:35:49,483 (model:925) WARNING: All labels are zero
2025-02-14 10:35:57,131 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 2500,  validation: loss=0.182, DER=0.4343, ACC=0.9166, MI=0.2158, FA=0.1063, CF=0.1122, over 0.00 frames. 
2025-02-14 10:35:57,132 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 3900MB
2025-02-14 10:35:59,836 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 2500,  validation: loss=0.1853, DER=0.4374, ACC=0.9146, MI=0.2158, FA=0.1069, CF=0.1147, over 0.00 frames. 
2025-02-14 10:35:59,837 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 3900MB
2025-02-14 10:44:41,381 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-3000.pt
2025-02-14 10:44:41,747 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-14 10:44:41,767 (checkpoint:355) WARNING: No checkpoints found in /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4
2025-02-14 10:44:42,679 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 3000, num_updates: 3000, {'loss': 0.21064673364162445, 'DER': 0.5029923451635352, 'ACC': np.float64(0.9048660714285713), 'MI': 0.3395963813500348, 'FA': 0.07320807237299931, 'CF': 0.09018789144050104}, batch size: 64, grad_norm: 0.3684777319431305, grad_scale: , lr: 9.44e-05, 
2025-02-14 10:44:42,680 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 10:44:42,680 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 3000, num_updates: 3000, {'loss': 0.14801792800426483, 'DER': 0.3669724770642202, 'ACC': np.float64(0.9328571428571429), 'MI': 0.20023299839813602, 'FA': 0.09567496723460026, 'CF': 0.07106451143148391}, batch size: 64, grad_norm: 0.3684777319431305, grad_scale: , lr: 9.44e-05, 
2025-02-14 10:44:42,680 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 10:45:14,503 (model:925) WARNING: All labels are zero
2025-02-14 10:45:15,060 (model:925) WARNING: All labels are zero
2025-02-14 10:45:15,459 (model:925) WARNING: All labels are zero
2025-02-14 10:46:12,905 (model:925) WARNING: All labels are zero
2025-02-14 10:46:20,560 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 3000,  validation: loss=0.1706, DER=0.3861, ACC=0.9279, MI=0.1701, FA=0.1352, CF=0.08082, over 0.00 frames. 
2025-02-14 10:46:20,560 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 3900MB
2025-02-14 10:46:23,549 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 3000,  validation: loss=0.1723, DER=0.3886, ACC=0.9269, MI=0.1742, FA=0.1363, CF=0.07805, over 0.00 frames. 
2025-02-14 10:46:23,549 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 3900MB
2025-02-14 10:55:09,692 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 3500, num_updates: 3500, {'loss': 0.1779380738735199, 'DER': 0.38010099631499933, 'ACC': np.float64(0.920513392857143), 'MI': 0.2111368909512761, 'FA': 0.06305445612119558, 'CF': 0.10590964924252763}, batch size: 64, grad_norm: 0.4093044102191925, grad_scale: , lr: 9.17e-05, 
2025-02-14 10:55:09,692 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 3500, num_updates: 3500, {'loss': 0.18165677785873413, 'DER': 0.4156687346703217, 'ACC': np.float64(0.92265625), 'MI': 0.2696580580002886, 'FA': 0.06175155100274131, 'CF': 0.08425912566729188}, batch size: 64, grad_norm: 0.4093044102191925, grad_scale: , lr: 9.17e-05, 
2025-02-14 10:55:09,693 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 10:55:09,693 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 10:55:41,631 (model:925) WARNING: All labels are zero
2025-02-14 10:55:42,320 (model:925) WARNING: All labels are zero
2025-02-14 10:55:42,723 (model:925) WARNING: All labels are zero
2025-02-14 10:56:40,111 (model:925) WARNING: All labels are zero
2025-02-14 10:56:47,777 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 3500,  validation: loss=0.1505, DER=0.349, ACC=0.9325, MI=0.1695, FA=0.09557, CF=0.0839, over 0.00 frames. 
2025-02-14 10:56:47,777 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 3900MB
2025-02-14 10:56:51,068 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 3500,  validation: loss=0.1532, DER=0.354, ACC=0.9309, MI=0.1715, FA=0.09742, CF=0.08507, over 0.00 frames. 
2025-02-14 10:56:51,068 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 3900MB
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
2025-02-14 11:05:52,006 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 4000, num_updates: 4000, {'loss': 0.13455523550510406, 'DER': 0.323123820583539, 'ACC': np.float64(0.9433705357142856), 'MI': 0.20888372768181157, 'FA': 0.06909565974742343, 'CF': 0.04514443315430396}, batch size: 64, grad_norm: 0.3787543475627899, grad_scale: , lr: 8.89e-05, 
2025-02-14 11:05:52,007 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 11:05:52,007 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 4000, num_updates: 4000, {'loss': 0.1951865255832672, 'DER': 0.4323651452282158, 'ACC': np.float64(0.9158928571428571), 'MI': 0.27676348547717844, 'FA': 0.06680497925311203, 'CF': 0.08879668049792531}, batch size: 64, grad_norm: 0.3787543475627899, grad_scale: , lr: 8.89e-05, 
2025-02-14 11:05:52,007 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 11:06:24,646 (model:925) WARNING: All labels are zero
2025-02-14 11:06:24,796 (model:925) WARNING: All labels are zero
2025-02-14 11:06:25,197 (model:925) WARNING: All labels are zero
2025-02-14 11:07:24,428 (model:925) WARNING: All labels are zero
2025-02-14 11:07:32,239 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 4000,  validation: loss=0.152, DER=0.354, ACC=0.9322, MI=0.1484, FA=0.1144, CF=0.09124, over 0.00 frames. 
2025-02-14 11:07:32,240 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6682MB
2025-02-14 11:07:33,910 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 4000,  validation: loss=0.1527, DER=0.351, ACC=0.9318, MI=0.1479, FA=0.1136, CF=0.08954, over 0.00 frames. 
2025-02-14 11:07:33,910 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6682MB
2025-02-14 11:09:44,070 (train_accelerate_ddp:713) INFO: end of epoch 1, batch_idx: 4113 batch_idx_train: 4113, {'loss': 0.12578722834587097, 'DER': 0.2765179224579371, 'ACC': np.float64(0.9506473214285713), 'MI': 0.15976591075347477, 'FA': 0.0697878566203365, 'CF': 0.046964155084125825}, batch size: 64, grad_norm: 0.34550026059150696, grad_scale: , lr: 8.83e-05, 
2025-02-14 11:09:44,070 (train_accelerate_ddp:713) INFO: end of epoch 1, batch_idx: 4113 batch_idx_train: 4113, {'loss': 0.15984870493412018, 'DER': 0.4075907590759076, 'ACC': np.float64(0.9230803571428571), 'MI': 0.20552055205520553, 'FA': 0.0927092709270927, 'CF': 0.10936093609360936}, batch size: 64, grad_norm: 0.34550026059150696, grad_scale: , lr: 8.83e-05, 
2025-02-14 11:09:44,072 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-1.pt
2025-02-14 11:09:44,419 (train_accelerate_ddp:561) INFO:  end of epoch 1, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-1.pt 
2025-02-14 11:09:47,014 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 4114, num_updates: 4000, {'loss': 0.1614711880683899, 'DER': 0.4078196347031963, 'ACC': np.float64(0.9248660714285714), 'MI': 0.2701198630136986, 'FA': 0.06521118721461187, 'CF': 0.07248858447488585}, batch size: 64, grad_norm: 0.3084302842617035, grad_scale: , lr: 8.83e-05, 
2025-02-14 11:09:47,015 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 4114, num_updates: 4000, {'loss': 0.14205676317214966, 'DER': 0.33160698431488606, 'ACC': np.float64(0.9417857142857143), 'MI': 0.2005031074282332, 'FA': 0.07679786919206866, 'CF': 0.0543060076945842}, batch size: 64, grad_norm: 0.3084302842617035, grad_scale: , lr: 8.83e-05, 
2025-02-14 11:17:23,634 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-4500.pt
2025-02-14 11:17:24,120 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-14 11:19:40,125 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 4614, num_updates: 4500, {'loss': 0.16045144200325012, 'DER': 0.39959273182957394, 'ACC': np.float64(0.928794642857143), 'MI': 0.1799812030075188, 'FA': 0.11951754385964912, 'CF': 0.10009398496240601}, batch size: 64, grad_norm: 0.32210978865623474, grad_scale: , lr: 8.55e-05, 
2025-02-14 11:19:40,126 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 11:19:40,127 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 4614, num_updates: 4500, {'loss': 0.12050911784172058, 'DER': 0.31216173193250557, 'ACC': np.float64(0.9454017857142857), 'MI': 0.1308500477554919, 'FA': 0.1041069723018147, 'CF': 0.07720471187519898}, batch size: 64, grad_norm: 0.32210978865623474, grad_scale: , lr: 8.55e-05, 
2025-02-14 11:19:40,128 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 11:20:13,759 (model:925) WARNING: All labels are zero
2025-02-14 11:20:14,174 (model:925) WARNING: All labels are zero
2025-02-14 11:20:18,129 (model:925) WARNING: All labels are zero
2025-02-14 11:21:22,801 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 4614,  validation: loss=0.1352, DER=0.2999, ACC=0.9414, MI=0.1262, FA=0.1099, CF=0.06381, over 0.00 frames. 
2025-02-14 11:21:22,802 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6684MB
2025-02-14 11:21:27,613 (model:925) WARNING: All labels are zero
2025-02-14 11:21:36,505 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 4614,  validation: loss=0.1332, DER=0.2958, ACC=0.9427, MI=0.1267, FA=0.1061, CF=0.06302, over 0.00 frames. 
2025-02-14 11:21:36,506 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6684MB
2025-02-14 11:31:32,432 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 5114, num_updates: 5000, {'loss': 0.12848591804504395, 'DER': 0.2926322043969103, 'ACC': np.float64(0.9471651785714286), 'MI': 0.1424539512774807, 'FA': 0.09120617944147356, 'CF': 0.05897207367795603}, batch size: 64, grad_norm: 0.2809969186782837, grad_scale: , lr: 8.27e-05, 
2025-02-14 11:31:32,432 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 5114, num_updates: 5000, {'loss': 0.1529543548822403, 'DER': 0.36787709497206705, 'ACC': np.float64(0.9304017857142857), 'MI': 0.23268156424581005, 'FA': 0.06759776536312849, 'CF': 0.06759776536312849}, batch size: 64, grad_norm: 0.2809969186782837, grad_scale: , lr: 8.27e-05, 
2025-02-14 11:31:32,432 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 11:31:32,432 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 11:32:04,847 (model:925) WARNING: All labels are zero
2025-02-14 11:32:05,076 (model:925) WARNING: All labels are zero
2025-02-14 11:32:05,249 (model:925) WARNING: All labels are zero
2025-02-14 11:33:04,987 (model:925) WARNING: All labels are zero
2025-02-14 11:33:12,829 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 5114,  validation: loss=0.1225, DER=0.2821, ACC=0.9453, MI=0.1327, FA=0.08839, CF=0.06099, over 0.00 frames. 
2025-02-14 11:33:12,830 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6684MB
2025-02-14 11:33:13,386 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 5114,  validation: loss=0.1245, DER=0.28, ACC=0.9445, MI=0.1308, FA=0.08643, CF=0.06275, over 0.00 frames. 
2025-02-14 11:33:13,387 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6684MB
2025-02-14 11:43:02,802 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 5614, num_updates: 5500, {'loss': 0.15868328511714935, 'DER': 0.3577346190411517, 'ACC': np.float64(0.9312723214285714), 'MI': 0.205486893929105, 'FA': 0.09181040336819231, 'CF': 0.060437321743854404}, batch size: 64, grad_norm: 0.25184109807014465, grad_scale: , lr: 7.99e-05, 
2025-02-14 11:43:02,803 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 11:43:03,431 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 5614, num_updates: 5500, {'loss': 0.1269056349992752, 'DER': 0.3040629095674967, 'ACC': np.float64(0.9407366071428571), 'MI': 0.12538226299694188, 'FA': 0.09611183923110529, 'CF': 0.08256880733944955}, batch size: 64, grad_norm: 0.25184109807014465, grad_scale: , lr: 7.99e-05, 
2025-02-14 11:43:03,431 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 11:43:36,106 (model:925) WARNING: All labels are zero
2025-02-14 11:43:41,347 (model:925) WARNING: All labels are zero
2025-02-14 11:43:41,810 (model:925) WARNING: All labels are zero
2025-02-14 11:44:36,057 (model:925) WARNING: All labels are zero
2025-02-14 11:44:43,895 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 5614,  validation: loss=0.1165, DER=0.2719, ACC=0.9481, MI=0.1163, FA=0.102, CF=0.05362, over 0.00 frames. 
2025-02-14 11:44:43,895 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6684MB
2025-02-14 11:45:01,402 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 5614,  validation: loss=0.1186, DER=0.2725, ACC=0.9467, MI=0.1134, FA=0.1026, CF=0.05661, over 0.00 frames. 
2025-02-14 11:45:01,402 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6684MB
2025-02-14 11:52:36,678 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-6000.pt
2025-02-14 11:52:37,155 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-14 11:54:56,099 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 6114, num_updates: 6000, {'loss': 0.11928372830152512, 'DER': 0.2842135559073248, 'ACC': np.float64(0.9471651785714286), 'MI': 0.1623255144625126, 'FA': 0.06547704705713052, 'CF': 0.05641099438768168}, batch size: 64, grad_norm: 0.25666460394859314, grad_scale: , lr: 7.71e-05, 
2025-02-14 11:54:56,099 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 6114, num_updates: 6000, {'loss': 0.12622316181659698, 'DER': 0.28919131117508506, 'ACC': np.float64(0.9462723214285714), 'MI': 0.19471342580476314, 'FA': 0.06869929337869668, 'CF': 0.02577859199162523}, batch size: 64, grad_norm: 0.25666460394859314, grad_scale: , lr: 7.71e-05, 
2025-02-14 11:54:56,099 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 11:54:56,099 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 11:55:28,615 (model:925) WARNING: All labels are zero
2025-02-14 11:55:29,003 (model:925) WARNING: All labels are zero
2025-02-14 11:55:29,010 (model:925) WARNING: All labels are zero
2025-02-14 11:56:28,897 (model:925) WARNING: All labels are zero
2025-02-14 11:56:36,622 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 6114,  validation: loss=0.1146, DER=0.2639, ACC=0.9478, MI=0.1213, FA=0.08442, CF=0.05813, over 0.00 frames. 
2025-02-14 11:56:36,622 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6684MB
2025-02-14 11:56:36,779 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 6114,  validation: loss=0.1128, DER=0.263, ACC=0.949, MI=0.1229, FA=0.08333, CF=0.05677, over 0.00 frames. 
2025-02-14 11:56:36,780 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6684MB
2025-02-14 12:06:23,480 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 6614, num_updates: 6500, {'loss': 0.1280674785375595, 'DER': 0.32347109958822634, 'ACC': np.float64(0.946763392857143), 'MI': 0.20863199633978954, 'FA': 0.0745767881653195, 'CF': 0.04026231508311728}, batch size: 64, grad_norm: 0.31090399622917175, grad_scale: , lr: 7.44e-05, 
2025-02-14 12:06:23,480 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 6614, num_updates: 6500, {'loss': 0.1397249847650528, 'DER': 0.3067755757900375, 'ACC': np.float64(0.9418973214285714), 'MI': 0.22241564006427425, 'FA': 0.04258168184252812, 'CF': 0.04177825388323514}, batch size: 64, grad_norm: 0.31090399622917175, grad_scale: , lr: 7.44e-05, 
2025-02-14 12:06:23,481 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 12:06:23,481 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 12:06:55,871 (model:925) WARNING: All labels are zero
2025-02-14 12:06:55,933 (model:925) WARNING: All labels are zero
2025-02-14 12:06:56,333 (model:925) WARNING: All labels are zero
2025-02-14 12:07:55,169 (model:925) WARNING: All labels are zero
2025-02-14 12:08:02,948 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 6614,  validation: loss=0.1068, DER=0.2431, ACC=0.953, MI=0.1326, FA=0.06671, CF=0.04384, over 0.00 frames. 
2025-02-14 12:08:02,949 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6684MB
2025-02-14 12:08:04,568 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 6614,  validation: loss=0.1095, DER=0.2433, ACC=0.9518, MI=0.1312, FA=0.06569, CF=0.04636, over 0.00 frames. 
2025-02-14 12:08:04,568 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6684MB
2025-02-14 12:18:12,991 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 7114, num_updates: 7000, {'loss': 0.15550313889980316, 'DER': 0.38781083800488714, 'ACC': np.float64(0.9234821428571429), 'MI': 0.1894494753485698, 'FA': 0.09343107661348282, 'CF': 0.10493028604283455}, batch size: 64, grad_norm: 0.30226269364356995, grad_scale: , lr: 7.16e-05, 
2025-02-14 12:18:12,991 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 7114, num_updates: 7000, {'loss': 0.14600209891796112, 'DER': 0.34078045874292523, 'ACC': np.float64(0.9393526785714286), 'MI': 0.16785820673220136, 'FA': 0.10902591599642537, 'CF': 0.06389633601429848}, batch size: 64, grad_norm: 0.30226269364356995, grad_scale: , lr: 7.16e-05, 
2025-02-14 12:18:12,992 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 12:18:12,992 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 12:18:46,439 (model:925) WARNING: All labels are zero
2025-02-14 12:18:46,489 (model:925) WARNING: All labels are zero
2025-02-14 12:18:46,851 (model:925) WARNING: All labels are zero
2025-02-14 12:19:46,899 (model:925) WARNING: All labels are zero
2025-02-14 12:19:54,784 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 7114,  validation: loss=0.1055, DER=0.247, ACC=0.9519, MI=0.1109, FA=0.08835, CF=0.04779, over 0.00 frames. 
2025-02-14 12:19:54,785 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6684MB
2025-02-14 12:19:57,171 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 7114,  validation: loss=0.1082, DER=0.2475, ACC=0.9507, MI=0.1093, FA=0.08729, CF=0.05091, over 0.00 frames. 
2025-02-14 12:19:57,171 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6684MB
2025-02-14 12:27:27,508 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-7500.pt
2025-02-14 12:27:28,008 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-14 12:29:41,751 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 7614, num_updates: 7500, {'loss': 0.13635876774787903, 'DER': 0.3116127200454287, 'ACC': np.float64(0.941138392857143), 'MI': 0.16510505394662123, 'FA': 0.08375922771152754, 'CF': 0.06274843838727995}, batch size: 64, grad_norm: 0.23951274156570435, grad_scale: , lr: 6.88e-05, 
2025-02-14 12:29:41,751 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 7614, num_updates: 7500, {'loss': 0.13176082074642181, 'DER': 0.33288022957257213, 'ACC': np.float64(0.9384821428571429), 'MI': 0.14816492976891707, 'FA': 0.1013442078235916, 'CF': 0.08337109198006344}, batch size: 64, grad_norm: 0.23951274156570435, grad_scale: , lr: 6.88e-05, 
2025-02-14 12:29:41,752 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 12:29:41,752 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 12:30:13,864 (model:925) WARNING: All labels are zero
2025-02-14 12:30:14,047 (model:925) WARNING: All labels are zero
2025-02-14 12:30:14,443 (model:925) WARNING: All labels are zero
2025-02-14 12:31:12,290 (model:925) WARNING: All labels are zero
2025-02-14 12:31:19,944 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 7614,  validation: loss=0.1026, DER=0.2361, ACC=0.9542, MI=0.1189, FA=0.07297, CF=0.04418, over 0.00 frames. 
2025-02-14 12:31:19,944 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6684MB
2025-02-14 12:31:22,272 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 7614,  validation: loss=0.1059, DER=0.2379, ACC=0.9525, MI=0.1159, FA=0.07368, CF=0.04829, over 0.00 frames. 
2025-02-14 12:31:22,272 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6684MB
2025-02-14 12:41:04,182 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 8114, num_updates: 8000, {'loss': 0.10776015371084213, 'DER': 0.2730486008836524, 'ACC': np.float64(0.951674107142857), 'MI': 0.13166421207658321, 'FA': 0.09558173784977908, 'CF': 0.04580265095729013}, batch size: 64, grad_norm: 0.2856466770172119, grad_scale: , lr: 6.60e-05, 
2025-02-14 12:41:04,183 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 12:41:04,790 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 8114, num_updates: 8000, {'loss': 0.13078494369983673, 'DER': 0.32243058584096523, 'ACC': np.float64(0.9402678571428571), 'MI': 0.15976159325483355, 'FA': 0.09608954789940398, 'CF': 0.06657944468672772}, batch size: 64, grad_norm: 0.2856466770172119, grad_scale: , lr: 6.60e-05, 
2025-02-14 12:41:04,790 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 12:41:36,744 (model:925) WARNING: All labels are zero
2025-02-14 12:41:37,183 (model:925) WARNING: All labels are zero
2025-02-14 12:41:37,583 (model:925) WARNING: All labels are zero
2025-02-14 12:42:35,376 (model:925) WARNING: All labels are zero
2025-02-14 12:42:43,054 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 8114,  validation: loss=0.1018, DER=0.2356, ACC=0.9542, MI=0.109, FA=0.08295, CF=0.04365, over 0.00 frames. 
2025-02-14 12:42:43,055 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6684MB
2025-02-14 12:42:45,694 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 8114,  validation: loss=0.1049, DER=0.2356, ACC=0.953, MI=0.1059, FA=0.08329, CF=0.04647, over 0.00 frames. 
2025-02-14 12:42:45,694 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6684MB
2025-02-14 12:44:56,753 (train_accelerate_ddp:713) INFO: end of epoch 2, batch_idx: 4113 batch_idx_train: 8227, {'loss': 0.11813201755285263, 'DER': 0.2775800711743772, 'ACC': np.float64(0.947767857142857), 'MI': 0.1516014234875445, 'FA': 0.0704626334519573, 'CF': 0.05551601423487545}, batch size: 64, grad_norm: 0.2567020356655121, grad_scale: , lr: 6.54e-05, 
2025-02-14 12:44:56,753 (train_accelerate_ddp:713) INFO: end of epoch 2, batch_idx: 4113 batch_idx_train: 8227, {'loss': 0.10826971381902695, 'DER': 0.25458037825059104, 'ACC': np.float64(0.9542633928571429), 'MI': 0.13785460992907803, 'FA': 0.06855791962174941, 'CF': 0.048167848699763594}, batch size: 64, grad_norm: 0.2567020356655121, grad_scale: , lr: 6.54e-05, 
2025-02-14 12:44:56,755 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-2.pt
2025-02-14 12:44:57,106 (train_accelerate_ddp:561) INFO:  end of epoch 2, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-2.pt 
2025-02-14 12:44:59,874 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 8228, num_updates: 8000, {'loss': 0.11494173109531403, 'DER': 0.22549992908807262, 'ACC': np.float64(0.9562276785714287), 'MI': 0.12381222521628138, 'FA': 0.04907105375124096, 'CF': 0.05261665012055028}, batch size: 64, grad_norm: 0.26219338178634644, grad_scale: , lr: 6.54e-05, 
2025-02-14 12:44:59,875 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 8228, num_updates: 8000, {'loss': 0.12942899763584137, 'DER': 0.3429613011777902, 'ACC': np.float64(0.9367857142857143), 'MI': 0.1775098149186764, 'FA': 0.11132922041503085, 'CF': 0.05412226584408301}, batch size: 64, grad_norm: 0.26219338178634644, grad_scale: , lr: 6.54e-05, 
2025-02-14 12:54:38,566 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 8728, num_updates: 8500, {'loss': 0.1021164059638977, 'DER': 0.26625520310033013, 'ACC': np.float64(0.95421875), 'MI': 0.1732452992679776, 'FA': 0.06487727859911009, 'CF': 0.02813262523324243}, batch size: 64, grad_norm: 0.26366087794303894, grad_scale: , lr: 6.26e-05, 
2025-02-14 12:54:38,566 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 8728, num_updates: 8500, {'loss': 0.12471982091665268, 'DER': 0.30199556541019956, 'ACC': np.float64(0.9476116071428571), 'MI': 0.1908351810790835, 'FA': 0.06622320768662232, 'CF': 0.04493717664449372}, batch size: 64, grad_norm: 0.26366087794303894, grad_scale: , lr: 6.26e-05, 
2025-02-14 12:54:38,566 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 12:54:38,566 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 12:55:10,551 (model:925) WARNING: All labels are zero
2025-02-14 12:55:10,930 (model:925) WARNING: All labels are zero
2025-02-14 12:55:11,328 (model:925) WARNING: All labels are zero
2025-02-14 12:56:09,316 (model:925) WARNING: All labels are zero
2025-02-14 12:56:17,004 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 8728,  validation: loss=0.101, DER=0.2342, ACC=0.9545, MI=0.1163, FA=0.07361, CF=0.0443, over 0.00 frames. 
2025-02-14 12:56:17,005 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6684MB
2025-02-14 12:56:19,512 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 8728,  validation: loss=0.1032, DER=0.234, ACC=0.9535, MI=0.1153, FA=0.073, CF=0.04577, over 0.00 frames. 
2025-02-14 12:56:19,512 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6684MB
2025-02-14 13:01:35,549 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-9000.pt
2025-02-14 13:01:35,993 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-14 13:01:36,019 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-14 13:06:02,273 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 9228, num_updates: 9000, {'loss': 0.100811667740345, 'DER': 0.23726258667470607, 'ACC': np.float64(0.9582589285714286), 'MI': 0.120440156768164, 'FA': 0.07220379861320471, 'CF': 0.04461863129333735}, batch size: 64, grad_norm: 0.23535603284835815, grad_scale: , lr: 5.98e-05, 
2025-02-14 13:06:02,273 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 9228, num_updates: 9000, {'loss': 0.13983206450939178, 'DER': 0.2876258442716962, 'ACC': np.float64(0.9413392857142857), 'MI': 0.19931183891933224, 'FA': 0.04103479036574487, 'CF': 0.04727921498661909}, batch size: 64, grad_norm: 0.23535603284835815, grad_scale: , lr: 5.98e-05, 
2025-02-14 13:06:02,273 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 13:06:02,273 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 13:06:34,250 (model:925) WARNING: All labels are zero
2025-02-14 13:06:34,746 (model:925) WARNING: All labels are zero
2025-02-14 13:06:35,145 (model:925) WARNING: All labels are zero
2025-02-14 13:07:32,894 (model:925) WARNING: All labels are zero
2025-02-14 13:07:40,578 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 9228,  validation: loss=0.09844, DER=0.2308, ACC=0.9555, MI=0.1058, FA=0.08293, CF=0.04202, over 0.00 frames. 
2025-02-14 13:07:40,579 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6684MB
2025-02-14 13:07:43,569 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 9228,  validation: loss=0.102, DER=0.2332, ACC=0.9538, MI=0.1052, FA=0.08278, CF=0.04527, over 0.00 frames. 
2025-02-14 13:07:43,569 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6684MB
2025-02-14 13:17:22,784 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 9728, num_updates: 9500, {'loss': 0.12090978026390076, 'DER': 0.3158799624882776, 'ACC': np.float64(0.9466071428571429), 'MI': 0.1361362925914348, 'FA': 0.1217567989996874, 'CF': 0.05798687089715536}, batch size: 64, grad_norm: 0.28385302424430847, grad_scale: , lr: 5.71e-05, 
2025-02-14 13:17:22,785 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 13:17:22,784 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 9728, num_updates: 9500, {'loss': 0.1123705580830574, 'DER': 0.27780226237696487, 'ACC': np.float64(0.9484375), 'MI': 0.15146173057147055, 'FA': 0.06478624944909651, 'CF': 0.06155428235639782}, batch size: 64, grad_norm: 0.28385302424430847, grad_scale: , lr: 5.71e-05, 
2025-02-14 13:17:22,785 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 13:17:54,722 (model:925) WARNING: All labels are zero
2025-02-14 13:17:55,191 (model:925) WARNING: All labels are zero
2025-02-14 13:17:55,589 (model:925) WARNING: All labels are zero
2025-02-14 13:18:53,340 (model:925) WARNING: All labels are zero
2025-02-14 13:19:01,009 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 9728,  validation: loss=0.09853, DER=0.2282, ACC=0.956, MI=0.1015, FA=0.08682, CF=0.03983, over 0.00 frames. 
2025-02-14 13:19:01,009 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6684MB
2025-02-14 13:19:03,709 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 9728,  validation: loss=0.1017, DER=0.2318, ACC=0.9544, MI=0.1017, FA=0.08847, CF=0.04168, over 0.00 frames. 
2025-02-14 13:19:03,709 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6684MB
2025-02-14 13:28:43,688 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 10228, num_updates: 10000, {'loss': 0.13644565641880035, 'DER': 0.2875693025970236, 'ACC': np.float64(0.9477232142857143), 'MI': 0.15917712284797197, 'FA': 0.07426320396848556, 'CF': 0.054128975780566094}, batch size: 64, grad_norm: 0.2599286139011383, grad_scale: , lr: 5.43e-05, 
2025-02-14 13:28:43,688 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 10228, num_updates: 10000, {'loss': 0.14247381687164307, 'DER': 0.3123348630232235, 'ACC': np.float64(0.9408035714285714), 'MI': 0.19246280072312613, 'FA': 0.06341259908218606, 'CF': 0.05645946321791128}, batch size: 64, grad_norm: 0.2599286139011383, grad_scale: , lr: 5.43e-05, 
2025-02-14 13:28:43,689 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 13:28:43,689 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 13:29:15,408 (model:925) WARNING: All labels are zero
2025-02-14 13:29:15,956 (model:925) WARNING: All labels are zero
2025-02-14 13:29:16,353 (model:925) WARNING: All labels are zero
2025-02-14 13:30:13,674 (model:925) WARNING: All labels are zero
2025-02-14 13:30:21,306 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 10228,  validation: loss=0.09702, DER=0.2257, ACC=0.956, MI=0.1043, FA=0.07883, CF=0.04258, over 0.00 frames. 
2025-02-14 13:30:21,307 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6684MB
2025-02-14 13:30:24,799 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 10228,  validation: loss=0.09997, DER=0.2277, ACC=0.9547, MI=0.1029, FA=0.07927, CF=0.04549, over 0.00 frames. 
2025-02-14 13:30:24,799 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6684MB
2025-02-14 13:35:36,200 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-10500.pt
2025-02-14 13:35:36,658 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-14 13:40:09,415 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 10728, num_updates: 10500, {'loss': 0.09012291580438614, 'DER': 0.19524690479578768, 'ACC': np.float64(0.9662723214285713), 'MI': 0.1199658460224847, 'FA': 0.05550021346235947, 'CF': 0.019780845310943505}, batch size: 64, grad_norm: 0.2903268337249756, grad_scale: , lr: 5.15e-05, 
2025-02-14 13:40:09,415 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 10728, num_updates: 10500, {'loss': 0.12506377696990967, 'DER': 0.30279363172123763, 'ACC': np.float64(0.9444642857142856), 'MI': 0.15034544908380895, 'FA': 0.08155602282967858, 'CF': 0.07089215980775007}, batch size: 64, grad_norm: 0.2903268337249756, grad_scale: , lr: 5.15e-05, 
2025-02-14 13:40:09,415 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 13:40:09,415 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 13:40:41,584 (model:925) WARNING: All labels are zero
2025-02-14 13:40:41,982 (model:925) WARNING: All labels are zero
2025-02-14 13:40:42,017 (model:925) WARNING: All labels are zero
2025-02-14 13:41:41,347 (model:925) WARNING: All labels are zero
2025-02-14 13:41:48,912 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 10728,  validation: loss=0.09615, DER=0.2177, ACC=0.9566, MI=0.1127, FA=0.0659, CF=0.03913, over 0.00 frames. 
2025-02-14 13:41:48,912 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 13:41:49,120 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 10728,  validation: loss=0.09369, DER=0.218, ACC=0.9577, MI=0.114, FA=0.06661, CF=0.03742, over 0.00 frames. 
2025-02-14 13:41:49,120 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 13:51:24,926 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 11228, num_updates: 11000, {'loss': 0.13121169805526733, 'DER': 0.2813688212927757, 'ACC': np.float64(0.9464732142857143), 'MI': 0.14477917519742614, 'FA': 0.06727113190991518, 'CF': 0.06931851418543433}, batch size: 64, grad_norm: 0.31430885195732117, grad_scale: , lr: 4.87e-05, 
2025-02-14 13:51:24,926 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 13:51:24,928 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 11228, num_updates: 11000, {'loss': 0.1296108514070511, 'DER': 0.29896637446029045, 'ACC': np.float64(0.9402678571428571), 'MI': 0.20188407693314145, 'FA': 0.045924375245322516, 'CF': 0.05115792228182651}, batch size: 64, grad_norm: 0.31430885195732117, grad_scale: , lr: 4.87e-05, 
2025-02-14 13:51:24,928 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 13:51:58,397 (model:925) WARNING: All labels are zero
2025-02-14 13:51:58,748 (model:925) WARNING: All labels are zero
2025-02-14 13:51:58,806 (model:925) WARNING: All labels are zero
2025-02-14 13:53:01,280 (model:925) WARNING: All labels are zero
2025-02-14 13:53:09,309 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 11228,  validation: loss=0.09202, DER=0.2133, ACC=0.9583, MI=0.1138, FA=0.06416, CF=0.03538, over 0.00 frames. 
2025-02-14 13:53:09,310 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 13:53:10,481 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 11228,  validation: loss=0.09453, DER=0.2169, ACC=0.957, MI=0.1155, FA=0.06463, CF=0.03676, over 0.00 frames. 
2025-02-14 13:53:10,481 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 14:03:00,708 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 11728, num_updates: 11500, {'loss': 0.08864274621009827, 'DER': 0.20321659401773637, 'ACC': np.float64(0.96359375), 'MI': 0.08266947241845783, 'FA': 0.0786111528633699, 'CF': 0.041935968735908616}, batch size: 64, grad_norm: 0.2542848587036133, grad_scale: , lr: 4.60e-05, 
2025-02-14 14:03:00,709 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 14:03:00,709 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 11728, num_updates: 11500, {'loss': 0.11209685355424881, 'DER': 0.2782492184010719, 'ACC': np.float64(0.95125), 'MI': 0.11344350156319785, 'FA': 0.11790978115230014, 'CF': 0.04689593568557392}, batch size: 64, grad_norm: 0.2542848587036133, grad_scale: , lr: 4.60e-05, 
2025-02-14 14:03:00,709 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 14:03:32,439 (model:925) WARNING: All labels are zero
2025-02-14 14:03:32,826 (model:925) WARNING: All labels are zero
2025-02-14 14:03:33,521 (model:925) WARNING: All labels are zero
2025-02-14 14:04:33,305 (model:925) WARNING: All labels are zero
2025-02-14 14:04:38,929 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 11728,  validation: loss=0.09479, DER=0.2154, ACC=0.9573, MI=0.1085, FA=0.07016, CF=0.0368, over 0.00 frames. 
2025-02-14 14:04:38,929 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 14:04:41,119 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 11728,  validation: loss=0.09249, DER=0.214, ACC=0.9584, MI=0.108, FA=0.07048, CF=0.03544, over 0.00 frames. 
2025-02-14 14:04:41,119 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 14:09:42,621 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-12000.pt
2025-02-14 14:09:43,098 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-14 14:14:03,493 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 12228, num_updates: 12000, {'loss': 0.09772109985351562, 'DER': 0.2418001525553013, 'ACC': np.float64(0.95921875), 'MI': 0.11151792524790237, 'FA': 0.09336384439359267, 'CF': 0.03691838291380625}, batch size: 64, grad_norm: 0.1986631453037262, grad_scale: , lr: 4.32e-05, 
2025-02-14 14:14:03,493 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 14:14:03,493 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 12228, num_updates: 12000, {'loss': 0.10571876168251038, 'DER': 0.25851938895417154, 'ACC': np.float64(0.9557142857142857), 'MI': 0.13557579318448884, 'FA': 0.09004112808460635, 'CF': 0.03290246768507638}, batch size: 64, grad_norm: 0.1986631453037262, grad_scale: , lr: 4.32e-05, 
2025-02-14 14:14:03,493 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 14:14:35,094 (model:925) WARNING: All labels are zero
2025-02-14 14:14:35,480 (model:925) WARNING: All labels are zero
2025-02-14 14:14:35,795 (model:925) WARNING: All labels are zero
2025-02-14 14:15:34,903 (model:925) WARNING: All labels are zero
2025-02-14 14:15:41,720 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 12228,  validation: loss=0.09276, DER=0.2118, ACC=0.9581, MI=0.1178, FA=0.05891, CF=0.03509, over 0.00 frames. 
2025-02-14 14:15:41,720 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 14:15:42,621 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 12228,  validation: loss=0.09029, DER=0.2104, ACC=0.9594, MI=0.117, FA=0.05892, CF=0.03446, over 0.00 frames. 
2025-02-14 14:15:42,621 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 14:17:48,194 (train_accelerate_ddp:713) INFO: end of epoch 3, batch_idx: 4113 batch_idx_train: 12341, {'loss': 0.11910784989595413, 'DER': 0.28182456140350876, 'ACC': np.float64(0.9442633928571429), 'MI': 0.13740350877192983, 'FA': 0.07578947368421053, 'CF': 0.06863157894736842}, batch size: 64, grad_norm: 0.26250651478767395, grad_scale: , lr: 4.25e-05, 
2025-02-14 14:17:48,194 (train_accelerate_ddp:713) INFO: end of epoch 3, batch_idx: 4113 batch_idx_train: 12341, {'loss': 0.11951296031475067, 'DER': 0.29539951573849876, 'ACC': np.float64(0.94046875), 'MI': 0.16142050040355124, 'FA': 0.07062146892655367, 'CF': 0.06335754640839386}, batch size: 64, grad_norm: 0.26250651478767395, grad_scale: , lr: 4.25e-05, 
2025-02-14 14:17:48,196 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-3.pt
2025-02-14 14:17:48,570 (train_accelerate_ddp:561) INFO:  end of epoch 3, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-3.pt 
2025-02-14 14:17:50,707 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 12342, num_updates: 12000, {'loss': 0.12582047283649445, 'DER': 0.2825770604577325, 'ACC': np.float64(0.9460267857142857), 'MI': 0.18031485646249504, 'FA': 0.06495568196851435, 'CF': 0.03730652202672311}, batch size: 64, grad_norm: 0.29979345202445984, grad_scale: , lr: 4.25e-05, 
2025-02-14 14:17:50,707 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 12342, num_updates: 12000, {'loss': 0.11986572295427322, 'DER': 0.27786032689450224, 'ACC': np.float64(0.95171875), 'MI': 0.16151560178306093, 'FA': 0.07280832095096583, 'CF': 0.04353640416047548}, batch size: 64, grad_norm: 0.29979345202445984, grad_scale: , lr: 4.25e-05, 
2025-02-14 14:27:24,499 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 12842, num_updates: 12500, {'loss': 0.132658451795578, 'DER': 0.3139869281045752, 'ACC': np.float64(0.9373214285714286), 'MI': 0.2172549019607843, 'FA': 0.04366013071895425, 'CF': 0.053071895424836604}, batch size: 64, grad_norm: 0.30391961336135864, grad_scale: , lr: 3.98e-05, 
2025-02-14 14:27:24,500 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 14:27:24,508 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 12842, num_updates: 12500, {'loss': 0.10745935887098312, 'DER': 0.24762042111335447, 'ACC': np.float64(0.9556473214285713), 'MI': 0.15546582059417363, 'FA': 0.05321603691952697, 'CF': 0.03893856359965388}, batch size: 64, grad_norm: 0.30391961336135864, grad_scale: , lr: 3.98e-05, 
2025-02-14 14:27:24,508 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 14:27:56,040 (model:925) WARNING: All labels are zero
2025-02-14 14:27:56,426 (model:925) WARNING: All labels are zero
2025-02-14 14:27:59,197 (model:925) WARNING: All labels are zero
2025-02-14 14:28:58,916 (model:925) WARNING: All labels are zero
2025-02-14 14:29:02,313 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 12842,  validation: loss=0.09666, DER=0.2179, ACC=0.9569, MI=0.1075, FA=0.07398, CF=0.03643, over 0.00 frames. 
2025-02-14 14:29:02,314 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 14:29:06,562 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 12842,  validation: loss=0.09403, DER=0.2149, ACC=0.9585, MI=0.1063, FA=0.07388, CF=0.03476, over 0.00 frames. 
2025-02-14 14:29:06,562 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 14:39:25,240 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 13342, num_updates: 13000, {'loss': 0.10801945626735687, 'DER': 0.2732759921533122, 'ACC': np.float64(0.953482142857143), 'MI': 0.14380564357929682, 'FA': 0.0882752376641014, 'CF': 0.04119511090991399}, batch size: 64, grad_norm: 0.19912855327129364, grad_scale: , lr: 3.70e-05, 
2025-02-14 14:39:25,240 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 14:39:25,241 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 13342, num_updates: 13000, {'loss': 0.11312026530504227, 'DER': 0.2714389009399855, 'ACC': np.float64(0.9476339285714286), 'MI': 0.1343456254519161, 'FA': 0.06926970354302242, 'CF': 0.067823571945047}, batch size: 64, grad_norm: 0.19912855327129364, grad_scale: , lr: 3.70e-05, 
2025-02-14 14:39:25,241 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 14:39:57,897 (model:925) WARNING: All labels are zero
2025-02-14 14:39:58,128 (model:925) WARNING: All labels are zero
2025-02-14 14:39:58,301 (model:925) WARNING: All labels are zero
2025-02-14 14:40:59,723 (model:925) WARNING: All labels are zero
2025-02-14 14:41:07,898 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 13342,  validation: loss=0.09233, DER=0.2134, ACC=0.959, MI=0.1046, FA=0.07413, CF=0.03469, over 0.00 frames. 
2025-02-14 14:41:07,898 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 14:41:10,088 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 13342,  validation: loss=0.09446, DER=0.2156, ACC=0.9577, MI=0.1049, FA=0.07545, CF=0.03525, over 0.00 frames. 
2025-02-14 14:41:10,089 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 14:44:33,754 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-13500.pt
2025-02-14 14:44:34,406 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-14 14:44:34,408 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-14 14:52:01,488 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 13842, num_updates: 13500, {'loss': 0.10459452867507935, 'DER': 0.2622503233223164, 'ACC': np.float64(0.9520758928571429), 'MI': 0.1253053599655123, 'FA': 0.09067394740623652, 'CF': 0.04627101595056761}, batch size: 64, grad_norm: 0.20143961906433105, grad_scale: , lr: 3.42e-05, 
2025-02-14 14:52:01,489 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 14:52:01,497 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 13842, num_updates: 13500, {'loss': 0.11208651959896088, 'DER': 0.25394846217788863, 'ACC': np.float64(0.950669642857143), 'MI': 0.14394569132723747, 'FA': 0.057772236076475476, 'CF': 0.05223053477417567}, batch size: 64, grad_norm: 0.20143961906433105, grad_scale: , lr: 3.42e-05, 
2025-02-14 14:52:01,497 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 14:52:37,485 (model:925) WARNING: All labels are zero
2025-02-14 14:52:41,196 (model:925) WARNING: All labels are zero
2025-02-14 14:52:41,646 (model:925) WARNING: All labels are zero
2025-02-14 14:53:45,559 (model:925) WARNING: All labels are zero
2025-02-14 14:53:54,780 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 13842,  validation: loss=0.09149, DER=0.2127, ACC=0.9588, MI=0.1088, FA=0.06757, CF=0.0363, over 0.00 frames. 
2025-02-14 14:53:54,781 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 14:54:03,289 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 13842,  validation: loss=0.09343, DER=0.2131, ACC=0.9577, MI=0.1107, FA=0.06606, CF=0.0363, over 0.00 frames. 
2025-02-14 14:54:03,290 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 15:04:51,175 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 14342, num_updates: 14000, {'loss': 0.09415270388126373, 'DER': 0.23484077359313654, 'ACC': np.float64(0.9567410714285713), 'MI': 0.12025592554893122, 'FA': 0.06761669332557801, 'CF': 0.04696815471862731}, batch size: 64, grad_norm: 0.17549143731594086, grad_scale: , lr: 3.14e-05, 
2025-02-14 15:04:51,175 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 15:04:51,186 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 14342, num_updates: 14000, {'loss': 0.11190509051084518, 'DER': 0.26077065263756577, 'ACC': np.float64(0.9545089285714287), 'MI': 0.1606711218541163, 'FA': 0.07109341674960899, 'CF': 0.029006114033840465}, batch size: 64, grad_norm: 0.17549143731594086, grad_scale: , lr: 3.14e-05, 
2025-02-14 15:04:51,186 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 15:05:23,996 (model:925) WARNING: All labels are zero
2025-02-14 15:05:41,414 (model:925) WARNING: All labels are zero
2025-02-14 15:05:42,041 (model:925) WARNING: All labels are zero
2025-02-14 15:06:23,661 (model:925) WARNING: All labels are zero
2025-02-14 15:06:31,541 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 14342,  validation: loss=0.08727, DER=0.2036, ACC=0.9607, MI=0.1249, FA=0.04872, CF=0.02992, over 0.00 frames. 
2025-02-14 15:06:31,541 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 15:07:12,534 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 14342,  validation: loss=0.08946, DER=0.2042, ACC=0.9596, MI=0.1257, FA=0.04756, CF=0.03095, over 0.00 frames. 
2025-02-14 15:07:12,535 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 15:18:00,953 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 14842, num_updates: 14500, {'loss': 0.09513228386640549, 'DER': 0.22791775267883, 'ACC': np.float64(0.9588544579930641), 'MI': 0.13336229365768898, 'FA': 0.0561830292499276, 'CF': 0.03837242977121344}, batch size: 64, grad_norm: 0.2416638284921646, grad_scale: , lr: 2.86e-05, 
2025-02-14 15:18:00,953 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 15:18:00,963 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 14842, num_updates: 14500, {'loss': 0.0978582352399826, 'DER': 0.2117910447761194, 'ACC': np.float64(0.9618080357142857), 'MI': 0.11567164179104478, 'FA': 0.05253731343283582, 'CF': 0.04358208955223881}, batch size: 64, grad_norm: 0.2416638284921646, grad_scale: , lr: 2.86e-05, 
2025-02-14 15:18:00,963 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 15:18:37,652 (model:925) WARNING: All labels are zero
2025-02-14 15:18:39,760 (model:925) WARNING: All labels are zero
2025-02-14 15:18:40,324 (model:925) WARNING: All labels are zero
2025-02-14 15:19:36,691 (model:925) WARNING: All labels are zero
2025-02-14 15:19:44,386 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 14842,  validation: loss=0.09002, DER=0.2103, ACC=0.9593, MI=0.1183, FA=0.05656, CF=0.03544, over 0.00 frames. 
2025-02-14 15:19:44,386 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 15:20:02,224 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 14842,  validation: loss=0.09197, DER=0.2093, ACC=0.9585, MI=0.1197, FA=0.05511, CF=0.03454, over 0.00 frames. 
2025-02-14 15:20:02,225 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 15:23:21,679 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-15000.pt
2025-02-14 15:23:22,752 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-14 15:30:45,442 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 15342, num_updates: 15000, {'loss': 0.10988346487283707, 'DER': 0.2590857467348098, 'ACC': np.float64(0.9493303571428571), 'MI': 0.1469335604770017, 'FA': 0.048977853492333905, 'CF': 0.06317433276547416}, batch size: 64, grad_norm: 0.2565896511077881, grad_scale: , lr: 2.59e-05, 
2025-02-14 15:30:45,443 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 15:30:45,454 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 15342, num_updates: 15000, {'loss': 0.1074640303850174, 'DER': 0.2321651198226901, 'ACC': np.float64(0.9543303571428571), 'MI': 0.1336750242415847, 'FA': 0.047236459343399366, 'CF': 0.051253636237706054}, batch size: 64, grad_norm: 0.2565896511077881, grad_scale: , lr: 2.59e-05, 
2025-02-14 15:30:45,454 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 15:31:18,327 (model:925) WARNING: All labels are zero
2025-02-14 15:31:18,729 (model:925) WARNING: All labels are zero
2025-02-14 15:31:30,016 (model:925) WARNING: All labels are zero
2025-02-14 15:32:27,293 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 15342,  validation: loss=0.09143, DER=0.2087, ACC=0.9588, MI=0.1205, FA=0.05456, CF=0.03372, over 0.00 frames. 
2025-02-14 15:32:27,294 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 15:33:04,382 (model:925) WARNING: All labels are zero
2025-02-14 15:33:16,778 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 15342,  validation: loss=0.08996, DER=0.2096, ACC=0.9596, MI=0.1204, FA=0.05661, CF=0.03257, over 0.00 frames. 
2025-02-14 15:33:16,779 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 15:43:40,714 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 15842, num_updates: 15500, {'loss': 0.12692417204380035, 'DER': 0.292259083728278, 'ACC': np.float64(0.94328125), 'MI': 0.16587677725118483, 'FA': 0.053712480252764615, 'CF': 0.07266982622432859}, batch size: 64, grad_norm: 0.25436046719551086, grad_scale: , lr: 2.31e-05, 
2025-02-14 15:43:40,715 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 15:43:40,724 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 15842, num_updates: 15500, {'loss': 0.10734150558710098, 'DER': 0.24638819095477388, 'ACC': np.float64(0.9570982142857143), 'MI': 0.11180904522613065, 'FA': 0.07914572864321608, 'CF': 0.055433417085427136}, batch size: 64, grad_norm: 0.25436046719551086, grad_scale: , lr: 2.31e-05, 
2025-02-14 15:43:40,725 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 15:44:14,066 (model:925) WARNING: All labels are zero
2025-02-14 15:44:20,812 (model:925) WARNING: All labels are zero
2025-02-14 15:44:21,261 (model:925) WARNING: All labels are zero
2025-02-14 15:45:15,046 (model:925) WARNING: All labels are zero
2025-02-14 15:45:23,036 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 15842,  validation: loss=0.09028, DER=0.2094, ACC=0.9592, MI=0.1156, FA=0.05918, CF=0.0347, over 0.00 frames. 
2025-02-14 15:45:23,037 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 15:45:44,570 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 15842,  validation: loss=0.09206, DER=0.2097, ACC=0.9581, MI=0.115, FA=0.05772, CF=0.03695, over 0.00 frames. 
2025-02-14 15:45:44,571 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 15:55:52,270 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 16342, num_updates: 16000, {'loss': 0.08545147627592087, 'DER': 0.1923517616728731, 'ACC': np.float64(0.9661607142857143), 'MI': 0.10340876539673446, 'FA': 0.0641649957032369, 'CF': 0.02477800057290175}, batch size: 64, grad_norm: 0.2565629780292511, grad_scale: , lr: 2.03e-05, 
2025-02-14 15:55:52,270 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 16342, num_updates: 16000, {'loss': 0.1311360001564026, 'DER': 0.29337496606027696, 'ACC': np.float64(0.9449776785714286), 'MI': 0.2002443660059734, 'FA': 0.05185989682324192, 'CF': 0.041270703231061634}, batch size: 64, grad_norm: 0.2565629780292511, grad_scale: , lr: 2.03e-05, 
2025-02-14 15:55:52,271 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 15:55:52,271 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 15:56:25,656 (model:925) WARNING: All labels are zero
2025-02-14 15:56:26,269 (model:925) WARNING: All labels are zero
2025-02-14 15:56:26,688 (model:925) WARNING: All labels are zero
2025-02-14 15:57:26,901 (model:925) WARNING: All labels are zero
2025-02-14 15:57:34,906 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 16342,  validation: loss=0.08962, DER=0.2072, ACC=0.96, MI=0.11, FA=0.06552, CF=0.03167, over 0.00 frames. 
2025-02-14 15:57:34,907 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 15:57:38,013 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 16342,  validation: loss=0.09162, DER=0.2077, ACC=0.9588, MI=0.1099, FA=0.0642, CF=0.03356, over 0.00 frames. 
2025-02-14 15:57:38,014 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 15:59:58,081 (train_accelerate_ddp:713) INFO: end of epoch 4, batch_idx: 4113 batch_idx_train: 16455, {'loss': 0.1035403460264206, 'DER': 0.22803608605135323, 'ACC': np.float64(0.9575892857142857), 'MI': 0.14309507286606524, 'FA': 0.049271339347675226, 'CF': 0.03566967383761277}, batch size: 64, grad_norm: 0.3058318793773651, grad_scale: , lr: 1.97e-05, 
2025-02-14 15:59:58,091 (train_accelerate_ddp:713) INFO: end of epoch 4, batch_idx: 4113 batch_idx_train: 16455, {'loss': 0.11506278812885284, 'DER': 0.2560761346998536, 'ACC': np.float64(0.9541964285714286), 'MI': 0.13587115666178623, 'FA': 0.07584187408491948, 'CF': 0.044363103953147874}, batch size: 64, grad_norm: 0.3058318793773651, grad_scale: , lr: 1.97e-05, 
2025-02-14 15:59:58,093 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-4.pt
2025-02-14 15:59:58,563 (train_accelerate_ddp:561) INFO:  end of epoch 4, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-4.pt 
2025-02-14 16:00:00,972 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 16456, num_updates: 16000, {'loss': 0.12121935933828354, 'DER': 0.31171607753705816, 'ACC': np.float64(0.9416294642857143), 'MI': 0.15293614595210947, 'FA': 0.09777651083238312, 'CF': 0.06100342075256556}, batch size: 64, grad_norm: 0.18698447942733765, grad_scale: , lr: 1.97e-05, 
2025-02-14 16:00:00,982 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 16456, num_updates: 16000, {'loss': 0.08766251802444458, 'DER': 0.2094665664913599, 'ACC': np.float64(0.9631919642857143), 'MI': 0.09616829451540196, 'FA': 0.07498121712997746, 'CF': 0.03831705484598046}, batch size: 64, grad_norm: 0.18698447942733765, grad_scale: , lr: 1.97e-05, 
2025-02-14 16:00:59,156 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-16500.pt
2025-02-14 16:00:59,683 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-14 16:00:59,702 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-14 16:10:13,118 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 16956, num_updates: 16500, {'loss': 0.1353503167629242, 'DER': 0.3583189587580367, 'ACC': np.float64(0.9403794642857143), 'MI': 0.14975693899952955, 'FA': 0.14803198996393288, 'CF': 0.06053002979457425}, batch size: 64, grad_norm: 0.295989453792572, grad_scale: , lr: 1.69e-05, 
2025-02-14 16:10:13,118 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 16956, num_updates: 16500, {'loss': 0.11909186840057373, 'DER': 0.26487470250594985, 'ACC': np.float64(0.9489285714285713), 'MI': 0.13803723925521488, 'FA': 0.07139857202855943, 'CF': 0.05543889122217556}, batch size: 64, grad_norm: 0.295989453792572, grad_scale: , lr: 1.69e-05, 
2025-02-14 16:10:13,118 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 16:10:13,118 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 16:10:45,305 (model:925) WARNING: All labels are zero
2025-02-14 16:10:45,707 (model:925) WARNING: All labels are zero
2025-02-14 16:10:45,799 (model:925) WARNING: All labels are zero
2025-02-14 16:11:45,546 (model:925) WARNING: All labels are zero
2025-02-14 16:11:52,851 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 16956,  validation: loss=0.09022, DER=0.2036, ACC=0.9593, MI=0.1135, FA=0.05716, CF=0.03291, over 0.00 frames. 
2025-02-14 16:11:52,852 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 16:11:53,390 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 16956,  validation: loss=0.08827, DER=0.2032, ACC=0.9604, MI=0.1134, FA=0.05775, CF=0.03204, over 0.00 frames. 
2025-02-14 16:11:53,390 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 16:21:58,057 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 17456, num_updates: 17000, {'loss': 0.12596631050109863, 'DER': 0.32723112128146453, 'ACC': np.float64(0.9347321428571429), 'MI': 0.1786243101359537, 'FA': 0.08224525508143761, 'CF': 0.06636155606407322}, batch size: 64, grad_norm: 0.20874343812465668, grad_scale: , lr: 1.41e-05, 
2025-02-14 16:21:58,057 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 17456, num_updates: 17000, {'loss': 0.09145525842905045, 'DER': 0.21969365426695842, 'ACC': np.float64(0.9615178571428571), 'MI': 0.13595915390226113, 'FA': 0.05193289569657185, 'CF': 0.031801604668125455}, batch size: 64, grad_norm: 0.20874343812465668, grad_scale: , lr: 1.41e-05, 
2025-02-14 16:21:58,058 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 16:21:58,058 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 16:22:31,690 (model:925) WARNING: All labels are zero
2025-02-14 16:22:32,444 (model:925) WARNING: All labels are zero
2025-02-14 16:22:32,861 (model:925) WARNING: All labels are zero
2025-02-14 16:23:33,378 (model:925) WARNING: All labels are zero
2025-02-14 16:23:41,412 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 17456,  validation: loss=0.088, DER=0.2015, ACC=0.9609, MI=0.1067, FA=0.06397, CF=0.03084, over 0.00 frames. 
2025-02-14 16:23:41,413 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 16:23:45,121 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 17456,  validation: loss=0.09041, DER=0.2033, ACC=0.9597, MI=0.1076, FA=0.06354, CF=0.03215, over 0.00 frames. 
2025-02-14 16:23:45,121 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 16:34:05,790 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 17956, num_updates: 17500, {'loss': 0.12327930331230164, 'DER': 0.28630249794125723, 'ACC': np.float64(0.9435044642857143), 'MI': 0.1681306615426846, 'FA': 0.05709580016469942, 'CF': 0.06107603623387318}, batch size: 64, grad_norm: 0.31078848242759705, grad_scale: , lr: 1.14e-05, 
2025-02-14 16:34:05,790 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 17956, num_updates: 17500, {'loss': 0.12010243535041809, 'DER': 0.2908425900839881, 'ACC': np.float64(0.9451116071428571), 'MI': 0.16418314819832025, 'FA': 0.0843944730425359, 'CF': 0.04226496884313194}, batch size: 64, grad_norm: 0.31078848242759705, grad_scale: , lr: 1.14e-05, 
2025-02-14 16:34:05,790 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 16:34:05,790 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 16:34:40,204 (model:925) WARNING: All labels are zero
2025-02-14 16:34:40,572 (model:925) WARNING: All labels are zero
2025-02-14 16:34:40,990 (model:925) WARNING: All labels are zero
2025-02-14 16:35:46,267 (model:925) WARNING: All labels are zero
2025-02-14 16:35:54,734 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 17956,  validation: loss=0.08807, DER=0.2033, ACC=0.9605, MI=0.1062, FA=0.06513, CF=0.03201, over 0.00 frames. 
2025-02-14 16:35:54,734 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 16:35:54,990 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 17956,  validation: loss=0.09055, DER=0.2043, ACC=0.9592, MI=0.1063, FA=0.06392, CF=0.03402, over 0.00 frames. 
2025-02-14 16:35:54,990 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 16:37:22,676 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-18000.pt
2025-02-14 16:37:23,119 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-14 16:47:28,570 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 18456, num_updates: 18000, {'loss': 0.08686119318008423, 'DER': 0.20602427255446704, 'ACC': np.float64(0.9635267857142857), 'MI': 0.1134668811229712, 'FA': 0.05965784471413949, 'CF': 0.032899546717356336}, batch size: 64, grad_norm: 0.1790490597486496, grad_scale: , lr: 8.57e-06, 
2025-02-14 16:47:28,571 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 16:47:28,581 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 18456, num_updates: 18000, {'loss': 0.09445324540138245, 'DER': 0.23264650007306736, 'ACC': np.float64(0.9614285714285714), 'MI': 0.14978810463247114, 'FA': 0.06298407131375128, 'CF': 0.01987432412684495}, batch size: 64, grad_norm: 0.1790490597486496, grad_scale: , lr: 8.57e-06, 
2025-02-14 16:47:28,581 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 16:48:09,144 (model:925) WARNING: All labels are zero
2025-02-14 16:48:19,165 (model:925) WARNING: All labels are zero
2025-02-14 16:48:19,810 (model:925) WARNING: All labels are zero
2025-02-14 16:49:21,327 (model:925) WARNING: All labels are zero
2025-02-14 16:49:31,144 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 18456,  validation: loss=0.08911, DER=0.2041, ACC=0.9603, MI=0.09975, FA=0.07134, CF=0.03305, over 0.00 frames. 
2025-02-14 16:49:31,145 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 16:49:36,922 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 18456,  validation: loss=0.09112, DER=0.2059, ACC=0.959, MI=0.1013, FA=0.07065, CF=0.03396, over 0.00 frames. 
2025-02-14 16:49:36,923 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 17:00:58,995 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 18956, num_updates: 18500, {'loss': 0.11854514479637146, 'DER': 0.260221465076661, 'ACC': np.float64(0.950625), 'MI': 0.13344690516751845, 'FA': 0.07296990346394094, 'CF': 0.05380465644520159}, batch size: 64, grad_norm: 0.29183536767959595, grad_scale: , lr: 5.79e-06, 
2025-02-14 17:00:58,995 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 18956, num_updates: 18500, {'loss': 0.11021733283996582, 'DER': 0.2685437481077808, 'ACC': np.float64(0.9549330357142857), 'MI': 0.1539509536784741, 'FA': 0.07750529821374508, 'CF': 0.03708749621556161}, batch size: 64, grad_norm: 0.29183536767959595, grad_scale: , lr: 5.79e-06, 
2025-02-14 17:00:58,996 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 17:00:58,996 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 17:01:32,253 (model:925) WARNING: All labels are zero
2025-02-14 17:01:33,070 (model:925) WARNING: All labels are zero
2025-02-14 17:01:33,490 (model:925) WARNING: All labels are zero
2025-02-14 17:02:33,026 (model:925) WARNING: All labels are zero
2025-02-14 17:02:40,947 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 18956,  validation: loss=0.0877, DER=0.2018, ACC=0.9608, MI=0.1051, FA=0.06552, CF=0.03116, over 0.00 frames. 
2025-02-14 17:02:40,947 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 17:02:44,873 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 18956,  validation: loss=0.0897, DER=0.2035, ACC=0.9596, MI=0.1064, FA=0.06452, CF=0.03254, over 0.00 frames. 
2025-02-14 17:02:44,873 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 17:13:24,340 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 19456, num_updates: 19000, {'loss': 0.10806639492511749, 'DER': 0.2448706512042819, 'ACC': np.float64(0.9539955357142857), 'MI': 0.09872137972048765, 'FA': 0.08459708593517692, 'CF': 0.06155218554861731}, batch size: 64, grad_norm: 0.25176888704299927, grad_scale: , lr: 3.02e-06, 
2025-02-14 17:13:24,340 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 17:13:24,341 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 19456, num_updates: 19000, {'loss': 0.08854342252016068, 'DER': 0.20848, 'ACC': np.float64(0.9675446428571429), 'MI': 0.0928, 'FA': 0.09152, 'CF': 0.02416}, batch size: 64, grad_norm: 0.25176888704299927, grad_scale: , lr: 3.02e-06, 
2025-02-14 17:13:24,341 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 17:13:57,600 (model:925) WARNING: All labels are zero
2025-02-14 17:14:04,362 (model:925) WARNING: All labels are zero
2025-02-14 17:14:04,869 (model:925) WARNING: All labels are zero
2025-02-14 17:14:58,204 (model:925) WARNING: All labels are zero
2025-02-14 17:15:06,124 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 19456,  validation: loss=0.08758, DER=0.2022, ACC=0.9608, MI=0.1041, FA=0.06734, CF=0.03074, over 0.00 frames. 
2025-02-14 17:15:06,125 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 17:15:29,093 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 19456,  validation: loss=0.08959, DER=0.2039, ACC=0.9595, MI=0.1051, FA=0.06662, CF=0.03211, over 0.00 frames. 
2025-02-14 17:15:29,094 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 17:16:27,236 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-19500.pt
2025-02-14 17:16:27,684 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-14 17:26:25,646 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 19956, num_updates: 19500, {'loss': 0.10432330518960953, 'DER': 0.2691167753408417, 'ACC': np.float64(0.9535044642857143), 'MI': 0.1347065797273266, 'FA': 0.0948429164196799, 'CF': 0.03956727919383521}, batch size: 64, grad_norm: 0.2631746530532837, grad_scale: , lr: 2.39e-07, 
2025-02-14 17:26:25,646 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 19956, num_updates: 19500, {'loss': 0.09484247118234634, 'DER': 0.22220611682852587, 'ACC': np.float64(0.9577678571428571), 'MI': 0.10421800260907378, 'FA': 0.06595158718654877, 'CF': 0.05203652703290332}, batch size: 64, grad_norm: 0.2631746530532837, grad_scale: , lr: 2.39e-07, 
2025-02-14 17:26:25,647 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 17:26:25,647 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 17:26:58,747 (model:925) WARNING: All labels are zero
2025-02-14 17:26:58,947 (model:925) WARNING: All labels are zero
2025-02-14 17:26:59,355 (model:925) WARNING: All labels are zero
2025-02-14 17:27:58,904 (model:925) WARNING: All labels are zero
2025-02-14 17:28:06,566 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 19956,  validation: loss=0.087, DER=0.2004, ACC=0.9611, MI=0.1052, FA=0.06512, CF=0.03011, over 0.00 frames. 
2025-02-14 17:28:06,567 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 17:28:08,216 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 19956,  validation: loss=0.08904, DER=0.2015, ACC=0.9599, MI=0.1065, FA=0.06403, CF=0.03105, over 0.00 frames. 
2025-02-14 17:28:08,216 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 17:38:40,590 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 20456, num_updates: 20000, {'loss': 0.10991223156452179, 'DER': 0.25372918175235337, 'ACC': np.float64(0.9560714285714286), 'MI': 0.13178855901520636, 'FA': 0.09065894279507603, 'CF': 0.03128167994207096}, batch size: 64, grad_norm: 0.23665571212768555, grad_scale: , lr: 0.00e+00, 
2025-02-14 17:38:40,590 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 20456, num_updates: 20000, {'loss': 0.1178361028432846, 'DER': 0.27838977288181693, 'ACC': np.float64(0.94578125), 'MI': 0.1659186726506188, 'FA': 0.06051951584387325, 'CF': 0.0519515843873249}, batch size: 64, grad_norm: 0.23665571212768555, grad_scale: , lr: 0.00e+00, 
2025-02-14 17:38:40,590 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 17:38:40,590 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 17:39:13,939 (model:925) WARNING: All labels are zero
2025-02-14 17:39:13,956 (model:925) WARNING: All labels are zero
2025-02-14 17:39:14,370 (model:925) WARNING: All labels are zero
2025-02-14 17:40:14,665 (model:925) WARNING: All labels are zero
2025-02-14 17:40:22,497 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 20456,  validation: loss=0.08687, DER=0.2011, ACC=0.961, MI=0.105, FA=0.06538, CF=0.03065, over 0.00 frames. 
2025-02-14 17:40:22,497 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 17:40:31,502 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 20456,  validation: loss=0.08889, DER=0.2019, ACC=0.9599, MI=0.106, FA=0.06414, CF=0.03174, over 0.00 frames. 
2025-02-14 17:40:31,502 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 17:42:50,081 (train_accelerate_ddp:713) INFO: end of epoch 5, batch_idx: 4113 batch_idx_train: 20569, {'loss': 0.10323832184076309, 'DER': 0.21911489116332708, 'ACC': np.float64(0.961294642857143), 'MI': 0.11532362692806689, 'FA': 0.0729421940320023, 'CF': 0.030849070203257892}, batch size: 64, grad_norm: 0.1960691660642624, grad_scale: , lr: 0.00e+00, 
2025-02-14 17:42:50,083 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-5.pt
2025-02-14 17:42:50,091 (train_accelerate_ddp:713) INFO: end of epoch 5, batch_idx: 4113 batch_idx_train: 20569, {'loss': 0.09442323446273804, 'DER': 0.2160105370993707, 'ACC': np.float64(0.9615848214285714), 'MI': 0.10302941606907653, 'FA': 0.07712571344943656, 'CF': 0.035855407580857604}, batch size: 64, grad_norm: 0.1960691660642624, grad_scale: , lr: 0.00e+00, 
2025-02-14 17:42:50,432 (train_accelerate_ddp:561) INFO:  end of epoch 5, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-5.pt 
2025-02-14 17:42:53,245 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 20570, num_updates: 20000, {'loss': 0.09641587734222412, 'DER': 0.2354696603666335, 'ACC': np.float64(0.9580580357142857), 'MI': 0.12448486570981952, 'FA': 0.0794372601961063, 'CF': 0.03154753446070769}, batch size: 64, grad_norm: 0.1641099900007248, grad_scale: , lr: 0.00e+00, 
2025-02-14 17:42:53,256 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 20570, num_updates: 20000, {'loss': 0.06007242202758789, 'DER': 0.15626403233048944, 'ACC': np.float64(0.9749776785714286), 'MI': 0.07798233797335728, 'FA': 0.06675647358179913, 'CF': 0.011525220775333035}, batch size: 64, grad_norm: 0.1641099900007248, grad_scale: , lr: 0.00e+00, 
2025-02-14 17:52:04,022 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-21000.pt
2025-02-14 17:52:05,069 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-14 17:52:05,116 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-14 17:53:26,867 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 21070, num_updates: 20500, {'loss': 0.10555977374315262, 'DER': 0.23698489514591584, 'ACC': np.float64(0.95671875), 'MI': 0.11438627364716233, 'FA': 0.075230972283326, 'CF': 0.04736764921542748}, batch size: 64, grad_norm: 0.2374008744955063, grad_scale: , lr: 0.00e+00, 
2025-02-14 17:53:26,867 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 21070, num_updates: 20500, {'loss': 0.10096848756074905, 'DER': 0.2485753052917232, 'ACC': np.float64(0.9503794642857143), 'MI': 0.1373134328358209, 'FA': 0.058208955223880594, 'CF': 0.05305291723202171}, batch size: 64, grad_norm: 0.2374008744955063, grad_scale: , lr: 0.00e+00, 
2025-02-14 17:53:26,868 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 17:53:26,868 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 17:53:59,849 (model:925) WARNING: All labels are zero
2025-02-14 17:53:59,990 (model:925) WARNING: All labels are zero
2025-02-14 17:54:00,392 (model:925) WARNING: All labels are zero
2025-02-14 17:55:00,305 (model:925) WARNING: All labels are zero
2025-02-14 17:55:08,162 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 21070,  validation: loss=0.08702, DER=0.2005, ACC=0.9611, MI=0.1058, FA=0.06491, CF=0.02981, over 0.00 frames. 
2025-02-14 17:55:08,163 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 17:55:08,190 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 21070,  validation: loss=0.0889, DER=0.2017, ACC=0.9599, MI=0.1067, FA=0.06403, CF=0.03098, over 0.00 frames. 
2025-02-14 17:55:08,190 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 18:05:39,688 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 21570, num_updates: 21000, {'loss': 0.10215224325656891, 'DER': 0.24024918743228602, 'ACC': np.float64(0.95546875), 'MI': 0.14138678223185266, 'FA': 0.06893282773564463, 'CF': 0.02992957746478873}, batch size: 64, grad_norm: 0.29025813937187195, grad_scale: , lr: 0.00e+00, 
2025-02-14 18:05:39,688 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 18:05:39,688 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 21570, num_updates: 21000, {'loss': 0.10359223932027817, 'DER': 0.258166017380881, 'ACC': np.float64(0.95140625), 'MI': 0.14204375187293977, 'FA': 0.04809709319748277, 'CF': 0.0680251723104585}, batch size: 64, grad_norm: 0.29025813937187195, grad_scale: , lr: 0.00e+00, 
2025-02-14 18:05:39,689 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 18:06:13,402 (model:925) WARNING: All labels are zero
2025-02-14 18:06:13,680 (model:925) WARNING: All labels are zero
2025-02-14 18:06:13,820 (model:925) WARNING: All labels are zero
2025-02-14 18:07:15,799 (model:925) WARNING: All labels are zero
2025-02-14 18:07:23,940 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 21570,  validation: loss=0.08721, DER=0.2014, ACC=0.961, MI=0.1072, FA=0.06383, CF=0.03042, over 0.00 frames. 
2025-02-14 18:07:23,941 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 18:07:24,623 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 21570,  validation: loss=0.08916, DER=0.2024, ACC=0.9598, MI=0.108, FA=0.0628, CF=0.0316, over 0.00 frames. 
2025-02-14 18:07:24,623 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 18:18:19,519 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 22070, num_updates: 21500, {'loss': 0.13429072499275208, 'DER': 0.3161263392235982, 'ACC': np.float64(0.937767857142857), 'MI': 0.16140253235007654, 'FA': 0.08292750800055657, 'CF': 0.07179629887296507}, batch size: 64, grad_norm: 0.3236704170703888, grad_scale: , lr: 0.00e+00, 
2025-02-14 18:18:19,519 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 22070, num_updates: 21500, {'loss': 0.0959225669503212, 'DER': 0.24379457917261055, 'ACC': np.float64(0.9554910714285714), 'MI': 0.13495007132667616, 'FA': 0.06818830242510698, 'CF': 0.04065620542082739}, batch size: 64, grad_norm: 0.3236704170703888, grad_scale: , lr: 0.00e+00, 
2025-02-14 18:18:19,520 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 18:18:19,520 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 18:18:52,066 (model:925) WARNING: All labels are zero
2025-02-14 18:18:52,104 (model:925) WARNING: All labels are zero
2025-02-14 18:18:52,504 (model:925) WARNING: All labels are zero
2025-02-14 18:19:51,862 (model:925) WARNING: All labels are zero
2025-02-14 18:19:59,679 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 22070,  validation: loss=0.08694, DER=0.2007, ACC=0.9611, MI=0.1056, FA=0.06471, CF=0.03038, over 0.00 frames. 
2025-02-14 18:19:59,680 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 18:20:01,086 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 22070,  validation: loss=0.08896, DER=0.2023, ACC=0.9599, MI=0.107, FA=0.06403, CF=0.03133, over 0.00 frames. 
2025-02-14 18:20:01,086 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 18:28:52,213 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-22500.pt
2025-02-14 18:28:53,278 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-14 18:30:22,830 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 22570, num_updates: 22000, {'loss': 0.09109263122081757, 'DER': 0.2111838191552647, 'ACC': np.float64(0.961830357142857), 'MI': 0.1069303985722784, 'FA': 0.06112433075550268, 'CF': 0.04312908982748364}, batch size: 64, grad_norm: 0.22006651759147644, grad_scale: , lr: 0.00e+00, 
2025-02-14 18:30:22,831 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 22570, num_updates: 22000, {'loss': 0.13145165145397186, 'DER': 0.289127986988615, 'ACC': np.float64(0.9395982142857143), 'MI': 0.2049293131490054, 'FA': 0.034780432878768926, 'CF': 0.049418240960840736}, batch size: 64, grad_norm: 0.22006651759147644, grad_scale: , lr: 0.00e+00, 
2025-02-14 18:30:22,831 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 18:30:22,831 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 18:30:56,057 (model:925) WARNING: All labels are zero
2025-02-14 18:30:56,757 (model:925) WARNING: All labels are zero
2025-02-14 18:30:57,181 (model:925) WARNING: All labels are zero
2025-02-14 18:31:57,244 (model:925) WARNING: All labels are zero
2025-02-14 18:32:05,260 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 22570,  validation: loss=0.08695, DER=0.2004, ACC=0.9611, MI=0.1068, FA=0.06308, CF=0.03049, over 0.00 frames. 
2025-02-14 18:32:05,261 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 18:32:08,895 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 22570,  validation: loss=0.08889, DER=0.2016, ACC=0.9599, MI=0.108, FA=0.06222, CF=0.0314, over 0.00 frames. 
2025-02-14 18:32:08,895 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 18:42:40,476 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 23070, num_updates: 22500, {'loss': 0.1184968650341034, 'DER': 0.26782299918055175, 'ACC': np.float64(0.946875), 'MI': 0.1543294181917509, 'FA': 0.056268779022125105, 'CF': 0.05722480196667577}, batch size: 64, grad_norm: 0.28498783707618713, grad_scale: , lr: 0.00e+00, 
2025-02-14 18:42:40,476 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 23070, num_updates: 22500, {'loss': 0.12992903590202332, 'DER': 0.2540729247478666, 'ACC': np.float64(0.9492633928571429), 'MI': 0.15309025084044478, 'FA': 0.061158520817170936, 'CF': 0.03982415309025084}, batch size: 64, grad_norm: 0.28498783707618713, grad_scale: , lr: 0.00e+00, 
2025-02-14 18:42:40,477 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 18:42:40,477 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 18:43:13,722 (model:925) WARNING: All labels are zero
2025-02-14 18:43:13,985 (model:925) WARNING: All labels are zero
2025-02-14 18:43:14,401 (model:925) WARNING: All labels are zero
2025-02-14 18:44:14,605 (model:925) WARNING: All labels are zero
2025-02-14 18:44:22,537 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 23070,  validation: loss=0.08648, DER=0.2004, ACC=0.9611, MI=0.1096, FA=0.06071, CF=0.03016, over 0.00 frames. 
2025-02-14 18:44:22,538 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 18:44:24,754 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 23070,  validation: loss=0.08849, DER=0.2015, ACC=0.9599, MI=0.1107, FA=0.05955, CF=0.0313, over 0.00 frames. 
2025-02-14 18:44:24,754 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 18:54:55,534 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 23570, num_updates: 23000, {'loss': 0.1093897745013237, 'DER': 0.2602703766898543, 'ACC': np.float64(0.947857142857143), 'MI': 0.1396508728179551, 'FA': 0.07428796429977687, 'CF': 0.04633153957212233}, batch size: 64, grad_norm: 0.1942257434129715, grad_scale: , lr: 0.00e+00, 
2025-02-14 18:54:55,534 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 23570, num_updates: 23000, {'loss': 0.07500813901424408, 'DER': 0.1693745506829619, 'ACC': np.float64(0.9702901785714286), 'MI': 0.11272465851905104, 'FA': 0.03465132997843278, 'CF': 0.021998562185478073}, batch size: 64, grad_norm: 0.1942257434129715, grad_scale: , lr: 0.00e+00, 
2025-02-14 18:54:55,534 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 18:54:55,534 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 18:55:29,260 (model:925) WARNING: All labels are zero
2025-02-14 18:55:29,446 (model:925) WARNING: All labels are zero
2025-02-14 18:55:29,669 (model:925) WARNING: All labels are zero
2025-02-14 18:56:31,532 (model:925) WARNING: All labels are zero
2025-02-14 18:56:39,616 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 23570,  validation: loss=0.08726, DER=0.201, ACC=0.961, MI=0.1079, FA=0.06308, CF=0.03003, over 0.00 frames. 
2025-02-14 18:56:39,617 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 18:56:40,616 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 23570,  validation: loss=0.08929, DER=0.2025, ACC=0.9598, MI=0.1091, FA=0.06218, CF=0.03114, over 0.00 frames. 
2025-02-14 18:56:40,617 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 19:06:04,029 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-24000.pt
2025-02-14 19:06:05,606 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-14 19:07:48,674 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 24070, num_updates: 23500, {'loss': 0.07677676528692245, 'DER': 0.19776785714285713, 'ACC': np.float64(0.9656473214285713), 'MI': 0.09389880952380952, 'FA': 0.07261904761904762, 'CF': 0.03125}, batch size: 64, grad_norm: 0.1912660151720047, grad_scale: , lr: 0.00e+00, 
2025-02-14 19:07:48,674 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 19:07:48,675 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 24070, num_updates: 23500, {'loss': 0.09796388447284698, 'DER': 0.22374566822359498, 'ACC': np.float64(0.962924107142857), 'MI': 0.0961277685701371, 'FA': 0.10109989453066144, 'CF': 0.026518005122796444}, batch size: 64, grad_norm: 0.1912660151720047, grad_scale: , lr: 0.00e+00, 
2025-02-14 19:07:48,675 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 19:08:20,919 (model:925) WARNING: All labels are zero
2025-02-14 19:08:21,318 (model:925) WARNING: All labels are zero
2025-02-14 19:08:38,127 (model:925) WARNING: All labels are zero
2025-02-14 19:09:29,357 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 24070,  validation: loss=0.08919, DER=0.2027, ACC=0.9598, MI=0.1073, FA=0.06384, CF=0.03158, over 0.00 frames. 
2025-02-14 19:09:29,358 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 19:09:49,797 (model:925) WARNING: All labels are zero
2025-02-14 19:09:58,962 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 24070,  validation: loss=0.08719, DER=0.2016, ACC=0.9609, MI=0.1062, FA=0.06476, CF=0.03061, over 0.00 frames. 
2025-02-14 19:09:58,962 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 19:20:52,900 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 24570, num_updates: 24000, {'loss': 0.13775452971458435, 'DER': 0.3052159739201304, 'ACC': np.float64(0.9403348214285714), 'MI': 0.16897582178755774, 'FA': 0.07837544145612606, 'CF': 0.05786471067644662}, batch size: 64, grad_norm: 0.3158338963985443, grad_scale: , lr: 0.00e+00, 
2025-02-14 19:20:52,901 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 19:20:52,901 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 24570, num_updates: 24000, {'loss': 0.11412502825260162, 'DER': 0.2463199214916585, 'ACC': np.float64(0.9562946428571429), 'MI': 0.1488854619374737, 'FA': 0.06925557269031263, 'CF': 0.028178886863872144}, batch size: 64, grad_norm: 0.3158338963985443, grad_scale: , lr: 0.00e+00, 
2025-02-14 19:20:52,901 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 19:21:25,202 (model:925) WARNING: All labels are zero
2025-02-14 19:21:31,801 (model:925) WARNING: All labels are zero
2025-02-14 19:21:32,264 (model:925) WARNING: All labels are zero
2025-02-14 19:22:24,262 (model:925) WARNING: All labels are zero
2025-02-14 19:22:31,991 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 24570,  validation: loss=0.08631, DER=0.1997, ACC=0.9612, MI=0.1067, FA=0.06284, CF=0.0301, over 0.00 frames. 
2025-02-14 19:22:31,991 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 19:22:54,003 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 24570,  validation: loss=0.0883, DER=0.2008, ACC=0.96, MI=0.1075, FA=0.06173, CF=0.03153, over 0.00 frames. 
2025-02-14 19:22:54,004 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 19:25:22,518 (train_accelerate_ddp:713) INFO: end of epoch 6, batch_idx: 4113 batch_idx_train: 24683, {'loss': 0.10645323991775513, 'DER': 0.24904755185551009, 'ACC': np.float64(0.9540625), 'MI': 0.11993791449132214, 'FA': 0.08776633272188514, 'CF': 0.041343304642302806}, batch size: 64, grad_norm: 0.2544601559638977, grad_scale: , lr: 0.00e+00, 
2025-02-14 19:25:22,520 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-6.pt
2025-02-14 19:25:22,529 (train_accelerate_ddp:713) INFO: end of epoch 6, batch_idx: 4113 batch_idx_train: 24683, {'loss': 0.10059017688035965, 'DER': 0.23819580630562678, 'ACC': np.float64(0.9573660714285714), 'MI': 0.1368230502338211, 'FA': 0.05144063961381807, 'CF': 0.04993211645798763}, batch size: 64, grad_norm: 0.2544601559638977, grad_scale: , lr: 0.00e+00, 
2025-02-14 19:25:22,862 (train_accelerate_ddp:561) INFO:  end of epoch 6, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-6.pt 
2025-02-14 19:25:25,960 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 24684, num_updates: 24000, {'loss': 0.09477531164884567, 'DER': 0.2097881665449233, 'ACC': np.float64(0.9614285714285714), 'MI': 0.09715120525931337, 'FA': 0.06997808619430242, 'CF': 0.04265887509130752}, batch size: 64, grad_norm: 0.2380475401878357, grad_scale: , lr: 0.00e+00, 
2025-02-14 19:25:25,971 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 24684, num_updates: 24000, {'loss': 0.11300527304410934, 'DER': 0.2837391987431265, 'ACC': np.float64(0.953482142857143), 'MI': 0.13747054202670855, 'FA': 0.1025923016496465, 'CF': 0.04367635506677141}, batch size: 64, grad_norm: 0.2380475401878357, grad_scale: , lr: 0.00e+00, 
2025-02-14 19:36:42,592 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 25184, num_updates: 24500, {'loss': 0.10608385503292084, 'DER': 0.26843571323852805, 'ACC': np.float64(0.9528125), 'MI': 0.13810291746078288, 'FA': 0.08884327811171383, 'CF': 0.04148951766603137}, batch size: 64, grad_norm: 0.2435644268989563, grad_scale: , lr: 0.00e+00, 
2025-02-14 19:36:42,593 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 19:36:42,603 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 25184, num_updates: 24500, {'loss': 0.09223875403404236, 'DER': 0.22072268175881585, 'ACC': np.float64(0.9628125), 'MI': 0.12392976345958497, 'FA': 0.07575097953852851, 'CF': 0.021041938760702365}, batch size: 64, grad_norm: 0.2435644268989563, grad_scale: , lr: 0.00e+00, 
2025-02-14 19:36:42,604 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 19:37:15,310 (model:925) WARNING: All labels are zero
2025-02-14 19:37:15,713 (model:925) WARNING: All labels are zero
2025-02-14 19:37:22,305 (model:925) WARNING: All labels are zero
2025-02-14 19:38:24,251 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 25184,  validation: loss=0.08891, DER=0.202, ACC=0.9599, MI=0.1063, FA=0.06385, CF=0.03181, over 0.00 frames. 
2025-02-14 19:38:24,252 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 19:38:34,889 (model:925) WARNING: All labels are zero
2025-02-14 19:38:44,180 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 25184,  validation: loss=0.08694, DER=0.2001, ACC=0.9611, MI=0.1048, FA=0.06459, CF=0.03072, over 0.00 frames. 
2025-02-14 19:38:44,180 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 19:45:32,789 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-25500.pt
2025-02-14 19:45:33,864 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-14 19:45:33,883 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-14 19:49:39,364 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 25684, num_updates: 25000, {'loss': 0.09426175802946091, 'DER': 0.20483759502418797, 'ACC': np.float64(0.9625669642857143), 'MI': 0.12881824464409122, 'FA': 0.04906703524533518, 'CF': 0.026952315134761574}, batch size: 64, grad_norm: 0.20122972130775452, grad_scale: , lr: 0.00e+00, 
2025-02-14 19:49:39,365 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 19:49:39,365 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 25684, num_updates: 25000, {'loss': 0.10867971181869507, 'DER': 0.274115296803653, 'ACC': np.float64(0.9521875), 'MI': 0.15468036529680365, 'FA': 0.08789954337899543, 'CF': 0.031535388127853885}, batch size: 64, grad_norm: 0.20122972130775452, grad_scale: , lr: 0.00e+00, 
2025-02-14 19:49:39,365 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 19:50:15,673 (model:925) WARNING: All labels are zero
2025-02-14 19:50:16,106 (model:925) WARNING: All labels are zero
2025-02-14 19:50:18,859 (model:925) WARNING: All labels are zero
2025-02-14 19:51:25,266 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 25684,  validation: loss=0.08873, DER=0.2016, ACC=0.9599, MI=0.1065, FA=0.06356, CF=0.03154, over 0.00 frames. 
2025-02-14 19:51:25,266 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 19:51:30,331 (model:925) WARNING: All labels are zero
2025-02-14 19:51:39,542 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 25684,  validation: loss=0.08682, DER=0.2003, ACC=0.9611, MI=0.1057, FA=0.06434, CF=0.03027, over 0.00 frames. 
2025-02-14 19:51:39,543 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 20:02:52,514 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 26184, num_updates: 25500, {'loss': 0.0894995927810669, 'DER': 0.22448044009779952, 'ACC': np.float64(0.9593973214285714), 'MI': 0.1023838630806846, 'FA': 0.06861246943765281, 'CF': 0.0534841075794621}, batch size: 64, grad_norm: 0.2158077359199524, grad_scale: , lr: 0.00e+00, 
2025-02-14 20:02:52,515 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 20:02:52,515 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 26184, num_updates: 25500, {'loss': 0.09708936512470245, 'DER': 0.27019583843329253, 'ACC': np.float64(0.9534375), 'MI': 0.11796205630354957, 'FA': 0.10327417380660955, 'CF': 0.04895960832313342}, batch size: 64, grad_norm: 0.2158077359199524, grad_scale: , lr: 0.00e+00, 
2025-02-14 20:02:52,516 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 20:03:24,604 (model:925) WARNING: All labels are zero
2025-02-14 20:03:31,779 (model:925) WARNING: All labels are zero
2025-02-14 20:03:32,173 (model:925) WARNING: All labels are zero
2025-02-14 20:04:23,232 (model:925) WARNING: All labels are zero
2025-02-14 20:04:30,897 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 26184,  validation: loss=0.0871, DER=0.2012, ACC=0.961, MI=0.1059, FA=0.06466, CF=0.03065, over 0.00 frames. 
2025-02-14 20:04:30,898 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 20:04:55,167 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 26184,  validation: loss=0.08911, DER=0.2024, ACC=0.9598, MI=0.1073, FA=0.06358, CF=0.03151, over 0.00 frames. 
2025-02-14 20:04:55,168 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 20:15:44,983 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 26684, num_updates: 26000, {'loss': 0.10070585459470749, 'DER': 0.21830357142857143, 'ACC': np.float64(0.9579910714285714), 'MI': 0.0900297619047619, 'FA': 0.06651785714285714, 'CF': 0.061755952380952384}, batch size: 64, grad_norm: 0.2214178591966629, grad_scale: , lr: 0.00e+00, 
2025-02-14 20:15:44,984 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 20:15:45,770 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 26684, num_updates: 26000, {'loss': 0.11298362910747528, 'DER': 0.23706624605678234, 'ACC': np.float64(0.960625), 'MI': 0.1083596214511041, 'FA': 0.08753943217665615, 'CF': 0.04116719242902208}, batch size: 64, grad_norm: 0.2214178591966629, grad_scale: , lr: 0.00e+00, 
2025-02-14 20:15:45,770 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 20:16:17,966 (model:925) WARNING: All labels are zero
2025-02-14 20:16:24,517 (model:925) WARNING: All labels are zero
2025-02-14 20:16:25,031 (model:925) WARNING: All labels are zero
2025-02-14 20:17:16,940 (model:925) WARNING: All labels are zero
2025-02-14 20:17:24,652 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 26684,  validation: loss=0.08701, DER=0.201, ACC=0.961, MI=0.1072, FA=0.06333, CF=0.03043, over 0.00 frames. 
2025-02-14 20:17:24,652 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 20:17:47,288 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 26684,  validation: loss=0.08908, DER=0.2021, ACC=0.9599, MI=0.1085, FA=0.06223, CF=0.03143, over 0.00 frames. 
2025-02-14 20:17:47,289 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 20:24:46,705 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-27000.pt
2025-02-14 20:24:47,478 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-14 20:28:57,947 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 27184, num_updates: 26500, {'loss': 0.09816897660493851, 'DER': 0.23190431811121467, 'ACC': np.float64(0.9586830357142857), 'MI': 0.10872941907424666, 'FA': 0.06756756756756757, 'CF': 0.05560733146940044}, batch size: 64, grad_norm: 0.19629639387130737, grad_scale: , lr: 0.00e+00, 
2025-02-14 20:28:57,947 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 20:28:57,947 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 27184, num_updates: 26500, {'loss': 0.0994289442896843, 'DER': 0.20942857142857144, 'ACC': np.float64(0.9633258928571429), 'MI': 0.11214285714285714, 'FA': 0.072, 'CF': 0.025285714285714286}, batch size: 64, grad_norm: 0.19629639387130737, grad_scale: , lr: 0.00e+00, 
2025-02-14 20:28:57,947 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 20:29:30,851 (model:925) WARNING: All labels are zero
2025-02-14 20:29:31,252 (model:925) WARNING: All labels are zero
2025-02-14 20:29:36,828 (model:925) WARNING: All labels are zero
2025-02-14 20:30:39,976 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 27184,  validation: loss=0.08918, DER=0.2022, ACC=0.9598, MI=0.1075, FA=0.06286, CF=0.0318, over 0.00 frames. 
2025-02-14 20:30:39,976 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 20:30:48,770 (model:925) WARNING: All labels are zero
2025-02-14 20:30:58,234 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 27184,  validation: loss=0.08724, DER=0.2015, ACC=0.9609, MI=0.1063, FA=0.06412, CF=0.03112, over 0.00 frames. 
2025-02-14 20:30:58,234 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 20:41:57,896 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 27684, num_updates: 27000, {'loss': 0.10953009128570557, 'DER': 0.2290888981059035, 'ACC': np.float64(0.9540848214285714), 'MI': 0.1108806857458869, 'FA': 0.06290612470620766, 'CF': 0.05530208765380893}, batch size: 64, grad_norm: 0.2637590765953064, grad_scale: , lr: 0.00e+00, 
2025-02-14 20:41:57,896 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 27684, num_updates: 27000, {'loss': 0.0933203473687172, 'DER': 0.22809821298852245, 'ACC': np.float64(0.9584375), 'MI': 0.10416969344762458, 'FA': 0.08150515763475229, 'CF': 0.042423361906145575}, batch size: 64, grad_norm: 0.2637590765953064, grad_scale: , lr: 0.00e+00, 
2025-02-14 20:41:57,896 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 20:41:57,896 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 20:42:30,615 (model:925) WARNING: All labels are zero
2025-02-14 20:42:36,078 (model:925) WARNING: All labels are zero
2025-02-14 20:42:36,586 (model:925) WARNING: All labels are zero
2025-02-14 20:43:30,237 (model:925) WARNING: All labels are zero
2025-02-14 20:43:38,059 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 27684,  validation: loss=0.08702, DER=0.2012, ACC=0.961, MI=0.1067, FA=0.06402, CF=0.03052, over 0.00 frames. 
2025-02-14 20:43:38,059 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 20:43:58,880 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 27684,  validation: loss=0.08907, DER=0.2022, ACC=0.9598, MI=0.1077, FA=0.06297, CF=0.03147, over 0.00 frames. 
2025-02-14 20:43:58,880 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 20:55:10,459 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 28184, num_updates: 27500, {'loss': 0.10735402256250381, 'DER': 0.21915385661814718, 'ACC': np.float64(0.960669642857143), 'MI': 0.14134131410692422, 'FA': 0.05727111957556795, 'CF': 0.020541422935655012}, batch size: 64, grad_norm: 0.19999851286411285, grad_scale: , lr: 0.00e+00, 
2025-02-14 20:55:10,460 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 20:55:10,471 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 28184, num_updates: 27500, {'loss': 0.06964243948459625, 'DER': 0.17235023041474654, 'ACC': np.float64(0.97234375), 'MI': 0.09293394777265745, 'FA': 0.06144393241167435, 'CF': 0.017972350230414748}, batch size: 64, grad_norm: 0.19999851286411285, grad_scale: , lr: 0.00e+00, 
2025-02-14 20:55:10,472 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 20:55:43,074 (model:925) WARNING: All labels are zero
2025-02-14 20:55:43,474 (model:925) WARNING: All labels are zero
2025-02-14 20:55:49,913 (model:925) WARNING: All labels are zero
2025-02-14 20:56:51,541 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 28184,  validation: loss=0.08895, DER=0.2017, ACC=0.9599, MI=0.106, FA=0.0643, CF=0.03146, over 0.00 frames. 
2025-02-14 20:56:51,541 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 20:57:01,260 (model:925) WARNING: All labels are zero
2025-02-14 20:57:10,615 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 28184,  validation: loss=0.08691, DER=0.2006, ACC=0.9611, MI=0.1048, FA=0.06545, CF=0.03032, over 0.00 frames. 
2025-02-14 20:57:10,616 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 21:04:08,153 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-28500.pt
2025-02-14 21:04:08,592 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-14 21:08:14,527 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 28684, num_updates: 28000, {'loss': 0.10761475563049316, 'DER': 0.2527618205921343, 'ACC': np.float64(0.9542410714285714), 'MI': 0.11680659891000147, 'FA': 0.0867579908675799, 'CF': 0.049197230814552954}, batch size: 64, grad_norm: 0.3060808777809143, grad_scale: , lr: 0.00e+00, 
2025-02-14 21:08:14,527 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 21:08:14,528 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 28684, num_updates: 28000, {'loss': 0.09931927919387817, 'DER': 0.2602957544919701, 'ACC': np.float64(0.9548214285714286), 'MI': 0.09476864366353951, 'FA': 0.10399109556368262, 'CF': 0.06153601526474797}, batch size: 64, grad_norm: 0.3060808777809143, grad_scale: , lr: 0.00e+00, 
2025-02-14 21:08:14,528 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 21:08:46,997 (model:925) WARNING: All labels are zero
2025-02-14 21:08:47,397 (model:925) WARNING: All labels are zero
2025-02-14 21:08:53,526 (model:925) WARNING: All labels are zero
2025-02-14 21:09:55,461 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 28684,  validation: loss=0.08883, DER=0.2011, ACC=0.96, MI=0.1063, FA=0.06349, CF=0.03133, over 0.00 frames. 
2025-02-14 21:09:55,462 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 21:10:06,898 (model:925) WARNING: All labels are zero
2025-02-14 21:10:16,694 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 28684,  validation: loss=0.08686, DER=0.2002, ACC=0.9611, MI=0.1054, FA=0.06455, CF=0.03023, over 0.00 frames. 
2025-02-14 21:10:16,694 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 21:12:44,862 (train_accelerate_ddp:713) INFO: end of epoch 7, batch_idx: 4113 batch_idx_train: 28797, {'loss': 0.12328338623046875, 'DER': 0.2864438931854662, 'ACC': np.float64(0.9467857142857143), 'MI': 0.14723478768422588, 'FA': 0.07777615642784182, 'CF': 0.06143294907339851}, batch size: 64, grad_norm: 0.26494234800338745, grad_scale: , lr: 0.00e+00, 
2025-02-14 21:12:44,863 (train_accelerate_ddp:713) INFO: end of epoch 7, batch_idx: 4113 batch_idx_train: 28797, {'loss': 0.08844021707773209, 'DER': 0.20346579025993428, 'ACC': np.float64(0.9650669642857143), 'MI': 0.10875410815655812, 'FA': 0.0643860173289513, 'CF': 0.03032566477442486}, batch size: 64, grad_norm: 0.26494234800338745, grad_scale: , lr: 0.00e+00, 
2025-02-14 21:12:44,864 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-7.pt
2025-02-14 21:12:45,357 (train_accelerate_ddp:561) INFO:  end of epoch 7, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-7.pt 
2025-02-14 21:12:47,493 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 28798, num_updates: 28000, {'loss': 0.12065139412879944, 'DER': 0.3028732227488152, 'ACC': np.float64(0.9424553571428571), 'MI': 0.1318127962085308, 'FA': 0.09212085308056872, 'CF': 0.07893957345971564}, batch size: 64, grad_norm: 0.21006818115711212, grad_scale: , lr: 0.00e+00, 
2025-02-14 21:12:47,503 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 28798, num_updates: 28000, {'loss': 0.07156717032194138, 'DER': 0.1852030171722035, 'ACC': np.float64(0.9718973214285714), 'MI': 0.08570052961001444, 'FA': 0.08265125982988285, 'CF': 0.016851227732306212}, batch size: 64, grad_norm: 0.21006818115711212, grad_scale: , lr: 0.00e+00, 
2025-02-14 21:24:09,446 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 29298, num_updates: 28500, {'loss': 0.09915069490671158, 'DER': 0.23028300531532825, 'ACC': np.float64(0.9579464285714286), 'MI': 0.10932337307858066, 'FA': 0.08059186898434133, 'CF': 0.040367763252406264}, batch size: 64, grad_norm: 0.2652070224285126, grad_scale: , lr: 0.00e+00, 
2025-02-14 21:24:09,446 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 21:24:09,456 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 29298, num_updates: 28500, {'loss': 0.12068042159080505, 'DER': 0.25326797385620914, 'ACC': np.float64(0.9488839285714286), 'MI': 0.1428376906318083, 'FA': 0.051879084967320264, 'CF': 0.05855119825708061}, batch size: 64, grad_norm: 0.2652070224285126, grad_scale: , lr: 0.00e+00, 
2025-02-14 21:24:09,457 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 21:24:41,695 (model:925) WARNING: All labels are zero
2025-02-14 21:24:48,247 (model:925) WARNING: All labels are zero
2025-02-14 21:24:48,741 (model:925) WARNING: All labels are zero
2025-02-14 21:25:40,665 (model:925) WARNING: All labels are zero
2025-02-14 21:25:48,377 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 29298,  validation: loss=0.0868, DER=0.2003, ACC=0.9611, MI=0.1078, FA=0.06209, CF=0.03045, over 0.00 frames. 
2025-02-14 21:25:48,377 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 21:26:10,392 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 29298,  validation: loss=0.0888, DER=0.2017, ACC=0.9599, MI=0.1091, FA=0.0613, CF=0.03128, over 0.00 frames. 
2025-02-14 21:26:10,393 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 21:37:04,134 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 29798, num_updates: 29000, {'loss': 0.11547891050577164, 'DER': 0.274822695035461, 'ACC': np.float64(0.945580357142857), 'MI': 0.15807419530823785, 'FA': 0.05905619203491544, 'CF': 0.057692307692307696}, batch size: 64, grad_norm: 0.32303377985954285, grad_scale: , lr: 0.00e+00, 
2025-02-14 21:37:04,134 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 21:37:04,135 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 29798, num_updates: 29000, {'loss': 0.13349922001361847, 'DER': 0.3147745396549224, 'ACC': np.float64(0.9427232142857143), 'MI': 0.14745541539799914, 'FA': 0.11004784688995216, 'CF': 0.05727127736697115}, batch size: 64, grad_norm: 0.32303377985954285, grad_scale: , lr: 0.00e+00, 
2025-02-14 21:37:04,135 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 21:37:36,214 (model:925) WARNING: All labels are zero
2025-02-14 21:37:43,344 (model:925) WARNING: All labels are zero
2025-02-14 21:37:43,831 (model:925) WARNING: All labels are zero
2025-02-14 21:38:35,079 (model:925) WARNING: All labels are zero
2025-02-14 21:38:42,793 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 29798,  validation: loss=0.08707, DER=0.2011, ACC=0.961, MI=0.1048, FA=0.06562, CF=0.03066, over 0.00 frames. 
2025-02-14 21:38:42,794 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 21:39:05,534 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 29798,  validation: loss=0.08907, DER=0.2026, ACC=0.9597, MI=0.1061, FA=0.06466, CF=0.03179, over 0.00 frames. 
2025-02-14 21:39:05,535 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 21:43:07,819 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-30000.pt
2025-02-14 21:43:08,300 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-14 21:43:08,322 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-14 21:49:29,820 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 30298, num_updates: 29500, {'loss': 0.09030313789844513, 'DER': 0.2453846153846154, 'ACC': np.float64(0.9591517857142857), 'MI': 0.1343076923076923, 'FA': 0.07492307692307693, 'CF': 0.036153846153846154}, batch size: 64, grad_norm: 0.20207282900810242, grad_scale: , lr: 0.00e+00, 
2025-02-14 21:49:29,820 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 21:49:29,822 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 30298, num_updates: 29500, {'loss': 0.11057596653699875, 'DER': 0.2652582159624413, 'ACC': np.float64(0.951205357142857), 'MI': 0.16114333057166527, 'FA': 0.06752278376139188, 'CF': 0.03659210162938415}, batch size: 64, grad_norm: 0.20207282900810242, grad_scale: , lr: 0.00e+00, 
2025-02-14 21:49:29,822 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 21:50:01,903 (model:925) WARNING: All labels are zero
2025-02-14 21:50:08,764 (model:925) WARNING: All labels are zero
2025-02-14 21:50:09,319 (model:925) WARNING: All labels are zero
2025-02-14 21:51:01,142 (model:925) WARNING: All labels are zero
2025-02-14 21:51:08,934 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 30298,  validation: loss=0.08725, DER=0.2016, ACC=0.9609, MI=0.1058, FA=0.0649, CF=0.03084, over 0.00 frames. 
2025-02-14 21:51:08,934 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 21:51:30,179 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 30298,  validation: loss=0.08923, DER=0.2024, ACC=0.9598, MI=0.107, FA=0.06365, CF=0.03178, over 0.00 frames. 
2025-02-14 21:51:30,180 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 22:03:06,350 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 30798, num_updates: 30000, {'loss': 0.10346073657274246, 'DER': 0.22665764546684708, 'ACC': np.float64(0.9576339285714286), 'MI': 0.13125845737483086, 'FA': 0.0652232746955345, 'CF': 0.03017591339648173}, batch size: 64, grad_norm: 0.1792846918106079, grad_scale: , lr: 0.00e+00, 
2025-02-14 22:03:06,350 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 22:03:06,351 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 30798, num_updates: 30000, {'loss': 0.08827317506074905, 'DER': 0.20884597414732908, 'ACC': np.float64(0.9674330357142857), 'MI': 0.09858277526864974, 'FA': 0.09188599906556612, 'CF': 0.018377199813113223}, batch size: 64, grad_norm: 0.1792846918106079, grad_scale: , lr: 0.00e+00, 
2025-02-14 22:03:06,351 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 22:03:38,959 (model:925) WARNING: All labels are zero
2025-02-14 22:03:45,585 (model:925) WARNING: All labels are zero
2025-02-14 22:03:46,199 (model:925) WARNING: All labels are zero
2025-02-14 22:04:38,932 (model:925) WARNING: All labels are zero
2025-02-14 22:04:46,748 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 30798,  validation: loss=0.08681, DER=0.2014, ACC=0.961, MI=0.1105, FA=0.06053, CF=0.03032, over 0.00 frames. 
2025-02-14 22:04:46,748 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 22:05:08,000 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 30798,  validation: loss=0.08884, DER=0.202, ACC=0.9599, MI=0.1115, FA=0.05919, CF=0.03137, over 0.00 frames. 
2025-02-14 22:05:08,000 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 22:16:38,687 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 31298, num_updates: 30500, {'loss': 0.08952499181032181, 'DER': 0.21196971861162692, 'ACC': np.float64(0.9600892857142856), 'MI': 0.09841451221254106, 'FA': 0.07013283816597629, 'CF': 0.043422368233109555}, batch size: 64, grad_norm: 0.27701184153556824, grad_scale: , lr: 0.00e+00, 
2025-02-14 22:16:38,688 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 22:16:39,226 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 31298, num_updates: 30500, {'loss': 0.12618032097816467, 'DER': 0.25793479821915843, 'ACC': np.float64(0.9523660714285714), 'MI': 0.13557374694815452, 'FA': 0.07381875628321126, 'CF': 0.04854229498779262}, batch size: 64, grad_norm: 0.27701184153556824, grad_scale: , lr: 0.00e+00, 
2025-02-14 22:16:39,227 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 22:17:11,639 (model:925) WARNING: All labels are zero
2025-02-14 22:17:17,756 (model:925) WARNING: All labels are zero
2025-02-14 22:17:18,220 (model:925) WARNING: All labels are zero
2025-02-14 22:18:11,241 (model:925) WARNING: All labels are zero
2025-02-14 22:18:19,054 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 31298,  validation: loss=0.08669, DER=0.2007, ACC=0.9611, MI=0.1072, FA=0.06305, CF=0.03042, over 0.00 frames. 
2025-02-14 22:18:19,054 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 22:18:39,145 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 31298,  validation: loss=0.08873, DER=0.202, ACC=0.9599, MI=0.1084, FA=0.06209, CF=0.03149, over 0.00 frames. 
2025-02-14 22:18:39,146 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 22:23:06,372 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-31500.pt
2025-02-14 22:23:06,940 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-14 22:29:38,339 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 31798, num_updates: 31000, {'loss': 0.14981502294540405, 'DER': 0.3403915301638034, 'ACC': np.float64(0.9347321428571429), 'MI': 0.21933679584498603, 'FA': 0.07204687708083633, 'CF': 0.04900785723798109}, batch size: 64, grad_norm: 0.3539730906486511, grad_scale: , lr: 0.00e+00, 
2025-02-14 22:29:38,340 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 22:29:38,345 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 31798, num_updates: 31000, {'loss': 0.1504901945590973, 'DER': 0.32233576642335765, 'ACC': np.float64(0.935580357142857), 'MI': 0.13708029197080293, 'FA': 0.08627737226277372, 'CF': 0.09897810218978102}, batch size: 64, grad_norm: 0.3539730906486511, grad_scale: , lr: 0.00e+00, 
2025-02-14 22:29:38,346 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 22:30:12,812 (model:925) WARNING: All labels are zero
2025-02-14 22:30:17,146 (model:925) WARNING: All labels are zero
2025-02-14 22:30:17,620 (model:925) WARNING: All labels are zero
2025-02-14 22:31:16,972 (model:925) WARNING: All labels are zero
2025-02-14 22:31:25,447 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 31798,  validation: loss=0.08661, DER=0.2004, ACC=0.9612, MI=0.106, FA=0.06395, CF=0.03048, over 0.00 frames. 
2025-02-14 22:31:25,448 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 22:31:39,610 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 31798,  validation: loss=0.08871, DER=0.2021, ACC=0.9599, MI=0.1074, FA=0.06309, CF=0.03159, over 0.00 frames. 
2025-02-14 22:31:39,611 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 22:42:54,054 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 32298, num_updates: 31500, {'loss': 0.1096297949552536, 'DER': 0.27813289727961943, 'ACC': np.float64(0.95), 'MI': 0.1263564739111045, 'FA': 0.09692284822357664, 'CF': 0.054853575144938306}, batch size: 64, grad_norm: 0.23103785514831543, grad_scale: , lr: 0.00e+00, 
2025-02-14 22:42:54,054 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 22:42:54,055 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 32298, num_updates: 31500, {'loss': 0.10887660086154938, 'DER': 0.22263948497854077, 'ACC': np.float64(0.9572321428571429), 'MI': 0.13023068669527896, 'FA': 0.05807403433476395, 'CF': 0.034334763948497854}, batch size: 64, grad_norm: 0.23103785514831543, grad_scale: , lr: 0.00e+00, 
2025-02-14 22:42:54,055 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 22:43:26,194 (model:925) WARNING: All labels are zero
2025-02-14 22:43:26,588 (model:925) WARNING: All labels are zero
2025-02-14 22:43:33,250 (model:925) WARNING: All labels are zero
2025-02-14 22:44:34,554 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 32298,  validation: loss=0.08878, DER=0.2015, ACC=0.9599, MI=0.1086, FA=0.06119, CF=0.03172, over 0.00 frames. 
2025-02-14 22:44:34,554 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 22:44:45,175 (model:925) WARNING: All labels are zero
2025-02-14 22:44:54,672 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 32298,  validation: loss=0.08672, DER=0.2003, ACC=0.9611, MI=0.1076, FA=0.06254, CF=0.0302, over 0.00 frames. 
2025-02-14 22:44:54,672 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 22:56:29,794 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 32798, num_updates: 32000, {'loss': 0.1198180541396141, 'DER': 0.2421957671957672, 'ACC': np.float64(0.9532589285714286), 'MI': 0.15119047619047618, 'FA': 0.056216931216931214, 'CF': 0.034788359788359785}, batch size: 64, grad_norm: 0.2709774374961853, grad_scale: , lr: 0.00e+00, 
2025-02-14 22:56:29,795 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 22:56:30,420 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 32798, num_updates: 32000, {'loss': 0.11465248465538025, 'DER': 0.2546328071379547, 'ACC': np.float64(0.9477901785714287), 'MI': 0.13452299245024021, 'FA': 0.05367192862045299, 'CF': 0.06643788606726149}, batch size: 64, grad_norm: 0.2709774374961853, grad_scale: , lr: 0.00e+00, 
2025-02-14 22:56:30,420 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 22:57:03,053 (model:925) WARNING: All labels are zero
2025-02-14 22:57:03,469 (model:925) WARNING: All labels are zero
2025-02-14 22:57:10,632 (model:925) WARNING: All labels are zero
2025-02-14 22:58:11,598 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 32798,  validation: loss=0.08872, DER=0.2016, ACC=0.96, MI=0.1116, FA=0.05897, CF=0.03101, over 0.00 frames. 
2025-02-14 22:58:11,598 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 22:58:22,653 (model:925) WARNING: All labels are zero
2025-02-14 22:58:32,193 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 32798,  validation: loss=0.08673, DER=0.2003, ACC=0.9612, MI=0.1104, FA=0.05992, CF=0.02989, over 0.00 frames. 
2025-02-14 22:58:32,194 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 23:01:02,695 (train_accelerate_ddp:713) INFO: end of epoch 8, batch_idx: 4113 batch_idx_train: 32911, {'loss': 0.09127063304185867, 'DER': 0.23339231140421426, 'ACC': np.float64(0.9586160714285714), 'MI': 0.09667041981663181, 'FA': 0.07189963004664629, 'CF': 0.06482226154093615}, batch size: 64, grad_norm: 0.22103509306907654, grad_scale: , lr: 0.00e+00, 
2025-02-14 23:01:02,706 (train_accelerate_ddp:713) INFO: end of epoch 8, batch_idx: 4113 batch_idx_train: 32911, {'loss': 0.08421396464109421, 'DER': 0.21663413901816544, 'ACC': np.float64(0.9641294642857143), 'MI': 0.12940999849872392, 'FA': 0.0626032127308212, 'CF': 0.024620927788620326}, batch size: 64, grad_norm: 0.22103509306907654, grad_scale: , lr: 0.00e+00, 
2025-02-14 23:01:02,709 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-8.pt
2025-02-14 23:01:03,147 (train_accelerate_ddp:561) INFO:  end of epoch 8, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-8.pt 
2025-02-14 23:01:06,054 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 32912, num_updates: 32000, {'loss': 0.11432480812072754, 'DER': 0.26352874859075537, 'ACC': np.float64(0.9488839285714286), 'MI': 0.11231679819616686, 'FA': 0.09202367531003382, 'CF': 0.05918827508455468}, batch size: 64, grad_norm: 0.2381572425365448, grad_scale: , lr: 0.00e+00, 
2025-02-14 23:01:06,054 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 32912, num_updates: 32000, {'loss': 0.11435359716415405, 'DER': 0.27233921457029026, 'ACC': np.float64(0.948325892857143), 'MI': 0.13873079112122938, 'FA': 0.0765509391007399, 'CF': 0.057057484348321}, batch size: 64, grad_norm: 0.2381572425365448, grad_scale: , lr: 0.00e+00, 
2025-02-14 23:03:02,765 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-33000.pt
2025-02-14 23:03:03,227 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-14 23:03:03,229 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-14 23:12:26,437 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 33412, num_updates: 32500, {'loss': 0.10576168447732925, 'DER': 0.24949842361708227, 'ACC': np.float64(0.9522544642857143), 'MI': 0.12238463743192891, 'FA': 0.07007738607050731, 'CF': 0.05703640011464603}, batch size: 64, grad_norm: 0.19176585972309113, grad_scale: , lr: 0.00e+00, 
2025-02-14 23:12:26,438 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 23:12:26,438 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 33412, num_updates: 32500, {'loss': 0.11307305097579956, 'DER': 0.27606375201052785, 'ACC': np.float64(0.94890625), 'MI': 0.12940488375493492, 'FA': 0.08802456499488229, 'CF': 0.05863430326071063}, batch size: 64, grad_norm: 0.19176585972309113, grad_scale: , lr: 0.00e+00, 
2025-02-14 23:12:26,438 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 23:12:58,854 (model:925) WARNING: All labels are zero
2025-02-14 23:12:59,251 (model:925) WARNING: All labels are zero
2025-02-14 23:13:05,958 (model:925) WARNING: All labels are zero
2025-02-14 23:14:07,080 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 33412,  validation: loss=0.08898, DER=0.2025, ACC=0.9598, MI=0.1075, FA=0.06359, CF=0.03139, over 0.00 frames. 
2025-02-14 23:14:07,081 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 23:14:17,429 (model:925) WARNING: All labels are zero
2025-02-14 23:14:26,876 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 33412,  validation: loss=0.08697, DER=0.2012, ACC=0.9611, MI=0.1063, FA=0.06455, CF=0.03027, over 0.00 frames. 
2025-02-14 23:14:26,877 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 23:25:24,167 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 33912, num_updates: 33000, {'loss': 0.12533535063266754, 'DER': 0.3139518709138962, 'ACC': np.float64(0.9408482142857143), 'MI': 0.18277924607038532, 'FA': 0.07650577270830436, 'CF': 0.05466685213520656}, batch size: 64, grad_norm: 0.23450937867164612, grad_scale: , lr: 0.00e+00, 
2025-02-14 23:25:24,168 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 23:25:24,168 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 33912, num_updates: 33000, {'loss': 0.09308511763811111, 'DER': 0.22362869198312235, 'ACC': np.float64(0.9555133928571429), 'MI': 0.11181434599156118, 'FA': 0.05513361462728551, 'CF': 0.05668073136427567}, batch size: 64, grad_norm: 0.23450937867164612, grad_scale: , lr: 0.00e+00, 
2025-02-14 23:25:24,168 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 23:25:56,854 (model:925) WARNING: All labels are zero
2025-02-14 23:26:03,746 (model:925) WARNING: All labels are zero
2025-02-14 23:26:04,154 (model:925) WARNING: All labels are zero
2025-02-14 23:26:56,570 (model:925) WARNING: All labels are zero
2025-02-14 23:27:04,383 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 33912,  validation: loss=0.08655, DER=0.1995, ACC=0.9612, MI=0.1076, FA=0.06187, CF=0.03005, over 0.00 frames. 
2025-02-14 23:27:04,383 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 23:27:26,163 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 33912,  validation: loss=0.08852, DER=0.201, ACC=0.9601, MI=0.1088, FA=0.06109, CF=0.03112, over 0.00 frames. 
2025-02-14 23:27:26,164 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 23:38:36,642 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 34412, num_updates: 33500, {'loss': 0.09468226879835129, 'DER': 0.21710788878541973, 'ACC': np.float64(0.957388392857143), 'MI': 0.13462817613409606, 'FA': 0.04562990554742583, 'CF': 0.03684980710389783}, batch size: 64, grad_norm: 0.2454497069120407, grad_scale: , lr: 0.00e+00, 
2025-02-14 23:38:36,643 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 23:38:36,643 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 34412, num_updates: 33500, {'loss': 0.101740263402462, 'DER': 0.23714123330491618, 'ACC': np.float64(0.9529241071428571), 'MI': 0.12205171923842001, 'FA': 0.052571753339016765, 'CF': 0.0625177607274794}, batch size: 64, grad_norm: 0.2454497069120407, grad_scale: , lr: 0.00e+00, 
2025-02-14 23:38:36,643 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 23:39:09,279 (model:925) WARNING: All labels are zero
2025-02-14 23:39:09,672 (model:925) WARNING: All labels are zero
2025-02-14 23:39:16,184 (model:925) WARNING: All labels are zero
2025-02-14 23:40:17,570 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 34412,  validation: loss=0.08925, DER=0.2022, ACC=0.9598, MI=0.1067, FA=0.0641, CF=0.03144, over 0.00 frames. 
2025-02-14 23:40:17,571 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 23:40:27,827 (model:925) WARNING: All labels are zero
2025-02-14 23:40:37,018 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 34412,  validation: loss=0.08731, DER=0.2009, ACC=0.961, MI=0.1053, FA=0.06501, CF=0.03061, over 0.00 frames. 
2025-02-14 23:40:37,019 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 23:42:45,977 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-34500.pt
2025-02-14 23:42:46,452 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-14 23:52:09,514 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 34912, num_updates: 34000, {'loss': 0.12853257358074188, 'DER': 0.30806675938803896, 'ACC': np.float64(0.9413616071428571), 'MI': 0.18678720445062588, 'FA': 0.06397774687065369, 'CF': 0.057301808066759385}, batch size: 64, grad_norm: 0.2276444137096405, grad_scale: , lr: 0.00e+00, 
2025-02-14 23:52:09,515 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 23:52:09,515 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 34912, num_updates: 34000, {'loss': 0.09123833477497101, 'DER': 0.2148872180451128, 'ACC': np.float64(0.9614508928571429), 'MI': 0.09654135338345865, 'FA': 0.07353383458646616, 'CF': 0.04481203007518797}, batch size: 64, grad_norm: 0.2276444137096405, grad_scale: , lr: 0.00e+00, 
2025-02-14 23:52:09,515 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 23:52:42,588 (model:925) WARNING: All labels are zero
2025-02-14 23:52:48,767 (model:925) WARNING: All labels are zero
2025-02-14 23:52:49,367 (model:925) WARNING: All labels are zero
2025-02-14 23:53:43,401 (model:925) WARNING: All labels are zero
2025-02-14 23:53:51,312 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 34912,  validation: loss=0.08659, DER=0.2006, ACC=0.9611, MI=0.1074, FA=0.06296, CF=0.03016, over 0.00 frames. 
2025-02-14 23:53:51,313 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-14 23:54:11,115 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 34912,  validation: loss=0.08854, DER=0.2013, ACC=0.9599, MI=0.1079, FA=0.062, CF=0.03141, over 0.00 frames. 
2025-02-14 23:54:11,116 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 00:05:42,727 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 35412, num_updates: 34500, {'loss': 0.08621501922607422, 'DER': 0.20427901524032827, 'ACC': np.float64(0.9642857142857143), 'MI': 0.10507033997655334, 'FA': 0.069021101992966, 'CF': 0.03018757327080891}, batch size: 64, grad_norm: 0.21058575809001923, grad_scale: , lr: 0.00e+00, 
2025-02-15 00:05:42,727 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 35412, num_updates: 34500, {'loss': 0.11554118990898132, 'DER': 0.27169197396963124, 'ACC': np.float64(0.9477901785714287), 'MI': 0.17190889370932755, 'FA': 0.054365509761388285, 'CF': 0.0454175704989154}, batch size: 64, grad_norm: 0.21058575809001923, grad_scale: , lr: 0.00e+00, 
2025-02-15 00:05:42,728 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 00:05:42,728 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 00:06:15,206 (model:925) WARNING: All labels are zero
2025-02-15 00:06:21,509 (model:925) WARNING: All labels are zero
2025-02-15 00:06:21,966 (model:925) WARNING: All labels are zero
2025-02-15 00:07:14,651 (model:925) WARNING: All labels are zero
2025-02-15 00:07:22,428 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 35412,  validation: loss=0.08711, DER=0.2011, ACC=0.9611, MI=0.1087, FA=0.06241, CF=0.03006, over 0.00 frames. 
2025-02-15 00:07:22,428 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 00:07:42,687 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 35412,  validation: loss=0.08906, DER=0.2022, ACC=0.9599, MI=0.1093, FA=0.06174, CF=0.0311, over 0.00 frames. 
2025-02-15 00:07:42,688 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 00:18:41,373 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 35912, num_updates: 35000, {'loss': 0.12927159667015076, 'DER': 0.3057718120805369, 'ACC': np.float64(0.93984375), 'MI': 0.16604026845637584, 'FA': 0.08375838926174496, 'CF': 0.05597315436241611}, batch size: 64, grad_norm: 0.23371919989585876, grad_scale: , lr: 0.00e+00, 
2025-02-15 00:18:41,373 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 00:18:41,383 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 35912, num_updates: 35000, {'loss': 0.1159675344824791, 'DER': 0.2563501367721766, 'ACC': np.float64(0.9458928571428571), 'MI': 0.14302461899179367, 'FA': 0.053927315357561546, 'CF': 0.059398202422821414}, batch size: 64, grad_norm: 0.23371919989585876, grad_scale: , lr: 0.00e+00, 
2025-02-15 00:18:41,383 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 00:19:17,779 (model:925) WARNING: All labels are zero
2025-02-15 00:19:19,931 (model:925) WARNING: All labels are zero
2025-02-15 00:19:20,388 (model:925) WARNING: All labels are zero
2025-02-15 00:20:19,254 (model:925) WARNING: All labels are zero
2025-02-15 00:20:27,072 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 35912,  validation: loss=0.08676, DER=0.2003, ACC=0.9611, MI=0.1069, FA=0.0629, CF=0.03048, over 0.00 frames. 
2025-02-15 00:20:27,072 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 00:20:40,747 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 35912,  validation: loss=0.08864, DER=0.2013, ACC=0.96, MI=0.1082, FA=0.0621, CF=0.031, over 0.00 frames. 
2025-02-15 00:20:40,748 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 00:22:36,058 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-36000.pt
2025-02-15 00:22:36,573 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-15 00:31:44,600 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 36412, num_updates: 35500, {'loss': 0.08158905059099197, 'DER': 0.18637681159420288, 'ACC': np.float64(0.9679910714285714), 'MI': 0.10797101449275362, 'FA': 0.056956521739130433, 'CF': 0.021449275362318842}, batch size: 64, grad_norm: 0.17887276411056519, grad_scale: , lr: 0.00e+00, 
2025-02-15 00:31:44,600 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 00:31:44,611 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 36412, num_updates: 35500, {'loss': 0.08257885277271271, 'DER': 0.20185239635401353, 'ACC': np.float64(0.9634375), 'MI': 0.09879447221405468, 'FA': 0.06409879447221406, 'CF': 0.03895912966774478}, batch size: 64, grad_norm: 0.17887276411056519, grad_scale: , lr: 0.00e+00, 
2025-02-15 00:31:44,611 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 00:32:16,950 (model:925) WARNING: All labels are zero
2025-02-15 00:32:17,349 (model:925) WARNING: All labels are zero
2025-02-15 00:32:23,943 (model:925) WARNING: All labels are zero
2025-02-15 00:33:25,002 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 36412,  validation: loss=0.0888, DER=0.2017, ACC=0.9599, MI=0.1095, FA=0.06113, CF=0.03108, over 0.00 frames. 
2025-02-15 00:33:25,003 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 00:33:36,531 (model:925) WARNING: All labels are zero
2025-02-15 00:33:45,960 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 36412,  validation: loss=0.08675, DER=0.2001, ACC=0.9611, MI=0.1078, FA=0.06198, CF=0.03034, over 0.00 frames. 
2025-02-15 00:33:45,961 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 00:45:33,635 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 36912, num_updates: 36000, {'loss': 0.10695456713438034, 'DER': 0.25329324169530354, 'ACC': np.float64(0.9525223214285714), 'MI': 0.1277205040091638, 'FA': 0.0743127147766323, 'CF': 0.051260022909507444}, batch size: 64, grad_norm: 0.23835590481758118, grad_scale: , lr: 0.00e+00, 
2025-02-15 00:45:33,635 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 00:45:33,635 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 36912, num_updates: 36000, {'loss': 0.10727588087320328, 'DER': 0.2457725947521866, 'ACC': np.float64(0.9539285714285713), 'MI': 0.13017492711370263, 'FA': 0.060495626822157436, 'CF': 0.05510204081632653}, batch size: 64, grad_norm: 0.23835590481758118, grad_scale: , lr: 0.00e+00, 
2025-02-15 00:45:33,636 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 00:46:06,667 (model:925) WARNING: All labels are zero
2025-02-15 00:46:12,365 (model:925) WARNING: All labels are zero
2025-02-15 00:46:12,768 (model:925) WARNING: All labels are zero
2025-02-15 00:47:07,482 (model:925) WARNING: All labels are zero
2025-02-15 00:47:15,422 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 36912,  validation: loss=0.08682, DER=0.2004, ACC=0.9611, MI=0.1086, FA=0.06136, CF=0.03043, over 0.00 frames. 
2025-02-15 00:47:15,422 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 00:47:35,855 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 36912,  validation: loss=0.08877, DER=0.2015, ACC=0.96, MI=0.1099, FA=0.06033, CF=0.03125, over 0.00 frames. 
2025-02-15 00:47:35,856 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 00:50:21,486 (train_accelerate_ddp:713) INFO: end of epoch 9, batch_idx: 4113 batch_idx_train: 37025, {'loss': 0.114090695977211, 'DER': 0.23604336043360433, 'ACC': np.float64(0.9508928571428571), 'MI': 0.12506775067750678, 'FA': 0.0489159891598916, 'CF': 0.06205962059620596}, batch size: 64, grad_norm: 0.22696229815483093, grad_scale: , lr: 0.00e+00, 
2025-02-15 00:50:21,487 (train_accelerate_ddp:713) INFO: end of epoch 9, batch_idx: 4113 batch_idx_train: 37025, {'loss': 0.13214372098445892, 'DER': 0.28754038488551764, 'ACC': np.float64(0.9441517857142857), 'MI': 0.14594746453153531, 'FA': 0.0776794493608653, 'CF': 0.063913470993117}, batch size: 64, grad_norm: 0.22696229815483093, grad_scale: , lr: 0.00e+00, 
2025-02-15 00:50:21,489 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-9.pt
2025-02-15 00:50:21,834 (train_accelerate_ddp:561) INFO:  end of epoch 9, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-9.pt 
2025-02-15 00:50:24,582 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 37026, num_updates: 36000, {'loss': 0.1299116015434265, 'DER': 0.3055064581917063, 'ACC': np.float64(0.9370758928571429), 'MI': 0.16315431679129844, 'FA': 0.06458191706322229, 'CF': 0.07777022433718558}, batch size: 64, grad_norm: 0.337691992521286, grad_scale: , lr: 0.00e+00, 
2025-02-15 00:50:24,592 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 37026, num_updates: 36000, {'loss': 0.1526937633752823, 'DER': 0.35271084337349395, 'ACC': np.float64(0.9386830357142857), 'MI': 0.19322289156626507, 'FA': 0.09849397590361446, 'CF': 0.06099397590361446}, batch size: 64, grad_norm: 0.337691992521286, grad_scale: , lr: 0.00e+00, 
2025-02-15 01:00:50,684 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-37500.pt
2025-02-15 01:00:51,143 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-15 01:00:51,145 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-15 01:01:26,689 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 37526, num_updates: 36500, {'loss': 0.07800628989934921, 'DER': 0.2037818409126426, 'ACC': np.float64(0.9666741071428571), 'MI': 0.0875136740115643, 'FA': 0.08673230192217533, 'CF': 0.029535864978902954}, batch size: 64, grad_norm: 0.1981416642665863, grad_scale: , lr: 0.00e+00, 
2025-02-15 01:01:26,689 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 01:01:26,690 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 37526, num_updates: 36500, {'loss': 0.09940892457962036, 'DER': 0.2491019618679193, 'ACC': np.float64(0.9529464285714286), 'MI': 0.15404807957999447, 'FA': 0.05291516993644653, 'CF': 0.04213871235147831}, batch size: 64, grad_norm: 0.1981416642665863, grad_scale: , lr: 0.00e+00, 
2025-02-15 01:01:26,690 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 01:01:58,961 (model:925) WARNING: All labels are zero
2025-02-15 01:01:59,358 (model:925) WARNING: All labels are zero
2025-02-15 01:02:06,090 (model:925) WARNING: All labels are zero
2025-02-15 01:03:07,141 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 37526,  validation: loss=0.08873, DER=0.2014, ACC=0.9599, MI=0.1088, FA=0.06144, CF=0.0312, over 0.00 frames. 
2025-02-15 01:03:07,142 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 01:03:18,515 (model:925) WARNING: All labels are zero
2025-02-15 01:03:27,731 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 37526,  validation: loss=0.08675, DER=0.2004, ACC=0.9611, MI=0.1078, FA=0.06258, CF=0.03008, over 0.00 frames. 
2025-02-15 01:03:27,731 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 01:14:33,118 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 38026, num_updates: 37000, {'loss': 0.10625004023313522, 'DER': 0.26531192269432996, 'ACC': np.float64(0.9502678571428571), 'MI': 0.1433849651840273, 'FA': 0.07062668750888162, 'CF': 0.05130027000142106}, batch size: 64, grad_norm: 0.18496611714363098, grad_scale: , lr: 0.00e+00, 
2025-02-15 01:14:33,118 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 01:14:33,118 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 38026, num_updates: 37000, {'loss': 0.08614829927682877, 'DER': 0.18551313688488896, 'ACC': np.float64(0.9673660714285713), 'MI': 0.0930468863405429, 'FA': 0.06575700391929162, 'CF': 0.026709246625054434}, batch size: 64, grad_norm: 0.18496611714363098, grad_scale: , lr: 0.00e+00, 
2025-02-15 01:14:33,118 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 01:15:04,815 (model:925) WARNING: All labels are zero
2025-02-15 01:15:05,207 (model:925) WARNING: All labels are zero
2025-02-15 01:15:22,936 (model:925) WARNING: All labels are zero
2025-02-15 01:16:11,846 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 38026,  validation: loss=0.0887, DER=0.2013, ACC=0.96, MI=0.1068, FA=0.06283, CF=0.03162, over 0.00 frames. 
2025-02-15 01:16:11,847 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 01:16:55,048 (model:925) WARNING: All labels are zero
2025-02-15 01:17:07,414 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 38026,  validation: loss=0.08668, DER=0.1998, ACC=0.9612, MI=0.1056, FA=0.06389, CF=0.03035, over 0.00 frames. 
2025-02-15 01:17:07,414 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 01:28:27,364 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 38526, num_updates: 37500, {'loss': 0.127914696931839, 'DER': 0.2747469066366704, 'ACC': np.float64(0.946138392857143), 'MI': 0.1325928008998875, 'FA': 0.07761529808773904, 'CF': 0.06453880764904386}, batch size: 64, grad_norm: 0.2137693464756012, grad_scale: , lr: 0.00e+00, 
2025-02-15 01:28:27,365 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 01:28:27,375 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 38526, num_updates: 37500, {'loss': 0.1101435199379921, 'DER': 0.2744610281923715, 'ACC': np.float64(0.947857142857143), 'MI': 0.15809839690436706, 'FA': 0.06799336650082918, 'CF': 0.04836926478717524}, batch size: 64, grad_norm: 0.2137693464756012, grad_scale: , lr: 0.00e+00, 
2025-02-15 01:28:27,376 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 01:28:59,931 (model:925) WARNING: All labels are zero
2025-02-15 01:29:00,346 (model:925) WARNING: All labels are zero
2025-02-15 01:29:06,632 (model:925) WARNING: All labels are zero
2025-02-15 01:30:08,458 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 38526,  validation: loss=0.08878, DER=0.2017, ACC=0.9599, MI=0.108, FA=0.06243, CF=0.03134, over 0.00 frames. 
2025-02-15 01:30:08,459 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 01:30:19,509 (model:925) WARNING: All labels are zero
2025-02-15 01:30:29,096 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 38526,  validation: loss=0.08679, DER=0.2005, ACC=0.9611, MI=0.1068, FA=0.06338, CF=0.03038, over 0.00 frames. 
2025-02-15 01:30:29,097 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 01:41:19,888 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-39000.pt
2025-02-15 01:41:20,312 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-15 01:42:02,354 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 39026, num_updates: 38000, {'loss': 0.11864983290433884, 'DER': 0.3104821504764614, 'ACC': np.float64(0.9436383928571429), 'MI': 0.14820082491821931, 'FA': 0.11363959607452709, 'CF': 0.04864172948371498}, batch size: 64, grad_norm: 0.2723545432090759, grad_scale: , lr: 0.00e+00, 
2025-02-15 01:42:02,354 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 01:42:02,355 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 39026, num_updates: 38000, {'loss': 0.08558988571166992, 'DER': 0.21254801536491677, 'ACC': np.float64(0.9605133928571429), 'MI': 0.12633376013657704, 'FA': 0.04709062455541329, 'CF': 0.03912363067292645}, batch size: 64, grad_norm: 0.2723545432090759, grad_scale: , lr: 0.00e+00, 
2025-02-15 01:42:02,355 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 01:42:34,224 (model:925) WARNING: All labels are zero
2025-02-15 01:42:34,618 (model:925) WARNING: All labels are zero
2025-02-15 01:42:53,148 (model:925) WARNING: All labels are zero
2025-02-15 01:43:41,608 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 39026,  validation: loss=0.08975, DER=0.203, ACC=0.9597, MI=0.1074, FA=0.06432, CF=0.0313, over 0.00 frames. 
2025-02-15 01:43:41,609 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 01:44:10,159 (model:925) WARNING: All labels are zero
2025-02-15 01:44:19,726 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 39026,  validation: loss=0.08775, DER=0.2019, ACC=0.9609, MI=0.1065, FA=0.06516, CF=0.03026, over 0.00 frames. 
2025-02-15 01:44:19,727 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 01:55:30,943 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 39526, num_updates: 38500, {'loss': 0.0878414586186409, 'DER': 0.21949052132701422, 'ACC': np.float64(0.9597991071428571), 'MI': 0.10885663507109004, 'FA': 0.06338862559241706, 'CF': 0.04724526066350711}, batch size: 64, grad_norm: 0.23383165895938873, grad_scale: , lr: 0.00e+00, 
2025-02-15 01:55:30,944 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 01:55:30,953 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 39526, num_updates: 38500, {'loss': 0.11886551231145859, 'DER': 0.25326335621046964, 'ACC': np.float64(0.9472544642857144), 'MI': 0.13026510563854124, 'FA': 0.05826941192302516, 'CF': 0.06472883864890325}, batch size: 64, grad_norm: 0.23383165895938873, grad_scale: , lr: 0.00e+00, 
2025-02-15 01:55:30,953 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 01:56:03,403 (model:925) WARNING: All labels are zero
2025-02-15 01:56:03,803 (model:925) WARNING: All labels are zero
2025-02-15 01:56:11,052 (model:925) WARNING: All labels are zero
2025-02-15 01:57:11,631 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 39526,  validation: loss=0.08888, DER=0.202, ACC=0.9599, MI=0.1078, FA=0.06295, CF=0.03123, over 0.00 frames. 
2025-02-15 01:57:11,632 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 01:57:24,041 (model:925) WARNING: All labels are zero
2025-02-15 01:57:33,457 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 39526,  validation: loss=0.08688, DER=0.2008, ACC=0.961, MI=0.1066, FA=0.06399, CF=0.0302, over 0.00 frames. 
2025-02-15 01:57:33,458 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 02:08:34,513 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 40026, num_updates: 39000, {'loss': 0.10915675759315491, 'DER': 0.27197132616487457, 'ACC': np.float64(0.9512276785714286), 'MI': 0.14881720430107526, 'FA': 0.08186379928315413, 'CF': 0.04129032258064516}, batch size: 64, grad_norm: 0.2004021853208542, grad_scale: , lr: 0.00e+00, 
2025-02-15 02:08:34,514 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 02:08:34,524 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 40026, num_updates: 39000, {'loss': 0.0915202796459198, 'DER': 0.22058184976118106, 'ACC': np.float64(0.9610044642857143), 'MI': 0.1276595744680851, 'FA': 0.06064553480966855, 'CF': 0.032276740483427414}, batch size: 64, grad_norm: 0.2004021853208542, grad_scale: , lr: 0.00e+00, 
2025-02-15 02:08:34,524 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 02:09:07,324 (model:925) WARNING: All labels are zero
2025-02-15 02:09:25,102 (model:925) WARNING: All labels are zero
2025-02-15 02:09:25,730 (model:925) WARNING: All labels are zero
2025-02-15 02:10:07,190 (model:925) WARNING: All labels are zero
2025-02-15 02:10:15,023 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 40026,  validation: loss=0.08705, DER=0.2004, ACC=0.9611, MI=0.1067, FA=0.06324, CF=0.03053, over 0.00 frames. 
2025-02-15 02:10:15,023 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 02:11:11,485 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 40026,  validation: loss=0.08914, DER=0.2021, ACC=0.9598, MI=0.1082, FA=0.06245, CF=0.0315, over 0.00 frames. 
2025-02-15 02:11:11,486 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 02:21:40,443 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-40500.pt
2025-02-15 02:21:40,883 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-15 02:22:15,811 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 40526, num_updates: 39500, {'loss': 0.1083635687828064, 'DER': 0.2512964883686472, 'ACC': np.float64(0.9547991071428571), 'MI': 0.12683360497851534, 'FA': 0.07571492072899688, 'CF': 0.048747962661134986}, batch size: 64, grad_norm: 0.2150523066520691, grad_scale: , lr: 0.00e+00, 
2025-02-15 02:22:15,812 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 02:22:15,812 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 40526, num_updates: 39500, {'loss': 0.09691090881824493, 'DER': 0.2292713567839196, 'ACC': np.float64(0.9627232142857143), 'MI': 0.13285175879396985, 'FA': 0.06344221105527638, 'CF': 0.032977386934673364}, batch size: 64, grad_norm: 0.2150523066520691, grad_scale: , lr: 0.00e+00, 
2025-02-15 02:22:15,813 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 02:22:47,951 (model:925) WARNING: All labels are zero
2025-02-15 02:22:48,341 (model:925) WARNING: All labels are zero
2025-02-15 02:22:55,307 (model:925) WARNING: All labels are zero
2025-02-15 02:23:55,531 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 40526,  validation: loss=0.08893, DER=0.2015, ACC=0.96, MI=0.1063, FA=0.06396, CF=0.03123, over 0.00 frames. 
2025-02-15 02:23:55,532 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 02:24:07,844 (model:925) WARNING: All labels are zero
2025-02-15 02:24:17,173 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 40526,  validation: loss=0.08692, DER=0.2001, ACC=0.9612, MI=0.1047, FA=0.06493, CF=0.03039, over 0.00 frames. 
2025-02-15 02:24:17,173 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 02:36:39,078 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 41026, num_updates: 40000, {'loss': 0.1216433122754097, 'DER': 0.2923882400322191, 'ACC': np.float64(0.9463839285714286), 'MI': 0.18378305812860787, 'FA': 0.07853403141361257, 'CF': 0.030071150489998658}, batch size: 64, grad_norm: 0.21247215569019318, grad_scale: , lr: 0.00e+00, 
2025-02-15 02:36:39,079 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 02:36:39,089 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 41026, num_updates: 40000, {'loss': 0.10509220510721207, 'DER': 0.26865671641791045, 'ACC': np.float64(0.9500223214285713), 'MI': 0.14504748982360924, 'FA': 0.08846675712347354, 'CF': 0.03514246947082768}, batch size: 64, grad_norm: 0.21247215569019318, grad_scale: , lr: 0.00e+00, 
2025-02-15 02:36:39,090 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 02:37:11,778 (model:925) WARNING: All labels are zero
2025-02-15 02:37:12,191 (model:925) WARNING: All labels are zero
2025-02-15 02:37:29,854 (model:925) WARNING: All labels are zero
2025-02-15 02:38:20,259 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 41026,  validation: loss=0.08857, DER=0.2011, ACC=0.96, MI=0.1078, FA=0.06174, CF=0.03151, over 0.00 frames. 
2025-02-15 02:38:20,260 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 02:38:44,993 (model:925) WARNING: All labels are zero
2025-02-15 02:38:54,537 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 41026,  validation: loss=0.0866, DER=0.2001, ACC=0.9612, MI=0.1064, FA=0.06289, CF=0.03076, over 0.00 frames. 
2025-02-15 02:38:54,537 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 02:41:23,727 (train_accelerate_ddp:713) INFO: end of epoch 10, batch_idx: 4113 batch_idx_train: 41139, {'loss': 0.1490585058927536, 'DER': 0.30133868808567604, 'ACC': np.float64(0.9381919642857143), 'MI': 0.1717536813922356, 'FA': 0.060240963855421686, 'CF': 0.06934404283801875}, batch size: 64, grad_norm: 0.2855897545814514, grad_scale: , lr: 0.00e+00, 
2025-02-15 02:41:23,737 (train_accelerate_ddp:713) INFO: end of epoch 10, batch_idx: 4113 batch_idx_train: 41139, {'loss': 0.10488851368427277, 'DER': 0.24568081991215227, 'ACC': np.float64(0.9545089285714287), 'MI': 0.11434846266471449, 'FA': 0.07862371888726208, 'CF': 0.0527086383601757}, batch size: 64, grad_norm: 0.2855897545814514, grad_scale: , lr: 0.00e+00, 
2025-02-15 02:41:23,740 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-10.pt
2025-02-15 02:41:24,086 (train_accelerate_ddp:561) INFO:  end of epoch 10, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-10.pt 
2025-02-15 02:41:26,219 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 41140, num_updates: 40000, {'loss': 0.06317425519227982, 'DER': 0.1403030303030303, 'ACC': np.float64(0.9779464285714287), 'MI': 0.08348484848484848, 'FA': 0.047424242424242424, 'CF': 0.009393939393939394}, batch size: 64, grad_norm: 0.14914095401763916, grad_scale: , lr: 0.00e+00, 
2025-02-15 02:41:26,229 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 41140, num_updates: 40000, {'loss': 0.11874572187662125, 'DER': 0.25098536036036034, 'ACC': np.float64(0.9525892857142857), 'MI': 0.13527590090090091, 'FA': 0.06770833333333333, 'CF': 0.04800112612612613}, batch size: 64, grad_norm: 0.14914095401763916, grad_scale: , lr: 0.00e+00, 
2025-02-15 02:52:23,295 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 41640, num_updates: 40500, {'loss': 0.09963332116603851, 'DER': 0.2633679169992019, 'ACC': np.float64(0.9585491071428571), 'MI': 0.13455706304868317, 'FA': 0.09577015163607343, 'CF': 0.03304070231444533}, batch size: 64, grad_norm: 0.21807704865932465, grad_scale: , lr: 0.00e+00, 
2025-02-15 02:52:23,296 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 41640, num_updates: 40500, {'loss': 0.10736212879419327, 'DER': 0.24467790987005805, 'ACC': np.float64(0.95578125), 'MI': 0.14749792645839094, 'FA': 0.06801216477743986, 'CF': 0.02916781863422726}, batch size: 64, grad_norm: 0.21807704865932465, grad_scale: , lr: 0.00e+00, 
2025-02-15 02:52:23,296 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 02:52:23,296 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 02:52:55,783 (model:925) WARNING: All labels are zero
2025-02-15 02:53:01,680 (model:925) WARNING: All labels are zero
2025-02-15 02:53:02,122 (model:925) WARNING: All labels are zero
2025-02-15 02:53:55,381 (model:925) WARNING: All labels are zero
2025-02-15 02:54:03,183 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 41640,  validation: loss=0.08714, DER=0.2012, ACC=0.961, MI=0.1071, FA=0.06385, CF=0.03023, over 0.00 frames. 
2025-02-15 02:54:03,184 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 02:54:23,440 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 41640,  validation: loss=0.08913, DER=0.2026, ACC=0.9598, MI=0.1083, FA=0.06272, CF=0.03158, over 0.00 frames. 
2025-02-15 02:54:23,440 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 03:02:26,831 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-42000.pt
2025-02-15 03:02:27,261 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-15 03:02:27,263 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-15 03:05:40,517 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 42140, num_updates: 41000, {'loss': 0.11753922700881958, 'DER': 0.23482167165804518, 'ACC': np.float64(0.9546205357142857), 'MI': 0.15069425537707595, 'FA': 0.04219983664579363, 'CF': 0.041927579635175606}, batch size: 64, grad_norm: 0.27901342511177063, grad_scale: , lr: 0.00e+00, 
2025-02-15 03:05:40,517 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 03:05:40,518 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 42140, num_updates: 41000, {'loss': 0.11663825064897537, 'DER': 0.3027266028002948, 'ACC': np.float64(0.9471651785714286), 'MI': 0.1509211495946942, 'FA': 0.10567428150331613, 'CF': 0.04613117170228445}, batch size: 64, grad_norm: 0.27901342511177063, grad_scale: , lr: 0.00e+00, 
2025-02-15 03:05:40,518 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 03:06:12,506 (model:925) WARNING: All labels are zero
2025-02-15 03:06:12,898 (model:925) WARNING: All labels are zero
2025-02-15 03:06:19,680 (model:925) WARNING: All labels are zero
2025-02-15 03:07:20,559 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 42140,  validation: loss=0.08854, DER=0.2011, ACC=0.96, MI=0.1065, FA=0.06311, CF=0.03148, over 0.00 frames. 
2025-02-15 03:07:20,559 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 03:07:32,310 (model:925) WARNING: All labels are zero
2025-02-15 03:07:41,777 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 42140,  validation: loss=0.08654, DER=0.1995, ACC=0.9612, MI=0.1054, FA=0.06397, CF=0.03022, over 0.00 frames. 
2025-02-15 03:07:41,778 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 03:18:24,838 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 42640, num_updates: 41500, {'loss': 0.11897817999124527, 'DER': 0.2770827409724197, 'ACC': np.float64(0.9489955357142857), 'MI': 0.15680978106340632, 'FA': 0.07250497583167473, 'CF': 0.04776798407733864}, batch size: 64, grad_norm: 0.2622833251953125, grad_scale: , lr: 0.00e+00, 
2025-02-15 03:18:24,839 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 03:18:24,850 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 42640, num_updates: 41500, {'loss': 0.10575328022241592, 'DER': 0.2810882744344226, 'ACC': np.float64(0.9507142857142857), 'MI': 0.1509685051012864, 'FA': 0.08472571344078073, 'CF': 0.04539405589235546}, batch size: 64, grad_norm: 0.2622833251953125, grad_scale: , lr: 0.00e+00, 
2025-02-15 03:18:24,850 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 03:18:57,034 (model:925) WARNING: All labels are zero
2025-02-15 03:18:57,429 (model:925) WARNING: All labels are zero
2025-02-15 03:19:04,575 (model:925) WARNING: All labels are zero
2025-02-15 03:20:04,702 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 42640,  validation: loss=0.08933, DER=0.2024, ACC=0.9598, MI=0.1066, FA=0.06459, CF=0.03124, over 0.00 frames. 
2025-02-15 03:20:04,702 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 03:20:16,748 (model:925) WARNING: All labels are zero
2025-02-15 03:20:26,140 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 42640,  validation: loss=0.08727, DER=0.201, ACC=0.9611, MI=0.1054, FA=0.06545, CF=0.0302, over 0.00 frames. 
2025-02-15 03:20:26,141 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 03:32:15,870 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 43140, num_updates: 42000, {'loss': 0.1032494455575943, 'DER': 0.21761658031088082, 'ACC': np.float64(0.9591071428571429), 'MI': 0.13325362030025242, 'FA': 0.05858907931446791, 'CF': 0.02577388069616049}, batch size: 64, grad_norm: 0.16722118854522705, grad_scale: , lr: 0.00e+00, 
2025-02-15 03:32:15,870 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 03:32:15,880 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 43140, num_updates: 42000, {'loss': 0.08816599100828171, 'DER': 0.21894273127753303, 'ACC': np.float64(0.9603348214285714), 'MI': 0.09926578560939794, 'FA': 0.0776798825256975, 'CF': 0.04199706314243759}, batch size: 64, grad_norm: 0.16722118854522705, grad_scale: , lr: 0.00e+00, 
2025-02-15 03:32:15,881 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 03:32:49,302 (model:925) WARNING: All labels are zero
2025-02-15 03:32:49,725 (model:925) WARNING: All labels are zero
2025-02-15 03:32:54,827 (model:925) WARNING: All labels are zero
2025-02-15 03:33:58,611 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 43140,  validation: loss=0.08921, DER=0.2026, ACC=0.9597, MI=0.1067, FA=0.06405, CF=0.03184, over 0.00 frames. 
2025-02-15 03:33:58,611 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 03:34:06,761 (model:925) WARNING: All labels are zero
2025-02-15 03:34:16,552 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 43140,  validation: loss=0.08728, DER=0.2014, ACC=0.9609, MI=0.1057, FA=0.06493, CF=0.03075, over 0.00 frames. 
2025-02-15 03:34:16,552 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 03:42:09,714 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-43500.pt
2025-02-15 03:42:10,273 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-15 03:45:13,335 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 43640, num_updates: 42500, {'loss': 0.10096734762191772, 'DER': 0.2504162042175361, 'ACC': np.float64(0.9516294642857143), 'MI': 0.1281908990011099, 'FA': 0.07200332963374029, 'CF': 0.0502219755826859}, batch size: 64, grad_norm: 0.2077389657497406, grad_scale: , lr: 0.00e+00, 
2025-02-15 03:45:13,335 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 03:45:13,336 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 43640, num_updates: 42500, {'loss': 0.09258183091878891, 'DER': 0.24918893866831454, 'ACC': np.float64(0.95796875), 'MI': 0.12992430094237603, 'FA': 0.07755291209640043, 'CF': 0.04171172562953808}, batch size: 64, grad_norm: 0.2077389657497406, grad_scale: , lr: 0.00e+00, 
2025-02-15 03:45:13,336 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 03:45:45,953 (model:925) WARNING: All labels are zero
2025-02-15 03:45:51,842 (model:925) WARNING: All labels are zero
2025-02-15 03:45:52,239 (model:925) WARNING: All labels are zero
2025-02-15 03:46:45,555 (model:925) WARNING: All labels are zero
2025-02-15 03:46:53,356 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 43640,  validation: loss=0.08683, DER=0.2011, ACC=0.961, MI=0.1066, FA=0.0639, CF=0.03067, over 0.00 frames. 
2025-02-15 03:46:53,356 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 03:47:13,546 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 43640,  validation: loss=0.08882, DER=0.202, ACC=0.9598, MI=0.1076, FA=0.0625, CF=0.03196, over 0.00 frames. 
2025-02-15 03:47:13,547 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 03:57:49,913 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 44140, num_updates: 43000, {'loss': 0.12979841232299805, 'DER': 0.2862540716612378, 'ACC': np.float64(0.9423214285714286), 'MI': 0.18710097719869706, 'FA': 0.048729641693811075, 'CF': 0.05042345276872964}, batch size: 64, grad_norm: 0.19855965673923492, grad_scale: , lr: 0.00e+00, 
2025-02-15 03:57:49,913 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 03:57:49,924 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 44140, num_updates: 43000, {'loss': 0.09310922026634216, 'DER': 0.24854784469581168, 'ACC': np.float64(0.9591037292384832), 'MI': 0.1149495567104861, 'FA': 0.10287373891776215, 'CF': 0.030724549067563438}, batch size: 64, grad_norm: 0.19855965673923492, grad_scale: , lr: 0.00e+00, 
2025-02-15 03:57:49,924 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 03:58:22,226 (model:925) WARNING: All labels are zero
2025-02-15 03:58:37,240 (model:925) WARNING: All labels are zero
2025-02-15 03:58:37,865 (model:925) WARNING: All labels are zero
2025-02-15 03:59:20,917 (model:925) WARNING: All labels are zero
2025-02-15 03:59:28,611 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 44140,  validation: loss=0.08649, DER=0.1993, ACC=0.9613, MI=0.1076, FA=0.06149, CF=0.03024, over 0.00 frames. 
2025-02-15 03:59:28,611 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 04:00:07,101 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 44140,  validation: loss=0.0885, DER=0.2004, ACC=0.9601, MI=0.1091, FA=0.06019, CF=0.03107, over 0.00 frames. 
2025-02-15 04:00:07,101 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 04:11:04,740 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 44640, num_updates: 43500, {'loss': 0.12944753468036652, 'DER': 0.2746459694989107, 'ACC': np.float64(0.9487053571428571), 'MI': 0.1696623093681917, 'FA': 0.06672113289760348, 'CF': 0.03826252723311547}, batch size: 64, grad_norm: 0.2138165533542633, grad_scale: , lr: 0.00e+00, 
2025-02-15 04:11:04,741 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 04:11:04,751 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 44640, num_updates: 43500, {'loss': 0.10815664380788803, 'DER': 0.28205886703150423, 'ACC': np.float64(0.946875), 'MI': 0.13696198787161662, 'FA': 0.07513681408075729, 'CF': 0.0699600650791303}, batch size: 64, grad_norm: 0.2138165533542633, grad_scale: , lr: 0.00e+00, 
2025-02-15 04:11:04,752 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 04:11:37,285 (model:925) WARNING: All labels are zero
2025-02-15 04:11:37,680 (model:925) WARNING: All labels are zero
2025-02-15 04:11:44,004 (model:925) WARNING: All labels are zero
2025-02-15 04:12:45,617 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 44640,  validation: loss=0.08882, DER=0.2013, ACC=0.96, MI=0.1069, FA=0.06299, CF=0.03144, over 0.00 frames. 
2025-02-15 04:12:45,617 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 04:12:57,694 (model:925) WARNING: All labels are zero
2025-02-15 04:13:07,233 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 44640,  validation: loss=0.08692, DER=0.1999, ACC=0.9612, MI=0.1058, FA=0.06362, CF=0.03051, over 0.00 frames. 
2025-02-15 04:13:07,233 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 04:21:04,734 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-45000.pt
2025-02-15 04:21:05,165 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-15 04:23:56,351 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 45140, num_updates: 44000, {'loss': 0.12058462202548981, 'DER': 0.26051124458723285, 'ACC': np.float64(0.9495089285714287), 'MI': 0.13283978209247102, 'FA': 0.07221679005447688, 'CF': 0.05545467244028496}, batch size: 64, grad_norm: 0.2533092498779297, grad_scale: , lr: 0.00e+00, 
2025-02-15 04:23:56,352 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 04:23:56,353 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 45140, num_updates: 44000, {'loss': 0.09721992164850235, 'DER': 0.23155472457931828, 'ACC': np.float64(0.9585491071428571), 'MI': 0.15389040701855314, 'FA': 0.042140083417229975, 'CF': 0.035524234143535165}, batch size: 64, grad_norm: 0.2533092498779297, grad_scale: , lr: 0.00e+00, 
2025-02-15 04:23:56,353 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 04:24:28,035 (model:925) WARNING: All labels are zero
2025-02-15 04:24:28,440 (model:925) WARNING: All labels are zero
2025-02-15 04:24:28,524 (model:925) WARNING: All labels are zero
2025-02-15 04:25:27,006 (model:925) WARNING: All labels are zero
2025-02-15 04:25:34,655 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 45140,  validation: loss=0.08713, DER=0.2003, ACC=0.9611, MI=0.1042, FA=0.06557, CF=0.03046, over 0.00 frames. 
2025-02-15 04:25:34,655 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 04:25:34,975 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 45140,  validation: loss=0.08913, DER=0.2018, ACC=0.9599, MI=0.1054, FA=0.0648, CF=0.03164, over 0.00 frames. 
2025-02-15 04:25:34,975 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 04:27:45,947 (train_accelerate_ddp:713) INFO: end of epoch 11, batch_idx: 4113 batch_idx_train: 45253, {'loss': 0.09730105102062225, 'DER': 0.21053374752894663, 'ACC': np.float64(0.9605580357142857), 'MI': 0.12397627788760238, 'FA': 0.04758542784524146, 'CF': 0.038972041796102794}, batch size: 64, grad_norm: 0.19589634239673615, grad_scale: , lr: 0.00e+00, 
2025-02-15 04:27:45,948 (train_accelerate_ddp:713) INFO: end of epoch 11, batch_idx: 4113 batch_idx_train: 45253, {'loss': 0.10860291868448257, 'DER': 0.2432701894317049, 'ACC': np.float64(0.95234375), 'MI': 0.12434126192850022, 'FA': 0.05811138014527845, 'CF': 0.06081754735792622}, batch size: 64, grad_norm: 0.19589634239673615, grad_scale: , lr: 0.00e+00, 
2025-02-15 04:27:45,949 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-11.pt
2025-02-15 04:27:46,284 (train_accelerate_ddp:561) INFO:  end of epoch 11, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-11.pt 
2025-02-15 04:27:48,388 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 45254, num_updates: 44000, {'loss': 0.09438997507095337, 'DER': 0.258050022465179, 'ACC': np.float64(0.957857142857143), 'MI': 0.1657930208177325, 'FA': 0.06754530477759473, 'CF': 0.02471169686985173}, batch size: 64, grad_norm: 0.22520485520362854, grad_scale: , lr: 0.00e+00, 
2025-02-15 04:27:48,388 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 45254, num_updates: 44000, {'loss': 0.11234120279550552, 'DER': 0.25819153424272256, 'ACC': np.float64(0.9512276785714286), 'MI': 0.146674166783856, 'FA': 0.06243847560118127, 'CF': 0.049078891857685276}, batch size: 64, grad_norm: 0.22520485520362854, grad_scale: , lr: 0.00e+00, 
2025-02-15 04:38:54,505 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 45754, num_updates: 44500, {'loss': 0.11695971339941025, 'DER': 0.28191489361702127, 'ACC': np.float64(0.94578125), 'MI': 0.19551115723923196, 'FA': 0.05319148936170213, 'CF': 0.03321224701608718}, batch size: 64, grad_norm: 0.2622072398662567, grad_scale: , lr: 0.00e+00, 
2025-02-15 04:38:54,506 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 04:38:54,514 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 45754, num_updates: 44500, {'loss': 0.0984967052936554, 'DER': 0.23991291727140784, 'ACC': np.float64(0.9590848214285714), 'MI': 0.12757619738751813, 'FA': 0.08621190130624093, 'CF': 0.026124818577648767}, batch size: 64, grad_norm: 0.2622072398662567, grad_scale: , lr: 0.00e+00, 
2025-02-15 04:38:54,515 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 04:39:27,445 (model:925) WARNING: All labels are zero
2025-02-15 04:39:33,984 (model:925) WARNING: All labels are zero
2025-02-15 04:39:34,485 (model:925) WARNING: All labels are zero
2025-02-15 04:40:26,554 (model:925) WARNING: All labels are zero
2025-02-15 04:40:34,256 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 45754,  validation: loss=0.0871, DER=0.2012, ACC=0.961, MI=0.1086, FA=0.06258, CF=0.03008, over 0.00 frames. 
2025-02-15 04:40:34,256 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 04:40:57,521 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 45754,  validation: loss=0.0891, DER=0.2024, ACC=0.9599, MI=0.1097, FA=0.06142, CF=0.03124, over 0.00 frames. 
2025-02-15 04:40:57,522 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 04:51:49,707 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 46254, num_updates: 45000, {'loss': 0.080207459628582, 'DER': 0.19987775061124693, 'ACC': np.float64(0.9661160714285714), 'MI': 0.09214547677261614, 'FA': 0.07564180929095354, 'CF': 0.032090464547677264}, batch size: 64, grad_norm: 0.2603147029876709, grad_scale: , lr: 0.00e+00, 
2025-02-15 04:51:49,708 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 04:51:49,718 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 46254, num_updates: 45000, {'loss': 0.12116993963718414, 'DER': 0.23662631784459195, 'ACC': np.float64(0.9506026785714287), 'MI': 0.14382402707275804, 'FA': 0.04139008199921906, 'CF': 0.05141220877261486}, batch size: 64, grad_norm: 0.2603147029876709, grad_scale: , lr: 0.00e+00, 
2025-02-15 04:51:49,718 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 04:52:22,342 (model:925) WARNING: All labels are zero
2025-02-15 04:52:28,033 (model:925) WARNING: All labels are zero
2025-02-15 04:52:28,645 (model:925) WARNING: All labels are zero
2025-02-15 04:53:22,193 (model:925) WARNING: All labels are zero
2025-02-15 04:53:30,013 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 46254,  validation: loss=0.08722, DER=0.2009, ACC=0.961, MI=0.105, FA=0.06529, CF=0.03057, over 0.00 frames. 
2025-02-15 04:53:30,013 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 04:53:49,665 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 46254,  validation: loss=0.08922, DER=0.2021, ACC=0.9598, MI=0.1062, FA=0.06452, CF=0.03138, over 0.00 frames. 
2025-02-15 04:53:49,666 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 04:59:38,072 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-46500.pt
2025-02-15 04:59:38,616 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-15 04:59:38,642 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-15 05:05:14,389 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 46754, num_updates: 45500, {'loss': 0.09987339377403259, 'DER': 0.26027023338337657, 'ACC': np.float64(0.9497321428571429), 'MI': 0.15449706564760474, 'FA': 0.05868704790500887, 'CF': 0.04708611983076293}, batch size: 64, grad_norm: 0.19747255742549896, grad_scale: , lr: 0.00e+00, 
2025-02-15 05:05:14,390 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 05:05:14,400 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 46754, num_updates: 45500, {'loss': 0.09230467677116394, 'DER': 0.21614324285917294, 'ACC': np.float64(0.9584151785714287), 'MI': 0.12235327554355549, 'FA': 0.0451897115247975, 'CF': 0.04860025579081995}, batch size: 64, grad_norm: 0.19747255742549896, grad_scale: , lr: 0.00e+00, 
2025-02-15 05:05:14,400 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 05:05:46,815 (model:925) WARNING: All labels are zero
2025-02-15 05:05:47,210 (model:925) WARNING: All labels are zero
2025-02-15 05:05:53,613 (model:925) WARNING: All labels are zero
2025-02-15 05:06:54,867 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 46754,  validation: loss=0.08896, DER=0.2015, ACC=0.96, MI=0.1059, FA=0.06439, CF=0.03123, over 0.00 frames. 
2025-02-15 05:06:54,867 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 05:07:05,659 (model:925) WARNING: All labels are zero
2025-02-15 05:07:15,172 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 46754,  validation: loss=0.08705, DER=0.2003, ACC=0.9611, MI=0.1044, FA=0.06525, CF=0.03063, over 0.00 frames. 
2025-02-15 05:07:15,173 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 05:18:45,283 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 47254, num_updates: 46000, {'loss': 0.11724358797073364, 'DER': 0.26688269604666237, 'ACC': np.float64(0.9461830357142857), 'MI': 0.17044718081659105, 'FA': 0.0508101101749838, 'CF': 0.04562540505508749}, batch size: 64, grad_norm: 0.2733227610588074, grad_scale: , lr: 0.00e+00, 
2025-02-15 05:18:45,283 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 05:18:45,287 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 47254, num_updates: 46000, {'loss': 0.10871246457099915, 'DER': 0.2638360175695461, 'ACC': np.float64(0.9540401785714286), 'MI': 0.14084919472913615, 'FA': 0.08535871156661787, 'CF': 0.03762811127379209}, batch size: 64, grad_norm: 0.2733227610588074, grad_scale: , lr: 0.00e+00, 
2025-02-15 05:18:45,287 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 05:19:17,901 (model:925) WARNING: All labels are zero
2025-02-15 05:19:25,101 (model:925) WARNING: All labels are zero
2025-02-15 05:19:25,541 (model:925) WARNING: All labels are zero
2025-02-15 05:20:17,550 (model:925) WARNING: All labels are zero
2025-02-15 05:20:25,322 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 47254,  validation: loss=0.08705, DER=0.2011, ACC=0.961, MI=0.108, FA=0.06282, CF=0.03028, over 0.00 frames. 
2025-02-15 05:20:25,322 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 05:20:47,043 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 47254,  validation: loss=0.08902, DER=0.2023, ACC=0.9598, MI=0.109, FA=0.06183, CF=0.03144, over 0.00 frames. 
2025-02-15 05:20:47,043 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 05:32:11,115 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 47754, num_updates: 46500, {'loss': 0.12011400610208511, 'DER': 0.2714968152866242, 'ACC': np.float64(0.9464285714285714), 'MI': 0.1429140127388535, 'FA': 0.08160828025477707, 'CF': 0.046974522292993634}, batch size: 64, grad_norm: 0.23544524610042572, grad_scale: , lr: 0.00e+00, 
2025-02-15 05:32:11,116 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 05:32:11,116 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 47754, num_updates: 46500, {'loss': 0.11724897474050522, 'DER': 0.26321297749869177, 'ACC': np.float64(0.9486160714285714), 'MI': 0.1804029304029304, 'FA': 0.04487179487179487, 'CF': 0.03793825222396651}, batch size: 64, grad_norm: 0.23544524610042572, grad_scale: , lr: 0.00e+00, 
2025-02-15 05:32:11,116 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 05:32:43,792 (model:925) WARNING: All labels are zero
2025-02-15 05:32:50,422 (model:925) WARNING: All labels are zero
2025-02-15 05:32:50,988 (model:925) WARNING: All labels are zero
2025-02-15 05:33:43,612 (model:925) WARNING: All labels are zero
2025-02-15 05:33:51,429 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 47754,  validation: loss=0.08705, DER=0.2018, ACC=0.9609, MI=0.1083, FA=0.06328, CF=0.0303, over 0.00 frames. 
2025-02-15 05:33:51,430 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 05:34:13,025 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 47754,  validation: loss=0.08891, DER=0.2027, ACC=0.9598, MI=0.1094, FA=0.06191, CF=0.03141, over 0.00 frames. 
2025-02-15 05:34:13,026 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 05:39:35,168 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-48000.pt
2025-02-15 05:39:35,752 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-15 05:45:05,171 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 48254, num_updates: 47000, {'loss': 0.11028055101633072, 'DER': 0.2379438261791203, 'ACC': np.float64(0.9549776785714286), 'MI': 0.13354531001589826, 'FA': 0.07511923688394277, 'CF': 0.02927927927927928}, batch size: 64, grad_norm: 0.29694634675979614, grad_scale: , lr: 0.00e+00, 
2025-02-15 05:45:05,171 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 05:45:05,182 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 48254, num_updates: 47000, {'loss': 0.1059010922908783, 'DER': 0.2580078982009653, 'ACC': np.float64(0.95328125), 'MI': 0.14406903612695626, 'FA': 0.06581834137779728, 'CF': 0.04812052069621179}, batch size: 64, grad_norm: 0.29694634675979614, grad_scale: , lr: 0.00e+00, 
2025-02-15 05:45:05,182 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 05:45:37,829 (model:925) WARNING: All labels are zero
2025-02-15 05:45:44,490 (model:925) WARNING: All labels are zero
2025-02-15 05:45:44,995 (model:925) WARNING: All labels are zero
2025-02-15 05:46:37,517 (model:925) WARNING: All labels are zero
2025-02-15 05:46:45,371 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 48254,  validation: loss=0.08671, DER=0.2003, ACC=0.9612, MI=0.11, FA=0.06041, CF=0.02981, over 0.00 frames. 
2025-02-15 05:46:45,372 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 05:47:08,798 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 48254,  validation: loss=0.08864, DER=0.2011, ACC=0.96, MI=0.1111, FA=0.05921, CF=0.0308, over 0.00 frames. 
2025-02-15 05:47:08,799 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 05:58:26,103 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 48754, num_updates: 47500, {'loss': 0.08168666064739227, 'DER': 0.1813580767608604, 'ACC': np.float64(0.9685714285714286), 'MI': 0.11753128075354984, 'FA': 0.04723745255166596, 'CF': 0.016589343455644594}, batch size: 64, grad_norm: 0.21377761662006378, grad_scale: , lr: 0.00e+00, 
2025-02-15 05:58:26,104 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 05:58:26,707 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 48754, num_updates: 47500, {'loss': 0.10849503427743912, 'DER': 0.2437919725128846, 'ACC': np.float64(0.9569419642857143), 'MI': 0.10698110260815243, 'FA': 0.07933781040137436, 'CF': 0.0574730595033578}, batch size: 64, grad_norm: 0.21377761662006378, grad_scale: , lr: 0.00e+00, 
2025-02-15 05:58:26,707 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 05:58:58,603 (model:925) WARNING: All labels are zero
2025-02-15 05:58:58,995 (model:925) WARNING: All labels are zero
2025-02-15 05:59:06,610 (model:925) WARNING: All labels are zero
2025-02-15 06:00:05,944 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 48754,  validation: loss=0.08875, DER=0.2016, ACC=0.9599, MI=0.1063, FA=0.06395, CF=0.03137, over 0.00 frames. 
2025-02-15 06:00:05,945 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 06:00:19,562 (model:925) WARNING: All labels are zero
2025-02-15 06:00:29,357 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 48754,  validation: loss=0.08678, DER=0.2005, ACC=0.9611, MI=0.1054, FA=0.06484, CF=0.03034, over 0.00 frames. 
2025-02-15 06:00:29,358 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 06:11:23,386 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 49254, num_updates: 48000, {'loss': 0.0939333364367485, 'DER': 0.2073053066850448, 'ACC': np.float64(0.9596205357142857), 'MI': 0.11909028256374914, 'FA': 0.0461750516884907, 'CF': 0.04203997243280496}, batch size: 64, grad_norm: 0.22100724279880524, grad_scale: , lr: 0.00e+00, 
2025-02-15 06:11:23,387 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 06:11:23,388 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 49254, num_updates: 48000, {'loss': 0.12469835579395294, 'DER': 0.2826086956521739, 'ACC': np.float64(0.9475892857142857), 'MI': 0.15574942791762014, 'FA': 0.07365560640732266, 'CF': 0.05320366132723112}, batch size: 64, grad_norm: 0.22100724279880524, grad_scale: , lr: 0.00e+00, 
2025-02-15 06:11:23,388 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 06:11:55,574 (model:925) WARNING: All labels are zero
2025-02-15 06:12:02,544 (model:925) WARNING: All labels are zero
2025-02-15 06:12:03,060 (model:925) WARNING: All labels are zero
2025-02-15 06:12:57,874 (model:925) WARNING: All labels are zero
2025-02-15 06:13:05,748 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 49254,  validation: loss=0.08648, DER=0.1998, ACC=0.9613, MI=0.1076, FA=0.06229, CF=0.02993, over 0.00 frames. 
2025-02-15 06:13:05,748 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 06:13:35,334 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 49254,  validation: loss=0.0885, DER=0.2008, ACC=0.9601, MI=0.1085, FA=0.06094, CF=0.03136, over 0.00 frames. 
2025-02-15 06:13:35,334 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 06:16:38,831 (train_accelerate_ddp:713) INFO: end of epoch 12, batch_idx: 4113 batch_idx_train: 49367, {'loss': 0.10462705790996552, 'DER': 0.24529677701618785, 'ACC': np.float64(0.9574107142857143), 'MI': 0.1372320256672014, 'FA': 0.07510573136940353, 'CF': 0.03295901997958291}, batch size: 64, grad_norm: 0.3022007346153259, grad_scale: , lr: 0.00e+00, 
2025-02-15 06:16:38,842 (train_accelerate_ddp:713) INFO: end of epoch 12, batch_idx: 4113 batch_idx_train: 49367, {'loss': 0.12612071633338928, 'DER': 0.2818978102189781, 'ACC': np.float64(0.9491964285714286), 'MI': 0.17430656934306568, 'FA': 0.057226277372262775, 'CF': 0.050364963503649635}, batch size: 64, grad_norm: 0.3022007346153259, grad_scale: , lr: 0.00e+00, 
2025-02-15 06:16:38,845 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-12.pt
2025-02-15 06:16:39,386 (train_accelerate_ddp:561) INFO:  end of epoch 12, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-12.pt 
2025-02-15 06:16:41,942 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 49368, num_updates: 48000, {'loss': 0.08706924319267273, 'DER': 0.21008893424697478, 'ACC': np.float64(0.9620089285714286), 'MI': 0.11634349030470914, 'FA': 0.055693249744860764, 'CF': 0.03805219419740487}, batch size: 64, grad_norm: 0.2060667872428894, grad_scale: , lr: 0.00e+00, 
2025-02-15 06:16:41,948 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 49368, num_updates: 48000, {'loss': 0.10614246875047684, 'DER': 0.27008643899674084, 'ACC': np.float64(0.9492857142857143), 'MI': 0.1526144253932266, 'FA': 0.06560861555901941, 'CF': 0.05186339804449483}, batch size: 64, grad_norm: 0.2060667872428894, grad_scale: , lr: 0.00e+00, 
2025-02-15 06:19:55,284 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-49500.pt
2025-02-15 06:19:55,874 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-15 06:19:55,876 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-15 06:28:13,470 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 49868, num_updates: 48500, {'loss': 0.11224398761987686, 'DER': 0.26742160278745647, 'ACC': np.float64(0.9520089285714286), 'MI': 0.13850174216027875, 'FA': 0.08420441347270616, 'CF': 0.044715447154471545}, batch size: 64, grad_norm: 0.2109166532754898, grad_scale: , lr: 0.00e+00, 
2025-02-15 06:28:13,471 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 06:28:13,471 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 49868, num_updates: 48500, {'loss': 0.09077192097902298, 'DER': 0.2539634606673713, 'ACC': np.float64(0.9565848214285714), 'MI': 0.12924656500075493, 'FA': 0.08500679450400121, 'CF': 0.03971010116261513}, batch size: 64, grad_norm: 0.2109166532754898, grad_scale: , lr: 0.00e+00, 
2025-02-15 06:28:13,472 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 06:28:46,226 (model:925) WARNING: All labels are zero
2025-02-15 06:28:46,639 (model:925) WARNING: All labels are zero
2025-02-15 06:28:52,854 (model:925) WARNING: All labels are zero
2025-02-15 06:29:55,016 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 49868,  validation: loss=0.08911, DER=0.2017, ACC=0.9599, MI=0.1067, FA=0.06341, CF=0.03159, over 0.00 frames. 
2025-02-15 06:29:55,017 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 06:30:05,998 (model:925) WARNING: All labels are zero
2025-02-15 06:30:15,471 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 49868,  validation: loss=0.08702, DER=0.2004, ACC=0.9611, MI=0.1054, FA=0.06439, CF=0.03061, over 0.00 frames. 
2025-02-15 06:30:15,472 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 06:41:37,314 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 50368, num_updates: 49000, {'loss': 0.12204454839229584, 'DER': 0.2859293731179852, 'ACC': np.float64(0.9432366071428571), 'MI': 0.17807281686285245, 'FA': 0.04571584998631262, 'CF': 0.06214070626882015}, batch size: 64, grad_norm: 0.27349838614463806, grad_scale: , lr: 0.00e+00, 
2025-02-15 06:41:37,314 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 06:41:37,324 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 50368, num_updates: 49000, {'loss': 0.10212790966033936, 'DER': 0.23625053018521136, 'ACC': np.float64(0.9543080357142857), 'MI': 0.10900607945709034, 'FA': 0.07408454686837268, 'CF': 0.053159903859748336}, batch size: 64, grad_norm: 0.27349838614463806, grad_scale: , lr: 0.00e+00, 
2025-02-15 06:41:37,325 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 06:42:09,587 (model:925) WARNING: All labels are zero
2025-02-15 06:42:09,984 (model:925) WARNING: All labels are zero
2025-02-15 06:42:23,303 (model:925) WARNING: All labels are zero
2025-02-15 06:43:18,110 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 50368,  validation: loss=0.0886, DER=0.2014, ACC=0.9599, MI=0.107, FA=0.06267, CF=0.03175, over 0.00 frames. 
2025-02-15 06:43:18,111 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 06:43:36,933 (model:925) WARNING: All labels are zero
2025-02-15 06:43:46,136 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 50368,  validation: loss=0.08659, DER=0.2005, ACC=0.9611, MI=0.1063, FA=0.06369, CF=0.03053, over 0.00 frames. 
2025-02-15 06:43:46,136 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 06:54:37,782 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 50868, num_updates: 49500, {'loss': 0.08307613432407379, 'DER': 0.18218562874251498, 'ACC': np.float64(0.9674330357142857), 'MI': 0.08682634730538923, 'FA': 0.05913173652694611, 'CF': 0.03622754491017964}, batch size: 64, grad_norm: 0.2059045433998108, grad_scale: , lr: 0.00e+00, 
2025-02-15 06:54:37,782 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 06:54:37,783 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 50868, num_updates: 49500, {'loss': 0.09583587199449539, 'DER': 0.23116883116883116, 'ACC': np.float64(0.9579910714285714), 'MI': 0.11601731601731602, 'FA': 0.07474747474747474, 'CF': 0.04040404040404041}, batch size: 64, grad_norm: 0.2059045433998108, grad_scale: , lr: 0.00e+00, 
2025-02-15 06:54:37,783 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 06:55:10,283 (model:925) WARNING: All labels are zero
2025-02-15 06:55:10,685 (model:925) WARNING: All labels are zero
2025-02-15 06:55:17,179 (model:925) WARNING: All labels are zero
2025-02-15 06:56:19,570 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 50868,  validation: loss=0.08869, DER=0.2017, ACC=0.9599, MI=0.109, FA=0.06136, CF=0.03137, over 0.00 frames. 
2025-02-15 06:56:19,570 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 06:56:29,427 (model:925) WARNING: All labels are zero
2025-02-15 06:56:38,914 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 50868,  validation: loss=0.08674, DER=0.2, ACC=0.9612, MI=0.1075, FA=0.0622, CF=0.03029, over 0.00 frames. 
2025-02-15 06:56:38,914 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 06:59:29,804 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-51000.pt
2025-02-15 06:59:30,275 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-15 07:07:54,973 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 51368, num_updates: 50000, {'loss': 0.1264803409576416, 'DER': 0.30230920867361305, 'ACC': np.float64(0.9434821428571429), 'MI': 0.15460433680653338, 'FA': 0.09349479019994368, 'CF': 0.05421008166713602}, batch size: 64, grad_norm: 0.24990056455135345, grad_scale: , lr: 0.00e+00, 
2025-02-15 07:07:54,974 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 07:07:54,974 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 51368, num_updates: 50000, {'loss': 0.09821449965238571, 'DER': 0.24918276374442794, 'ACC': np.float64(0.9547098214285714), 'MI': 0.14368499257057948, 'FA': 0.053194650817236254, 'CF': 0.052303120356612186}, batch size: 64, grad_norm: 0.24990056455135345, grad_scale: , lr: 0.00e+00, 
2025-02-15 07:07:54,974 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 07:08:27,348 (model:925) WARNING: All labels are zero
2025-02-15 07:08:27,743 (model:925) WARNING: All labels are zero
2025-02-15 07:08:34,501 (model:925) WARNING: All labels are zero
2025-02-15 07:09:35,993 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 51368,  validation: loss=0.08854, DER=0.2013, ACC=0.96, MI=0.1097, FA=0.06059, CF=0.031, over 0.00 frames. 
2025-02-15 07:09:35,993 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 07:09:46,982 (model:925) WARNING: All labels are zero
2025-02-15 07:09:56,454 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 51368,  validation: loss=0.08657, DER=0.2002, ACC=0.9611, MI=0.1083, FA=0.06176, CF=0.03016, over 0.00 frames. 
2025-02-15 07:09:56,455 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 07:21:13,938 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 51868, num_updates: 50500, {'loss': 0.09149745851755142, 'DER': 0.2257603884049693, 'ACC': np.float64(0.9583705357142857), 'MI': 0.11209481650721119, 'FA': 0.07311152363272883, 'CF': 0.04055404826502927}, batch size: 64, grad_norm: 0.2564425766468048, grad_scale: , lr: 0.00e+00, 
2025-02-15 07:21:13,938 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 51868, num_updates: 50500, {'loss': 0.11342062056064606, 'DER': 0.24582306217474664, 'ACC': np.float64(0.9512276785714286), 'MI': 0.13667488359353602, 'FA': 0.055738153930430016, 'CF': 0.05341002465078061}, batch size: 64, grad_norm: 0.2564425766468048, grad_scale: , lr: 0.00e+00, 
2025-02-15 07:21:13,938 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 07:21:13,938 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 07:21:46,359 (model:925) WARNING: All labels are zero
2025-02-15 07:21:46,751 (model:925) WARNING: All labels are zero
2025-02-15 07:21:46,775 (model:925) WARNING: All labels are zero
2025-02-15 07:22:47,341 (model:925) WARNING: All labels are zero
2025-02-15 07:22:55,188 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 51868,  validation: loss=0.08916, DER=0.2021, ACC=0.9598, MI=0.1079, FA=0.0625, CF=0.03169, over 0.00 frames. 
2025-02-15 07:22:55,189 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 07:22:55,215 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 51868,  validation: loss=0.08719, DER=0.2008, ACC=0.961, MI=0.1065, FA=0.06366, CF=0.0306, over 0.00 frames. 
2025-02-15 07:22:55,216 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 07:32:59,193 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 52368, num_updates: 51000, {'loss': 0.11179212480783463, 'DER': 0.258362676056338, 'ACC': np.float64(0.9556919642857143), 'MI': 0.12588028169014084, 'FA': 0.09961854460093897, 'CF': 0.03286384976525822}, batch size: 64, grad_norm: 0.2597280740737915, grad_scale: , lr: 0.00e+00, 
2025-02-15 07:32:59,193 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 07:32:59,193 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 52368, num_updates: 51000, {'loss': 0.1260056048631668, 'DER': 0.2798348428343101, 'ACC': np.float64(0.9441071428571429), 'MI': 0.148907831646244, 'FA': 0.07725093233883858, 'CF': 0.05367607884922749}, batch size: 64, grad_norm: 0.2597280740737915, grad_scale: , lr: 0.00e+00, 
2025-02-15 07:32:59,193 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 07:33:30,961 (model:925) WARNING: All labels are zero
2025-02-15 07:33:31,092 (model:925) WARNING: All labels are zero
2025-02-15 07:33:31,484 (model:925) WARNING: All labels are zero
2025-02-15 07:34:29,667 (model:925) WARNING: All labels are zero
2025-02-15 07:34:37,267 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 52368,  validation: loss=0.08711, DER=0.2007, ACC=0.961, MI=0.1073, FA=0.0629, CF=0.03051, over 0.00 frames. 
2025-02-15 07:34:37,268 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 07:34:38,541 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 52368,  validation: loss=0.08909, DER=0.2017, ACC=0.9599, MI=0.1084, FA=0.0617, CF=0.03158, over 0.00 frames. 
2025-02-15 07:34:38,542 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 07:37:09,939 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-52500.pt
2025-02-15 07:37:10,389 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-15 07:45:29,094 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 52868, num_updates: 51500, {'loss': 0.0794278159737587, 'DER': 0.1828642512828487, 'ACC': np.float64(0.9679017857142856), 'MI': 0.09236510651531643, 'FA': 0.04975897994091121, 'CF': 0.04074016482662105}, batch size: 64, grad_norm: 0.22007744014263153, grad_scale: , lr: 0.00e+00, 
2025-02-15 07:45:29,094 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 07:45:29,095 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 52868, num_updates: 51500, {'loss': 0.09221877157688141, 'DER': 0.2106075487582433, 'ACC': np.float64(0.960625), 'MI': 0.10719797951452224, 'FA': 0.06650764697628736, 'CF': 0.036901922267433704}, batch size: 64, grad_norm: 0.22007744014263153, grad_scale: , lr: 0.00e+00, 
2025-02-15 07:45:29,095 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 07:46:01,410 (model:925) WARNING: All labels are zero
2025-02-15 07:46:01,800 (model:925) WARNING: All labels are zero
2025-02-15 07:46:08,435 (model:925) WARNING: All labels are zero
2025-02-15 07:47:09,054 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 52868,  validation: loss=0.08939, DER=0.2029, ACC=0.9597, MI=0.106, FA=0.06537, CF=0.03155, over 0.00 frames. 
2025-02-15 07:47:09,055 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 07:47:20,459 (model:925) WARNING: All labels are zero
2025-02-15 07:47:30,699 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 52868,  validation: loss=0.08728, DER=0.2011, ACC=0.961, MI=0.1047, FA=0.06618, CF=0.03026, over 0.00 frames. 
2025-02-15 07:47:30,700 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 07:58:26,263 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 53368, num_updates: 52000, {'loss': 0.09946295619010925, 'DER': 0.24216917345108321, 'ACC': np.float64(0.955111607142857), 'MI': 0.16144611563405548, 'FA': 0.045398095763764315, 'CF': 0.035324962053263416}, batch size: 64, grad_norm: 0.21732239425182343, grad_scale: , lr: 0.00e+00, 
2025-02-15 07:58:26,264 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 07:58:26,265 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 53368, num_updates: 52000, {'loss': 0.1209835633635521, 'DER': 0.2999586833769453, 'ACC': np.float64(0.9450669642857144), 'MI': 0.1772483129045586, 'FA': 0.08373502272414268, 'CF': 0.038975347748244044}, batch size: 64, grad_norm: 0.21732239425182343, grad_scale: , lr: 0.00e+00, 
2025-02-15 07:58:26,265 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 07:58:58,045 (model:925) WARNING: All labels are zero
2025-02-15 07:58:58,438 (model:925) WARNING: All labels are zero
2025-02-15 07:59:05,897 (model:925) WARNING: All labels are zero
2025-02-15 08:00:05,339 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 53368,  validation: loss=0.08897, DER=0.2016, ACC=0.9599, MI=0.1065, FA=0.06362, CF=0.03153, over 0.00 frames. 
2025-02-15 08:00:05,339 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 08:00:18,620 (model:925) WARNING: All labels are zero
2025-02-15 08:00:28,070 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 53368,  validation: loss=0.08694, DER=0.1998, ACC=0.9612, MI=0.1049, FA=0.06461, CF=0.0303, over 0.00 frames. 
2025-02-15 08:00:28,070 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 08:02:55,689 (train_accelerate_ddp:713) INFO: end of epoch 13, batch_idx: 4113 batch_idx_train: 53481, {'loss': 0.1283031702041626, 'DER': 0.26246648793565686, 'ACC': np.float64(0.9488169642857143), 'MI': 0.16742627345844505, 'FA': 0.05013404825737265, 'CF': 0.044906166219839144}, batch size: 64, grad_norm: 0.30656683444976807, grad_scale: , lr: 0.00e+00, 
2025-02-15 08:02:55,690 (train_accelerate_ddp:713) INFO: end of epoch 13, batch_idx: 4113 batch_idx_train: 53481, {'loss': 0.11840064078569412, 'DER': 0.27903202006787664, 'ACC': np.float64(0.9514732142857143), 'MI': 0.14475431606905712, 'FA': 0.09251881363435148, 'CF': 0.04175889036446805}, batch size: 64, grad_norm: 0.30656683444976807, grad_scale: , lr: 0.00e+00, 
2025-02-15 08:02:55,692 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-13.pt
2025-02-15 08:02:56,219 (train_accelerate_ddp:561) INFO:  end of epoch 13, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-13.pt 
2025-02-15 08:02:58,438 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 53482, num_updates: 52000, {'loss': 0.10977955162525177, 'DER': 0.2964031218187988, 'ACC': np.float64(0.9531473214285714), 'MI': 0.12555140821174077, 'FA': 0.11112996267390567, 'CF': 0.05972175093315236}, batch size: 64, grad_norm: 0.3349894881248474, grad_scale: , lr: 0.00e+00, 
2025-02-15 08:02:58,449 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 53482, num_updates: 52000, {'loss': 0.09760217368602753, 'DER': 0.249442213297635, 'ACC': np.float64(0.955), 'MI': 0.12211810203778076, 'FA': 0.07690019336605682, 'CF': 0.05042391789379741}, batch size: 64, grad_norm: 0.3349894881248474, grad_scale: , lr: 0.00e+00, 
2025-02-15 08:14:24,706 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 53982, num_updates: 52500, {'loss': 0.11814139038324356, 'DER': 0.2817073170731707, 'ACC': np.float64(0.9463392857142857), 'MI': 0.18495934959349594, 'FA': 0.052710027100271, 'CF': 0.04403794037940379}, batch size: 64, grad_norm: 0.3235103487968445, grad_scale: , lr: 0.00e+00, 
2025-02-15 08:14:24,707 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 08:14:24,708 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 53982, num_updates: 52500, {'loss': 0.11198965460062027, 'DER': 0.24466921815199563, 'ACC': np.float64(0.9531696428571429), 'MI': 0.14748496446145434, 'FA': 0.05508474576271186, 'CF': 0.04209950792782941}, batch size: 64, grad_norm: 0.3235103487968445, grad_scale: , lr: 0.00e+00, 
2025-02-15 08:14:24,708 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 08:14:57,663 (model:925) WARNING: All labels are zero
2025-02-15 08:15:04,800 (model:925) WARNING: All labels are zero
2025-02-15 08:15:05,309 (model:925) WARNING: All labels are zero
2025-02-15 08:15:58,565 (model:925) WARNING: All labels are zero
2025-02-15 08:16:06,486 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 53982,  validation: loss=0.08682, DER=0.2003, ACC=0.961, MI=0.1055, FA=0.06426, CF=0.03054, over 0.00 frames. 
2025-02-15 08:16:06,486 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 08:16:27,643 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 53982,  validation: loss=0.0887, DER=0.2016, ACC=0.9599, MI=0.1067, FA=0.06339, CF=0.03148, over 0.00 frames. 
2025-02-15 08:16:27,644 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 08:16:56,592 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-54000.pt
2025-02-15 08:16:57,072 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-15 08:16:57,074 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-15 08:27:36,425 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 54482, num_updates: 53000, {'loss': 0.09605583548545837, 'DER': 0.22642955695232256, 'ACC': np.float64(0.9600892857142856), 'MI': 0.09366855741223364, 'FA': 0.08508355051356738, 'CF': 0.04767744902652154}, batch size: 64, grad_norm: 0.20716586709022522, grad_scale: , lr: 0.00e+00, 
2025-02-15 08:27:36,425 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 54482, num_updates: 53000, {'loss': 0.09284251183271408, 'DER': 0.22616984402079723, 'ACC': np.float64(0.96171875), 'MI': 0.13807047949162335, 'FA': 0.06658001155401502, 'CF': 0.02151935297515887}, batch size: 64, grad_norm: 0.20716586709022522, grad_scale: , lr: 0.00e+00, 
2025-02-15 08:27:36,426 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 08:27:36,426 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 08:28:11,074 (model:925) WARNING: All labels are zero
2025-02-15 08:28:11,506 (model:925) WARNING: All labels are zero
2025-02-15 08:28:11,527 (model:925) WARNING: All labels are zero
2025-02-15 08:29:15,529 (model:925) WARNING: All labels are zero
2025-02-15 08:29:23,831 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 54482,  validation: loss=0.0874, DER=0.202, ACC=0.9609, MI=0.1052, FA=0.06643, CF=0.0303, over 0.00 frames. 
2025-02-15 08:29:23,832 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 08:29:23,896 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 54482,  validation: loss=0.08941, DER=0.203, ACC=0.9597, MI=0.1062, FA=0.06523, CF=0.03158, over 0.00 frames. 
2025-02-15 08:29:23,896 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 08:39:57,398 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 54982, num_updates: 53500, {'loss': 0.08608317375183105, 'DER': 0.19650844034049922, 'ACC': np.float64(0.9658035714285714), 'MI': 0.12494589525321022, 'FA': 0.04703505987591978, 'CF': 0.024527485211369212}, batch size: 64, grad_norm: 0.2523503303527832, grad_scale: , lr: 0.00e+00, 
2025-02-15 08:39:57,398 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 08:39:57,408 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 54982, num_updates: 53500, {'loss': 0.1350879818201065, 'DER': 0.3117860128169406, 'ACC': np.float64(0.9345089285714286), 'MI': 0.1447478406241293, 'FA': 0.0700752298690443, 'CF': 0.09696294232376707}, batch size: 64, grad_norm: 0.2523503303527832, grad_scale: , lr: 0.00e+00, 
2025-02-15 08:39:57,408 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 08:40:30,446 (model:925) WARNING: All labels are zero
2025-02-15 08:40:36,300 (model:925) WARNING: All labels are zero
2025-02-15 08:40:36,766 (model:925) WARNING: All labels are zero
2025-02-15 08:41:30,808 (model:925) WARNING: All labels are zero
2025-02-15 08:41:38,696 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 54982,  validation: loss=0.08711, DER=0.201, ACC=0.961, MI=0.1083, FA=0.06239, CF=0.03028, over 0.00 frames. 
2025-02-15 08:41:38,696 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 08:41:58,495 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 54982,  validation: loss=0.08905, DER=0.2022, ACC=0.9599, MI=0.1097, FA=0.06141, CF=0.03112, over 0.00 frames. 
2025-02-15 08:41:58,496 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 08:52:44,385 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 55482, num_updates: 54000, {'loss': 0.11683045327663422, 'DER': 0.23264564681458413, 'ACC': np.float64(0.953950892857143), 'MI': 0.13247696898923056, 'FA': 0.0651355910211496, 'CF': 0.03503308680420397}, batch size: 64, grad_norm: 0.26966392993927, grad_scale: , lr: 0.00e+00, 
2025-02-15 08:52:44,386 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 08:52:44,386 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 55482, num_updates: 54000, {'loss': 0.13501481711864471, 'DER': 0.306606883819069, 'ACC': np.float64(0.9341071428571429), 'MI': 0.16325992351312146, 'FA': 0.060662007121192144, 'CF': 0.08268495318475537}, batch size: 64, grad_norm: 0.26966392993927, grad_scale: , lr: 0.00e+00, 
2025-02-15 08:52:44,387 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 08:53:16,686 (model:925) WARNING: All labels are zero
2025-02-15 08:53:30,347 (model:925) WARNING: All labels are zero
2025-02-15 08:53:30,979 (model:925) WARNING: All labels are zero
2025-02-15 08:54:15,454 (model:925) WARNING: All labels are zero
2025-02-15 08:54:23,133 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 55482,  validation: loss=0.08714, DER=0.2019, ACC=0.961, MI=0.1103, FA=0.0617, CF=0.02994, over 0.00 frames. 
2025-02-15 08:54:23,133 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 08:55:08,049 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 55482,  validation: loss=0.08908, DER=0.2027, ACC=0.9598, MI=0.1106, FA=0.06093, CF=0.0311, over 0.00 frames. 
2025-02-15 08:55:08,050 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 08:55:29,303 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-55500.pt
2025-02-15 08:55:29,749 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-15 09:05:57,126 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 55982, num_updates: 54500, {'loss': 0.10262264311313629, 'DER': 0.21650071123755335, 'ACC': np.float64(0.9591964285714286), 'MI': 0.11379800853485064, 'FA': 0.059174964438122334, 'CF': 0.04352773826458037}, batch size: 64, grad_norm: 0.2315673828125, grad_scale: , lr: 0.00e+00, 
2025-02-15 09:05:57,126 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 09:05:57,136 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 55982, num_updates: 54500, {'loss': 0.08062762767076492, 'DER': 0.22123062470643495, 'ACC': np.float64(0.9653125), 'MI': 0.10677939564740879, 'FA': 0.09237513699702521, 'CF': 0.02207609206200094}, batch size: 64, grad_norm: 0.2315673828125, grad_scale: , lr: 0.00e+00, 
2025-02-15 09:05:57,136 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 09:06:30,347 (model:925) WARNING: All labels are zero
2025-02-15 09:06:36,206 (model:925) WARNING: All labels are zero
2025-02-15 09:06:36,709 (model:925) WARNING: All labels are zero
2025-02-15 09:07:29,480 (model:925) WARNING: All labels are zero
2025-02-15 09:07:37,212 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 55982,  validation: loss=0.08673, DER=0.2002, ACC=0.9611, MI=0.1083, FA=0.06162, CF=0.03023, over 0.00 frames. 
2025-02-15 09:07:37,212 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 09:07:58,402 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 55982,  validation: loss=0.08872, DER=0.2018, ACC=0.9599, MI=0.1098, FA=0.06071, CF=0.0313, over 0.00 frames. 
2025-02-15 09:07:58,402 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 09:18:31,159 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 56482, num_updates: 55000, {'loss': 0.09826144576072693, 'DER': 0.21463480857996198, 'ACC': np.float64(0.9582142857142857), 'MI': 0.13589465109964702, 'FA': 0.03923431984795004, 'CF': 0.03950583763236492}, batch size: 64, grad_norm: 0.21811525523662567, grad_scale: , lr: 0.00e+00, 
2025-02-15 09:18:31,159 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 56482, num_updates: 55000, {'loss': 0.09668956696987152, 'DER': 0.24996201185230207, 'ACC': np.float64(0.9571651785714286), 'MI': 0.12460112444917186, 'FA': 0.08372587752621183, 'CF': 0.0416350098769184}, batch size: 64, grad_norm: 0.21811525523662567, grad_scale: , lr: 0.00e+00, 
2025-02-15 09:18:31,159 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 09:18:31,159 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 09:19:03,648 (model:925) WARNING: All labels are zero
2025-02-15 09:19:03,930 (model:925) WARNING: All labels are zero
2025-02-15 09:19:04,049 (model:925) WARNING: All labels are zero
2025-02-15 09:20:03,707 (model:925) WARNING: All labels are zero
2025-02-15 09:20:11,542 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 56482,  validation: loss=0.087, DER=0.2014, ACC=0.961, MI=0.11, FA=0.06132, CF=0.03016, over 0.00 frames. 
2025-02-15 09:20:11,542 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 09:20:11,947 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 56482,  validation: loss=0.0889, DER=0.2023, ACC=0.9598, MI=0.1109, FA=0.06007, CF=0.03134, over 0.00 frames. 
2025-02-15 09:20:11,947 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 09:30:56,438 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 56982, num_updates: 55500, {'loss': 0.09155645966529846, 'DER': 0.22191380569758948, 'ACC': np.float64(0.9626339285714286), 'MI': 0.13528122717311908, 'FA': 0.06398831263696128, 'CF': 0.022644265887509132}, batch size: 64, grad_norm: 0.21909824013710022, grad_scale: , lr: 0.00e+00, 
2025-02-15 09:30:56,438 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 09:30:56,448 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 56982, num_updates: 55500, {'loss': 0.09148332476615906, 'DER': 0.22705454545454545, 'ACC': np.float64(0.95859375), 'MI': 0.08654545454545455, 'FA': 0.09774545454545455, 'CF': 0.042763636363636365}, batch size: 64, grad_norm: 0.21909824013710022, grad_scale: , lr: 0.00e+00, 
2025-02-15 09:30:56,449 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 09:31:29,131 (model:925) WARNING: All labels are zero
2025-02-15 09:31:29,531 (model:925) WARNING: All labels are zero
2025-02-15 09:31:35,603 (model:925) WARNING: All labels are zero
2025-02-15 09:32:37,498 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 56982,  validation: loss=0.08903, DER=0.202, ACC=0.9598, MI=0.1079, FA=0.06228, CF=0.03183, over 0.00 frames. 
2025-02-15 09:32:37,499 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 09:32:47,901 (model:925) WARNING: All labels are zero
2025-02-15 09:32:57,105 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 56982,  validation: loss=0.08699, DER=0.2006, ACC=0.9611, MI=0.1068, FA=0.06337, CF=0.0305, over 0.00 frames. 
2025-02-15 09:32:57,105 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 09:33:19,400 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-57000.pt
2025-02-15 09:33:20,142 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-15 09:43:58,611 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 57482, num_updates: 56000, {'loss': 0.10368511825799942, 'DER': 0.2532246108228317, 'ACC': np.float64(0.9569642857142857), 'MI': 0.15048183839881393, 'FA': 0.07012601927353596, 'CF': 0.03261675315048184}, batch size: 64, grad_norm: 0.2568587362766266, grad_scale: , lr: 0.00e+00, 
2025-02-15 09:43:58,611 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 09:43:58,612 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 57482, num_updates: 56000, {'loss': 0.10138340294361115, 'DER': 0.22504430005906675, 'ACC': np.float64(0.9578125), 'MI': 0.11857649143532191, 'FA': 0.05242173656231541, 'CF': 0.05404607206142942}, batch size: 64, grad_norm: 0.2568587362766266, grad_scale: , lr: 0.00e+00, 
2025-02-15 09:43:58,612 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 09:44:31,082 (model:925) WARNING: All labels are zero
2025-02-15 09:44:31,482 (model:925) WARNING: All labels are zero
2025-02-15 09:44:38,247 (model:925) WARNING: All labels are zero
2025-02-15 09:45:42,638 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 57482,  validation: loss=0.08883, DER=0.2018, ACC=0.9599, MI=0.1092, FA=0.0612, CF=0.03138, over 0.00 frames. 
2025-02-15 09:45:42,638 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 09:45:53,543 (model:925) WARNING: All labels are zero
2025-02-15 09:46:02,991 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 57482,  validation: loss=0.08687, DER=0.2008, ACC=0.9611, MI=0.1078, FA=0.06246, CF=0.03047, over 0.00 frames. 
2025-02-15 09:46:02,992 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 09:49:03,802 (train_accelerate_ddp:713) INFO: end of epoch 14, batch_idx: 4113 batch_idx_train: 57595, {'loss': 0.10463254898786545, 'DER': 0.2781870595771941, 'ACC': np.float64(0.9555580357142857), 'MI': 0.13869314541960281, 'FA': 0.09881486226777707, 'CF': 0.04067905188981422}, batch size: 64, grad_norm: 0.23843508958816528, grad_scale: , lr: 0.00e+00, 
2025-02-15 09:49:03,803 (train_accelerate_ddp:713) INFO: end of epoch 14, batch_idx: 4113 batch_idx_train: 57595, {'loss': 0.09797944873571396, 'DER': 0.24646606018194542, 'ACC': np.float64(0.9549330357142857), 'MI': 0.15913226032190342, 'FA': 0.05122463261021693, 'CF': 0.036109167249825054}, batch size: 64, grad_norm: 0.23843508958816528, grad_scale: , lr: 0.00e+00, 
2025-02-15 09:49:03,805 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-14.pt
2025-02-15 09:49:04,205 (train_accelerate_ddp:561) INFO:  end of epoch 14, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-14.pt 
2025-02-15 09:49:06,496 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 57596, num_updates: 56000, {'loss': 0.12269284576177597, 'DER': 0.28466416834822716, 'ACC': np.float64(0.9450669642857144), 'MI': 0.15451138656673394, 'FA': 0.060103776304410494, 'CF': 0.07004900547708273}, batch size: 64, grad_norm: 0.24788501858711243, grad_scale: , lr: 0.00e+00, 
2025-02-15 09:49:06,497 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 57596, num_updates: 56000, {'loss': 0.10207150876522064, 'DER': 0.2400388726919339, 'ACC': np.float64(0.9571428571428571), 'MI': 0.1453561016243232, 'FA': 0.06816604192697487, 'CF': 0.026516729140635846}, batch size: 64, grad_norm: 0.24788501858711243, grad_scale: , lr: 0.00e+00, 
2025-02-15 10:01:04,521 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 58096, num_updates: 56500, {'loss': 0.1331435739994049, 'DER': 0.32684824902723736, 'ACC': np.float64(0.9368973214285714), 'MI': 0.20207522697795072, 'FA': 0.08495460440985733, 'CF': 0.03981841763942931}, batch size: 64, grad_norm: 0.2543681263923645, grad_scale: , lr: 0.00e+00, 
2025-02-15 10:01:04,521 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 58096, num_updates: 56500, {'loss': 0.11204353719949722, 'DER': 0.2628718535469107, 'ACC': np.float64(0.9510044642857143), 'MI': 0.14673913043478262, 'FA': 0.06507437070938216, 'CF': 0.051058352402746}, batch size: 64, grad_norm: 0.2543681263923645, grad_scale: , lr: 0.00e+00, 
2025-02-15 10:01:04,521 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 10:01:04,521 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 10:01:37,372 (model:925) WARNING: All labels are zero
2025-02-15 10:01:37,798 (model:925) WARNING: All labels are zero
2025-02-15 10:01:44,089 (model:925) WARNING: All labels are zero
2025-02-15 10:02:46,688 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 58096,  validation: loss=0.08913, DER=0.2029, ACC=0.9598, MI=0.1061, FA=0.06534, CF=0.03151, over 0.00 frames. 
2025-02-15 10:02:46,689 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 10:02:57,071 (model:925) WARNING: All labels are zero
2025-02-15 10:03:06,716 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 58096,  validation: loss=0.08717, DER=0.2012, ACC=0.961, MI=0.1048, FA=0.06595, CF=0.03052, over 0.00 frames. 
2025-02-15 10:03:06,717 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 10:11:56,063 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-58500.pt
2025-02-15 10:11:56,630 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-15 10:11:56,632 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-15 10:14:06,142 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 58596, num_updates: 57000, {'loss': 0.1096227690577507, 'DER': 0.26294025381434477, 'ACC': np.float64(0.9517857142857143), 'MI': 0.13859974333380864, 'FA': 0.07928133466419507, 'CF': 0.04505917581634108}, batch size: 64, grad_norm: 0.21871694922447205, grad_scale: , lr: 0.00e+00, 
2025-02-15 10:14:06,142 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 58596, num_updates: 57000, {'loss': 0.0859101191163063, 'DER': 0.19803370786516855, 'ACC': np.float64(0.9656026785714286), 'MI': 0.10786516853932585, 'FA': 0.07176966292134832, 'CF': 0.01839887640449438}, batch size: 64, grad_norm: 0.21871694922447205, grad_scale: , lr: 0.00e+00, 
2025-02-15 10:14:06,142 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 10:14:06,142 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 10:14:38,449 (model:925) WARNING: All labels are zero
2025-02-15 10:14:38,844 (model:925) WARNING: All labels are zero
2025-02-15 10:14:44,514 (model:925) WARNING: All labels are zero
2025-02-15 10:15:46,990 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 58596,  validation: loss=0.08888, DER=0.2019, ACC=0.9599, MI=0.1058, FA=0.06437, CF=0.03167, over 0.00 frames. 
2025-02-15 10:15:46,991 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 10:15:57,124 (model:925) WARNING: All labels are zero
2025-02-15 10:16:05,828 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 58596,  validation: loss=0.08683, DER=0.2006, ACC=0.9611, MI=0.1047, FA=0.06523, CF=0.03075, over 0.00 frames. 
2025-02-15 10:16:05,828 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 10:27:21,477 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 59096, num_updates: 57500, {'loss': 0.10791609436273575, 'DER': 0.26372688477951634, 'ACC': np.float64(0.950044642857143), 'MI': 0.12460881934566145, 'FA': 0.0844950213371266, 'CF': 0.05462304409672831}, batch size: 64, grad_norm: 0.28463098406791687, grad_scale: , lr: 0.00e+00, 
2025-02-15 10:27:21,478 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 10:27:21,478 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 59096, num_updates: 57500, {'loss': 0.14084716141223907, 'DER': 0.30636352089419533, 'ACC': np.float64(0.9387053571428571), 'MI': 0.2104661501333672, 'FA': 0.05347389813285914, 'CF': 0.04242347262796901}, batch size: 64, grad_norm: 0.28463098406791687, grad_scale: , lr: 0.00e+00, 
2025-02-15 10:27:21,479 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 10:27:54,076 (model:925) WARNING: All labels are zero
2025-02-15 10:28:00,496 (model:925) WARNING: All labels are zero
2025-02-15 10:28:00,976 (model:925) WARNING: All labels are zero
2025-02-15 10:28:54,233 (model:925) WARNING: All labels are zero
2025-02-15 10:29:02,166 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 59096,  validation: loss=0.08695, DER=0.2009, ACC=0.961, MI=0.1072, FA=0.06346, CF=0.03031, over 0.00 frames. 
2025-02-15 10:29:02,166 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 10:29:22,328 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 59096,  validation: loss=0.08897, DER=0.202, ACC=0.9599, MI=0.108, FA=0.06267, CF=0.03136, over 0.00 frames. 
2025-02-15 10:29:22,329 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 10:40:00,407 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 59596, num_updates: 58000, {'loss': 0.1053253561258316, 'DER': 0.24613240418118468, 'ACC': np.float64(0.9534375), 'MI': 0.13714285714285715, 'FA': 0.06439024390243903, 'CF': 0.0445993031358885}, batch size: 64, grad_norm: 0.1768428236246109, grad_scale: , lr: 0.00e+00, 
2025-02-15 10:40:00,407 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 10:40:00,407 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 59596, num_updates: 58000, {'loss': 0.08777054399251938, 'DER': 0.18577479187965532, 'ACC': np.float64(0.96453125), 'MI': 0.0842704834233971, 'FA': 0.05520665985102965, 'CF': 0.046297648605228565}, batch size: 64, grad_norm: 0.1768428236246109, grad_scale: , lr: 0.00e+00, 
2025-02-15 10:40:00,407 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 10:40:35,331 (model:925) WARNING: All labels are zero
2025-02-15 10:40:41,538 (model:925) WARNING: All labels are zero
2025-02-15 10:40:42,044 (model:925) WARNING: All labels are zero
2025-02-15 10:41:39,501 (model:925) WARNING: All labels are zero
2025-02-15 10:41:48,895 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 59596,  validation: loss=0.08709, DER=0.2014, ACC=0.9609, MI=0.1082, FA=0.06308, CF=0.03015, over 0.00 frames. 
2025-02-15 10:41:48,896 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 10:41:56,628 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 59596,  validation: loss=0.08904, DER=0.2023, ACC=0.9598, MI=0.1086, FA=0.06211, CF=0.03155, over 0.00 frames. 
2025-02-15 10:41:56,628 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 10:51:46,671 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-60000.pt
2025-02-15 10:51:47,133 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-15 10:53:58,678 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 60096, num_updates: 58500, {'loss': 0.09246032685041428, 'DER': 0.2128022759601707, 'ACC': np.float64(0.9611383928571429), 'MI': 0.11266002844950214, 'FA': 0.06529160739687055, 'CF': 0.03485064011379801}, batch size: 64, grad_norm: 0.2547111511230469, grad_scale: , lr: 0.00e+00, 
2025-02-15 10:53:58,679 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 10:53:58,689 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 60096, num_updates: 58500, {'loss': 0.12701323628425598, 'DER': 0.30920950458145674, 'ACC': np.float64(0.9488216240366357), 'MI': 0.12734896723093647, 'FA': 0.13526945177822644, 'CF': 0.046591085572293835}, batch size: 64, grad_norm: 0.2547111511230469, grad_scale: , lr: 0.00e+00, 
2025-02-15 10:53:58,689 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 10:54:31,481 (model:925) WARNING: All labels are zero
2025-02-15 10:54:37,764 (model:925) WARNING: All labels are zero
2025-02-15 10:54:38,277 (model:925) WARNING: All labels are zero
2025-02-15 10:55:31,806 (model:925) WARNING: All labels are zero
2025-02-15 10:55:39,664 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 60096,  validation: loss=0.08687, DER=0.2014, ACC=0.9609, MI=0.1077, FA=0.06328, CF=0.03042, over 0.00 frames. 
2025-02-15 10:55:39,664 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 10:56:01,217 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 60096,  validation: loss=0.08885, DER=0.2025, ACC=0.9598, MI=0.1085, FA=0.06222, CF=0.03178, over 0.00 frames. 
2025-02-15 10:56:01,217 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 11:06:33,761 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 60596, num_updates: 59000, {'loss': 0.12519969046115875, 'DER': 0.3070791677924885, 'ACC': np.float64(0.9388169642857143), 'MI': 0.19832477708727372, 'FA': 0.04552823561199676, 'CF': 0.06322615509321805}, batch size: 64, grad_norm: 0.29570719599723816, grad_scale: , lr: 0.00e+00, 
2025-02-15 11:06:33,762 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 11:06:33,772 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 60596, num_updates: 59000, {'loss': 0.11754299700260162, 'DER': 0.30368794326241133, 'ACC': np.float64(0.93921875), 'MI': 0.13120567375886524, 'FA': 0.0899290780141844, 'CF': 0.0825531914893617}, batch size: 64, grad_norm: 0.29570719599723816, grad_scale: , lr: 0.00e+00, 
2025-02-15 11:06:33,772 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 11:07:05,945 (model:925) WARNING: All labels are zero
2025-02-15 11:07:07,680 (model:925) WARNING: All labels are zero
2025-02-15 11:07:08,068 (model:925) WARNING: All labels are zero
2025-02-15 11:08:05,495 (model:925) WARNING: All labels are zero
2025-02-15 11:08:13,245 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 60596,  validation: loss=0.08665, DER=0.2002, ACC=0.9612, MI=0.1068, FA=0.06341, CF=0.03007, over 0.00 frames. 
2025-02-15 11:08:13,246 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 11:08:14,503 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 60596,  validation: loss=0.08858, DER=0.2016, ACC=0.96, MI=0.1081, FA=0.06223, CF=0.03127, over 0.00 frames. 
2025-02-15 11:08:14,503 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 11:18:00,973 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 61096, num_updates: 59500, {'loss': 0.10567329078912735, 'DER': 0.24579630895420368, 'ACC': np.float64(0.95234375), 'MI': 0.13875598086124402, 'FA': 0.06097060833902939, 'CF': 0.04606971975393028}, batch size: 64, grad_norm: 0.25613903999328613, grad_scale: , lr: 0.00e+00, 
2025-02-15 11:18:00,973 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 11:18:00,977 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 61096, num_updates: 59500, {'loss': 0.09743291884660721, 'DER': 0.2477733975762885, 'ACC': np.float64(0.95609375), 'MI': 0.1311140312454373, 'FA': 0.07723755292743466, 'CF': 0.03942181340341656}, batch size: 64, grad_norm: 0.25613903999328613, grad_scale: , lr: 0.00e+00, 
2025-02-15 11:18:00,978 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 11:18:38,054 (model:925) WARNING: All labels are zero
2025-02-15 11:18:51,145 (model:925) WARNING: All labels are zero
2025-02-15 11:18:51,769 (model:925) WARNING: All labels are zero
2025-02-15 11:19:40,390 (model:925) WARNING: All labels are zero
2025-02-15 11:19:48,148 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 61096,  validation: loss=0.08644, DER=0.1999, ACC=0.9613, MI=0.1088, FA=0.06114, CF=0.02995, over 0.00 frames. 
2025-02-15 11:19:48,148 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 11:20:33,467 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 61096,  validation: loss=0.08837, DER=0.2014, ACC=0.96, MI=0.1103, FA=0.06014, CF=0.03097, over 0.00 frames. 
2025-02-15 11:20:33,468 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 11:29:01,042 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-61500.pt
2025-02-15 11:29:01,480 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-15 11:30:59,534 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 61596, num_updates: 60000, {'loss': 0.10286643356084824, 'DER': 0.2302050591228858, 'ACC': np.float64(0.9584907347385833), 'MI': 0.1037269869779973, 'FA': 0.0787307289327945, 'CF': 0.047747343212094}, batch size: 64, grad_norm: 0.24072915315628052, grad_scale: , lr: 0.00e+00, 
2025-02-15 11:30:59,534 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 11:30:59,534 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 61596, num_updates: 60000, {'loss': 0.09271440654993057, 'DER': 0.22669882252801815, 'ACC': np.float64(0.9608258928571429), 'MI': 0.1349127535820684, 'FA': 0.06951340615690169, 'CF': 0.022272662789048093}, batch size: 64, grad_norm: 0.24072915315628052, grad_scale: , lr: 0.00e+00, 
2025-02-15 11:30:59,535 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 11:31:31,640 (model:925) WARNING: All labels are zero
2025-02-15 11:31:32,036 (model:925) WARNING: All labels are zero
2025-02-15 11:31:38,484 (model:925) WARNING: All labels are zero
2025-02-15 11:32:39,815 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 61596,  validation: loss=0.08913, DER=0.2023, ACC=0.9599, MI=0.1076, FA=0.0633, CF=0.03143, over 0.00 frames. 
2025-02-15 11:32:39,816 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 11:32:50,756 (model:925) WARNING: All labels are zero
2025-02-15 11:32:59,924 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 61596,  validation: loss=0.08709, DER=0.2006, ACC=0.9611, MI=0.1063, FA=0.06388, CF=0.03038, over 0.00 frames. 
2025-02-15 11:32:59,924 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 11:35:28,374 (train_accelerate_ddp:713) INFO: end of epoch 15, batch_idx: 4113 batch_idx_train: 61709, {'loss': 0.12407582253217697, 'DER': 0.2966173962478681, 'ACC': np.float64(0.941875), 'MI': 0.1530699260943718, 'FA': 0.07006822057987493, 'CF': 0.07347924957362137}, batch size: 64, grad_norm: 0.2837614417076111, grad_scale: , lr: 0.00e+00, 
2025-02-15 11:35:28,376 (train_accelerate_ddp:713) INFO: end of epoch 15, batch_idx: 4113 batch_idx_train: 61709, {'loss': 0.11255620419979095, 'DER': 0.22413298939524218, 'ACC': np.float64(0.9559821428571429), 'MI': 0.11321295500143308, 'FA': 0.052450558899398106, 'CF': 0.058469475494411005}, batch size: 64, grad_norm: 0.2837614417076111, grad_scale: , lr: 0.00e+00, 
2025-02-15 11:35:28,377 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-15.pt
2025-02-15 11:35:28,761 (train_accelerate_ddp:561) INFO:  end of epoch 15, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-15.pt 
2025-02-15 11:35:31,201 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 61710, num_updates: 60000, {'loss': 0.10848119109869003, 'DER': 0.27816508644729504, 'ACC': np.float64(0.9486607142857143), 'MI': 0.1689905186837702, 'FA': 0.06664807585052984, 'CF': 0.04252649191299498}, batch size: 64, grad_norm: 0.21972008049488068, grad_scale: , lr: 0.00e+00, 
2025-02-15 11:35:31,202 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 61710, num_updates: 60000, {'loss': 0.10132887959480286, 'DER': 0.2645692883895131, 'ACC': np.float64(0.9559151785714286), 'MI': 0.12599250936329587, 'FA': 0.10726591760299625, 'CF': 0.031310861423220974}, batch size: 64, grad_norm: 0.21972008049488068, grad_scale: , lr: 0.00e+00, 
2025-02-15 11:47:15,994 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 62210, num_updates: 60500, {'loss': 0.10821820050477982, 'DER': 0.25535025920510435, 'ACC': np.float64(0.9520758928571429), 'MI': 0.18436793832247775, 'FA': 0.04094111391732022, 'CF': 0.030041206965306395}, batch size: 64, grad_norm: 0.19514906406402588, grad_scale: , lr: 0.00e+00, 
2025-02-15 11:47:15,994 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 11:47:15,994 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 62210, num_updates: 60500, {'loss': 0.10720697790384293, 'DER': 0.25247995651583094, 'ACC': np.float64(0.9521205357142857), 'MI': 0.14118766136703356, 'FA': 0.07229243103682566, 'CF': 0.03899986411197173}, batch size: 64, grad_norm: 0.19514906406402588, grad_scale: , lr: 0.00e+00, 
2025-02-15 11:47:15,995 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 11:47:48,749 (model:925) WARNING: All labels are zero
2025-02-15 11:47:49,167 (model:925) WARNING: All labels are zero
2025-02-15 11:47:54,903 (model:925) WARNING: All labels are zero
2025-02-15 11:48:57,816 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 62210,  validation: loss=0.08894, DER=0.2015, ACC=0.96, MI=0.1101, FA=0.06049, CF=0.03093, over 0.00 frames. 
2025-02-15 11:48:57,817 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 11:49:07,657 (model:925) WARNING: All labels are zero
2025-02-15 11:49:17,204 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 62210,  validation: loss=0.08701, DER=0.2003, ACC=0.9611, MI=0.1085, FA=0.0614, CF=0.0304, over 0.00 frames. 
2025-02-15 11:49:17,204 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 12:00:13,188 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 62710, num_updates: 61000, {'loss': 0.11632265895605087, 'DER': 0.27489033630200715, 'ACC': np.float64(0.9467410714285713), 'MI': 0.15352917718995082, 'FA': 0.0790907882493686, 'CF': 0.042270370862687756}, batch size: 64, grad_norm: 0.24797482788562775, grad_scale: , lr: 0.00e+00, 
2025-02-15 12:00:13,188 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 12:00:13,188 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 62710, num_updates: 61000, {'loss': 0.115629181265831, 'DER': 0.28463024282560706, 'ACC': np.float64(0.9440625), 'MI': 0.14293598233995586, 'FA': 0.08057395143487858, 'CF': 0.06112030905077263}, batch size: 64, grad_norm: 0.24797482788562775, grad_scale: , lr: 0.00e+00, 
2025-02-15 12:00:13,188 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 12:00:45,230 (model:925) WARNING: All labels are zero
2025-02-15 12:00:45,623 (model:925) WARNING: All labels are zero
2025-02-15 12:00:53,491 (model:925) WARNING: All labels are zero
2025-02-15 12:01:52,598 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 62710,  validation: loss=0.08875, DER=0.202, ACC=0.9599, MI=0.1094, FA=0.06127, CF=0.03126, over 0.00 frames. 
2025-02-15 12:01:52,599 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 12:02:05,304 (model:925) WARNING: All labels are zero
2025-02-15 12:02:14,845 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 62710,  validation: loss=0.08679, DER=0.201, ACC=0.961, MI=0.1083, FA=0.06246, CF=0.03022, over 0.00 frames. 
2025-02-15 12:02:14,845 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 12:08:29,981 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-63000.pt
2025-02-15 12:08:30,525 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-15 12:08:30,527 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-15 12:13:27,376 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 63210, num_updates: 61500, {'loss': 0.10577154159545898, 'DER': 0.27110125646711014, 'ACC': np.float64(0.9496205357142857), 'MI': 0.14294161123429416, 'FA': 0.06563192904656319, 'CF': 0.06252771618625277}, batch size: 64, grad_norm: 0.1830817312002182, grad_scale: , lr: 0.00e+00, 
2025-02-15 12:13:27,376 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 12:13:27,377 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 63210, num_updates: 61500, {'loss': 0.09406610578298569, 'DER': 0.20242024202420242, 'ACC': np.float64(0.9628125), 'MI': 0.12788778877887788, 'FA': 0.04785478547854786, 'CF': 0.02667766776677668}, batch size: 64, grad_norm: 0.1830817312002182, grad_scale: , lr: 0.00e+00, 
2025-02-15 12:13:27,377 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 12:13:59,707 (model:925) WARNING: All labels are zero
2025-02-15 12:14:00,104 (model:925) WARNING: All labels are zero
2025-02-15 12:14:05,976 (model:925) WARNING: All labels are zero
2025-02-15 12:15:07,812 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 63210,  validation: loss=0.08937, DER=0.2026, ACC=0.9598, MI=0.1083, FA=0.0628, CF=0.03153, over 0.00 frames. 
2025-02-15 12:15:07,812 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 12:15:17,308 (model:925) WARNING: All labels are zero
2025-02-15 12:15:26,692 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 63210,  validation: loss=0.08738, DER=0.201, ACC=0.961, MI=0.1068, FA=0.06361, CF=0.03065, over 0.00 frames. 
2025-02-15 12:15:26,693 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 12:26:12,031 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 63710, num_updates: 62000, {'loss': 0.11363992840051651, 'DER': 0.26451975812122064, 'ACC': np.float64(0.94546875), 'MI': 0.12712698635916186, 'FA': 0.05836028687948249, 'CF': 0.07903248488257629}, batch size: 64, grad_norm: 0.2192832976579666, grad_scale: , lr: 0.00e+00, 
2025-02-15 12:26:12,031 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 12:26:12,042 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 63710, num_updates: 62000, {'loss': 0.08824904263019562, 'DER': 0.20346981263011799, 'ACC': np.float64(0.9635267857142857), 'MI': 0.13712699514226231, 'FA': 0.04302567661346287, 'CF': 0.023317140874392784}, batch size: 64, grad_norm: 0.2192832976579666, grad_scale: , lr: 0.00e+00, 
2025-02-15 12:26:12,042 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 12:26:44,692 (model:925) WARNING: All labels are zero
2025-02-15 12:26:51,004 (model:925) WARNING: All labels are zero
2025-02-15 12:26:51,470 (model:925) WARNING: All labels are zero
2025-02-15 12:27:44,190 (model:925) WARNING: All labels are zero
2025-02-15 12:27:51,885 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 63710,  validation: loss=0.08687, DER=0.2002, ACC=0.9611, MI=0.1072, FA=0.06247, CF=0.03048, over 0.00 frames. 
2025-02-15 12:27:51,885 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 12:28:12,551 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 63710,  validation: loss=0.08885, DER=0.2012, ACC=0.96, MI=0.1084, FA=0.06138, CF=0.03138, over 0.00 frames. 
2025-02-15 12:28:12,552 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 12:38:34,291 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 64210, num_updates: 62500, {'loss': 0.09224756807088852, 'DER': 0.22738944365192582, 'ACC': np.float64(0.9595535714285713), 'MI': 0.1282453637660485, 'FA': 0.0680456490727532, 'CF': 0.03109843081312411}, batch size: 64, grad_norm: 0.16323207318782806, grad_scale: , lr: 0.00e+00, 
2025-02-15 12:38:34,291 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 64210, num_updates: 62500, {'loss': 0.10700415074825287, 'DER': 0.25393807713199346, 'ACC': np.float64(0.9535714285714286), 'MI': 0.16716458446496468, 'FA': 0.05825638240086909, 'CF': 0.028517110266159697}, batch size: 64, grad_norm: 0.16323207318782806, grad_scale: , lr: 0.00e+00, 
2025-02-15 12:38:34,292 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 12:38:34,292 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 12:39:07,224 (model:925) WARNING: All labels are zero
2025-02-15 12:39:07,404 (model:925) WARNING: All labels are zero
2025-02-15 12:39:07,810 (model:925) WARNING: All labels are zero
2025-02-15 12:40:08,252 (model:925) WARNING: All labels are zero
2025-02-15 12:40:16,224 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 64210,  validation: loss=0.08699, DER=0.2008, ACC=0.9611, MI=0.1058, FA=0.06437, CF=0.03063, over 0.00 frames. 
2025-02-15 12:40:16,225 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 12:40:17,475 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 64210,  validation: loss=0.089, DER=0.2024, ACC=0.9598, MI=0.1072, FA=0.0635, CF=0.03164, over 0.00 frames. 
2025-02-15 12:40:17,475 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 12:46:50,755 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-64500.pt
2025-02-15 12:46:51,300 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-15 12:51:27,285 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 64710, num_updates: 63000, {'loss': 0.10850615054368973, 'DER': 0.26873831103438356, 'ACC': np.float64(0.9522767857142856), 'MI': 0.13782189613005322, 'FA': 0.0920730830096389, 'CF': 0.03884333189469141}, batch size: 64, grad_norm: 0.2114349603652954, grad_scale: , lr: 0.00e+00, 
2025-02-15 12:51:27,286 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 12:51:27,294 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 64710, num_updates: 63000, {'loss': 0.11395536363124847, 'DER': 0.2701041944963933, 'ACC': np.float64(0.9458035714285714), 'MI': 0.16123430403419717, 'FA': 0.05463531926262356, 'CF': 0.054234571199572534}, batch size: 64, grad_norm: 0.2114349603652954, grad_scale: , lr: 0.00e+00, 
2025-02-15 12:51:27,295 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 12:51:59,755 (model:925) WARNING: All labels are zero
2025-02-15 12:52:00,155 (model:925) WARNING: All labels are zero
2025-02-15 12:52:06,458 (model:925) WARNING: All labels are zero
2025-02-15 12:53:07,970 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 64710,  validation: loss=0.08904, DER=0.2027, ACC=0.9598, MI=0.1073, FA=0.06391, CF=0.03143, over 0.00 frames. 
2025-02-15 12:53:07,971 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 12:53:18,513 (model:925) WARNING: All labels are zero
2025-02-15 12:53:27,707 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 64710,  validation: loss=0.08707, DER=0.2014, ACC=0.961, MI=0.1061, FA=0.06486, CF=0.03044, over 0.00 frames. 
2025-02-15 12:53:27,708 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 13:04:26,019 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 65210, num_updates: 63500, {'loss': 0.13072094321250916, 'DER': 0.2974274315586738, 'ACC': np.float64(0.938392857142857), 'MI': 0.14156004952538176, 'FA': 0.07360022011280781, 'CF': 0.08226716192048425}, batch size: 64, grad_norm: 0.2447608858346939, grad_scale: , lr: 0.00e+00, 
2025-02-15 13:04:26,020 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 13:04:26,020 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 65210, num_updates: 63500, {'loss': 0.09785982966423035, 'DER': 0.2345132743362832, 'ACC': np.float64(0.9597132584470399), 'MI': 0.11214525480622521, 'FA': 0.08162953921269454, 'CF': 0.04073848031736344}, batch size: 64, grad_norm: 0.2447608858346939, grad_scale: , lr: 0.00e+00, 
2025-02-15 13:04:26,020 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 13:05:02,468 (model:925) WARNING: All labels are zero
2025-02-15 13:05:04,736 (model:925) WARNING: All labels are zero
2025-02-15 13:05:05,247 (model:925) WARNING: All labels are zero
2025-02-15 13:06:08,197 (model:925) WARNING: All labels are zero
2025-02-15 13:06:15,901 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 65210,  validation: loss=0.08752, DER=0.2016, ACC=0.9609, MI=0.1052, FA=0.06589, CF=0.03046, over 0.00 frames. 
2025-02-15 13:06:15,901 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 13:06:27,223 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 65210,  validation: loss=0.08949, DER=0.2033, ACC=0.9597, MI=0.1065, FA=0.0653, CF=0.03149, over 0.00 frames. 
2025-02-15 13:06:27,224 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 13:17:45,857 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 65710, num_updates: 64000, {'loss': 0.11340998858213425, 'DER': 0.2577925396014308, 'ACC': np.float64(0.9455357142857143), 'MI': 0.14665304036791008, 'FA': 0.057230454777721, 'CF': 0.05390904445579969}, batch size: 64, grad_norm: 0.2345777302980423, grad_scale: , lr: 0.00e+00, 
2025-02-15 13:17:45,858 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 13:17:45,868 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 65710, num_updates: 64000, {'loss': 0.11473134905099869, 'DER': 0.2692941499588025, 'ACC': np.float64(0.9502232142857143), 'MI': 0.1557264487778083, 'FA': 0.07662730019225487, 'CF': 0.03694040098873936}, batch size: 64, grad_norm: 0.2345777302980423, grad_scale: , lr: 0.00e+00, 
2025-02-15 13:17:45,869 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 13:18:18,517 (model:925) WARNING: All labels are zero
2025-02-15 13:18:18,915 (model:925) WARNING: All labels are zero
2025-02-15 13:18:25,452 (model:925) WARNING: All labels are zero
2025-02-15 13:19:27,212 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 65710,  validation: loss=0.08896, DER=0.2016, ACC=0.9599, MI=0.1049, FA=0.0649, CF=0.03177, over 0.00 frames. 
2025-02-15 13:19:27,213 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 13:19:36,844 (model:925) WARNING: All labels are zero
2025-02-15 13:19:46,452 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 65710,  validation: loss=0.08692, DER=0.2006, ACC=0.9611, MI=0.1042, FA=0.06575, CF=0.03073, over 0.00 frames. 
2025-02-15 13:19:46,453 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 13:22:10,860 (train_accelerate_ddp:713) INFO: end of epoch 16, batch_idx: 4113 batch_idx_train: 65823, {'loss': 0.10614638030529022, 'DER': 0.2345031598762942, 'ACC': np.float64(0.9578348214285713), 'MI': 0.14616108645959391, 'FA': 0.06884496436735242, 'CF': 0.019497109049347854}, batch size: 64, grad_norm: 0.17851674556732178, grad_scale: , lr: 0.00e+00, 
2025-02-15 13:22:10,871 (train_accelerate_ddp:713) INFO: end of epoch 16, batch_idx: 4113 batch_idx_train: 65823, {'loss': 0.09223204851150513, 'DER': 0.2241112828438949, 'ACC': np.float64(0.9639732142857143), 'MI': 0.09876352395672335, 'FA': 0.1, 'CF': 0.02534775888717156}, batch size: 64, grad_norm: 0.17851674556732178, grad_scale: , lr: 0.00e+00, 
2025-02-15 13:22:10,873 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-16.pt
2025-02-15 13:22:11,301 (train_accelerate_ddp:561) INFO:  end of epoch 16, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-16.pt 
2025-02-15 13:22:13,721 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 65824, num_updates: 64000, {'loss': 0.12885886430740356, 'DER': 0.3425090252707581, 'ACC': np.float64(0.9351785714285714), 'MI': 0.14726233453670276, 'FA': 0.10093261131167268, 'CF': 0.09431407942238267}, batch size: 64, grad_norm: 0.2999408543109894, grad_scale: , lr: 0.00e+00, 
2025-02-15 13:22:13,732 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 65824, num_updates: 64000, {'loss': 0.11491946876049042, 'DER': 0.264366235908716, 'ACC': np.float64(0.9522767857142856), 'MI': 0.1734946384382733, 'FA': 0.06131427000274952, 'CF': 0.029557327467693153}, batch size: 64, grad_norm: 0.2999408543109894, grad_scale: , lr: 0.00e+00, 
2025-02-15 13:26:18,485 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-66000.pt
2025-02-15 13:26:19,122 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-15 13:26:19,124 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-15 13:33:39,569 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 66324, num_updates: 64500, {'loss': 0.135065957903862, 'DER': 0.2878787878787879, 'ACC': np.float64(0.9425892857142857), 'MI': 0.15619834710743802, 'FA': 0.0652892561983471, 'CF': 0.06639118457300275}, batch size: 64, grad_norm: 0.2434004545211792, grad_scale: , lr: 0.00e+00, 
2025-02-15 13:33:39,570 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 13:33:39,580 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 66324, num_updates: 64500, {'loss': 0.08253877609968185, 'DER': 0.19454753068798172, 'ACC': np.float64(0.965), 'MI': 0.11418783899514702, 'FA': 0.05109905795032829, 'CF': 0.029260633742506422}, batch size: 64, grad_norm: 0.2434004545211792, grad_scale: , lr: 0.00e+00, 
2025-02-15 13:33:39,580 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 13:34:12,022 (model:925) WARNING: All labels are zero
2025-02-15 13:34:12,432 (model:925) WARNING: All labels are zero
2025-02-15 13:34:18,156 (model:925) WARNING: All labels are zero
2025-02-15 13:35:20,380 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 66324,  validation: loss=0.08896, DER=0.2019, ACC=0.9599, MI=0.1086, FA=0.06176, CF=0.03156, over 0.00 frames. 
2025-02-15 13:35:20,381 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 13:35:29,803 (model:925) WARNING: All labels are zero
2025-02-15 13:35:41,451 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 66324,  validation: loss=0.08703, DER=0.2005, ACC=0.961, MI=0.1072, FA=0.06242, CF=0.03093, over 0.00 frames. 
2025-02-15 13:35:41,452 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 13:46:57,994 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 66824, num_updates: 65000, {'loss': 0.10626181215047836, 'DER': 0.2633655284995239, 'ACC': np.float64(0.9519419642857143), 'MI': 0.17004489185144878, 'FA': 0.06380084342266358, 'CF': 0.029519793225411508}, batch size: 64, grad_norm: 0.2597813606262207, grad_scale: , lr: 0.00e+00, 
2025-02-15 13:46:57,994 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 13:46:57,994 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 66824, num_updates: 65000, {'loss': 0.11911754310131073, 'DER': 0.31336753168376585, 'ACC': np.float64(0.9464285714285714), 'MI': 0.16294508147254075, 'FA': 0.10168980084490042, 'CF': 0.04873264936632468}, batch size: 64, grad_norm: 0.2597813606262207, grad_scale: , lr: 0.00e+00, 
2025-02-15 13:46:57,995 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 13:47:30,521 (model:925) WARNING: All labels are zero
2025-02-15 13:47:30,921 (model:925) WARNING: All labels are zero
2025-02-15 13:47:37,008 (model:925) WARNING: All labels are zero
2025-02-15 13:48:39,072 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 66824,  validation: loss=0.08867, DER=0.2016, ACC=0.9599, MI=0.109, FA=0.06133, CF=0.0313, over 0.00 frames. 
2025-02-15 13:48:39,073 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 13:48:49,086 (model:925) WARNING: All labels are zero
2025-02-15 13:48:58,431 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 66824,  validation: loss=0.0867, DER=0.2008, ACC=0.9611, MI=0.108, FA=0.06257, CF=0.03018, over 0.00 frames. 
2025-02-15 13:48:58,431 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 13:59:54,811 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 67324, num_updates: 65500, {'loss': 0.12398781627416611, 'DER': 0.2544529262086514, 'ACC': np.float64(0.9459598214285714), 'MI': 0.1419579483058792, 'FA': 0.04272130708450515, 'CF': 0.06977367081826705}, batch size: 64, grad_norm: 0.2900981903076172, grad_scale: , lr: 0.00e+00, 
2025-02-15 13:59:54,811 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 13:59:54,812 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 67324, num_updates: 65500, {'loss': 0.13567638397216797, 'DER': 0.3179940162416299, 'ACC': np.float64(0.9397544642857143), 'MI': 0.16654794130217979, 'FA': 0.08491238068100869, 'CF': 0.06653369425844137}, batch size: 64, grad_norm: 0.2900981903076172, grad_scale: , lr: 0.00e+00, 
2025-02-15 13:59:54,812 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 14:00:27,540 (model:925) WARNING: All labels are zero
2025-02-15 14:00:32,342 (model:925) WARNING: All labels are zero
2025-02-15 14:00:32,790 (model:925) WARNING: All labels are zero
2025-02-15 14:01:27,292 (model:925) WARNING: All labels are zero
2025-02-15 14:01:35,124 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 67324,  validation: loss=0.08648, DER=0.2002, ACC=0.9611, MI=0.1066, FA=0.06294, CF=0.0307, over 0.00 frames. 
2025-02-15 14:01:35,124 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 14:01:56,350 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 67324,  validation: loss=0.08849, DER=0.2012, ACC=0.96, MI=0.1079, FA=0.06186, CF=0.03144, over 0.00 frames. 
2025-02-15 14:01:56,351 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 14:06:08,112 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-67500.pt
2025-02-15 14:06:08,637 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-15 14:13:14,158 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 67824, num_updates: 66000, {'loss': 0.08264077454805374, 'DER': 0.20628209000302022, 'ACC': np.float64(0.9645982142857144), 'MI': 0.12352763515554213, 'FA': 0.04953186348535186, 'CF': 0.03322259136212625}, batch size: 64, grad_norm: 0.16700035333633423, grad_scale: , lr: 0.00e+00, 
2025-02-15 14:13:14,159 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 14:13:14,170 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 67824, num_updates: 66000, {'loss': 0.10342593491077423, 'DER': 0.25026329647182727, 'ACC': np.float64(0.9502222023716475), 'MI': 0.14942074776198, 'FA': 0.05766192733017378, 'CF': 0.04318062137967351}, batch size: 64, grad_norm: 0.16700035333633423, grad_scale: , lr: 0.00e+00, 
2025-02-15 14:13:14,170 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 14:13:46,775 (model:925) WARNING: All labels are zero
2025-02-15 14:13:52,653 (model:925) WARNING: All labels are zero
2025-02-15 14:13:53,113 (model:925) WARNING: All labels are zero
2025-02-15 14:14:46,334 (model:925) WARNING: All labels are zero
2025-02-15 14:14:54,129 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 67824,  validation: loss=0.08719, DER=0.2011, ACC=0.9611, MI=0.1052, FA=0.06551, CF=0.0303, over 0.00 frames. 
2025-02-15 14:14:54,129 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 14:15:14,785 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 67824,  validation: loss=0.08922, DER=0.2023, ACC=0.9599, MI=0.1063, FA=0.06455, CF=0.0314, over 0.00 frames. 
2025-02-15 14:15:14,786 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 14:26:50,534 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 68324, num_updates: 66500, {'loss': 0.09509602934122086, 'DER': 0.22734829592684955, 'ACC': np.float64(0.96046875), 'MI': 0.14713216957605985, 'FA': 0.062205597118315324, 'CF': 0.01801052923247437}, batch size: 64, grad_norm: 0.21802541613578796, grad_scale: , lr: 0.00e+00, 
2025-02-15 14:26:50,534 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 14:26:50,535 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 68324, num_updates: 66500, {'loss': 0.10751266032457352, 'DER': 0.2652046783625731, 'ACC': np.float64(0.9478125), 'MI': 0.10950292397660819, 'FA': 0.079093567251462, 'CF': 0.07660818713450293}, batch size: 64, grad_norm: 0.21802541613578796, grad_scale: , lr: 0.00e+00, 
2025-02-15 14:26:50,535 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 14:27:23,219 (model:925) WARNING: All labels are zero
2025-02-15 14:27:23,637 (model:925) WARNING: All labels are zero
2025-02-15 14:27:29,571 (model:925) WARNING: All labels are zero
2025-02-15 14:28:32,349 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 68324,  validation: loss=0.08923, DER=0.2024, ACC=0.9598, MI=0.1088, FA=0.06226, CF=0.03135, over 0.00 frames. 
2025-02-15 14:28:32,349 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 14:28:54,509 (model:925) WARNING: All labels are zero
2025-02-15 14:29:06,756 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 68324,  validation: loss=0.08721, DER=0.2014, ACC=0.961, MI=0.1075, FA=0.06339, CF=0.03051, over 0.00 frames. 
2025-02-15 14:29:06,756 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 14:40:16,824 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 68824, num_updates: 67000, {'loss': 0.11810433119535446, 'DER': 0.27990464170523066, 'ACC': np.float64(0.9450669642857144), 'MI': 0.15089047819380172, 'FA': 0.06380591782358716, 'CF': 0.06520824568784182}, batch size: 64, grad_norm: 0.26569679379463196, grad_scale: , lr: 0.00e+00, 
2025-02-15 14:40:16,825 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 14:40:16,824 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 68824, num_updates: 67000, {'loss': 0.11696913838386536, 'DER': 0.26782658300057044, 'ACC': np.float64(0.9469419642857143), 'MI': 0.12221905305191101, 'FA': 0.0744438106103822, 'CF': 0.07116371933827724}, batch size: 64, grad_norm: 0.26569679379463196, grad_scale: , lr: 0.00e+00, 
2025-02-15 14:40:16,825 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 14:40:49,371 (model:925) WARNING: All labels are zero
2025-02-15 14:40:56,437 (model:925) WARNING: All labels are zero
2025-02-15 14:40:56,923 (model:925) WARNING: All labels are zero
2025-02-15 14:41:49,022 (model:925) WARNING: All labels are zero
2025-02-15 14:41:56,825 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 68824,  validation: loss=0.08694, DER=0.2011, ACC=0.9611, MI=0.1067, FA=0.06415, CF=0.03031, over 0.00 frames. 
2025-02-15 14:41:56,825 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 14:42:18,291 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 68824,  validation: loss=0.08903, DER=0.2023, ACC=0.9598, MI=0.1079, FA=0.06293, CF=0.03154, over 0.00 frames. 
2025-02-15 14:42:18,292 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 14:46:02,738 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-69000.pt
2025-02-15 14:46:03,311 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-15 14:53:06,221 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 69324, num_updates: 67500, {'loss': 0.07550748437643051, 'DER': 0.17904648034673443, 'ACC': np.float64(0.9700892857142857), 'MI': 0.10162905395307129, 'FA': 0.056194888656404124, 'CF': 0.021222537737259003}, batch size: 64, grad_norm: 0.23242148756980896, grad_scale: , lr: 0.00e+00, 
2025-02-15 14:53:06,222 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 14:53:06,232 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 69324, num_updates: 67500, {'loss': 0.09182725101709366, 'DER': 0.26684097200861273, 'ACC': np.float64(0.9539955357142857), 'MI': 0.1299600123039065, 'FA': 0.08674254075669025, 'CF': 0.050138418948015996}, batch size: 64, grad_norm: 0.23242148756980896, grad_scale: , lr: 0.00e+00, 
2025-02-15 14:53:06,232 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 14:53:38,394 (model:925) WARNING: All labels are zero
2025-02-15 14:53:38,789 (model:925) WARNING: All labels are zero
2025-02-15 14:53:44,909 (model:925) WARNING: All labels are zero
2025-02-15 14:54:46,102 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 69324,  validation: loss=0.0895, DER=0.2027, ACC=0.9597, MI=0.1063, FA=0.06474, CF=0.03171, over 0.00 frames. 
2025-02-15 14:54:46,103 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 14:55:09,024 (model:925) WARNING: All labels are zero
2025-02-15 14:55:20,025 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 69324,  validation: loss=0.08761, DER=0.2013, ACC=0.9609, MI=0.1052, FA=0.06536, CF=0.03074, over 0.00 frames. 
2025-02-15 14:55:20,026 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 15:06:36,414 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 69824, num_updates: 68000, {'loss': 0.07541458308696747, 'DER': 0.19057939604103452, 'ACC': np.float64(0.9668080357142856), 'MI': 0.10200838029186533, 'FA': 0.06429706689784713, 'CF': 0.024273948851322065}, batch size: 64, grad_norm: 0.17523345351219177, grad_scale: , lr: 0.00e+00, 
2025-02-15 15:06:36,415 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 15:06:36,424 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 69824, num_updates: 68000, {'loss': 0.0948038175702095, 'DER': 0.21572212065813529, 'ACC': np.float64(0.9601785714285714), 'MI': 0.11587681057516523, 'FA': 0.0646885107579806, 'CF': 0.035156799324989454}, batch size: 64, grad_norm: 0.17523345351219177, grad_scale: , lr: 0.00e+00, 
2025-02-15 15:06:36,425 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 15:07:09,049 (model:925) WARNING: All labels are zero
2025-02-15 15:07:14,985 (model:925) WARNING: All labels are zero
2025-02-15 15:07:15,611 (model:925) WARNING: All labels are zero
2025-02-15 15:08:08,616 (model:925) WARNING: All labels are zero
2025-02-15 15:08:16,418 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 69824,  validation: loss=0.08746, DER=0.2013, ACC=0.961, MI=0.1071, FA=0.06388, CF=0.0304, over 0.00 frames. 
2025-02-15 15:08:16,418 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 15:08:37,021 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 69824,  validation: loss=0.08953, DER=0.2026, ACC=0.9598, MI=0.1084, FA=0.06291, CF=0.03131, over 0.00 frames. 
2025-02-15 15:08:37,022 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 15:11:17,281 (train_accelerate_ddp:713) INFO: end of epoch 17, batch_idx: 4113 batch_idx_train: 69937, {'loss': 0.10279656946659088, 'DER': 0.21326116373477672, 'ACC': np.float64(0.9582589285714286), 'MI': 0.12246278755074425, 'FA': 0.0510148849797023, 'CF': 0.039783491204330175}, batch size: 64, grad_norm: 0.26614898443222046, grad_scale: , lr: 0.00e+00, 
2025-02-15 15:11:17,283 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-17.pt
2025-02-15 15:11:17,292 (train_accelerate_ddp:713) INFO: end of epoch 17, batch_idx: 4113 batch_idx_train: 69937, {'loss': 0.11812081187963486, 'DER': 0.2671733830489029, 'ACC': np.float64(0.9507589285714286), 'MI': 0.13394521726659975, 'FA': 0.08403843395955829, 'CF': 0.04918973182274487}, batch size: 64, grad_norm: 0.26614898443222046, grad_scale: , lr: 0.00e+00, 
2025-02-15 15:11:17,637 (train_accelerate_ddp:561) INFO:  end of epoch 17, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-17.pt 
2025-02-15 15:11:20,412 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 69938, num_updates: 68000, {'loss': 0.10608887672424316, 'DER': 0.2445927903871829, 'ACC': np.float64(0.9521205357142857), 'MI': 0.1464619492656876, 'FA': 0.05634178905206943, 'CF': 0.0417890520694259}, batch size: 64, grad_norm: 0.24016126990318298, grad_scale: , lr: 0.00e+00, 
2025-02-15 15:11:20,413 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 69938, num_updates: 68000, {'loss': 0.10951517522335052, 'DER': 0.27382606279522087, 'ACC': np.float64(0.9483705357142856), 'MI': 0.15559877743817727, 'FA': 0.07071408724645735, 'CF': 0.047513198110586276}, batch size: 64, grad_norm: 0.24016126990318298, grad_scale: , lr: 0.00e+00, 
2025-02-15 15:23:02,361 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 70438, num_updates: 68500, {'loss': 0.11275263875722885, 'DER': 0.2211525045346728, 'ACC': np.float64(0.9559151785714286), 'MI': 0.13004046323426818, 'FA': 0.03669596762941259, 'CF': 0.05441607367099205}, batch size: 64, grad_norm: 0.29575327038764954, grad_scale: , lr: 0.00e+00, 
2025-02-15 15:23:02,362 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 15:23:02,372 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 70438, num_updates: 68500, {'loss': 0.09988097101449966, 'DER': 0.2705773955773956, 'ACC': np.float64(0.9542633928571429), 'MI': 0.15018427518427518, 'FA': 0.07632063882063882, 'CF': 0.04407248157248157}, batch size: 64, grad_norm: 0.29575327038764954, grad_scale: , lr: 0.00e+00, 
2025-02-15 15:23:02,373 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 15:23:35,093 (model:925) WARNING: All labels are zero
2025-02-15 15:23:35,505 (model:925) WARNING: All labels are zero
2025-02-15 15:23:49,750 (model:925) WARNING: All labels are zero
2025-02-15 15:24:43,815 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 70438,  validation: loss=0.08942, DER=0.2028, ACC=0.9598, MI=0.107, FA=0.06422, CF=0.03161, over 0.00 frames. 
2025-02-15 15:24:43,816 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 15:25:02,632 (model:925) WARNING: All labels are zero
2025-02-15 15:25:12,075 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 70438,  validation: loss=0.08737, DER=0.2014, ACC=0.961, MI=0.1057, FA=0.06513, CF=0.0305, over 0.00 frames. 
2025-02-15 15:25:12,075 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 15:26:32,780 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-70500.pt
2025-02-15 15:26:33,340 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-15 15:26:33,342 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-15 15:36:07,926 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 70938, num_updates: 69000, {'loss': 0.1059720367193222, 'DER': 0.24491162292447777, 'ACC': np.float64(0.9513616071428571), 'MI': 0.1468934118907338, 'FA': 0.05115158007498661, 'CF': 0.046866630958757365}, batch size: 64, grad_norm: 0.2540552616119385, grad_scale: , lr: 0.00e+00, 
2025-02-15 15:36:07,926 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 15:36:07,937 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 70938, num_updates: 69000, {'loss': 0.10412179678678513, 'DER': 0.2493663756688257, 'ACC': np.float64(0.9526339285714286), 'MI': 0.14348070965925092, 'FA': 0.05646296817797804, 'CF': 0.04942269783159673}, batch size: 64, grad_norm: 0.2540552616119385, grad_scale: , lr: 0.00e+00, 
2025-02-15 15:36:07,937 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 15:36:40,155 (model:925) WARNING: All labels are zero
2025-02-15 15:36:40,550 (model:925) WARNING: All labels are zero
2025-02-15 15:36:46,838 (model:925) WARNING: All labels are zero
2025-02-15 15:37:48,014 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 70938,  validation: loss=0.08851, DER=0.2018, ACC=0.9599, MI=0.1085, FA=0.0616, CF=0.03173, over 0.00 frames. 
2025-02-15 15:37:48,015 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 15:37:58,105 (model:925) WARNING: All labels are zero
2025-02-15 15:38:07,424 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 70938,  validation: loss=0.08658, DER=0.2009, ACC=0.961, MI=0.1075, FA=0.06281, CF=0.03064, over 0.00 frames. 
2025-02-15 15:38:07,424 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 15:49:27,960 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 71438, num_updates: 69500, {'loss': 0.10581424087285995, 'DER': 0.24792946834090301, 'ACC': np.float64(0.95265625), 'MI': 0.14533796419983971, 'FA': 0.06719209190488913, 'CF': 0.03539941223617419}, batch size: 64, grad_norm: 0.24620415270328522, grad_scale: , lr: 0.00e+00, 
2025-02-15 15:49:27,960 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 15:49:27,970 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 71438, num_updates: 69500, {'loss': 0.1141190156340599, 'DER': 0.257508896797153, 'ACC': np.float64(0.948861607142857), 'MI': 0.13252669039145906, 'FA': 0.056370106761565834, 'CF': 0.06861209964412811}, batch size: 64, grad_norm: 0.24620415270328522, grad_scale: , lr: 0.00e+00, 
2025-02-15 15:49:27,970 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 15:50:00,327 (model:925) WARNING: All labels are zero
2025-02-15 15:50:00,722 (model:925) WARNING: All labels are zero
2025-02-15 15:50:15,597 (model:925) WARNING: All labels are zero
2025-02-15 15:51:07,834 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 71438,  validation: loss=0.08925, DER=0.2024, ACC=0.9598, MI=0.1066, FA=0.06427, CF=0.03151, over 0.00 frames. 
2025-02-15 15:51:07,835 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 15:51:27,442 (model:925) WARNING: All labels are zero
2025-02-15 15:51:37,480 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 71438,  validation: loss=0.08727, DER=0.2011, ACC=0.961, MI=0.1057, FA=0.06507, CF=0.0303, over 0.00 frames. 
2025-02-15 15:51:37,480 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 16:02:26,577 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 71938, num_updates: 70000, {'loss': 0.07477734982967377, 'DER': 0.16822699121417256, 'ACC': np.float64(0.9713839285714286), 'MI': 0.11378366700273657, 'FA': 0.0380239089730664, 'CF': 0.01641941523836958}, batch size: 64, grad_norm: 0.1721872091293335, grad_scale: , lr: 0.00e+00, 
2025-02-15 16:02:26,577 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 16:02:26,587 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 71938, num_updates: 70000, {'loss': 0.11565231531858444, 'DER': 0.23019835379840778, 'ACC': np.float64(0.9563616071428571), 'MI': 0.12980704358386183, 'FA': 0.06679260558629065, 'CF': 0.033598704628255295}, batch size: 64, grad_norm: 0.1721872091293335, grad_scale: , lr: 0.00e+00, 
2025-02-15 16:02:26,587 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 16:03:01,869 (model:925) WARNING: All labels are zero
2025-02-15 16:03:08,890 (model:925) WARNING: All labels are zero
2025-02-15 16:03:09,400 (model:925) WARNING: All labels are zero
2025-02-15 16:04:03,692 (model:925) WARNING: All labels are zero
2025-02-15 16:04:11,671 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 71938,  validation: loss=0.08741, DER=0.2017, ACC=0.9609, MI=0.106, FA=0.06519, CF=0.03048, over 0.00 frames. 
2025-02-15 16:04:11,671 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 16:04:31,756 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 71938,  validation: loss=0.08939, DER=0.2029, ACC=0.9597, MI=0.1071, FA=0.0642, CF=0.03164, over 0.00 frames. 
2025-02-15 16:04:31,757 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 16:06:18,671 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-72000.pt
2025-02-15 16:06:19,306 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-15 16:16:50,667 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 72438, num_updates: 70500, {'loss': 0.10385920107364655, 'DER': 0.2317871569856526, 'ACC': np.float64(0.9543526785714286), 'MI': 0.11672934949157264, 'FA': 0.06198634907368714, 'CF': 0.05307145842039281}, batch size: 64, grad_norm: 0.23664191365242004, grad_scale: , lr: 0.00e+00, 
2025-02-15 16:16:50,667 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 16:16:50,673 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 72438, num_updates: 70500, {'loss': 0.12490412592887878, 'DER': 0.2715179968701095, 'ACC': np.float64(0.9442410714285714), 'MI': 0.15362545644235784, 'FA': 0.06364110589462701, 'CF': 0.05425143453312467}, batch size: 64, grad_norm: 0.23664191365242004, grad_scale: , lr: 0.00e+00, 
2025-02-15 16:16:50,673 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 16:17:23,603 (model:925) WARNING: All labels are zero
2025-02-15 16:17:29,518 (model:925) WARNING: All labels are zero
2025-02-15 16:17:30,037 (model:925) WARNING: All labels are zero
2025-02-15 16:18:24,142 (model:925) WARNING: All labels are zero
2025-02-15 16:18:32,002 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 72438,  validation: loss=0.0873, DER=0.201, ACC=0.961, MI=0.1052, FA=0.06505, CF=0.03072, over 0.00 frames. 
2025-02-15 16:18:32,003 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 16:18:53,842 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 72438,  validation: loss=0.08925, DER=0.2024, ACC=0.9598, MI=0.1066, FA=0.06415, CF=0.03169, over 0.00 frames. 
2025-02-15 16:18:53,843 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 16:29:46,134 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 72938, num_updates: 71000, {'loss': 0.11781731247901917, 'DER': 0.29296455424274975, 'ACC': np.float64(0.9391741071428571), 'MI': 0.15601503759398497, 'FA': 0.06404403866809882, 'CF': 0.07290547798066595}, batch size: 64, grad_norm: 0.24168367683887482, grad_scale: , lr: 0.00e+00, 
2025-02-15 16:29:46,135 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 16:29:46,135 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 72938, num_updates: 71000, {'loss': 0.09855630993843079, 'DER': 0.2197633959638135, 'ACC': np.float64(0.9577232142857143), 'MI': 0.120946416144746, 'FA': 0.054975643702157274, 'CF': 0.04384133611691023}, batch size: 64, grad_norm: 0.24168367683887482, grad_scale: , lr: 0.00e+00, 
2025-02-15 16:29:46,135 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 16:30:18,199 (model:925) WARNING: All labels are zero
2025-02-15 16:30:25,095 (model:925) WARNING: All labels are zero
2025-02-15 16:30:25,494 (model:925) WARNING: All labels are zero
2025-02-15 16:31:17,490 (model:925) WARNING: All labels are zero
2025-02-15 16:31:25,212 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 72938,  validation: loss=0.08688, DER=0.2009, ACC=0.9611, MI=0.1067, FA=0.06384, CF=0.03031, over 0.00 frames. 
2025-02-15 16:31:25,212 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 16:31:47,318 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 72938,  validation: loss=0.08878, DER=0.2019, ACC=0.9599, MI=0.1076, FA=0.06285, CF=0.03145, over 0.00 frames. 
2025-02-15 16:31:47,318 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 16:42:55,022 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 73438, num_updates: 71500, {'loss': 0.1116749718785286, 'DER': 0.26073941026792397, 'ACC': np.float64(0.951763392857143), 'MI': 0.10537344708875916, 'FA': 0.0926508007783266, 'CF': 0.0627151624008382}, batch size: 64, grad_norm: 0.22561363875865936, grad_scale: , lr: 0.00e+00, 
2025-02-15 16:42:55,023 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 16:42:55,025 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 73438, num_updates: 71500, {'loss': 0.11969929188489914, 'DER': 0.2675668228162028, 'ACC': np.float64(0.9486160714285714), 'MI': 0.16340589694130614, 'FA': 0.05456048498208873, 'CF': 0.049600440892807934}, batch size: 64, grad_norm: 0.22561363875865936, grad_scale: , lr: 0.00e+00, 
2025-02-15 16:42:55,025 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 16:43:27,727 (model:925) WARNING: All labels are zero
2025-02-15 16:43:28,134 (model:925) WARNING: All labels are zero
2025-02-15 16:43:34,594 (model:925) WARNING: All labels are zero
2025-02-15 16:44:37,310 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 73438,  validation: loss=0.08888, DER=0.2015, ACC=0.96, MI=0.1085, FA=0.06197, CF=0.03102, over 0.00 frames. 
2025-02-15 16:44:37,311 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 16:44:48,150 (model:925) WARNING: All labels are zero
2025-02-15 16:44:57,863 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 73438,  validation: loss=0.08698, DER=0.2005, ACC=0.9611, MI=0.1075, FA=0.06273, CF=0.03028, over 0.00 frames. 
2025-02-15 16:44:57,863 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 16:46:17,308 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-73500.pt
2025-02-15 16:46:17,912 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-15 16:55:40,014 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 73938, num_updates: 72000, {'loss': 0.09784117341041565, 'DER': 0.22490129723632263, 'ACC': np.float64(0.9586607142857143), 'MI': 0.09898477157360407, 'FA': 0.08967851099830795, 'CF': 0.0362380146644106}, batch size: 64, grad_norm: 0.21403592824935913, grad_scale: , lr: 0.00e+00, 
2025-02-15 16:55:40,014 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 16:55:40,014 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 73938, num_updates: 72000, {'loss': 0.10978486388921738, 'DER': 0.2784354862880264, 'ACC': np.float64(0.9527455357142857), 'MI': 0.14566162145961337, 'FA': 0.09396073729956542, 'CF': 0.038813127528847594}, batch size: 64, grad_norm: 0.21403592824935913, grad_scale: , lr: 0.00e+00, 
2025-02-15 16:55:40,015 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 16:56:12,053 (model:925) WARNING: All labels are zero
2025-02-15 16:56:12,451 (model:925) WARNING: All labels are zero
2025-02-15 16:56:18,988 (model:925) WARNING: All labels are zero
2025-02-15 16:57:20,188 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 73938,  validation: loss=0.08892, DER=0.2022, ACC=0.9598, MI=0.1074, FA=0.06323, CF=0.03156, over 0.00 frames. 
2025-02-15 16:57:20,188 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 16:57:31,450 (model:925) WARNING: All labels are zero
2025-02-15 16:57:40,921 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 73938,  validation: loss=0.08707, DER=0.201, ACC=0.961, MI=0.1061, FA=0.06421, CF=0.03074, over 0.00 frames. 
2025-02-15 16:57:40,922 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 17:00:24,903 (train_accelerate_ddp:713) INFO: end of epoch 18, batch_idx: 4113 batch_idx_train: 74051, {'loss': 0.10134714841842651, 'DER': 0.24356617647058823, 'ACC': np.float64(0.9509598214285714), 'MI': 0.13996848739495799, 'FA': 0.0586922268907563, 'CF': 0.04490546218487395}, batch size: 64, grad_norm: 0.18984510004520416, grad_scale: , lr: 0.00e+00, 
2025-02-15 17:00:24,904 (train_accelerate_ddp:713) INFO: end of epoch 18, batch_idx: 4113 batch_idx_train: 74051, {'loss': 0.11199837923049927, 'DER': 0.26276094276094275, 'ACC': np.float64(0.9502901785714286), 'MI': 0.1402020202020202, 'FA': 0.08538720538720539, 'CF': 0.037171717171717175}, batch size: 64, grad_norm: 0.18984510004520416, grad_scale: , lr: 0.00e+00, 
2025-02-15 17:00:24,906 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-18.pt
2025-02-15 17:00:25,362 (train_accelerate_ddp:561) INFO:  end of epoch 18, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-18.pt 
2025-02-15 17:00:27,630 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 74052, num_updates: 72000, {'loss': 0.11467058956623077, 'DER': 0.2636079815392969, 'ACC': np.float64(0.948861607142857), 'MI': 0.13628342608931723, 'FA': 0.07995113343287634, 'CF': 0.047373422017103296}, batch size: 64, grad_norm: 0.3018515408039093, grad_scale: , lr: 0.00e+00, 
2025-02-15 17:00:27,632 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 74052, num_updates: 72000, {'loss': 0.14816313982009888, 'DER': 0.31515307435039874, 'ACC': np.float64(0.934486607142857), 'MI': 0.19063545150501673, 'FA': 0.0621301775147929, 'CF': 0.062387445330589146}, batch size: 64, grad_norm: 0.3018515408039093, grad_scale: , lr: 0.00e+00, 
2025-02-15 17:12:11,492 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 74552, num_updates: 72500, {'loss': 0.09574339538812637, 'DER': 0.2151846785225718, 'ACC': np.float64(0.9612276785714287), 'MI': 0.11942544459644323, 'FA': 0.07332421340629275, 'CF': 0.02243502051983584}, batch size: 64, grad_norm: 0.3374597430229187, grad_scale: , lr: 0.00e+00, 
2025-02-15 17:12:11,492 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 17:12:11,503 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 74552, num_updates: 72500, {'loss': 0.1150817796587944, 'DER': 0.2594332474617366, 'ACC': np.float64(0.9524554969138564), 'MI': 0.1363843006516139, 'FA': 0.06031216851038036, 'CF': 0.06273677829974239}, batch size: 64, grad_norm: 0.3374597430229187, grad_scale: , lr: 0.00e+00, 
2025-02-15 17:12:11,503 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 17:12:44,324 (model:925) WARNING: All labels are zero
2025-02-15 17:12:44,739 (model:925) WARNING: All labels are zero
2025-02-15 17:12:50,487 (model:925) WARNING: All labels are zero
2025-02-15 17:13:52,202 (model:925) WARNING: All labels are zero
2025-02-15 17:13:59,955 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 74552,  validation: loss=0.08741, DER=0.201, ACC=0.961, MI=0.1045, FA=0.06567, CF=0.03082, over 0.00 frames. 
2025-02-15 17:13:59,955 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 17:14:01,721 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 74552,  validation: loss=0.08943, DER=0.2027, ACC=0.9598, MI=0.1058, FA=0.06502, CF=0.03195, over 0.00 frames. 
2025-02-15 17:14:01,721 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 17:23:46,180 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-75000.pt
2025-02-15 17:23:46,735 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-15 17:23:46,737 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-15 17:24:55,239 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 75052, num_updates: 73000, {'loss': 0.10409872233867645, 'DER': 0.2628214234976559, 'ACC': np.float64(0.950580357142857), 'MI': 0.14973717857650234, 'FA': 0.061372354027560735, 'CF': 0.05171189089359284}, batch size: 64, grad_norm: 0.18955175578594208, grad_scale: , lr: 0.00e+00, 
2025-02-15 17:24:55,240 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 17:24:55,250 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 75052, num_updates: 73000, {'loss': 0.09921395033597946, 'DER': 0.23115904365904366, 'ACC': np.float64(0.9545982142857143), 'MI': 0.15033783783783783, 'FA': 0.047687110187110186, 'CF': 0.03313409563409563}, batch size: 64, grad_norm: 0.18955175578594208, grad_scale: , lr: 0.00e+00, 
2025-02-15 17:24:55,250 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 17:25:27,694 (model:925) WARNING: All labels are zero
2025-02-15 17:25:28,094 (model:925) WARNING: All labels are zero
2025-02-15 17:25:34,270 (model:925) WARNING: All labels are zero
2025-02-15 17:26:36,491 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 75052,  validation: loss=0.08845, DER=0.201, ACC=0.96, MI=0.1077, FA=0.06194, CF=0.03134, over 0.00 frames. 
2025-02-15 17:26:36,491 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 17:26:46,784 (model:925) WARNING: All labels are zero
2025-02-15 17:26:56,446 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 75052,  validation: loss=0.08643, DER=0.1995, ACC=0.9612, MI=0.1063, FA=0.06266, CF=0.03047, over 0.00 frames. 
2025-02-15 17:26:56,447 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 17:38:08,127 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 75552, num_updates: 73500, {'loss': 0.11261051148176193, 'DER': 0.2656886715566422, 'ACC': np.float64(0.948325892857143), 'MI': 0.15702254822059222, 'FA': 0.05990220048899755, 'CF': 0.04876392284705243}, batch size: 64, grad_norm: 0.23049505054950714, grad_scale: , lr: 0.00e+00, 
2025-02-15 17:38:08,127 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 17:38:08,137 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 75552, num_updates: 73500, {'loss': 0.08744460344314575, 'DER': 0.2380155227514838, 'ACC': np.float64(0.9598214285714286), 'MI': 0.1430528077918125, 'FA': 0.059047329173641756, 'CF': 0.03591538578602952}, batch size: 64, grad_norm: 0.23049505054950714, grad_scale: , lr: 0.00e+00, 
2025-02-15 17:38:08,138 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 17:38:40,724 (model:925) WARNING: All labels are zero
2025-02-15 17:38:48,240 (model:925) WARNING: All labels are zero
2025-02-15 17:38:48,748 (model:925) WARNING: All labels are zero
2025-02-15 17:39:40,461 (model:925) WARNING: All labels are zero
2025-02-15 17:39:48,261 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 75552,  validation: loss=0.08637, DER=0.2002, ACC=0.9612, MI=0.1074, FA=0.06253, CF=0.03031, over 0.00 frames. 
2025-02-15 17:39:48,262 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 17:40:10,830 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 75552,  validation: loss=0.08839, DER=0.2011, ACC=0.96, MI=0.1083, FA=0.06131, CF=0.03146, over 0.00 frames. 
2025-02-15 17:40:10,831 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 17:50:57,881 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 76052, num_updates: 74000, {'loss': 0.1041392907500267, 'DER': 0.2792891964145306, 'ACC': np.float64(0.950580357142857), 'MI': 0.10095927032552288, 'FA': 0.10945117156785658, 'CF': 0.06887875452115112}, batch size: 64, grad_norm: 0.27112796902656555, grad_scale: , lr: 0.00e+00, 
2025-02-15 17:50:57,882 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 17:50:57,883 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 76052, num_updates: 74000, {'loss': 0.11638844758272171, 'DER': 0.31321044546850996, 'ACC': np.float64(0.9433035714285714), 'MI': 0.11044546850998464, 'FA': 0.12580645161290321, 'CF': 0.07695852534562211}, batch size: 64, grad_norm: 0.27112796902656555, grad_scale: , lr: 0.00e+00, 
2025-02-15 17:50:57,883 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 17:51:30,026 (model:925) WARNING: All labels are zero
2025-02-15 17:51:30,421 (model:925) WARNING: All labels are zero
2025-02-15 17:51:38,128 (model:925) WARNING: All labels are zero
2025-02-15 17:52:44,864 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 76052,  validation: loss=0.08923, DER=0.2024, ACC=0.9598, MI=0.1055, FA=0.06536, CF=0.03157, over 0.00 frames. 
2025-02-15 17:52:44,864 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 17:52:54,043 (model:925) WARNING: All labels are zero
2025-02-15 17:53:03,574 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 76052,  validation: loss=0.0872, DER=0.2009, ACC=0.961, MI=0.1044, FA=0.06617, CF=0.03032, over 0.00 frames. 
2025-02-15 17:53:03,574 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 18:04:13,188 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-76500.pt
2025-02-15 18:04:13,878 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-15 18:05:24,957 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 76552, num_updates: 74500, {'loss': 0.10410626232624054, 'DER': 0.277447607131686, 'ACC': np.float64(0.9553125), 'MI': 0.1474820143884892, 'FA': 0.09430716296527995, 'CF': 0.0356584297779168}, batch size: 64, grad_norm: 0.20175880193710327, grad_scale: , lr: 0.00e+00, 
2025-02-15 18:05:24,957 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 18:05:24,957 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 76552, num_updates: 74500, {'loss': 0.08498308062553406, 'DER': 0.1892762144757105, 'ACC': np.float64(0.9648883928571429), 'MI': 0.10849783004339913, 'FA': 0.049839003219935604, 'CF': 0.03093938121237575}, batch size: 64, grad_norm: 0.20175880193710327, grad_scale: , lr: 0.00e+00, 
2025-02-15 18:05:24,958 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 18:05:58,055 (model:925) WARNING: All labels are zero
2025-02-15 18:06:02,258 (model:925) WARNING: All labels are zero
2025-02-15 18:06:02,650 (model:925) WARNING: All labels are zero
2025-02-15 18:07:10,089 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 76552,  validation: loss=0.089, DER=0.2021, ACC=0.9599, MI=0.1072, FA=0.06348, CF=0.03135, over 0.00 frames. 
2025-02-15 18:07:10,090 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 18:07:10,857 (model:925) WARNING: All labels are zero
2025-02-15 18:07:20,283 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 76552,  validation: loss=0.0871, DER=0.2011, ACC=0.961, MI=0.106, FA=0.06458, CF=0.03052, over 0.00 frames. 
2025-02-15 18:07:20,284 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 18:18:10,957 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 77052, num_updates: 75000, {'loss': 0.10436851531267166, 'DER': 0.24417358692740423, 'ACC': np.float64(0.9549553571428571), 'MI': 0.15215644253951247, 'FA': 0.0658987409590142, 'CF': 0.026118403428877578}, batch size: 64, grad_norm: 0.2035847008228302, grad_scale: , lr: 0.00e+00, 
2025-02-15 18:18:10,957 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 18:18:10,958 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 77052, num_updates: 75000, {'loss': 0.09995772689580917, 'DER': 0.24022920952101087, 'ACC': np.float64(0.9577678571428571), 'MI': 0.1413458712900382, 'FA': 0.061122538936232734, 'CF': 0.03776079929473994}, batch size: 64, grad_norm: 0.2035847008228302, grad_scale: , lr: 0.00e+00, 
2025-02-15 18:18:10,958 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 18:18:43,260 (model:925) WARNING: All labels are zero
2025-02-15 18:18:43,654 (model:925) WARNING: All labels are zero
2025-02-15 18:18:50,299 (model:925) WARNING: All labels are zero
2025-02-15 18:19:51,294 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 77052,  validation: loss=0.08937, DER=0.2027, ACC=0.9598, MI=0.1086, FA=0.063, CF=0.03116, over 0.00 frames. 
2025-02-15 18:19:51,294 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 18:20:02,609 (model:925) WARNING: All labels are zero
2025-02-15 18:20:12,607 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 77052,  validation: loss=0.08729, DER=0.2014, ACC=0.961, MI=0.1074, FA=0.06395, CF=0.03006, over 0.00 frames. 
2025-02-15 18:20:12,608 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 18:31:32,071 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 77552, num_updates: 75500, {'loss': 0.09234584867954254, 'DER': 0.23993288590604026, 'ACC': np.float64(0.955044642857143), 'MI': 0.13716442953020133, 'FA': 0.06110178970917226, 'CF': 0.041666666666666664}, batch size: 64, grad_norm: 0.21368816494941711, grad_scale: , lr: 0.00e+00, 
2025-02-15 18:31:32,072 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 18:31:32,072 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 77552, num_updates: 75500, {'loss': 0.09149210155010223, 'DER': 0.2221889055472264, 'ACC': np.float64(0.9622544642857143), 'MI': 0.12383808095952024, 'FA': 0.06701649175412294, 'CF': 0.03133433283358321}, batch size: 64, grad_norm: 0.21368816494941711, grad_scale: , lr: 0.00e+00, 
2025-02-15 18:31:32,073 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 18:32:04,328 (model:925) WARNING: All labels are zero
2025-02-15 18:32:04,724 (model:925) WARNING: All labels are zero
2025-02-15 18:32:11,164 (model:925) WARNING: All labels are zero
2025-02-15 18:33:12,491 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 77552,  validation: loss=0.08862, DER=0.2013, ACC=0.96, MI=0.1073, FA=0.06244, CF=0.03152, over 0.00 frames. 
2025-02-15 18:33:12,492 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 18:33:23,820 (model:925) WARNING: All labels are zero
2025-02-15 18:33:33,260 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 77552,  validation: loss=0.08673, DER=0.2009, ACC=0.961, MI=0.1065, FA=0.06372, CF=0.03077, over 0.00 frames. 
2025-02-15 18:33:33,261 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 18:43:13,991 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-78000.pt
2025-02-15 18:43:14,432 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-15 18:44:21,383 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 78052, num_updates: 76000, {'loss': 0.12308929860591888, 'DER': 0.33509192645883296, 'ACC': np.float64(0.9422767857142857), 'MI': 0.12565947242206235, 'FA': 0.1310951239008793, 'CF': 0.07833733013589128}, batch size: 64, grad_norm: 0.29666557908058167, grad_scale: , lr: 0.00e+00, 
2025-02-15 18:44:21,383 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 18:44:21,394 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 78052, num_updates: 76000, {'loss': 0.10275617241859436, 'DER': 0.2648215128164806, 'ACC': np.float64(0.957388392857143), 'MI': 0.1114955181632332, 'FA': 0.11794307281019029, 'CF': 0.03538292184305709}, batch size: 64, grad_norm: 0.29666557908058167, grad_scale: , lr: 0.00e+00, 
2025-02-15 18:44:21,394 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 18:44:53,638 (model:925) WARNING: All labels are zero
2025-02-15 18:44:54,034 (model:925) WARNING: All labels are zero
2025-02-15 18:45:00,925 (model:925) WARNING: All labels are zero
2025-02-15 18:46:02,419 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 78052,  validation: loss=0.08912, DER=0.202, ACC=0.9599, MI=0.1089, FA=0.06209, CF=0.0311, over 0.00 frames. 
2025-02-15 18:46:02,420 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 18:46:13,804 (model:925) WARNING: All labels are zero
2025-02-15 18:46:23,455 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 78052,  validation: loss=0.08719, DER=0.2011, ACC=0.961, MI=0.108, FA=0.0628, CF=0.0303, over 0.00 frames. 
2025-02-15 18:46:23,455 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 18:48:51,057 (train_accelerate_ddp:713) INFO: end of epoch 19, batch_idx: 4113 batch_idx_train: 78165, {'loss': 0.11213749647140503, 'DER': 0.2900293665221647, 'ACC': np.float64(0.94859375), 'MI': 0.18053419102223464, 'FA': 0.07747168228219829, 'CF': 0.032023493217731784}, batch size: 64, grad_norm: 0.296027809381485, grad_scale: , lr: 0.00e+00, 
2025-02-15 18:48:51,068 (train_accelerate_ddp:713) INFO: end of epoch 19, batch_idx: 4113 batch_idx_train: 78165, {'loss': 0.12456429749727249, 'DER': 0.2478839177750907, 'ACC': np.float64(0.9490401785714286), 'MI': 0.14134085718124412, 'FA': 0.047695821577320975, 'CF': 0.058847239016525596}, batch size: 64, grad_norm: 0.296027809381485, grad_scale: , lr: 0.00e+00, 
2025-02-15 18:48:51,071 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-19.pt
2025-02-15 18:48:51,532 (train_accelerate_ddp:561) INFO:  end of epoch 19, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-19.pt 
2025-02-15 18:48:55,734 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 78166, num_updates: 76000, {'loss': 0.08262129873037338, 'DER': 0.17855080831408776, 'ACC': np.float64(0.9694866071428571), 'MI': 0.11200923787528869, 'FA': 0.04777713625866051, 'CF': 0.018764434180138567}, batch size: 64, grad_norm: 0.23985043168067932, grad_scale: , lr: 0.00e+00, 
2025-02-15 18:48:55,735 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 78166, num_updates: 76000, {'loss': 0.09818127751350403, 'DER': 0.22973571534032186, 'ACC': np.float64(0.9584598214285713), 'MI': 0.11988778975343274, 'FA': 0.06481618189871549, 'CF': 0.04503174368817363}, batch size: 64, grad_norm: 0.23985043168067932, grad_scale: , lr: 0.00e+00, 
2025-02-15 19:00:43,668 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 78666, num_updates: 76500, {'loss': 0.09340406209230423, 'DER': 0.20815117754900578, 'ACC': np.float64(0.9619866071428571), 'MI': 0.11465237625158652, 'FA': 0.06148639120011282, 'CF': 0.032012410097306446}, batch size: 64, grad_norm: 0.24594087898731232, grad_scale: , lr: 0.00e+00, 
2025-02-15 19:00:43,669 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 19:00:43,669 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 78666, num_updates: 76500, {'loss': 0.11355733126401901, 'DER': 0.25325755475464373, 'ACC': np.float64(0.9529241071428571), 'MI': 0.14457998336567784, 'FA': 0.06958691433324092, 'CF': 0.03909065705572498}, batch size: 64, grad_norm: 0.24594087898731232, grad_scale: , lr: 0.00e+00, 
2025-02-15 19:00:43,669 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 19:01:16,421 (model:925) WARNING: All labels are zero
2025-02-15 19:01:22,650 (model:925) WARNING: All labels are zero
2025-02-15 19:01:23,134 (model:925) WARNING: All labels are zero
2025-02-15 19:02:16,911 (model:925) WARNING: All labels are zero
2025-02-15 19:02:24,722 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 78666,  validation: loss=0.08719, DER=0.2016, ACC=0.9609, MI=0.1082, FA=0.06308, CF=0.03027, over 0.00 frames. 
2025-02-15 19:02:24,722 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 19:02:44,492 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 78666,  validation: loss=0.08912, DER=0.2021, ACC=0.9598, MI=0.1088, FA=0.06188, CF=0.03143, over 0.00 frames. 
2025-02-15 19:02:44,492 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 19:13:43,785 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 79166, num_updates: 77000, {'loss': 0.09938876330852509, 'DER': 0.214697599570873, 'ACC': np.float64(0.9597544642857143), 'MI': 0.13423628805149523, 'FA': 0.05337266997452059, 'CF': 0.02708864154485718}, batch size: 64, grad_norm: 0.2768031358718872, grad_scale: , lr: 0.00e+00, 
2025-02-15 19:13:43,785 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 19:13:43,794 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 79166, num_updates: 77000, {'loss': 0.12501297891139984, 'DER': 0.28294460641399416, 'ACC': np.float64(0.9457142857142857), 'MI': 0.11530612244897959, 'FA': 0.09606413994169097, 'CF': 0.07157434402332362}, batch size: 64, grad_norm: 0.2768031358718872, grad_scale: , lr: 0.00e+00, 
2025-02-15 19:13:43,795 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 19:14:16,532 (model:925) WARNING: All labels are zero
2025-02-15 19:14:16,938 (model:925) WARNING: All labels are zero
2025-02-15 19:14:23,546 (model:925) WARNING: All labels are zero
2025-02-15 19:15:25,190 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 79166,  validation: loss=0.08858, DER=0.2012, ACC=0.9599, MI=0.1059, FA=0.06371, CF=0.03166, over 0.00 frames. 
2025-02-15 19:15:25,191 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 19:15:42,342 (model:925) WARNING: All labels are zero
2025-02-15 19:15:51,096 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 79166,  validation: loss=0.08667, DER=0.2003, ACC=0.9611, MI=0.1047, FA=0.06494, CF=0.03068, over 0.00 frames. 
2025-02-15 19:15:51,097 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 19:23:22,172 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-79500.pt
2025-02-15 19:23:22,672 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-15 19:23:22,674 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-15 19:26:58,814 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 79666, num_updates: 77500, {'loss': 0.08035938441753387, 'DER': 0.19281856663260838, 'ACC': np.float64(0.9667857142857144), 'MI': 0.12304773025835644, 'FA': 0.045394832871113705, 'CF': 0.02437600350313823}, batch size: 64, grad_norm: 0.26406022906303406, grad_scale: , lr: 0.00e+00, 
2025-02-15 19:26:58,814 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 19:26:58,825 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 79666, num_updates: 77500, {'loss': 0.14422401785850525, 'DER': 0.34074271263143885, 'ACC': np.float64(0.9326482743214566), 'MI': 0.2075069878876614, 'FA': 0.07267403167842407, 'CF': 0.06056169306535339}, batch size: 64, grad_norm: 0.26406022906303406, grad_scale: , lr: 0.00e+00, 
2025-02-15 19:26:58,825 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 19:27:31,309 (model:925) WARNING: All labels are zero
2025-02-15 19:27:37,761 (model:925) WARNING: All labels are zero
2025-02-15 19:27:38,162 (model:925) WARNING: All labels are zero
2025-02-15 19:28:31,658 (model:925) WARNING: All labels are zero
2025-02-15 19:28:39,486 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 79666,  validation: loss=0.08732, DER=0.2011, ACC=0.961, MI=0.1067, FA=0.06393, CF=0.03039, over 0.00 frames. 
2025-02-15 19:28:39,487 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 19:28:59,921 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 79666,  validation: loss=0.08924, DER=0.2022, ACC=0.9598, MI=0.1078, FA=0.06317, CF=0.0312, over 0.00 frames. 
2025-02-15 19:28:59,922 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 19:39:51,660 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 80166, num_updates: 78000, {'loss': 0.0993008092045784, 'DER': 0.22609060402684564, 'ACC': np.float64(0.9580580357142857), 'MI': 0.11717002237136466, 'FA': 0.07228747203579418, 'CF': 0.0366331096196868}, batch size: 64, grad_norm: 0.23734574019908905, grad_scale: , lr: 0.00e+00, 
2025-02-15 19:39:51,661 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 19:39:51,662 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 80166, num_updates: 78000, {'loss': 0.09384681284427643, 'DER': 0.21730052199850858, 'ACC': np.float64(0.9618080357142857), 'MI': 0.10723340790454884, 'FA': 0.07218493661446682, 'CF': 0.037882177479492914}, batch size: 64, grad_norm: 0.23734574019908905, grad_scale: , lr: 0.00e+00, 
2025-02-15 19:39:51,662 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 19:40:24,278 (model:925) WARNING: All labels are zero
2025-02-15 19:40:24,678 (model:925) WARNING: All labels are zero
2025-02-15 19:40:30,594 (model:925) WARNING: All labels are zero
2025-02-15 19:41:32,658 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 80166,  validation: loss=0.08932, DER=0.2026, ACC=0.9598, MI=0.1072, FA=0.06376, CF=0.03164, over 0.00 frames. 
2025-02-15 19:41:32,658 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 19:41:56,011 (model:925) WARNING: All labels are zero
2025-02-15 19:42:07,327 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 80166,  validation: loss=0.08735, DER=0.2009, ACC=0.961, MI=0.1057, FA=0.06436, CF=0.03084, over 0.00 frames. 
2025-02-15 19:42:07,328 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 19:53:57,784 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 80666, num_updates: 78500, {'loss': 0.09303213655948639, 'DER': 0.2535299654847819, 'ACC': np.float64(0.9565848214285714), 'MI': 0.09899592092877314, 'FA': 0.10291810480075306, 'CF': 0.051615939755255726}, batch size: 64, grad_norm: 0.21712997555732727, grad_scale: , lr: 0.00e+00, 
2025-02-15 19:53:57,784 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 19:53:57,785 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 80666, num_updates: 78500, {'loss': 0.11558975279331207, 'DER': 0.2678939414754774, 'ACC': np.float64(0.9478125), 'MI': 0.15812611622475614, 'FA': 0.056463799972523696, 'CF': 0.05330402527819755}, batch size: 64, grad_norm: 0.21712997555732727, grad_scale: , lr: 0.00e+00, 
2025-02-15 19:53:57,785 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 19:54:30,364 (model:925) WARNING: All labels are zero
2025-02-15 19:54:36,646 (model:925) WARNING: All labels are zero
2025-02-15 19:54:37,076 (model:925) WARNING: All labels are zero
2025-02-15 19:55:30,734 (model:925) WARNING: All labels are zero
2025-02-15 19:55:38,527 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 80666,  validation: loss=0.08727, DER=0.201, ACC=0.961, MI=0.1065, FA=0.06392, CF=0.03054, over 0.00 frames. 
2025-02-15 19:55:38,527 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 19:55:59,372 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 80666,  validation: loss=0.08923, DER=0.2026, ACC=0.9598, MI=0.1079, FA=0.06301, CF=0.03169, over 0.00 frames. 
2025-02-15 19:55:59,372 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 20:03:16,789 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/checkpoint-81000.pt
2025-02-15 20:03:17,371 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-15 20:06:57,965 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 81166, num_updates: 79000, {'loss': 0.11733311414718628, 'DER': 0.2952948365413993, 'ACC': np.float64(0.9488005728607232), 'MI': 0.14482126489459213, 'FA': 0.09624197983501374, 'CF': 0.05423159181179346}, batch size: 64, grad_norm: 0.27536243200302124, grad_scale: , lr: 0.00e+00, 
2025-02-15 20:06:57,966 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 20:06:57,966 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 81166, num_updates: 79000, {'loss': 0.11313764750957489, 'DER': 0.2843164663125524, 'ACC': np.float64(0.94671875), 'MI': 0.15557729941291584, 'FA': 0.07939614201845122, 'CF': 0.04934302488118535}, batch size: 64, grad_norm: 0.27536243200302124, grad_scale: , lr: 0.00e+00, 
2025-02-15 20:06:57,967 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 20:07:31,935 (model:925) WARNING: All labels are zero
2025-02-15 20:07:39,575 (model:925) WARNING: All labels are zero
2025-02-15 20:07:40,207 (model:925) WARNING: All labels are zero
2025-02-15 20:08:30,892 (model:925) WARNING: All labels are zero
2025-02-15 20:08:38,611 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 81166,  validation: loss=0.08632, DER=0.1996, ACC=0.9612, MI=0.1057, FA=0.06336, CF=0.03054, over 0.00 frames. 
2025-02-15 20:08:38,611 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 20:09:09,585 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 81166,  validation: loss=0.08827, DER=0.2009, ACC=0.9601, MI=0.107, FA=0.06251, CF=0.03144, over 0.00 frames. 
2025-02-15 20:09:09,586 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 20:20:12,806 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 81666, num_updates: 79500, {'loss': 0.11322395503520966, 'DER': 0.262123745819398, 'ACC': np.float64(0.9484151785714287), 'MI': 0.145066889632107, 'FA': 0.05713489409141583, 'CF': 0.059921962095875136}, batch size: 64, grad_norm: 0.24593767523765564, grad_scale: , lr: 0.00e+00, 
2025-02-15 20:20:12,807 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 20:20:12,807 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 81666, num_updates: 79500, {'loss': 0.10706252604722977, 'DER': 0.24649108973348052, 'ACC': np.float64(0.9595089285714287), 'MI': 0.12190506229301372, 'FA': 0.08500236555748304, 'CF': 0.039583661882983755}, batch size: 64, grad_norm: 0.24593767523765564, grad_scale: , lr: 0.00e+00, 
2025-02-15 20:20:12,807 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 20:20:46,127 (model:925) WARNING: All labels are zero
2025-02-15 20:20:46,528 (model:925) WARNING: All labels are zero
2025-02-15 20:20:53,341 (model:925) WARNING: All labels are zero
2025-02-15 20:21:54,343 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 81666,  validation: loss=0.08898, DER=0.2021, ACC=0.9599, MI=0.1094, FA=0.06166, CF=0.03099, over 0.00 frames. 
2025-02-15 20:21:54,343 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 20:22:06,497 (model:925) WARNING: All labels are zero
2025-02-15 20:22:16,022 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 81666,  validation: loss=0.08706, DER=0.2008, ACC=0.9611, MI=0.1082, FA=0.06231, CF=0.03022, over 0.00 frames. 
2025-02-15 20:22:16,022 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 20:33:05,788 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 82166, num_updates: 80000, {'loss': 0.12441642582416534, 'DER': 0.2644799054373522, 'ACC': np.float64(0.951138392857143), 'MI': 0.1434692671394799, 'FA': 0.06205673758865248, 'CF': 0.05895390070921986}, batch size: 64, grad_norm: 0.3802228569984436, grad_scale: , lr: 0.00e+00, 
2025-02-15 20:33:05,788 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 20:33:05,794 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 82166, num_updates: 80000, {'loss': 0.15019340813159943, 'DER': 0.3426524304579938, 'ACC': np.float64(0.9350223214285713), 'MI': 0.17856139364990165, 'FA': 0.0977802753582467, 'CF': 0.06631076144984546}, batch size: 64, grad_norm: 0.3802228569984436, grad_scale: , lr: 0.00e+00, 
2025-02-15 20:33:05,794 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-15 20:33:39,256 (model:925) WARNING: All labels are zero
2025-02-15 20:33:54,337 (model:925) WARNING: All labels are zero
2025-02-15 20:33:54,964 (model:925) WARNING: All labels are zero
2025-02-15 20:34:38,983 (model:925) WARNING: All labels are zero
2025-02-15 20:34:46,798 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 82166,  validation: loss=0.08711, DER=0.2006, ACC=0.9611, MI=0.1076, FA=0.06293, CF=0.03004, over 0.00 frames. 
2025-02-15 20:34:46,798 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 20:35:37,693 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 82166,  validation: loss=0.08907, DER=0.2021, ACC=0.9599, MI=0.1088, FA=0.06223, CF=0.03112, over 0.00 frames. 
2025-02-15 20:35:37,694 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6685MB
2025-02-15 20:38:45,610 (train_accelerate_ddp:713) INFO: end of epoch 20, batch_idx: 4113 batch_idx_train: 82279, {'loss': 0.1032743901014328, 'DER': 0.22073921971252566, 'ACC': np.float64(0.9565625), 'MI': 0.10296274567321795, 'FA': 0.05309474919331182, 'CF': 0.0646817248459959}, batch size: 64, grad_norm: 0.2681010961532593, grad_scale: , lr: 0.00e+00, 
2025-02-15 20:38:45,612 (train_accelerate_ddp:1066) INFO: Done!
2025-02-15 20:38:45,621 (train_accelerate_ddp:713) INFO: end of epoch 20, batch_idx: 4113 batch_idx_train: 82279, {'loss': 0.09782764315605164, 'DER': 0.22426946883546856, 'ACC': np.float64(0.9568526785714286), 'MI': 0.11026342306031381, 'FA': 0.0600259104649489, 'CF': 0.053980135310205846}, batch size: 64, grad_norm: 0.2681010961532593, grad_scale: , lr: 0.00e+00, 
2025-02-15 20:38:45,624 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-20.pt
2025-02-15 20:38:46,031 (train_accelerate_ddp:561) INFO:  end of epoch 20, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len4/epoch-20.pt 
2025-02-15 20:38:46,032 (train_accelerate_ddp:1066) INFO: Done!
pgpu27:192869:192937 [1] NCCL INFO [Service thread] Connection closed by localRank 1
[rank0]:[W215 20:38:46.227210964 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
pgpu27:192868:192938 [0] NCCL INFO [Service thread] Connection closed by localRank 0
pgpu27:192869:896074 [1] NCCL INFO comm 0x55557b0f9640 rank 1 nranks 2 cudaDev 1 busId 68000 - Abort COMPLETE
pgpu27:192868:896075 [0] NCCL INFO comm 0x555578f23350 rank 0 nranks 2 cudaDev 0 busId 63000 - Abort COMPLETE
