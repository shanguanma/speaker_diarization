2025-02-06 10:09:54,068 (infer:256) INFO: infer data_cfg: TSVADDataConfig(data_dir='/mntcephfs/lab_data/maduo/datasets/alimeeting', ts_len=6000, rs_len=10, segment_shift=1, spk_path='/mntcephfs/lab_data/maduo/model_hub/ts_vad/spk_embed/alimeeting/SpeakerEmbedding', speech_encoder_type='w2v-bert2', speaker_embedding_name_dir='cam++_zh-cn_200k_feature_dir', speaker_embed_dim=192, noise_ratio=0.8, zero_ratio=0.3, sample_rate=16000, max_num_speaker=7, dataset_name='alimeeting', embed_input=False, embed_len=1, embed_shift=0.4, label_rate=25, random_channel=False, random_mask_speaker_prob=0.0, random_mask_speaker_step=0, musan_path='/mntcephfs/lee_dataset/asr/musan', rir_path='/mntcephfs/lee_dataset/asr/RIRS_NOISES')
2025-02-06 10:09:54,068 (infer:257) INFO: currently, it will infer Eval set.
  0%|          | 0/25 [00:00<?, ?it/s]100%|██████████| 25/25 [00:00<00:00, 433.79it/s]
2025-02-06 10:09:54,133 (ts_vad_dataset:152) INFO: model expect fbank as input , fbank_input should be True !!!
2025-02-06 10:09:54,133 (ts_vad_dataset:160) INFO: loaded sentence=15141, shortest sent=5120.0, longest sent=160000.0, rs_len=10, segment_shift=1,  rir=False, musan=False, noise_ratio=0.8, zero_ratio=0.3 
2025-02-06 10:09:54,330 (infer:279) INFO: Device: cuda:0
2025-02-06 10:09:54,330 (infer:297) INFO: infer model_cfg: TSVADConfig(speech_encoder_path='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/w2v-bert2.0/model.safetensors', speech_encoder_type='w2v-bert2', freeze_speech_encoder_updates=4000, num_attention_head=4, num_transformer_layer=2, transformer_embed_dim=384, transformer_ffn_embed_dim=1536, speaker_embed_dim=192, dropout=0.1, use_spk_embed=True, feature_grad_mult=0.1, whisper_n_mels=80, select_encoder_layer_nums=6, wavlm_fuse_feat_post_norm=False, speech_encoder_config='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/w2v-bert2.0/config.json', single_backend_type='mamba2', multi_backend_type='transformer', d_state=256, expand=4)
Some weights of the model checkpoint at /mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/w2v-bert2.0/model.safetensors were not used when initializing Wav2Vec2BertModel: ['encoder.layers.10.conv_module.depthwise_conv.weight', 'encoder.layers.10.conv_module.depthwise_layer_norm.bias', 'encoder.layers.10.conv_module.depthwise_layer_norm.weight', 'encoder.layers.10.conv_module.layer_norm.bias', 'encoder.layers.10.conv_module.layer_norm.weight', 'encoder.layers.10.conv_module.pointwise_conv1.weight', 'encoder.layers.10.conv_module.pointwise_conv2.weight', 'encoder.layers.10.ffn1.intermediate_dense.bias', 'encoder.layers.10.ffn1.intermediate_dense.weight', 'encoder.layers.10.ffn1.output_dense.bias', 'encoder.layers.10.ffn1.output_dense.weight', 'encoder.layers.10.ffn1_layer_norm.bias', 'encoder.layers.10.ffn1_layer_norm.weight', 'encoder.layers.10.ffn2.intermediate_dense.bias', 'encoder.layers.10.ffn2.intermediate_dense.weight', 'encoder.layers.10.ffn2.output_dense.bias', 'encoder.layers.10.ffn2.output_dense.weight', 'encoder.layers.10.ffn2_layer_norm.bias', 'encoder.layers.10.ffn2_layer_norm.weight', 'encoder.layers.10.final_layer_norm.bias', 'encoder.layers.10.final_layer_norm.weight', 'encoder.layers.10.self_attn.distance_embedding.weight', 'encoder.layers.10.self_attn.linear_k.bias', 'encoder.layers.10.self_attn.linear_k.weight', 'encoder.layers.10.self_attn.linear_out.bias', 'encoder.layers.10.self_attn.linear_out.weight', 'encoder.layers.10.self_attn.linear_q.bias', 'encoder.layers.10.self_attn.linear_q.weight', 'encoder.layers.10.self_attn.linear_v.bias', 'encoder.layers.10.self_attn.linear_v.weight', 'encoder.layers.10.self_attn_layer_norm.bias', 'encoder.layers.10.self_attn_layer_norm.weight', 'encoder.layers.11.conv_module.depthwise_conv.weight', 'encoder.layers.11.conv_module.depthwise_layer_norm.bias', 'encoder.layers.11.conv_module.depthwise_layer_norm.weight', 'encoder.layers.11.conv_module.layer_norm.bias', 'encoder.layers.11.conv_module.layer_norm.weight', 'encoder.layers.11.conv_module.pointwise_conv1.weight', 'encoder.layers.11.conv_module.pointwise_conv2.weight', 'encoder.layers.11.ffn1.intermediate_dense.bias', 'encoder.layers.11.ffn1.intermediate_dense.weight', 'encoder.layers.11.ffn1.output_dense.bias', 'encoder.layers.11.ffn1.output_dense.weight', 'encoder.layers.11.ffn1_layer_norm.bias', 'encoder.layers.11.ffn1_layer_norm.weight', 'encoder.layers.11.ffn2.intermediate_dense.bias', 'encoder.layers.11.ffn2.intermediate_dense.weight', 'encoder.layers.11.ffn2.output_dense.bias', 'encoder.layers.11.ffn2.output_dense.weight', 'encoder.layers.11.ffn2_layer_norm.bias', 'encoder.layers.11.ffn2_layer_norm.weight', 'encoder.layers.11.final_layer_norm.bias', 'encoder.layers.11.final_layer_norm.weight', 'encoder.layers.11.self_attn.distance_embedding.weight', 'encoder.layers.11.self_attn.linear_k.bias', 'encoder.layers.11.self_attn.linear_k.weight', 'encoder.layers.11.self_attn.linear_out.bias', 'encoder.layers.11.self_attn.linear_out.weight', 'encoder.layers.11.self_attn.linear_q.bias', 'encoder.layers.11.self_attn.linear_q.weight', 'encoder.layers.11.self_attn.linear_v.bias', 'encoder.layers.11.self_attn.linear_v.weight', 'encoder.layers.11.self_attn_layer_norm.bias', 'encoder.layers.11.self_attn_layer_norm.weight', 'encoder.layers.12.conv_module.depthwise_conv.weight', 'encoder.layers.12.conv_module.depthwise_layer_norm.bias', 'encoder.layers.12.conv_module.depthwise_layer_norm.weight', 'encoder.layers.12.conv_module.layer_norm.bias', 'encoder.layers.12.conv_module.layer_norm.weight', 'encoder.layers.12.conv_module.pointwise_conv1.weight', 'encoder.layers.12.conv_module.pointwise_conv2.weight', 'encoder.layers.12.ffn1.intermediate_dense.bias', 'encoder.layers.12.ffn1.intermediate_dense.weight', 'encoder.layers.12.ffn1.output_dense.bias', 'encoder.layers.12.ffn1.output_dense.weight', 'encoder.layers.12.ffn1_layer_norm.bias', 'encoder.layers.12.ffn1_layer_norm.weight', 'encoder.layers.12.ffn2.intermediate_dense.bias', 'encoder.layers.12.ffn2.intermediate_dense.weight', 'encoder.layers.12.ffn2.output_dense.bias', 'encoder.layers.12.ffn2.output_dense.weight', 'encoder.layers.12.ffn2_layer_norm.bias', 'encoder.layers.12.ffn2_layer_norm.weight', 'encoder.layers.12.final_layer_norm.bias', 'encoder.layers.12.final_layer_norm.weight', 'encoder.layers.12.self_attn.distance_embedding.weight', 'encoder.layers.12.self_attn.linear_k.bias', 'encoder.layers.12.self_attn.linear_k.weight', 'encoder.layers.12.self_attn.linear_out.bias', 'encoder.layers.12.self_attn.linear_out.weight', 'encoder.layers.12.self_attn.linear_q.bias', 'encoder.layers.12.self_attn.linear_q.weight', 'encoder.layers.12.self_attn.linear_v.bias', 'encoder.layers.12.self_attn.linear_v.weight', 'encoder.layers.12.self_attn_layer_norm.bias', 'encoder.layers.12.self_attn_layer_norm.weight', 'encoder.layers.13.conv_module.depthwise_conv.weight', 'encoder.layers.13.conv_module.depthwise_layer_norm.bias', 'encoder.layers.13.conv_module.depthwise_layer_norm.weight', 'encoder.layers.13.conv_module.layer_norm.bias', 'encoder.layers.13.conv_module.layer_norm.weight', 'encoder.layers.13.conv_module.pointwise_conv1.weight', 'encoder.layers.13.conv_module.pointwise_conv2.weight', 'encoder.layers.13.ffn1.intermediate_dense.bias', 'encoder.layers.13.ffn1.intermediate_dense.weight', 'encoder.layers.13.ffn1.output_dense.bias', 'encoder.layers.13.ffn1.output_dense.weight', 'encoder.layers.13.ffn1_layer_norm.bias', 'encoder.layers.13.ffn1_layer_norm.weight', 'encoder.layers.13.ffn2.intermediate_dense.bias', 'encoder.layers.13.ffn2.intermediate_dense.weight', 'encoder.layers.13.ffn2.output_dense.bias', 'encoder.layers.13.ffn2.output_dense.weight', 'encoder.layers.13.ffn2_layer_norm.bias', 'encoder.layers.13.ffn2_layer_norm.weight', 'encoder.layers.13.final_layer_norm.bias', 'encoder.layers.13.final_layer_norm.weight', 'encoder.layers.13.self_attn.distance_embedding.weight', 'encoder.layers.13.self_attn.linear_k.bias', 'encoder.layers.13.self_attn.linear_k.weight', 'encoder.layers.13.self_attn.linear_out.bias', 'encoder.layers.13.self_attn.linear_out.weight', 'encoder.layers.13.self_attn.linear_q.bias', 'encoder.layers.13.self_attn.linear_q.weight', 'encoder.layers.13.self_attn.linear_v.bias', 'encoder.layers.13.self_attn.linear_v.weight', 'encoder.layers.13.self_attn_layer_norm.bias', 'encoder.layers.13.self_attn_layer_norm.weight', 'encoder.layers.14.conv_module.depthwise_conv.weight', 'encoder.layers.14.conv_module.depthwise_layer_norm.bias', 'encoder.layers.14.conv_module.depthwise_layer_norm.weight', 'encoder.layers.14.conv_module.layer_norm.bias', 'encoder.layers.14.conv_module.layer_norm.weight', 'encoder.layers.14.conv_module.pointwise_conv1.weight', 'encoder.layers.14.conv_module.pointwise_conv2.weight', 'encoder.layers.14.ffn1.intermediate_dense.bias', 'encoder.layers.14.ffn1.intermediate_dense.weight', 'encoder.layers.14.ffn1.output_dense.bias', 'encoder.layers.14.ffn1.output_dense.weight', 'encoder.layers.14.ffn1_layer_norm.bias', 'encoder.layers.14.ffn1_layer_norm.weight', 'encoder.layers.14.ffn2.intermediate_dense.bias', 'encoder.layers.14.ffn2.intermediate_dense.weight', 'encoder.layers.14.ffn2.output_dense.bias', 'encoder.layers.14.ffn2.output_dense.weight', 'encoder.layers.14.ffn2_layer_norm.bias', 'encoder.layers.14.ffn2_layer_norm.weight', 'encoder.layers.14.final_layer_norm.bias', 'encoder.layers.14.final_layer_norm.weight', 'encoder.layers.14.self_attn.distance_embedding.weight', 'encoder.layers.14.self_attn.linear_k.bias', 'encoder.layers.14.self_attn.linear_k.weight', 'encoder.layers.14.self_attn.linear_out.bias', 'encoder.layers.14.self_attn.linear_out.weight', 'encoder.layers.14.self_attn.linear_q.bias', 'encoder.layers.14.self_attn.linear_q.weight', 'encoder.layers.14.self_attn.linear_v.bias', 'encoder.layers.14.self_attn.linear_v.weight', 'encoder.layers.14.self_attn_layer_norm.bias', 'encoder.layers.14.self_attn_layer_norm.weight', 'encoder.layers.15.conv_module.depthwise_conv.weight', 'encoder.layers.15.conv_module.depthwise_layer_norm.bias', 'encoder.layers.15.conv_module.depthwise_layer_norm.weight', 'encoder.layers.15.conv_module.layer_norm.bias', 'encoder.layers.15.conv_module.layer_norm.weight', 'encoder.layers.15.conv_module.pointwise_conv1.weight', 'encoder.layers.15.conv_module.pointwise_conv2.weight', 'encoder.layers.15.ffn1.intermediate_dense.bias', 'encoder.layers.15.ffn1.intermediate_dense.weight', 'encoder.layers.15.ffn1.output_dense.bias', 'encoder.layers.15.ffn1.output_dense.weight', 'encoder.layers.15.ffn1_layer_norm.bias', 'encoder.layers.15.ffn1_layer_norm.weight', 'encoder.layers.15.ffn2.intermediate_dense.bias', 'encoder.layers.15.ffn2.intermediate_dense.weight', 'encoder.layers.15.ffn2.output_dense.bias', 'encoder.layers.15.ffn2.output_dense.weight', 'encoder.layers.15.ffn2_layer_norm.bias', 'encoder.layers.15.ffn2_layer_norm.weight', 'encoder.layers.15.final_layer_norm.bias', 'encoder.layers.15.final_layer_norm.weight', 'encoder.layers.15.self_attn.distance_embedding.weight', 'encoder.layers.15.self_attn.linear_k.bias', 'encoder.layers.15.self_attn.linear_k.weight', 'encoder.layers.15.self_attn.linear_out.bias', 'encoder.layers.15.self_attn.linear_out.weight', 'encoder.layers.15.self_attn.linear_q.bias', 'encoder.layers.15.self_attn.linear_q.weight', 'encoder.layers.15.self_attn.linear_v.bias', 'encoder.layers.15.self_attn.linear_v.weight', 'encoder.layers.15.self_attn_layer_norm.bias', 'encoder.layers.15.self_attn_layer_norm.weight', 'encoder.layers.16.conv_module.depthwise_conv.weight', 'encoder.layers.16.conv_module.depthwise_layer_norm.bias', 'encoder.layers.16.conv_module.depthwise_layer_norm.weight', 'encoder.layers.16.conv_module.layer_norm.bias', 'encoder.layers.16.conv_module.layer_norm.weight', 'encoder.layers.16.conv_module.pointwise_conv1.weight', 'encoder.layers.16.conv_module.pointwise_conv2.weight', 'encoder.layers.16.ffn1.intermediate_dense.bias', 'encoder.layers.16.ffn1.intermediate_dense.weight', 'encoder.layers.16.ffn1.output_dense.bias', 'encoder.layers.16.ffn1.output_dense.weight', 'encoder.layers.16.ffn1_layer_norm.bias', 'encoder.layers.16.ffn1_layer_norm.weight', 'encoder.layers.16.ffn2.intermediate_dense.bias', 'encoder.layers.16.ffn2.intermediate_dense.weight', 'encoder.layers.16.ffn2.output_dense.bias', 'encoder.layers.16.ffn2.output_dense.weight', 'encoder.layers.16.ffn2_layer_norm.bias', 'encoder.layers.16.ffn2_layer_norm.weight', 'encoder.layers.16.final_layer_norm.bias', 'encoder.layers.16.final_layer_norm.weight', 'encoder.layers.16.self_attn.distance_embedding.weight', 'encoder.layers.16.self_attn.linear_k.bias', 'encoder.layers.16.self_attn.linear_k.weight', 'encoder.layers.16.self_attn.linear_out.bias', 'encoder.layers.16.self_attn.linear_out.weight', 'encoder.layers.16.self_attn.linear_q.bias', 'encoder.layers.16.self_attn.linear_q.weight', 'encoder.layers.16.self_attn.linear_v.bias', 'encoder.layers.16.self_attn.linear_v.weight', 'encoder.layers.16.self_attn_layer_norm.bias', 'encoder.layers.16.self_attn_layer_norm.weight', 'encoder.layers.17.conv_module.depthwise_conv.weight', 'encoder.layers.17.conv_module.depthwise_layer_norm.bias', 'encoder.layers.17.conv_module.depthwise_layer_norm.weight', 'encoder.layers.17.conv_module.layer_norm.bias', 'encoder.layers.17.conv_module.layer_norm.weight', 'encoder.layers.17.conv_module.pointwise_conv1.weight', 'encoder.layers.17.conv_module.pointwise_conv2.weight', 'encoder.layers.17.ffn1.intermediate_dense.bias', 'encoder.layers.17.ffn1.intermediate_dense.weight', 'encoder.layers.17.ffn1.output_dense.bias', 'encoder.layers.17.ffn1.output_dense.weight', 'encoder.layers.17.ffn1_layer_norm.bias', 'encoder.layers.17.ffn1_layer_norm.weight', 'encoder.layers.17.ffn2.intermediate_dense.bias', 'encoder.layers.17.ffn2.intermediate_dense.weight', 'encoder.layers.17.ffn2.output_dense.bias', 'encoder.layers.17.ffn2.output_dense.weight', 'encoder.layers.17.ffn2_layer_norm.bias', 'encoder.layers.17.ffn2_layer_norm.weight', 'encoder.layers.17.final_layer_norm.bias', 'encoder.layers.17.final_layer_norm.weight', 'encoder.layers.17.self_attn.distance_embedding.weight', 'encoder.layers.17.self_attn.linear_k.bias', 'encoder.layers.17.self_attn.linear_k.weight', 'encoder.layers.17.self_attn.linear_out.bias', 'encoder.layers.17.self_attn.linear_out.weight', 'encoder.layers.17.self_attn.linear_q.bias', 'encoder.layers.17.self_attn.linear_q.weight', 'encoder.layers.17.self_attn.linear_v.bias', 'encoder.layers.17.self_attn.linear_v.weight', 'encoder.layers.17.self_attn_layer_norm.bias', 'encoder.layers.17.self_attn_layer_norm.weight', 'encoder.layers.18.conv_module.depthwise_conv.weight', 'encoder.layers.18.conv_module.depthwise_layer_norm.bias', 'encoder.layers.18.conv_module.depthwise_layer_norm.weight', 'encoder.layers.18.conv_module.layer_norm.bias', 'encoder.layers.18.conv_module.layer_norm.weight', 'encoder.layers.18.conv_module.pointwise_conv1.weight', 'encoder.layers.18.conv_module.pointwise_conv2.weight', 'encoder.layers.18.ffn1.intermediate_dense.bias', 'encoder.layers.18.ffn1.intermediate_dense.weight', 'encoder.layers.18.ffn1.output_dense.bias', 'encoder.layers.18.ffn1.output_dense.weight', 'encoder.layers.18.ffn1_layer_norm.bias', 'encoder.layers.18.ffn1_layer_norm.weight', 'encoder.layers.18.ffn2.intermediate_dense.bias', 'encoder.layers.18.ffn2.intermediate_dense.weight', 'encoder.layers.18.ffn2.output_dense.bias', 'encoder.layers.18.ffn2.output_dense.weight', 'encoder.layers.18.ffn2_layer_norm.bias', 'encoder.layers.18.ffn2_layer_norm.weight', 'encoder.layers.18.final_layer_norm.bias', 'encoder.layers.18.final_layer_norm.weight', 'encoder.layers.18.self_attn.distance_embedding.weight', 'encoder.layers.18.self_attn.linear_k.bias', 'encoder.layers.18.self_attn.linear_k.weight', 'encoder.layers.18.self_attn.linear_out.bias', 'encoder.layers.18.self_attn.linear_out.weight', 'encoder.layers.18.self_attn.linear_q.bias', 'encoder.layers.18.self_attn.linear_q.weight', 'encoder.layers.18.self_attn.linear_v.bias', 'encoder.layers.18.self_attn.linear_v.weight', 'encoder.layers.18.self_attn_layer_norm.bias', 'encoder.layers.18.self_attn_layer_norm.weight', 'encoder.layers.19.conv_module.depthwise_conv.weight', 'encoder.layers.19.conv_module.depthwise_layer_norm.bias', 'encoder.layers.19.conv_module.depthwise_layer_norm.weight', 'encoder.layers.19.conv_module.layer_norm.bias', 'encoder.layers.19.conv_module.layer_norm.weight', 'encoder.layers.19.conv_module.pointwise_conv1.weight', 'encoder.layers.19.conv_module.pointwise_conv2.weight', 'encoder.layers.19.ffn1.intermediate_dense.bias', 'encoder.layers.19.ffn1.intermediate_dense.weight', 'encoder.layers.19.ffn1.output_dense.bias', 'encoder.layers.19.ffn1.output_dense.weight', 'encoder.layers.19.ffn1_layer_norm.bias', 'encoder.layers.19.ffn1_layer_norm.weight', 'encoder.layers.19.ffn2.intermediate_dense.bias', 'encoder.layers.19.ffn2.intermediate_dense.weight', 'encoder.layers.19.ffn2.output_dense.bias', 'encoder.layers.19.ffn2.output_dense.weight', 'encoder.layers.19.ffn2_layer_norm.bias', 'encoder.layers.19.ffn2_layer_norm.weight', 'encoder.layers.19.final_layer_norm.bias', 'encoder.layers.19.final_layer_norm.weight', 'encoder.layers.19.self_attn.distance_embedding.weight', 'encoder.layers.19.self_attn.linear_k.bias', 'encoder.layers.19.self_attn.linear_k.weight', 'encoder.layers.19.self_attn.linear_out.bias', 'encoder.layers.19.self_attn.linear_out.weight', 'encoder.layers.19.self_attn.linear_q.bias', 'encoder.layers.19.self_attn.linear_q.weight', 'encoder.layers.19.self_attn.linear_v.bias', 'encoder.layers.19.self_attn.linear_v.weight', 'encoder.layers.19.self_attn_layer_norm.bias', 'encoder.layers.19.self_attn_layer_norm.weight', 'encoder.layers.20.conv_module.depthwise_conv.weight', 'encoder.layers.20.conv_module.depthwise_layer_norm.bias', 'encoder.layers.20.conv_module.depthwise_layer_norm.weight', 'encoder.layers.20.conv_module.layer_norm.bias', 'encoder.layers.20.conv_module.layer_norm.weight', 'encoder.layers.20.conv_module.pointwise_conv1.weight', 'encoder.layers.20.conv_module.pointwise_conv2.weight', 'encoder.layers.20.ffn1.intermediate_dense.bias', 'encoder.layers.20.ffn1.intermediate_dense.weight', 'encoder.layers.20.ffn1.output_dense.bias', 'encoder.layers.20.ffn1.output_dense.weight', 'encoder.layers.20.ffn1_layer_norm.bias', 'encoder.layers.20.ffn1_layer_norm.weight', 'encoder.layers.20.ffn2.intermediate_dense.bias', 'encoder.layers.20.ffn2.intermediate_dense.weight', 'encoder.layers.20.ffn2.output_dense.bias', 'encoder.layers.20.ffn2.output_dense.weight', 'encoder.layers.20.ffn2_layer_norm.bias', 'encoder.layers.20.ffn2_layer_norm.weight', 'encoder.layers.20.final_layer_norm.bias', 'encoder.layers.20.final_layer_norm.weight', 'encoder.layers.20.self_attn.distance_embedding.weight', 'encoder.layers.20.self_attn.linear_k.bias', 'encoder.layers.20.self_attn.linear_k.weight', 'encoder.layers.20.self_attn.linear_out.bias', 'encoder.layers.20.self_attn.linear_out.weight', 'encoder.layers.20.self_attn.linear_q.bias', 'encoder.layers.20.self_attn.linear_q.weight', 'encoder.layers.20.self_attn.linear_v.bias', 'encoder.layers.20.self_attn.linear_v.weight', 'encoder.layers.20.self_attn_layer_norm.bias', 'encoder.layers.20.self_attn_layer_norm.weight', 'encoder.layers.21.conv_module.depthwise_conv.weight', 'encoder.layers.21.conv_module.depthwise_layer_norm.bias', 'encoder.layers.21.conv_module.depthwise_layer_norm.weight', 'encoder.layers.21.conv_module.layer_norm.bias', 'encoder.layers.21.conv_module.layer_norm.weight', 'encoder.layers.21.conv_module.pointwise_conv1.weight', 'encoder.layers.21.conv_module.pointwise_conv2.weight', 'encoder.layers.21.ffn1.intermediate_dense.bias', 'encoder.layers.21.ffn1.intermediate_dense.weight', 'encoder.layers.21.ffn1.output_dense.bias', 'encoder.layers.21.ffn1.output_dense.weight', 'encoder.layers.21.ffn1_layer_norm.bias', 'encoder.layers.21.ffn1_layer_norm.weight', 'encoder.layers.21.ffn2.intermediate_dense.bias', 'encoder.layers.21.ffn2.intermediate_dense.weight', 'encoder.layers.21.ffn2.output_dense.bias', 'encoder.layers.21.ffn2.output_dense.weight', 'encoder.layers.21.ffn2_layer_norm.bias', 'encoder.layers.21.ffn2_layer_norm.weight', 'encoder.layers.21.final_layer_norm.bias', 'encoder.layers.21.final_layer_norm.weight', 'encoder.layers.21.self_attn.distance_embedding.weight', 'encoder.layers.21.self_attn.linear_k.bias', 'encoder.layers.21.self_attn.linear_k.weight', 'encoder.layers.21.self_attn.linear_out.bias', 'encoder.layers.21.self_attn.linear_out.weight', 'encoder.layers.21.self_attn.linear_q.bias', 'encoder.layers.21.self_attn.linear_q.weight', 'encoder.layers.21.self_attn.linear_v.bias', 'encoder.layers.21.self_attn.linear_v.weight', 'encoder.layers.21.self_attn_layer_norm.bias', 'encoder.layers.21.self_attn_layer_norm.weight', 'encoder.layers.22.conv_module.depthwise_conv.weight', 'encoder.layers.22.conv_module.depthwise_layer_norm.bias', 'encoder.layers.22.conv_module.depthwise_layer_norm.weight', 'encoder.layers.22.conv_module.layer_norm.bias', 'encoder.layers.22.conv_module.layer_norm.weight', 'encoder.layers.22.conv_module.pointwise_conv1.weight', 'encoder.layers.22.conv_module.pointwise_conv2.weight', 'encoder.layers.22.ffn1.intermediate_dense.bias', 'encoder.layers.22.ffn1.intermediate_dense.weight', 'encoder.layers.22.ffn1.output_dense.bias', 'encoder.layers.22.ffn1.output_dense.weight', 'encoder.layers.22.ffn1_layer_norm.bias', 'encoder.layers.22.ffn1_layer_norm.weight', 'encoder.layers.22.ffn2.intermediate_dense.bias', 'encoder.layers.22.ffn2.intermediate_dense.weight', 'encoder.layers.22.ffn2.output_dense.bias', 'encoder.layers.22.ffn2.output_dense.weight', 'encoder.layers.22.ffn2_layer_norm.bias', 'encoder.layers.22.ffn2_layer_norm.weight', 'encoder.layers.22.final_layer_norm.bias', 'encoder.layers.22.final_layer_norm.weight', 'encoder.layers.22.self_attn.distance_embedding.weight', 'encoder.layers.22.self_attn.linear_k.bias', 'encoder.layers.22.self_attn.linear_k.weight', 'encoder.layers.22.self_attn.linear_out.bias', 'encoder.layers.22.self_attn.linear_out.weight', 'encoder.layers.22.self_attn.linear_q.bias', 'encoder.layers.22.self_attn.linear_q.weight', 'encoder.layers.22.self_attn.linear_v.bias', 'encoder.layers.22.self_attn.linear_v.weight', 'encoder.layers.22.self_attn_layer_norm.bias', 'encoder.layers.22.self_attn_layer_norm.weight', 'encoder.layers.23.conv_module.depthwise_conv.weight', 'encoder.layers.23.conv_module.depthwise_layer_norm.bias', 'encoder.layers.23.conv_module.depthwise_layer_norm.weight', 'encoder.layers.23.conv_module.layer_norm.bias', 'encoder.layers.23.conv_module.layer_norm.weight', 'encoder.layers.23.conv_module.pointwise_conv1.weight', 'encoder.layers.23.conv_module.pointwise_conv2.weight', 'encoder.layers.23.ffn1.intermediate_dense.bias', 'encoder.layers.23.ffn1.intermediate_dense.weight', 'encoder.layers.23.ffn1.output_dense.bias', 'encoder.layers.23.ffn1.output_dense.weight', 'encoder.layers.23.ffn1_layer_norm.bias', 'encoder.layers.23.ffn1_layer_norm.weight', 'encoder.layers.23.ffn2.intermediate_dense.bias', 'encoder.layers.23.ffn2.intermediate_dense.weight', 'encoder.layers.23.ffn2.output_dense.bias', 'encoder.layers.23.ffn2.output_dense.weight', 'encoder.layers.23.ffn2_layer_norm.bias', 'encoder.layers.23.ffn2_layer_norm.weight', 'encoder.layers.23.final_layer_norm.bias', 'encoder.layers.23.final_layer_norm.weight', 'encoder.layers.23.self_attn.distance_embedding.weight', 'encoder.layers.23.self_attn.linear_k.bias', 'encoder.layers.23.self_attn.linear_k.weight', 'encoder.layers.23.self_attn.linear_out.bias', 'encoder.layers.23.self_attn.linear_out.weight', 'encoder.layers.23.self_attn.linear_q.bias', 'encoder.layers.23.self_attn.linear_q.weight', 'encoder.layers.23.self_attn.linear_v.bias', 'encoder.layers.23.self_attn.linear_v.weight', 'encoder.layers.23.self_attn_layer_norm.bias', 'encoder.layers.23.self_attn_layer_norm.weight', 'encoder.layers.6.conv_module.depthwise_conv.weight', 'encoder.layers.6.conv_module.depthwise_layer_norm.bias', 'encoder.layers.6.conv_module.depthwise_layer_norm.weight', 'encoder.layers.6.conv_module.layer_norm.bias', 'encoder.layers.6.conv_module.layer_norm.weight', 'encoder.layers.6.conv_module.pointwise_conv1.weight', 'encoder.layers.6.conv_module.pointwise_conv2.weight', 'encoder.layers.6.ffn1.intermediate_dense.bias', 'encoder.layers.6.ffn1.intermediate_dense.weight', 'encoder.layers.6.ffn1.output_dense.bias', 'encoder.layers.6.ffn1.output_dense.weight', 'encoder.layers.6.ffn1_layer_norm.bias', 'encoder.layers.6.ffn1_layer_norm.weight', 'encoder.layers.6.ffn2.intermediate_dense.bias', 'encoder.layers.6.ffn2.intermediate_dense.weight', 'encoder.layers.6.ffn2.output_dense.bias', 'encoder.layers.6.ffn2.output_dense.weight', 'encoder.layers.6.ffn2_layer_norm.bias', 'encoder.layers.6.ffn2_layer_norm.weight', 'encoder.layers.6.final_layer_norm.bias', 'encoder.layers.6.final_layer_norm.weight', 'encoder.layers.6.self_attn.distance_embedding.weight', 'encoder.layers.6.self_attn.linear_k.bias', 'encoder.layers.6.self_attn.linear_k.weight', 'encoder.layers.6.self_attn.linear_out.bias', 'encoder.layers.6.self_attn.linear_out.weight', 'encoder.layers.6.self_attn.linear_q.bias', 'encoder.layers.6.self_attn.linear_q.weight', 'encoder.layers.6.self_attn.linear_v.bias', 'encoder.layers.6.self_attn.linear_v.weight', 'encoder.layers.6.self_attn_layer_norm.bias', 'encoder.layers.6.self_attn_layer_norm.weight', 'encoder.layers.7.conv_module.depthwise_conv.weight', 'encoder.layers.7.conv_module.depthwise_layer_norm.bias', 'encoder.layers.7.conv_module.depthwise_layer_norm.weight', 'encoder.layers.7.conv_module.layer_norm.bias', 'encoder.layers.7.conv_module.layer_norm.weight', 'encoder.layers.7.conv_module.pointwise_conv1.weight', 'encoder.layers.7.conv_module.pointwise_conv2.weight', 'encoder.layers.7.ffn1.intermediate_dense.bias', 'encoder.layers.7.ffn1.intermediate_dense.weight', 'encoder.layers.7.ffn1.output_dense.bias', 'encoder.layers.7.ffn1.output_dense.weight', 'encoder.layers.7.ffn1_layer_norm.bias', 'encoder.layers.7.ffn1_layer_norm.weight', 'encoder.layers.7.ffn2.intermediate_dense.bias', 'encoder.layers.7.ffn2.intermediate_dense.weight', 'encoder.layers.7.ffn2.output_dense.bias', 'encoder.layers.7.ffn2.output_dense.weight', 'encoder.layers.7.ffn2_layer_norm.bias', 'encoder.layers.7.ffn2_layer_norm.weight', 'encoder.layers.7.final_layer_norm.bias', 'encoder.layers.7.final_layer_norm.weight', 'encoder.layers.7.self_attn.distance_embedding.weight', 'encoder.layers.7.self_attn.linear_k.bias', 'encoder.layers.7.self_attn.linear_k.weight', 'encoder.layers.7.self_attn.linear_out.bias', 'encoder.layers.7.self_attn.linear_out.weight', 'encoder.layers.7.self_attn.linear_q.bias', 'encoder.layers.7.self_attn.linear_q.weight', 'encoder.layers.7.self_attn.linear_v.bias', 'encoder.layers.7.self_attn.linear_v.weight', 'encoder.layers.7.self_attn_layer_norm.bias', 'encoder.layers.7.self_attn_layer_norm.weight', 'encoder.layers.8.conv_module.depthwise_conv.weight', 'encoder.layers.8.conv_module.depthwise_layer_norm.bias', 'encoder.layers.8.conv_module.depthwise_layer_norm.weight', 'encoder.layers.8.conv_module.layer_norm.bias', 'encoder.layers.8.conv_module.layer_norm.weight', 'encoder.layers.8.conv_module.pointwise_conv1.weight', 'encoder.layers.8.conv_module.pointwise_conv2.weight', 'encoder.layers.8.ffn1.intermediate_dense.bias', 'encoder.layers.8.ffn1.intermediate_dense.weight', 'encoder.layers.8.ffn1.output_dense.bias', 'encoder.layers.8.ffn1.output_dense.weight', 'encoder.layers.8.ffn1_layer_norm.bias', 'encoder.layers.8.ffn1_layer_norm.weight', 'encoder.layers.8.ffn2.intermediate_dense.bias', 'encoder.layers.8.ffn2.intermediate_dense.weight', 'encoder.layers.8.ffn2.output_dense.bias', 'encoder.layers.8.ffn2.output_dense.weight', 'encoder.layers.8.ffn2_layer_norm.bias', 'encoder.layers.8.ffn2_layer_norm.weight', 'encoder.layers.8.final_layer_norm.bias', 'encoder.layers.8.final_layer_norm.weight', 'encoder.layers.8.self_attn.distance_embedding.weight', 'encoder.layers.8.self_attn.linear_k.bias', 'encoder.layers.8.self_attn.linear_k.weight', 'encoder.layers.8.self_attn.linear_out.bias', 'encoder.layers.8.self_attn.linear_out.weight', 'encoder.layers.8.self_attn.linear_q.bias', 'encoder.layers.8.self_attn.linear_q.weight', 'encoder.layers.8.self_attn.linear_v.bias', 'encoder.layers.8.self_attn.linear_v.weight', 'encoder.layers.8.self_attn_layer_norm.bias', 'encoder.layers.8.self_attn_layer_norm.weight', 'encoder.layers.9.conv_module.depthwise_conv.weight', 'encoder.layers.9.conv_module.depthwise_layer_norm.bias', 'encoder.layers.9.conv_module.depthwise_layer_norm.weight', 'encoder.layers.9.conv_module.layer_norm.bias', 'encoder.layers.9.conv_module.layer_norm.weight', 'encoder.layers.9.conv_module.pointwise_conv1.weight', 'encoder.layers.9.conv_module.pointwise_conv2.weight', 'encoder.layers.9.ffn1.intermediate_dense.bias', 'encoder.layers.9.ffn1.intermediate_dense.weight', 'encoder.layers.9.ffn1.output_dense.bias', 'encoder.layers.9.ffn1.output_dense.weight', 'encoder.layers.9.ffn1_layer_norm.bias', 'encoder.layers.9.ffn1_layer_norm.weight', 'encoder.layers.9.ffn2.intermediate_dense.bias', 'encoder.layers.9.ffn2.intermediate_dense.weight', 'encoder.layers.9.ffn2.output_dense.bias', 'encoder.layers.9.ffn2.output_dense.weight', 'encoder.layers.9.ffn2_layer_norm.bias', 'encoder.layers.9.ffn2_layer_norm.weight', 'encoder.layers.9.final_layer_norm.bias', 'encoder.layers.9.final_layer_norm.weight', 'encoder.layers.9.self_attn.distance_embedding.weight', 'encoder.layers.9.self_attn.linear_k.bias', 'encoder.layers.9.self_attn.linear_k.weight', 'encoder.layers.9.self_attn.linear_out.bias', 'encoder.layers.9.self_attn.linear_out.weight', 'encoder.layers.9.self_attn.linear_q.bias', 'encoder.layers.9.self_attn.linear_q.weight', 'encoder.layers.9.self_attn.linear_v.bias', 'encoder.layers.9.self_attn.linear_v.weight', 'encoder.layers.9.self_attn_layer_norm.bias', 'encoder.layers.9.self_attn_layer_norm.weight']
- This IS expected if you are initializing Wav2Vec2BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing Wav2Vec2BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
2025-02-06 10:09:55,204 (infer:201) INFO: params.model_file: /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_w2v-bert2_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/best-valid-der.pt
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py:203: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  torch.load(params.model_file, map_location=device)["model"]
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/ts_vad_dataset.py:398: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  feature = torch.load(path, map_location="cpu")
2025-02-06 10:15:32,824 (infer:89) INFO: frame_len: 0.04!!
self.wavlm_fuse_feat_post_norm: False
Model DER:  1.0
Model ACC:  0.8314988093552543
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:23,  1.03it/s]  8%|▊         | 2/25 [00:01<00:14,  1.56it/s] 12%|█▏        | 3/25 [00:01<00:11,  1.86it/s] 16%|█▌        | 4/25 [00:02<00:10,  2.03it/s] 20%|██        | 5/25 [00:02<00:10,  2.00it/s] 24%|██▍       | 6/25 [00:03<00:09,  2.00it/s] 28%|██▊       | 7/25 [00:03<00:08,  2.00it/s] 32%|███▏      | 8/25 [00:04<00:08,  2.01it/s] 36%|███▌      | 9/25 [00:04<00:07,  2.02it/s] 40%|████      | 10/25 [00:05<00:07,  2.02it/s] 44%|████▍     | 11/25 [00:06<00:08,  1.59it/s] 48%|████▊     | 12/25 [00:06<00:07,  1.66it/s] 52%|█████▏    | 13/25 [00:07<00:07,  1.71it/s] 56%|█████▌    | 14/25 [00:07<00:06,  1.74it/s] 60%|██████    | 15/25 [00:08<00:05,  1.83it/s] 64%|██████▍   | 16/25 [00:08<00:04,  1.88it/s] 68%|██████▊   | 17/25 [00:09<00:04,  2.00it/s] 72%|███████▏  | 18/25 [00:09<00:03,  2.11it/s] 76%|███████▌  | 19/25 [00:10<00:02,  2.08it/s] 80%|████████  | 20/25 [00:10<00:02,  1.67it/s] 84%|████████▍ | 21/25 [00:11<00:02,  1.77it/s] 88%|████████▊ | 22/25 [00:11<00:01,  1.84it/s] 92%|█████████▏| 23/25 [00:12<00:01,  1.80it/s] 96%|█████████▌| 24/25 [00:13<00:00,  1.78it/s]100%|██████████| 25/25 [00:13<00:00,  1.75it/s]100%|██████████| 25/25 [00:13<00:00,  1.82it/s]
Eval for threshold 0.2 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.3 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.35 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.4 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.45 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.5 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.55 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.6 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.7 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.8 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


2025-02-06 10:15:53,768 (infer:256) INFO: infer data_cfg: TSVADDataConfig(data_dir='/mntcephfs/lab_data/maduo/datasets/alimeeting', ts_len=6000, rs_len=10, segment_shift=1, spk_path='/mntcephfs/lab_data/maduo/model_hub/ts_vad/spk_embed/alimeeting/SpeakerEmbedding', speech_encoder_type='w2v-bert2', speaker_embedding_name_dir='cam++_zh-cn_200k_feature_dir', speaker_embed_dim=192, noise_ratio=0.8, zero_ratio=0.3, sample_rate=16000, max_num_speaker=7, dataset_name='alimeeting', embed_input=False, embed_len=1, embed_shift=0.4, label_rate=25, random_channel=False, random_mask_speaker_prob=0.0, random_mask_speaker_step=0, musan_path='/mntcephfs/lee_dataset/asr/musan', rir_path='/mntcephfs/lee_dataset/asr/RIRS_NOISES')
2025-02-06 10:15:53,768 (infer:257) INFO: currently, it will infer Test set.
  0%|          | 0/60 [00:00<?, ?it/s] 70%|███████   | 42/60 [00:00<00:00, 416.03it/s]100%|██████████| 60/60 [00:00<00:00, 416.64it/s]
2025-02-06 10:15:53,925 (ts_vad_dataset:152) INFO: model expect fbank as input , fbank_input should be True !!!
2025-02-06 10:15:53,926 (ts_vad_dataset:160) INFO: loaded sentence=38807, shortest sent=640.0, longest sent=160000.0, rs_len=10, segment_shift=1,  rir=False, musan=False, noise_ratio=0.8, zero_ratio=0.3 
2025-02-06 10:15:53,995 (infer:279) INFO: Device: cuda:0
2025-02-06 10:15:53,995 (infer:297) INFO: infer model_cfg: TSVADConfig(speech_encoder_path='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/w2v-bert2.0/model.safetensors', speech_encoder_type='w2v-bert2', freeze_speech_encoder_updates=4000, num_attention_head=4, num_transformer_layer=2, transformer_embed_dim=384, transformer_ffn_embed_dim=1536, speaker_embed_dim=192, dropout=0.1, use_spk_embed=True, feature_grad_mult=0.1, whisper_n_mels=80, select_encoder_layer_nums=6, wavlm_fuse_feat_post_norm=False, speech_encoder_config='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/w2v-bert2.0/config.json', single_backend_type='mamba2', multi_backend_type='transformer', d_state=256, expand=4)
Some weights of the model checkpoint at /mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/w2v-bert2.0/model.safetensors were not used when initializing Wav2Vec2BertModel: ['encoder.layers.10.conv_module.depthwise_conv.weight', 'encoder.layers.10.conv_module.depthwise_layer_norm.bias', 'encoder.layers.10.conv_module.depthwise_layer_norm.weight', 'encoder.layers.10.conv_module.layer_norm.bias', 'encoder.layers.10.conv_module.layer_norm.weight', 'encoder.layers.10.conv_module.pointwise_conv1.weight', 'encoder.layers.10.conv_module.pointwise_conv2.weight', 'encoder.layers.10.ffn1.intermediate_dense.bias', 'encoder.layers.10.ffn1.intermediate_dense.weight', 'encoder.layers.10.ffn1.output_dense.bias', 'encoder.layers.10.ffn1.output_dense.weight', 'encoder.layers.10.ffn1_layer_norm.bias', 'encoder.layers.10.ffn1_layer_norm.weight', 'encoder.layers.10.ffn2.intermediate_dense.bias', 'encoder.layers.10.ffn2.intermediate_dense.weight', 'encoder.layers.10.ffn2.output_dense.bias', 'encoder.layers.10.ffn2.output_dense.weight', 'encoder.layers.10.ffn2_layer_norm.bias', 'encoder.layers.10.ffn2_layer_norm.weight', 'encoder.layers.10.final_layer_norm.bias', 'encoder.layers.10.final_layer_norm.weight', 'encoder.layers.10.self_attn.distance_embedding.weight', 'encoder.layers.10.self_attn.linear_k.bias', 'encoder.layers.10.self_attn.linear_k.weight', 'encoder.layers.10.self_attn.linear_out.bias', 'encoder.layers.10.self_attn.linear_out.weight', 'encoder.layers.10.self_attn.linear_q.bias', 'encoder.layers.10.self_attn.linear_q.weight', 'encoder.layers.10.self_attn.linear_v.bias', 'encoder.layers.10.self_attn.linear_v.weight', 'encoder.layers.10.self_attn_layer_norm.bias', 'encoder.layers.10.self_attn_layer_norm.weight', 'encoder.layers.11.conv_module.depthwise_conv.weight', 'encoder.layers.11.conv_module.depthwise_layer_norm.bias', 'encoder.layers.11.conv_module.depthwise_layer_norm.weight', 'encoder.layers.11.conv_module.layer_norm.bias', 'encoder.layers.11.conv_module.layer_norm.weight', 'encoder.layers.11.conv_module.pointwise_conv1.weight', 'encoder.layers.11.conv_module.pointwise_conv2.weight', 'encoder.layers.11.ffn1.intermediate_dense.bias', 'encoder.layers.11.ffn1.intermediate_dense.weight', 'encoder.layers.11.ffn1.output_dense.bias', 'encoder.layers.11.ffn1.output_dense.weight', 'encoder.layers.11.ffn1_layer_norm.bias', 'encoder.layers.11.ffn1_layer_norm.weight', 'encoder.layers.11.ffn2.intermediate_dense.bias', 'encoder.layers.11.ffn2.intermediate_dense.weight', 'encoder.layers.11.ffn2.output_dense.bias', 'encoder.layers.11.ffn2.output_dense.weight', 'encoder.layers.11.ffn2_layer_norm.bias', 'encoder.layers.11.ffn2_layer_norm.weight', 'encoder.layers.11.final_layer_norm.bias', 'encoder.layers.11.final_layer_norm.weight', 'encoder.layers.11.self_attn.distance_embedding.weight', 'encoder.layers.11.self_attn.linear_k.bias', 'encoder.layers.11.self_attn.linear_k.weight', 'encoder.layers.11.self_attn.linear_out.bias', 'encoder.layers.11.self_attn.linear_out.weight', 'encoder.layers.11.self_attn.linear_q.bias', 'encoder.layers.11.self_attn.linear_q.weight', 'encoder.layers.11.self_attn.linear_v.bias', 'encoder.layers.11.self_attn.linear_v.weight', 'encoder.layers.11.self_attn_layer_norm.bias', 'encoder.layers.11.self_attn_layer_norm.weight', 'encoder.layers.12.conv_module.depthwise_conv.weight', 'encoder.layers.12.conv_module.depthwise_layer_norm.bias', 'encoder.layers.12.conv_module.depthwise_layer_norm.weight', 'encoder.layers.12.conv_module.layer_norm.bias', 'encoder.layers.12.conv_module.layer_norm.weight', 'encoder.layers.12.conv_module.pointwise_conv1.weight', 'encoder.layers.12.conv_module.pointwise_conv2.weight', 'encoder.layers.12.ffn1.intermediate_dense.bias', 'encoder.layers.12.ffn1.intermediate_dense.weight', 'encoder.layers.12.ffn1.output_dense.bias', 'encoder.layers.12.ffn1.output_dense.weight', 'encoder.layers.12.ffn1_layer_norm.bias', 'encoder.layers.12.ffn1_layer_norm.weight', 'encoder.layers.12.ffn2.intermediate_dense.bias', 'encoder.layers.12.ffn2.intermediate_dense.weight', 'encoder.layers.12.ffn2.output_dense.bias', 'encoder.layers.12.ffn2.output_dense.weight', 'encoder.layers.12.ffn2_layer_norm.bias', 'encoder.layers.12.ffn2_layer_norm.weight', 'encoder.layers.12.final_layer_norm.bias', 'encoder.layers.12.final_layer_norm.weight', 'encoder.layers.12.self_attn.distance_embedding.weight', 'encoder.layers.12.self_attn.linear_k.bias', 'encoder.layers.12.self_attn.linear_k.weight', 'encoder.layers.12.self_attn.linear_out.bias', 'encoder.layers.12.self_attn.linear_out.weight', 'encoder.layers.12.self_attn.linear_q.bias', 'encoder.layers.12.self_attn.linear_q.weight', 'encoder.layers.12.self_attn.linear_v.bias', 'encoder.layers.12.self_attn.linear_v.weight', 'encoder.layers.12.self_attn_layer_norm.bias', 'encoder.layers.12.self_attn_layer_norm.weight', 'encoder.layers.13.conv_module.depthwise_conv.weight', 'encoder.layers.13.conv_module.depthwise_layer_norm.bias', 'encoder.layers.13.conv_module.depthwise_layer_norm.weight', 'encoder.layers.13.conv_module.layer_norm.bias', 'encoder.layers.13.conv_module.layer_norm.weight', 'encoder.layers.13.conv_module.pointwise_conv1.weight', 'encoder.layers.13.conv_module.pointwise_conv2.weight', 'encoder.layers.13.ffn1.intermediate_dense.bias', 'encoder.layers.13.ffn1.intermediate_dense.weight', 'encoder.layers.13.ffn1.output_dense.bias', 'encoder.layers.13.ffn1.output_dense.weight', 'encoder.layers.13.ffn1_layer_norm.bias', 'encoder.layers.13.ffn1_layer_norm.weight', 'encoder.layers.13.ffn2.intermediate_dense.bias', 'encoder.layers.13.ffn2.intermediate_dense.weight', 'encoder.layers.13.ffn2.output_dense.bias', 'encoder.layers.13.ffn2.output_dense.weight', 'encoder.layers.13.ffn2_layer_norm.bias', 'encoder.layers.13.ffn2_layer_norm.weight', 'encoder.layers.13.final_layer_norm.bias', 'encoder.layers.13.final_layer_norm.weight', 'encoder.layers.13.self_attn.distance_embedding.weight', 'encoder.layers.13.self_attn.linear_k.bias', 'encoder.layers.13.self_attn.linear_k.weight', 'encoder.layers.13.self_attn.linear_out.bias', 'encoder.layers.13.self_attn.linear_out.weight', 'encoder.layers.13.self_attn.linear_q.bias', 'encoder.layers.13.self_attn.linear_q.weight', 'encoder.layers.13.self_attn.linear_v.bias', 'encoder.layers.13.self_attn.linear_v.weight', 'encoder.layers.13.self_attn_layer_norm.bias', 'encoder.layers.13.self_attn_layer_norm.weight', 'encoder.layers.14.conv_module.depthwise_conv.weight', 'encoder.layers.14.conv_module.depthwise_layer_norm.bias', 'encoder.layers.14.conv_module.depthwise_layer_norm.weight', 'encoder.layers.14.conv_module.layer_norm.bias', 'encoder.layers.14.conv_module.layer_norm.weight', 'encoder.layers.14.conv_module.pointwise_conv1.weight', 'encoder.layers.14.conv_module.pointwise_conv2.weight', 'encoder.layers.14.ffn1.intermediate_dense.bias', 'encoder.layers.14.ffn1.intermediate_dense.weight', 'encoder.layers.14.ffn1.output_dense.bias', 'encoder.layers.14.ffn1.output_dense.weight', 'encoder.layers.14.ffn1_layer_norm.bias', 'encoder.layers.14.ffn1_layer_norm.weight', 'encoder.layers.14.ffn2.intermediate_dense.bias', 'encoder.layers.14.ffn2.intermediate_dense.weight', 'encoder.layers.14.ffn2.output_dense.bias', 'encoder.layers.14.ffn2.output_dense.weight', 'encoder.layers.14.ffn2_layer_norm.bias', 'encoder.layers.14.ffn2_layer_norm.weight', 'encoder.layers.14.final_layer_norm.bias', 'encoder.layers.14.final_layer_norm.weight', 'encoder.layers.14.self_attn.distance_embedding.weight', 'encoder.layers.14.self_attn.linear_k.bias', 'encoder.layers.14.self_attn.linear_k.weight', 'encoder.layers.14.self_attn.linear_out.bias', 'encoder.layers.14.self_attn.linear_out.weight', 'encoder.layers.14.self_attn.linear_q.bias', 'encoder.layers.14.self_attn.linear_q.weight', 'encoder.layers.14.self_attn.linear_v.bias', 'encoder.layers.14.self_attn.linear_v.weight', 'encoder.layers.14.self_attn_layer_norm.bias', 'encoder.layers.14.self_attn_layer_norm.weight', 'encoder.layers.15.conv_module.depthwise_conv.weight', 'encoder.layers.15.conv_module.depthwise_layer_norm.bias', 'encoder.layers.15.conv_module.depthwise_layer_norm.weight', 'encoder.layers.15.conv_module.layer_norm.bias', 'encoder.layers.15.conv_module.layer_norm.weight', 'encoder.layers.15.conv_module.pointwise_conv1.weight', 'encoder.layers.15.conv_module.pointwise_conv2.weight', 'encoder.layers.15.ffn1.intermediate_dense.bias', 'encoder.layers.15.ffn1.intermediate_dense.weight', 'encoder.layers.15.ffn1.output_dense.bias', 'encoder.layers.15.ffn1.output_dense.weight', 'encoder.layers.15.ffn1_layer_norm.bias', 'encoder.layers.15.ffn1_layer_norm.weight', 'encoder.layers.15.ffn2.intermediate_dense.bias', 'encoder.layers.15.ffn2.intermediate_dense.weight', 'encoder.layers.15.ffn2.output_dense.bias', 'encoder.layers.15.ffn2.output_dense.weight', 'encoder.layers.15.ffn2_layer_norm.bias', 'encoder.layers.15.ffn2_layer_norm.weight', 'encoder.layers.15.final_layer_norm.bias', 'encoder.layers.15.final_layer_norm.weight', 'encoder.layers.15.self_attn.distance_embedding.weight', 'encoder.layers.15.self_attn.linear_k.bias', 'encoder.layers.15.self_attn.linear_k.weight', 'encoder.layers.15.self_attn.linear_out.bias', 'encoder.layers.15.self_attn.linear_out.weight', 'encoder.layers.15.self_attn.linear_q.bias', 'encoder.layers.15.self_attn.linear_q.weight', 'encoder.layers.15.self_attn.linear_v.bias', 'encoder.layers.15.self_attn.linear_v.weight', 'encoder.layers.15.self_attn_layer_norm.bias', 'encoder.layers.15.self_attn_layer_norm.weight', 'encoder.layers.16.conv_module.depthwise_conv.weight', 'encoder.layers.16.conv_module.depthwise_layer_norm.bias', 'encoder.layers.16.conv_module.depthwise_layer_norm.weight', 'encoder.layers.16.conv_module.layer_norm.bias', 'encoder.layers.16.conv_module.layer_norm.weight', 'encoder.layers.16.conv_module.pointwise_conv1.weight', 'encoder.layers.16.conv_module.pointwise_conv2.weight', 'encoder.layers.16.ffn1.intermediate_dense.bias', 'encoder.layers.16.ffn1.intermediate_dense.weight', 'encoder.layers.16.ffn1.output_dense.bias', 'encoder.layers.16.ffn1.output_dense.weight', 'encoder.layers.16.ffn1_layer_norm.bias', 'encoder.layers.16.ffn1_layer_norm.weight', 'encoder.layers.16.ffn2.intermediate_dense.bias', 'encoder.layers.16.ffn2.intermediate_dense.weight', 'encoder.layers.16.ffn2.output_dense.bias', 'encoder.layers.16.ffn2.output_dense.weight', 'encoder.layers.16.ffn2_layer_norm.bias', 'encoder.layers.16.ffn2_layer_norm.weight', 'encoder.layers.16.final_layer_norm.bias', 'encoder.layers.16.final_layer_norm.weight', 'encoder.layers.16.self_attn.distance_embedding.weight', 'encoder.layers.16.self_attn.linear_k.bias', 'encoder.layers.16.self_attn.linear_k.weight', 'encoder.layers.16.self_attn.linear_out.bias', 'encoder.layers.16.self_attn.linear_out.weight', 'encoder.layers.16.self_attn.linear_q.bias', 'encoder.layers.16.self_attn.linear_q.weight', 'encoder.layers.16.self_attn.linear_v.bias', 'encoder.layers.16.self_attn.linear_v.weight', 'encoder.layers.16.self_attn_layer_norm.bias', 'encoder.layers.16.self_attn_layer_norm.weight', 'encoder.layers.17.conv_module.depthwise_conv.weight', 'encoder.layers.17.conv_module.depthwise_layer_norm.bias', 'encoder.layers.17.conv_module.depthwise_layer_norm.weight', 'encoder.layers.17.conv_module.layer_norm.bias', 'encoder.layers.17.conv_module.layer_norm.weight', 'encoder.layers.17.conv_module.pointwise_conv1.weight', 'encoder.layers.17.conv_module.pointwise_conv2.weight', 'encoder.layers.17.ffn1.intermediate_dense.bias', 'encoder.layers.17.ffn1.intermediate_dense.weight', 'encoder.layers.17.ffn1.output_dense.bias', 'encoder.layers.17.ffn1.output_dense.weight', 'encoder.layers.17.ffn1_layer_norm.bias', 'encoder.layers.17.ffn1_layer_norm.weight', 'encoder.layers.17.ffn2.intermediate_dense.bias', 'encoder.layers.17.ffn2.intermediate_dense.weight', 'encoder.layers.17.ffn2.output_dense.bias', 'encoder.layers.17.ffn2.output_dense.weight', 'encoder.layers.17.ffn2_layer_norm.bias', 'encoder.layers.17.ffn2_layer_norm.weight', 'encoder.layers.17.final_layer_norm.bias', 'encoder.layers.17.final_layer_norm.weight', 'encoder.layers.17.self_attn.distance_embedding.weight', 'encoder.layers.17.self_attn.linear_k.bias', 'encoder.layers.17.self_attn.linear_k.weight', 'encoder.layers.17.self_attn.linear_out.bias', 'encoder.layers.17.self_attn.linear_out.weight', 'encoder.layers.17.self_attn.linear_q.bias', 'encoder.layers.17.self_attn.linear_q.weight', 'encoder.layers.17.self_attn.linear_v.bias', 'encoder.layers.17.self_attn.linear_v.weight', 'encoder.layers.17.self_attn_layer_norm.bias', 'encoder.layers.17.self_attn_layer_norm.weight', 'encoder.layers.18.conv_module.depthwise_conv.weight', 'encoder.layers.18.conv_module.depthwise_layer_norm.bias', 'encoder.layers.18.conv_module.depthwise_layer_norm.weight', 'encoder.layers.18.conv_module.layer_norm.bias', 'encoder.layers.18.conv_module.layer_norm.weight', 'encoder.layers.18.conv_module.pointwise_conv1.weight', 'encoder.layers.18.conv_module.pointwise_conv2.weight', 'encoder.layers.18.ffn1.intermediate_dense.bias', 'encoder.layers.18.ffn1.intermediate_dense.weight', 'encoder.layers.18.ffn1.output_dense.bias', 'encoder.layers.18.ffn1.output_dense.weight', 'encoder.layers.18.ffn1_layer_norm.bias', 'encoder.layers.18.ffn1_layer_norm.weight', 'encoder.layers.18.ffn2.intermediate_dense.bias', 'encoder.layers.18.ffn2.intermediate_dense.weight', 'encoder.layers.18.ffn2.output_dense.bias', 'encoder.layers.18.ffn2.output_dense.weight', 'encoder.layers.18.ffn2_layer_norm.bias', 'encoder.layers.18.ffn2_layer_norm.weight', 'encoder.layers.18.final_layer_norm.bias', 'encoder.layers.18.final_layer_norm.weight', 'encoder.layers.18.self_attn.distance_embedding.weight', 'encoder.layers.18.self_attn.linear_k.bias', 'encoder.layers.18.self_attn.linear_k.weight', 'encoder.layers.18.self_attn.linear_out.bias', 'encoder.layers.18.self_attn.linear_out.weight', 'encoder.layers.18.self_attn.linear_q.bias', 'encoder.layers.18.self_attn.linear_q.weight', 'encoder.layers.18.self_attn.linear_v.bias', 'encoder.layers.18.self_attn.linear_v.weight', 'encoder.layers.18.self_attn_layer_norm.bias', 'encoder.layers.18.self_attn_layer_norm.weight', 'encoder.layers.19.conv_module.depthwise_conv.weight', 'encoder.layers.19.conv_module.depthwise_layer_norm.bias', 'encoder.layers.19.conv_module.depthwise_layer_norm.weight', 'encoder.layers.19.conv_module.layer_norm.bias', 'encoder.layers.19.conv_module.layer_norm.weight', 'encoder.layers.19.conv_module.pointwise_conv1.weight', 'encoder.layers.19.conv_module.pointwise_conv2.weight', 'encoder.layers.19.ffn1.intermediate_dense.bias', 'encoder.layers.19.ffn1.intermediate_dense.weight', 'encoder.layers.19.ffn1.output_dense.bias', 'encoder.layers.19.ffn1.output_dense.weight', 'encoder.layers.19.ffn1_layer_norm.bias', 'encoder.layers.19.ffn1_layer_norm.weight', 'encoder.layers.19.ffn2.intermediate_dense.bias', 'encoder.layers.19.ffn2.intermediate_dense.weight', 'encoder.layers.19.ffn2.output_dense.bias', 'encoder.layers.19.ffn2.output_dense.weight', 'encoder.layers.19.ffn2_layer_norm.bias', 'encoder.layers.19.ffn2_layer_norm.weight', 'encoder.layers.19.final_layer_norm.bias', 'encoder.layers.19.final_layer_norm.weight', 'encoder.layers.19.self_attn.distance_embedding.weight', 'encoder.layers.19.self_attn.linear_k.bias', 'encoder.layers.19.self_attn.linear_k.weight', 'encoder.layers.19.self_attn.linear_out.bias', 'encoder.layers.19.self_attn.linear_out.weight', 'encoder.layers.19.self_attn.linear_q.bias', 'encoder.layers.19.self_attn.linear_q.weight', 'encoder.layers.19.self_attn.linear_v.bias', 'encoder.layers.19.self_attn.linear_v.weight', 'encoder.layers.19.self_attn_layer_norm.bias', 'encoder.layers.19.self_attn_layer_norm.weight', 'encoder.layers.20.conv_module.depthwise_conv.weight', 'encoder.layers.20.conv_module.depthwise_layer_norm.bias', 'encoder.layers.20.conv_module.depthwise_layer_norm.weight', 'encoder.layers.20.conv_module.layer_norm.bias', 'encoder.layers.20.conv_module.layer_norm.weight', 'encoder.layers.20.conv_module.pointwise_conv1.weight', 'encoder.layers.20.conv_module.pointwise_conv2.weight', 'encoder.layers.20.ffn1.intermediate_dense.bias', 'encoder.layers.20.ffn1.intermediate_dense.weight', 'encoder.layers.20.ffn1.output_dense.bias', 'encoder.layers.20.ffn1.output_dense.weight', 'encoder.layers.20.ffn1_layer_norm.bias', 'encoder.layers.20.ffn1_layer_norm.weight', 'encoder.layers.20.ffn2.intermediate_dense.bias', 'encoder.layers.20.ffn2.intermediate_dense.weight', 'encoder.layers.20.ffn2.output_dense.bias', 'encoder.layers.20.ffn2.output_dense.weight', 'encoder.layers.20.ffn2_layer_norm.bias', 'encoder.layers.20.ffn2_layer_norm.weight', 'encoder.layers.20.final_layer_norm.bias', 'encoder.layers.20.final_layer_norm.weight', 'encoder.layers.20.self_attn.distance_embedding.weight', 'encoder.layers.20.self_attn.linear_k.bias', 'encoder.layers.20.self_attn.linear_k.weight', 'encoder.layers.20.self_attn.linear_out.bias', 'encoder.layers.20.self_attn.linear_out.weight', 'encoder.layers.20.self_attn.linear_q.bias', 'encoder.layers.20.self_attn.linear_q.weight', 'encoder.layers.20.self_attn.linear_v.bias', 'encoder.layers.20.self_attn.linear_v.weight', 'encoder.layers.20.self_attn_layer_norm.bias', 'encoder.layers.20.self_attn_layer_norm.weight', 'encoder.layers.21.conv_module.depthwise_conv.weight', 'encoder.layers.21.conv_module.depthwise_layer_norm.bias', 'encoder.layers.21.conv_module.depthwise_layer_norm.weight', 'encoder.layers.21.conv_module.layer_norm.bias', 'encoder.layers.21.conv_module.layer_norm.weight', 'encoder.layers.21.conv_module.pointwise_conv1.weight', 'encoder.layers.21.conv_module.pointwise_conv2.weight', 'encoder.layers.21.ffn1.intermediate_dense.bias', 'encoder.layers.21.ffn1.intermediate_dense.weight', 'encoder.layers.21.ffn1.output_dense.bias', 'encoder.layers.21.ffn1.output_dense.weight', 'encoder.layers.21.ffn1_layer_norm.bias', 'encoder.layers.21.ffn1_layer_norm.weight', 'encoder.layers.21.ffn2.intermediate_dense.bias', 'encoder.layers.21.ffn2.intermediate_dense.weight', 'encoder.layers.21.ffn2.output_dense.bias', 'encoder.layers.21.ffn2.output_dense.weight', 'encoder.layers.21.ffn2_layer_norm.bias', 'encoder.layers.21.ffn2_layer_norm.weight', 'encoder.layers.21.final_layer_norm.bias', 'encoder.layers.21.final_layer_norm.weight', 'encoder.layers.21.self_attn.distance_embedding.weight', 'encoder.layers.21.self_attn.linear_k.bias', 'encoder.layers.21.self_attn.linear_k.weight', 'encoder.layers.21.self_attn.linear_out.bias', 'encoder.layers.21.self_attn.linear_out.weight', 'encoder.layers.21.self_attn.linear_q.bias', 'encoder.layers.21.self_attn.linear_q.weight', 'encoder.layers.21.self_attn.linear_v.bias', 'encoder.layers.21.self_attn.linear_v.weight', 'encoder.layers.21.self_attn_layer_norm.bias', 'encoder.layers.21.self_attn_layer_norm.weight', 'encoder.layers.22.conv_module.depthwise_conv.weight', 'encoder.layers.22.conv_module.depthwise_layer_norm.bias', 'encoder.layers.22.conv_module.depthwise_layer_norm.weight', 'encoder.layers.22.conv_module.layer_norm.bias', 'encoder.layers.22.conv_module.layer_norm.weight', 'encoder.layers.22.conv_module.pointwise_conv1.weight', 'encoder.layers.22.conv_module.pointwise_conv2.weight', 'encoder.layers.22.ffn1.intermediate_dense.bias', 'encoder.layers.22.ffn1.intermediate_dense.weight', 'encoder.layers.22.ffn1.output_dense.bias', 'encoder.layers.22.ffn1.output_dense.weight', 'encoder.layers.22.ffn1_layer_norm.bias', 'encoder.layers.22.ffn1_layer_norm.weight', 'encoder.layers.22.ffn2.intermediate_dense.bias', 'encoder.layers.22.ffn2.intermediate_dense.weight', 'encoder.layers.22.ffn2.output_dense.bias', 'encoder.layers.22.ffn2.output_dense.weight', 'encoder.layers.22.ffn2_layer_norm.bias', 'encoder.layers.22.ffn2_layer_norm.weight', 'encoder.layers.22.final_layer_norm.bias', 'encoder.layers.22.final_layer_norm.weight', 'encoder.layers.22.self_attn.distance_embedding.weight', 'encoder.layers.22.self_attn.linear_k.bias', 'encoder.layers.22.self_attn.linear_k.weight', 'encoder.layers.22.self_attn.linear_out.bias', 'encoder.layers.22.self_attn.linear_out.weight', 'encoder.layers.22.self_attn.linear_q.bias', 'encoder.layers.22.self_attn.linear_q.weight', 'encoder.layers.22.self_attn.linear_v.bias', 'encoder.layers.22.self_attn.linear_v.weight', 'encoder.layers.22.self_attn_layer_norm.bias', 'encoder.layers.22.self_attn_layer_norm.weight', 'encoder.layers.23.conv_module.depthwise_conv.weight', 'encoder.layers.23.conv_module.depthwise_layer_norm.bias', 'encoder.layers.23.conv_module.depthwise_layer_norm.weight', 'encoder.layers.23.conv_module.layer_norm.bias', 'encoder.layers.23.conv_module.layer_norm.weight', 'encoder.layers.23.conv_module.pointwise_conv1.weight', 'encoder.layers.23.conv_module.pointwise_conv2.weight', 'encoder.layers.23.ffn1.intermediate_dense.bias', 'encoder.layers.23.ffn1.intermediate_dense.weight', 'encoder.layers.23.ffn1.output_dense.bias', 'encoder.layers.23.ffn1.output_dense.weight', 'encoder.layers.23.ffn1_layer_norm.bias', 'encoder.layers.23.ffn1_layer_norm.weight', 'encoder.layers.23.ffn2.intermediate_dense.bias', 'encoder.layers.23.ffn2.intermediate_dense.weight', 'encoder.layers.23.ffn2.output_dense.bias', 'encoder.layers.23.ffn2.output_dense.weight', 'encoder.layers.23.ffn2_layer_norm.bias', 'encoder.layers.23.ffn2_layer_norm.weight', 'encoder.layers.23.final_layer_norm.bias', 'encoder.layers.23.final_layer_norm.weight', 'encoder.layers.23.self_attn.distance_embedding.weight', 'encoder.layers.23.self_attn.linear_k.bias', 'encoder.layers.23.self_attn.linear_k.weight', 'encoder.layers.23.self_attn.linear_out.bias', 'encoder.layers.23.self_attn.linear_out.weight', 'encoder.layers.23.self_attn.linear_q.bias', 'encoder.layers.23.self_attn.linear_q.weight', 'encoder.layers.23.self_attn.linear_v.bias', 'encoder.layers.23.self_attn.linear_v.weight', 'encoder.layers.23.self_attn_layer_norm.bias', 'encoder.layers.23.self_attn_layer_norm.weight', 'encoder.layers.6.conv_module.depthwise_conv.weight', 'encoder.layers.6.conv_module.depthwise_layer_norm.bias', 'encoder.layers.6.conv_module.depthwise_layer_norm.weight', 'encoder.layers.6.conv_module.layer_norm.bias', 'encoder.layers.6.conv_module.layer_norm.weight', 'encoder.layers.6.conv_module.pointwise_conv1.weight', 'encoder.layers.6.conv_module.pointwise_conv2.weight', 'encoder.layers.6.ffn1.intermediate_dense.bias', 'encoder.layers.6.ffn1.intermediate_dense.weight', 'encoder.layers.6.ffn1.output_dense.bias', 'encoder.layers.6.ffn1.output_dense.weight', 'encoder.layers.6.ffn1_layer_norm.bias', 'encoder.layers.6.ffn1_layer_norm.weight', 'encoder.layers.6.ffn2.intermediate_dense.bias', 'encoder.layers.6.ffn2.intermediate_dense.weight', 'encoder.layers.6.ffn2.output_dense.bias', 'encoder.layers.6.ffn2.output_dense.weight', 'encoder.layers.6.ffn2_layer_norm.bias', 'encoder.layers.6.ffn2_layer_norm.weight', 'encoder.layers.6.final_layer_norm.bias', 'encoder.layers.6.final_layer_norm.weight', 'encoder.layers.6.self_attn.distance_embedding.weight', 'encoder.layers.6.self_attn.linear_k.bias', 'encoder.layers.6.self_attn.linear_k.weight', 'encoder.layers.6.self_attn.linear_out.bias', 'encoder.layers.6.self_attn.linear_out.weight', 'encoder.layers.6.self_attn.linear_q.bias', 'encoder.layers.6.self_attn.linear_q.weight', 'encoder.layers.6.self_attn.linear_v.bias', 'encoder.layers.6.self_attn.linear_v.weight', 'encoder.layers.6.self_attn_layer_norm.bias', 'encoder.layers.6.self_attn_layer_norm.weight', 'encoder.layers.7.conv_module.depthwise_conv.weight', 'encoder.layers.7.conv_module.depthwise_layer_norm.bias', 'encoder.layers.7.conv_module.depthwise_layer_norm.weight', 'encoder.layers.7.conv_module.layer_norm.bias', 'encoder.layers.7.conv_module.layer_norm.weight', 'encoder.layers.7.conv_module.pointwise_conv1.weight', 'encoder.layers.7.conv_module.pointwise_conv2.weight', 'encoder.layers.7.ffn1.intermediate_dense.bias', 'encoder.layers.7.ffn1.intermediate_dense.weight', 'encoder.layers.7.ffn1.output_dense.bias', 'encoder.layers.7.ffn1.output_dense.weight', 'encoder.layers.7.ffn1_layer_norm.bias', 'encoder.layers.7.ffn1_layer_norm.weight', 'encoder.layers.7.ffn2.intermediate_dense.bias', 'encoder.layers.7.ffn2.intermediate_dense.weight', 'encoder.layers.7.ffn2.output_dense.bias', 'encoder.layers.7.ffn2.output_dense.weight', 'encoder.layers.7.ffn2_layer_norm.bias', 'encoder.layers.7.ffn2_layer_norm.weight', 'encoder.layers.7.final_layer_norm.bias', 'encoder.layers.7.final_layer_norm.weight', 'encoder.layers.7.self_attn.distance_embedding.weight', 'encoder.layers.7.self_attn.linear_k.bias', 'encoder.layers.7.self_attn.linear_k.weight', 'encoder.layers.7.self_attn.linear_out.bias', 'encoder.layers.7.self_attn.linear_out.weight', 'encoder.layers.7.self_attn.linear_q.bias', 'encoder.layers.7.self_attn.linear_q.weight', 'encoder.layers.7.self_attn.linear_v.bias', 'encoder.layers.7.self_attn.linear_v.weight', 'encoder.layers.7.self_attn_layer_norm.bias', 'encoder.layers.7.self_attn_layer_norm.weight', 'encoder.layers.8.conv_module.depthwise_conv.weight', 'encoder.layers.8.conv_module.depthwise_layer_norm.bias', 'encoder.layers.8.conv_module.depthwise_layer_norm.weight', 'encoder.layers.8.conv_module.layer_norm.bias', 'encoder.layers.8.conv_module.layer_norm.weight', 'encoder.layers.8.conv_module.pointwise_conv1.weight', 'encoder.layers.8.conv_module.pointwise_conv2.weight', 'encoder.layers.8.ffn1.intermediate_dense.bias', 'encoder.layers.8.ffn1.intermediate_dense.weight', 'encoder.layers.8.ffn1.output_dense.bias', 'encoder.layers.8.ffn1.output_dense.weight', 'encoder.layers.8.ffn1_layer_norm.bias', 'encoder.layers.8.ffn1_layer_norm.weight', 'encoder.layers.8.ffn2.intermediate_dense.bias', 'encoder.layers.8.ffn2.intermediate_dense.weight', 'encoder.layers.8.ffn2.output_dense.bias', 'encoder.layers.8.ffn2.output_dense.weight', 'encoder.layers.8.ffn2_layer_norm.bias', 'encoder.layers.8.ffn2_layer_norm.weight', 'encoder.layers.8.final_layer_norm.bias', 'encoder.layers.8.final_layer_norm.weight', 'encoder.layers.8.self_attn.distance_embedding.weight', 'encoder.layers.8.self_attn.linear_k.bias', 'encoder.layers.8.self_attn.linear_k.weight', 'encoder.layers.8.self_attn.linear_out.bias', 'encoder.layers.8.self_attn.linear_out.weight', 'encoder.layers.8.self_attn.linear_q.bias', 'encoder.layers.8.self_attn.linear_q.weight', 'encoder.layers.8.self_attn.linear_v.bias', 'encoder.layers.8.self_attn.linear_v.weight', 'encoder.layers.8.self_attn_layer_norm.bias', 'encoder.layers.8.self_attn_layer_norm.weight', 'encoder.layers.9.conv_module.depthwise_conv.weight', 'encoder.layers.9.conv_module.depthwise_layer_norm.bias', 'encoder.layers.9.conv_module.depthwise_layer_norm.weight', 'encoder.layers.9.conv_module.layer_norm.bias', 'encoder.layers.9.conv_module.layer_norm.weight', 'encoder.layers.9.conv_module.pointwise_conv1.weight', 'encoder.layers.9.conv_module.pointwise_conv2.weight', 'encoder.layers.9.ffn1.intermediate_dense.bias', 'encoder.layers.9.ffn1.intermediate_dense.weight', 'encoder.layers.9.ffn1.output_dense.bias', 'encoder.layers.9.ffn1.output_dense.weight', 'encoder.layers.9.ffn1_layer_norm.bias', 'encoder.layers.9.ffn1_layer_norm.weight', 'encoder.layers.9.ffn2.intermediate_dense.bias', 'encoder.layers.9.ffn2.intermediate_dense.weight', 'encoder.layers.9.ffn2.output_dense.bias', 'encoder.layers.9.ffn2.output_dense.weight', 'encoder.layers.9.ffn2_layer_norm.bias', 'encoder.layers.9.ffn2_layer_norm.weight', 'encoder.layers.9.final_layer_norm.bias', 'encoder.layers.9.final_layer_norm.weight', 'encoder.layers.9.self_attn.distance_embedding.weight', 'encoder.layers.9.self_attn.linear_k.bias', 'encoder.layers.9.self_attn.linear_k.weight', 'encoder.layers.9.self_attn.linear_out.bias', 'encoder.layers.9.self_attn.linear_out.weight', 'encoder.layers.9.self_attn.linear_q.bias', 'encoder.layers.9.self_attn.linear_q.weight', 'encoder.layers.9.self_attn.linear_v.bias', 'encoder.layers.9.self_attn.linear_v.weight', 'encoder.layers.9.self_attn_layer_norm.bias', 'encoder.layers.9.self_attn_layer_norm.weight']
- This IS expected if you are initializing Wav2Vec2BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing Wav2Vec2BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
2025-02-06 10:15:54,592 (infer:201) INFO: params.model_file: /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_w2v-bert2_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/best-valid-der.pt
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py:203: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  torch.load(params.model_file, map_location=device)["model"]
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/ts_vad_dataset.py:398: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  feature = torch.load(path, map_location="cpu")
2025-02-06 10:29:56,607 (infer:89) INFO: frame_len: 0.04!!
self.wavlm_fuse_feat_post_norm: False
Model DER:  1.0
Model ACC:  0.8328180897519811
  0%|          | 0/60 [00:00<?, ?it/s]  2%|▏         | 1/60 [00:00<00:31,  1.85it/s]  3%|▎         | 2/60 [00:01<00:31,  1.84it/s]  5%|▌         | 3/60 [00:01<00:30,  1.84it/s]  7%|▋         | 4/60 [00:02<00:30,  1.84it/s]  8%|▊         | 5/60 [00:02<00:30,  1.82it/s] 10%|█         | 6/60 [00:03<00:29,  1.83it/s] 12%|█▏        | 7/60 [00:03<00:28,  1.84it/s] 13%|█▎        | 8/60 [00:04<00:28,  1.84it/s] 15%|█▌        | 9/60 [00:04<00:28,  1.81it/s] 17%|█▋        | 10/60 [00:05<00:27,  1.81it/s] 18%|█▊        | 11/60 [00:06<00:27,  1.81it/s] 20%|██        | 12/60 [00:06<00:26,  1.81it/s] 22%|██▏       | 13/60 [00:07<00:25,  1.82it/s] 23%|██▎       | 14/60 [00:08<00:36,  1.27it/s] 25%|██▌       | 15/60 [00:08<00:31,  1.42it/s] 27%|██▋       | 16/60 [00:09<00:28,  1.54it/s] 28%|██▊       | 17/60 [00:09<00:25,  1.67it/s] 30%|███       | 18/60 [00:10<00:23,  1.77it/s] 32%|███▏      | 19/60 [00:10<00:22,  1.84it/s] 33%|███▎      | 20/60 [00:11<00:21,  1.90it/s] 35%|███▌      | 21/60 [00:11<00:20,  1.92it/s] 37%|███▋      | 22/60 [00:12<00:19,  1.94it/s] 38%|███▊      | 23/60 [00:12<00:18,  1.96it/s] 40%|████      | 24/60 [00:13<00:18,  1.98it/s] 42%|████▏     | 25/60 [00:13<00:17,  2.00it/s] 43%|████▎     | 26/60 [00:14<00:16,  2.01it/s] 45%|████▌     | 27/60 [00:14<00:16,  2.04it/s] 47%|████▋     | 28/60 [00:15<00:15,  2.05it/s] 48%|████▊     | 29/60 [00:15<00:15,  2.07it/s] 50%|█████     | 30/60 [00:16<00:14,  2.08it/s] 52%|█████▏    | 31/60 [00:16<00:13,  2.09it/s] 53%|█████▎    | 32/60 [00:17<00:13,  2.10it/s] 55%|█████▌    | 33/60 [00:18<00:18,  1.47it/s] 57%|█████▋    | 34/60 [00:18<00:16,  1.60it/s] 58%|█████▊    | 35/60 [00:19<00:14,  1.69it/s] 60%|██████    | 36/60 [00:19<00:13,  1.78it/s] 62%|██████▏   | 37/60 [00:20<00:12,  1.83it/s] 63%|██████▎   | 38/60 [00:20<00:11,  1.89it/s] 65%|██████▌   | 39/60 [00:21<00:10,  1.95it/s] 67%|██████▋   | 40/60 [00:21<00:09,  2.01it/s] 68%|██████▊   | 41/60 [00:22<00:09,  1.97it/s] 70%|███████   | 42/60 [00:22<00:09,  1.97it/s] 72%|███████▏  | 43/60 [00:23<00:08,  1.97it/s] 73%|███████▎  | 44/60 [00:23<00:08,  1.98it/s] 75%|███████▌  | 45/60 [00:24<00:07,  2.02it/s] 77%|███████▋  | 46/60 [00:24<00:06,  2.04it/s] 78%|███████▊  | 47/60 [00:25<00:06,  2.05it/s] 80%|████████  | 48/60 [00:25<00:05,  2.04it/s] 82%|████████▏ | 49/60 [00:26<00:05,  2.01it/s] 83%|████████▎ | 50/60 [00:26<00:05,  1.99it/s] 85%|████████▌ | 51/60 [00:27<00:04,  1.97it/s] 87%|████████▋ | 52/60 [00:28<00:05,  1.43it/s] 88%|████████▊ | 53/60 [00:29<00:04,  1.59it/s] 90%|█████████ | 54/60 [00:29<00:03,  1.72it/s] 92%|█████████▏| 55/60 [00:29<00:02,  1.83it/s] 93%|█████████▎| 56/60 [00:30<00:02,  1.91it/s] 95%|█████████▌| 57/60 [00:30<00:01,  1.96it/s] 97%|█████████▋| 58/60 [00:31<00:01,  1.99it/s] 98%|█████████▊| 59/60 [00:31<00:00,  2.01it/s]100%|██████████| 60/60 [00:32<00:00,  2.02it/s]100%|██████████| 60/60 [00:32<00:00,  1.85it/s]
Eval for threshold 0.2 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.3 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.35 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.4 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.45 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.5 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.55 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.6 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.7 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.8 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


2025-02-06 10:30:44,036 (infer:256) INFO: infer data_cfg: TSVADDataConfig(data_dir='/mntcephfs/lab_data/maduo/datasets/alimeeting', ts_len=6000, rs_len=10, segment_shift=1, spk_path='/mntcephfs/lab_data/maduo/model_hub/ts_vad/spk_embed/alimeeting/SpeakerEmbedding', speech_encoder_type='w2v-bert2', speaker_embedding_name_dir='cam++_zh-cn_200k_feature_dir', speaker_embed_dim=192, noise_ratio=0.8, zero_ratio=0.3, sample_rate=16000, max_num_speaker=7, dataset_name='alimeeting', embed_input=False, embed_len=1, embed_shift=0.4, label_rate=25, random_channel=False, random_mask_speaker_prob=0.0, random_mask_speaker_step=0, musan_path='/mntcephfs/lee_dataset/asr/musan', rir_path='/mntcephfs/lee_dataset/asr/RIRS_NOISES')
2025-02-06 10:30:44,036 (infer:257) INFO: currently, it will infer Eval set.
  0%|          | 0/25 [00:00<?, ?it/s]100%|██████████| 25/25 [00:00<00:00, 432.82it/s]
2025-02-06 10:30:44,101 (ts_vad_dataset:152) INFO: model expect fbank as input , fbank_input should be True !!!
2025-02-06 10:30:44,101 (ts_vad_dataset:160) INFO: loaded sentence=15141, shortest sent=5120.0, longest sent=160000.0, rs_len=10, segment_shift=1,  rir=False, musan=False, noise_ratio=0.8, zero_ratio=0.3 
2025-02-06 10:30:44,171 (infer:279) INFO: Device: cuda:0
2025-02-06 10:30:44,171 (infer:297) INFO: infer model_cfg: TSVADConfig(speech_encoder_path='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/w2v-bert2.0/model.safetensors', speech_encoder_type='w2v-bert2', freeze_speech_encoder_updates=4000, num_attention_head=4, num_transformer_layer=2, transformer_embed_dim=384, transformer_ffn_embed_dim=1536, speaker_embed_dim=192, dropout=0.1, use_spk_embed=True, feature_grad_mult=0.1, whisper_n_mels=80, select_encoder_layer_nums=6, wavlm_fuse_feat_post_norm=False, speech_encoder_config='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/w2v-bert2.0/config.json', single_backend_type='mamba2', multi_backend_type='transformer', d_state=256, expand=4)
Some weights of the model checkpoint at /mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/w2v-bert2.0/model.safetensors were not used when initializing Wav2Vec2BertModel: ['encoder.layers.10.conv_module.depthwise_conv.weight', 'encoder.layers.10.conv_module.depthwise_layer_norm.bias', 'encoder.layers.10.conv_module.depthwise_layer_norm.weight', 'encoder.layers.10.conv_module.layer_norm.bias', 'encoder.layers.10.conv_module.layer_norm.weight', 'encoder.layers.10.conv_module.pointwise_conv1.weight', 'encoder.layers.10.conv_module.pointwise_conv2.weight', 'encoder.layers.10.ffn1.intermediate_dense.bias', 'encoder.layers.10.ffn1.intermediate_dense.weight', 'encoder.layers.10.ffn1.output_dense.bias', 'encoder.layers.10.ffn1.output_dense.weight', 'encoder.layers.10.ffn1_layer_norm.bias', 'encoder.layers.10.ffn1_layer_norm.weight', 'encoder.layers.10.ffn2.intermediate_dense.bias', 'encoder.layers.10.ffn2.intermediate_dense.weight', 'encoder.layers.10.ffn2.output_dense.bias', 'encoder.layers.10.ffn2.output_dense.weight', 'encoder.layers.10.ffn2_layer_norm.bias', 'encoder.layers.10.ffn2_layer_norm.weight', 'encoder.layers.10.final_layer_norm.bias', 'encoder.layers.10.final_layer_norm.weight', 'encoder.layers.10.self_attn.distance_embedding.weight', 'encoder.layers.10.self_attn.linear_k.bias', 'encoder.layers.10.self_attn.linear_k.weight', 'encoder.layers.10.self_attn.linear_out.bias', 'encoder.layers.10.self_attn.linear_out.weight', 'encoder.layers.10.self_attn.linear_q.bias', 'encoder.layers.10.self_attn.linear_q.weight', 'encoder.layers.10.self_attn.linear_v.bias', 'encoder.layers.10.self_attn.linear_v.weight', 'encoder.layers.10.self_attn_layer_norm.bias', 'encoder.layers.10.self_attn_layer_norm.weight', 'encoder.layers.11.conv_module.depthwise_conv.weight', 'encoder.layers.11.conv_module.depthwise_layer_norm.bias', 'encoder.layers.11.conv_module.depthwise_layer_norm.weight', 'encoder.layers.11.conv_module.layer_norm.bias', 'encoder.layers.11.conv_module.layer_norm.weight', 'encoder.layers.11.conv_module.pointwise_conv1.weight', 'encoder.layers.11.conv_module.pointwise_conv2.weight', 'encoder.layers.11.ffn1.intermediate_dense.bias', 'encoder.layers.11.ffn1.intermediate_dense.weight', 'encoder.layers.11.ffn1.output_dense.bias', 'encoder.layers.11.ffn1.output_dense.weight', 'encoder.layers.11.ffn1_layer_norm.bias', 'encoder.layers.11.ffn1_layer_norm.weight', 'encoder.layers.11.ffn2.intermediate_dense.bias', 'encoder.layers.11.ffn2.intermediate_dense.weight', 'encoder.layers.11.ffn2.output_dense.bias', 'encoder.layers.11.ffn2.output_dense.weight', 'encoder.layers.11.ffn2_layer_norm.bias', 'encoder.layers.11.ffn2_layer_norm.weight', 'encoder.layers.11.final_layer_norm.bias', 'encoder.layers.11.final_layer_norm.weight', 'encoder.layers.11.self_attn.distance_embedding.weight', 'encoder.layers.11.self_attn.linear_k.bias', 'encoder.layers.11.self_attn.linear_k.weight', 'encoder.layers.11.self_attn.linear_out.bias', 'encoder.layers.11.self_attn.linear_out.weight', 'encoder.layers.11.self_attn.linear_q.bias', 'encoder.layers.11.self_attn.linear_q.weight', 'encoder.layers.11.self_attn.linear_v.bias', 'encoder.layers.11.self_attn.linear_v.weight', 'encoder.layers.11.self_attn_layer_norm.bias', 'encoder.layers.11.self_attn_layer_norm.weight', 'encoder.layers.12.conv_module.depthwise_conv.weight', 'encoder.layers.12.conv_module.depthwise_layer_norm.bias', 'encoder.layers.12.conv_module.depthwise_layer_norm.weight', 'encoder.layers.12.conv_module.layer_norm.bias', 'encoder.layers.12.conv_module.layer_norm.weight', 'encoder.layers.12.conv_module.pointwise_conv1.weight', 'encoder.layers.12.conv_module.pointwise_conv2.weight', 'encoder.layers.12.ffn1.intermediate_dense.bias', 'encoder.layers.12.ffn1.intermediate_dense.weight', 'encoder.layers.12.ffn1.output_dense.bias', 'encoder.layers.12.ffn1.output_dense.weight', 'encoder.layers.12.ffn1_layer_norm.bias', 'encoder.layers.12.ffn1_layer_norm.weight', 'encoder.layers.12.ffn2.intermediate_dense.bias', 'encoder.layers.12.ffn2.intermediate_dense.weight', 'encoder.layers.12.ffn2.output_dense.bias', 'encoder.layers.12.ffn2.output_dense.weight', 'encoder.layers.12.ffn2_layer_norm.bias', 'encoder.layers.12.ffn2_layer_norm.weight', 'encoder.layers.12.final_layer_norm.bias', 'encoder.layers.12.final_layer_norm.weight', 'encoder.layers.12.self_attn.distance_embedding.weight', 'encoder.layers.12.self_attn.linear_k.bias', 'encoder.layers.12.self_attn.linear_k.weight', 'encoder.layers.12.self_attn.linear_out.bias', 'encoder.layers.12.self_attn.linear_out.weight', 'encoder.layers.12.self_attn.linear_q.bias', 'encoder.layers.12.self_attn.linear_q.weight', 'encoder.layers.12.self_attn.linear_v.bias', 'encoder.layers.12.self_attn.linear_v.weight', 'encoder.layers.12.self_attn_layer_norm.bias', 'encoder.layers.12.self_attn_layer_norm.weight', 'encoder.layers.13.conv_module.depthwise_conv.weight', 'encoder.layers.13.conv_module.depthwise_layer_norm.bias', 'encoder.layers.13.conv_module.depthwise_layer_norm.weight', 'encoder.layers.13.conv_module.layer_norm.bias', 'encoder.layers.13.conv_module.layer_norm.weight', 'encoder.layers.13.conv_module.pointwise_conv1.weight', 'encoder.layers.13.conv_module.pointwise_conv2.weight', 'encoder.layers.13.ffn1.intermediate_dense.bias', 'encoder.layers.13.ffn1.intermediate_dense.weight', 'encoder.layers.13.ffn1.output_dense.bias', 'encoder.layers.13.ffn1.output_dense.weight', 'encoder.layers.13.ffn1_layer_norm.bias', 'encoder.layers.13.ffn1_layer_norm.weight', 'encoder.layers.13.ffn2.intermediate_dense.bias', 'encoder.layers.13.ffn2.intermediate_dense.weight', 'encoder.layers.13.ffn2.output_dense.bias', 'encoder.layers.13.ffn2.output_dense.weight', 'encoder.layers.13.ffn2_layer_norm.bias', 'encoder.layers.13.ffn2_layer_norm.weight', 'encoder.layers.13.final_layer_norm.bias', 'encoder.layers.13.final_layer_norm.weight', 'encoder.layers.13.self_attn.distance_embedding.weight', 'encoder.layers.13.self_attn.linear_k.bias', 'encoder.layers.13.self_attn.linear_k.weight', 'encoder.layers.13.self_attn.linear_out.bias', 'encoder.layers.13.self_attn.linear_out.weight', 'encoder.layers.13.self_attn.linear_q.bias', 'encoder.layers.13.self_attn.linear_q.weight', 'encoder.layers.13.self_attn.linear_v.bias', 'encoder.layers.13.self_attn.linear_v.weight', 'encoder.layers.13.self_attn_layer_norm.bias', 'encoder.layers.13.self_attn_layer_norm.weight', 'encoder.layers.14.conv_module.depthwise_conv.weight', 'encoder.layers.14.conv_module.depthwise_layer_norm.bias', 'encoder.layers.14.conv_module.depthwise_layer_norm.weight', 'encoder.layers.14.conv_module.layer_norm.bias', 'encoder.layers.14.conv_module.layer_norm.weight', 'encoder.layers.14.conv_module.pointwise_conv1.weight', 'encoder.layers.14.conv_module.pointwise_conv2.weight', 'encoder.layers.14.ffn1.intermediate_dense.bias', 'encoder.layers.14.ffn1.intermediate_dense.weight', 'encoder.layers.14.ffn1.output_dense.bias', 'encoder.layers.14.ffn1.output_dense.weight', 'encoder.layers.14.ffn1_layer_norm.bias', 'encoder.layers.14.ffn1_layer_norm.weight', 'encoder.layers.14.ffn2.intermediate_dense.bias', 'encoder.layers.14.ffn2.intermediate_dense.weight', 'encoder.layers.14.ffn2.output_dense.bias', 'encoder.layers.14.ffn2.output_dense.weight', 'encoder.layers.14.ffn2_layer_norm.bias', 'encoder.layers.14.ffn2_layer_norm.weight', 'encoder.layers.14.final_layer_norm.bias', 'encoder.layers.14.final_layer_norm.weight', 'encoder.layers.14.self_attn.distance_embedding.weight', 'encoder.layers.14.self_attn.linear_k.bias', 'encoder.layers.14.self_attn.linear_k.weight', 'encoder.layers.14.self_attn.linear_out.bias', 'encoder.layers.14.self_attn.linear_out.weight', 'encoder.layers.14.self_attn.linear_q.bias', 'encoder.layers.14.self_attn.linear_q.weight', 'encoder.layers.14.self_attn.linear_v.bias', 'encoder.layers.14.self_attn.linear_v.weight', 'encoder.layers.14.self_attn_layer_norm.bias', 'encoder.layers.14.self_attn_layer_norm.weight', 'encoder.layers.15.conv_module.depthwise_conv.weight', 'encoder.layers.15.conv_module.depthwise_layer_norm.bias', 'encoder.layers.15.conv_module.depthwise_layer_norm.weight', 'encoder.layers.15.conv_module.layer_norm.bias', 'encoder.layers.15.conv_module.layer_norm.weight', 'encoder.layers.15.conv_module.pointwise_conv1.weight', 'encoder.layers.15.conv_module.pointwise_conv2.weight', 'encoder.layers.15.ffn1.intermediate_dense.bias', 'encoder.layers.15.ffn1.intermediate_dense.weight', 'encoder.layers.15.ffn1.output_dense.bias', 'encoder.layers.15.ffn1.output_dense.weight', 'encoder.layers.15.ffn1_layer_norm.bias', 'encoder.layers.15.ffn1_layer_norm.weight', 'encoder.layers.15.ffn2.intermediate_dense.bias', 'encoder.layers.15.ffn2.intermediate_dense.weight', 'encoder.layers.15.ffn2.output_dense.bias', 'encoder.layers.15.ffn2.output_dense.weight', 'encoder.layers.15.ffn2_layer_norm.bias', 'encoder.layers.15.ffn2_layer_norm.weight', 'encoder.layers.15.final_layer_norm.bias', 'encoder.layers.15.final_layer_norm.weight', 'encoder.layers.15.self_attn.distance_embedding.weight', 'encoder.layers.15.self_attn.linear_k.bias', 'encoder.layers.15.self_attn.linear_k.weight', 'encoder.layers.15.self_attn.linear_out.bias', 'encoder.layers.15.self_attn.linear_out.weight', 'encoder.layers.15.self_attn.linear_q.bias', 'encoder.layers.15.self_attn.linear_q.weight', 'encoder.layers.15.self_attn.linear_v.bias', 'encoder.layers.15.self_attn.linear_v.weight', 'encoder.layers.15.self_attn_layer_norm.bias', 'encoder.layers.15.self_attn_layer_norm.weight', 'encoder.layers.16.conv_module.depthwise_conv.weight', 'encoder.layers.16.conv_module.depthwise_layer_norm.bias', 'encoder.layers.16.conv_module.depthwise_layer_norm.weight', 'encoder.layers.16.conv_module.layer_norm.bias', 'encoder.layers.16.conv_module.layer_norm.weight', 'encoder.layers.16.conv_module.pointwise_conv1.weight', 'encoder.layers.16.conv_module.pointwise_conv2.weight', 'encoder.layers.16.ffn1.intermediate_dense.bias', 'encoder.layers.16.ffn1.intermediate_dense.weight', 'encoder.layers.16.ffn1.output_dense.bias', 'encoder.layers.16.ffn1.output_dense.weight', 'encoder.layers.16.ffn1_layer_norm.bias', 'encoder.layers.16.ffn1_layer_norm.weight', 'encoder.layers.16.ffn2.intermediate_dense.bias', 'encoder.layers.16.ffn2.intermediate_dense.weight', 'encoder.layers.16.ffn2.output_dense.bias', 'encoder.layers.16.ffn2.output_dense.weight', 'encoder.layers.16.ffn2_layer_norm.bias', 'encoder.layers.16.ffn2_layer_norm.weight', 'encoder.layers.16.final_layer_norm.bias', 'encoder.layers.16.final_layer_norm.weight', 'encoder.layers.16.self_attn.distance_embedding.weight', 'encoder.layers.16.self_attn.linear_k.bias', 'encoder.layers.16.self_attn.linear_k.weight', 'encoder.layers.16.self_attn.linear_out.bias', 'encoder.layers.16.self_attn.linear_out.weight', 'encoder.layers.16.self_attn.linear_q.bias', 'encoder.layers.16.self_attn.linear_q.weight', 'encoder.layers.16.self_attn.linear_v.bias', 'encoder.layers.16.self_attn.linear_v.weight', 'encoder.layers.16.self_attn_layer_norm.bias', 'encoder.layers.16.self_attn_layer_norm.weight', 'encoder.layers.17.conv_module.depthwise_conv.weight', 'encoder.layers.17.conv_module.depthwise_layer_norm.bias', 'encoder.layers.17.conv_module.depthwise_layer_norm.weight', 'encoder.layers.17.conv_module.layer_norm.bias', 'encoder.layers.17.conv_module.layer_norm.weight', 'encoder.layers.17.conv_module.pointwise_conv1.weight', 'encoder.layers.17.conv_module.pointwise_conv2.weight', 'encoder.layers.17.ffn1.intermediate_dense.bias', 'encoder.layers.17.ffn1.intermediate_dense.weight', 'encoder.layers.17.ffn1.output_dense.bias', 'encoder.layers.17.ffn1.output_dense.weight', 'encoder.layers.17.ffn1_layer_norm.bias', 'encoder.layers.17.ffn1_layer_norm.weight', 'encoder.layers.17.ffn2.intermediate_dense.bias', 'encoder.layers.17.ffn2.intermediate_dense.weight', 'encoder.layers.17.ffn2.output_dense.bias', 'encoder.layers.17.ffn2.output_dense.weight', 'encoder.layers.17.ffn2_layer_norm.bias', 'encoder.layers.17.ffn2_layer_norm.weight', 'encoder.layers.17.final_layer_norm.bias', 'encoder.layers.17.final_layer_norm.weight', 'encoder.layers.17.self_attn.distance_embedding.weight', 'encoder.layers.17.self_attn.linear_k.bias', 'encoder.layers.17.self_attn.linear_k.weight', 'encoder.layers.17.self_attn.linear_out.bias', 'encoder.layers.17.self_attn.linear_out.weight', 'encoder.layers.17.self_attn.linear_q.bias', 'encoder.layers.17.self_attn.linear_q.weight', 'encoder.layers.17.self_attn.linear_v.bias', 'encoder.layers.17.self_attn.linear_v.weight', 'encoder.layers.17.self_attn_layer_norm.bias', 'encoder.layers.17.self_attn_layer_norm.weight', 'encoder.layers.18.conv_module.depthwise_conv.weight', 'encoder.layers.18.conv_module.depthwise_layer_norm.bias', 'encoder.layers.18.conv_module.depthwise_layer_norm.weight', 'encoder.layers.18.conv_module.layer_norm.bias', 'encoder.layers.18.conv_module.layer_norm.weight', 'encoder.layers.18.conv_module.pointwise_conv1.weight', 'encoder.layers.18.conv_module.pointwise_conv2.weight', 'encoder.layers.18.ffn1.intermediate_dense.bias', 'encoder.layers.18.ffn1.intermediate_dense.weight', 'encoder.layers.18.ffn1.output_dense.bias', 'encoder.layers.18.ffn1.output_dense.weight', 'encoder.layers.18.ffn1_layer_norm.bias', 'encoder.layers.18.ffn1_layer_norm.weight', 'encoder.layers.18.ffn2.intermediate_dense.bias', 'encoder.layers.18.ffn2.intermediate_dense.weight', 'encoder.layers.18.ffn2.output_dense.bias', 'encoder.layers.18.ffn2.output_dense.weight', 'encoder.layers.18.ffn2_layer_norm.bias', 'encoder.layers.18.ffn2_layer_norm.weight', 'encoder.layers.18.final_layer_norm.bias', 'encoder.layers.18.final_layer_norm.weight', 'encoder.layers.18.self_attn.distance_embedding.weight', 'encoder.layers.18.self_attn.linear_k.bias', 'encoder.layers.18.self_attn.linear_k.weight', 'encoder.layers.18.self_attn.linear_out.bias', 'encoder.layers.18.self_attn.linear_out.weight', 'encoder.layers.18.self_attn.linear_q.bias', 'encoder.layers.18.self_attn.linear_q.weight', 'encoder.layers.18.self_attn.linear_v.bias', 'encoder.layers.18.self_attn.linear_v.weight', 'encoder.layers.18.self_attn_layer_norm.bias', 'encoder.layers.18.self_attn_layer_norm.weight', 'encoder.layers.19.conv_module.depthwise_conv.weight', 'encoder.layers.19.conv_module.depthwise_layer_norm.bias', 'encoder.layers.19.conv_module.depthwise_layer_norm.weight', 'encoder.layers.19.conv_module.layer_norm.bias', 'encoder.layers.19.conv_module.layer_norm.weight', 'encoder.layers.19.conv_module.pointwise_conv1.weight', 'encoder.layers.19.conv_module.pointwise_conv2.weight', 'encoder.layers.19.ffn1.intermediate_dense.bias', 'encoder.layers.19.ffn1.intermediate_dense.weight', 'encoder.layers.19.ffn1.output_dense.bias', 'encoder.layers.19.ffn1.output_dense.weight', 'encoder.layers.19.ffn1_layer_norm.bias', 'encoder.layers.19.ffn1_layer_norm.weight', 'encoder.layers.19.ffn2.intermediate_dense.bias', 'encoder.layers.19.ffn2.intermediate_dense.weight', 'encoder.layers.19.ffn2.output_dense.bias', 'encoder.layers.19.ffn2.output_dense.weight', 'encoder.layers.19.ffn2_layer_norm.bias', 'encoder.layers.19.ffn2_layer_norm.weight', 'encoder.layers.19.final_layer_norm.bias', 'encoder.layers.19.final_layer_norm.weight', 'encoder.layers.19.self_attn.distance_embedding.weight', 'encoder.layers.19.self_attn.linear_k.bias', 'encoder.layers.19.self_attn.linear_k.weight', 'encoder.layers.19.self_attn.linear_out.bias', 'encoder.layers.19.self_attn.linear_out.weight', 'encoder.layers.19.self_attn.linear_q.bias', 'encoder.layers.19.self_attn.linear_q.weight', 'encoder.layers.19.self_attn.linear_v.bias', 'encoder.layers.19.self_attn.linear_v.weight', 'encoder.layers.19.self_attn_layer_norm.bias', 'encoder.layers.19.self_attn_layer_norm.weight', 'encoder.layers.20.conv_module.depthwise_conv.weight', 'encoder.layers.20.conv_module.depthwise_layer_norm.bias', 'encoder.layers.20.conv_module.depthwise_layer_norm.weight', 'encoder.layers.20.conv_module.layer_norm.bias', 'encoder.layers.20.conv_module.layer_norm.weight', 'encoder.layers.20.conv_module.pointwise_conv1.weight', 'encoder.layers.20.conv_module.pointwise_conv2.weight', 'encoder.layers.20.ffn1.intermediate_dense.bias', 'encoder.layers.20.ffn1.intermediate_dense.weight', 'encoder.layers.20.ffn1.output_dense.bias', 'encoder.layers.20.ffn1.output_dense.weight', 'encoder.layers.20.ffn1_layer_norm.bias', 'encoder.layers.20.ffn1_layer_norm.weight', 'encoder.layers.20.ffn2.intermediate_dense.bias', 'encoder.layers.20.ffn2.intermediate_dense.weight', 'encoder.layers.20.ffn2.output_dense.bias', 'encoder.layers.20.ffn2.output_dense.weight', 'encoder.layers.20.ffn2_layer_norm.bias', 'encoder.layers.20.ffn2_layer_norm.weight', 'encoder.layers.20.final_layer_norm.bias', 'encoder.layers.20.final_layer_norm.weight', 'encoder.layers.20.self_attn.distance_embedding.weight', 'encoder.layers.20.self_attn.linear_k.bias', 'encoder.layers.20.self_attn.linear_k.weight', 'encoder.layers.20.self_attn.linear_out.bias', 'encoder.layers.20.self_attn.linear_out.weight', 'encoder.layers.20.self_attn.linear_q.bias', 'encoder.layers.20.self_attn.linear_q.weight', 'encoder.layers.20.self_attn.linear_v.bias', 'encoder.layers.20.self_attn.linear_v.weight', 'encoder.layers.20.self_attn_layer_norm.bias', 'encoder.layers.20.self_attn_layer_norm.weight', 'encoder.layers.21.conv_module.depthwise_conv.weight', 'encoder.layers.21.conv_module.depthwise_layer_norm.bias', 'encoder.layers.21.conv_module.depthwise_layer_norm.weight', 'encoder.layers.21.conv_module.layer_norm.bias', 'encoder.layers.21.conv_module.layer_norm.weight', 'encoder.layers.21.conv_module.pointwise_conv1.weight', 'encoder.layers.21.conv_module.pointwise_conv2.weight', 'encoder.layers.21.ffn1.intermediate_dense.bias', 'encoder.layers.21.ffn1.intermediate_dense.weight', 'encoder.layers.21.ffn1.output_dense.bias', 'encoder.layers.21.ffn1.output_dense.weight', 'encoder.layers.21.ffn1_layer_norm.bias', 'encoder.layers.21.ffn1_layer_norm.weight', 'encoder.layers.21.ffn2.intermediate_dense.bias', 'encoder.layers.21.ffn2.intermediate_dense.weight', 'encoder.layers.21.ffn2.output_dense.bias', 'encoder.layers.21.ffn2.output_dense.weight', 'encoder.layers.21.ffn2_layer_norm.bias', 'encoder.layers.21.ffn2_layer_norm.weight', 'encoder.layers.21.final_layer_norm.bias', 'encoder.layers.21.final_layer_norm.weight', 'encoder.layers.21.self_attn.distance_embedding.weight', 'encoder.layers.21.self_attn.linear_k.bias', 'encoder.layers.21.self_attn.linear_k.weight', 'encoder.layers.21.self_attn.linear_out.bias', 'encoder.layers.21.self_attn.linear_out.weight', 'encoder.layers.21.self_attn.linear_q.bias', 'encoder.layers.21.self_attn.linear_q.weight', 'encoder.layers.21.self_attn.linear_v.bias', 'encoder.layers.21.self_attn.linear_v.weight', 'encoder.layers.21.self_attn_layer_norm.bias', 'encoder.layers.21.self_attn_layer_norm.weight', 'encoder.layers.22.conv_module.depthwise_conv.weight', 'encoder.layers.22.conv_module.depthwise_layer_norm.bias', 'encoder.layers.22.conv_module.depthwise_layer_norm.weight', 'encoder.layers.22.conv_module.layer_norm.bias', 'encoder.layers.22.conv_module.layer_norm.weight', 'encoder.layers.22.conv_module.pointwise_conv1.weight', 'encoder.layers.22.conv_module.pointwise_conv2.weight', 'encoder.layers.22.ffn1.intermediate_dense.bias', 'encoder.layers.22.ffn1.intermediate_dense.weight', 'encoder.layers.22.ffn1.output_dense.bias', 'encoder.layers.22.ffn1.output_dense.weight', 'encoder.layers.22.ffn1_layer_norm.bias', 'encoder.layers.22.ffn1_layer_norm.weight', 'encoder.layers.22.ffn2.intermediate_dense.bias', 'encoder.layers.22.ffn2.intermediate_dense.weight', 'encoder.layers.22.ffn2.output_dense.bias', 'encoder.layers.22.ffn2.output_dense.weight', 'encoder.layers.22.ffn2_layer_norm.bias', 'encoder.layers.22.ffn2_layer_norm.weight', 'encoder.layers.22.final_layer_norm.bias', 'encoder.layers.22.final_layer_norm.weight', 'encoder.layers.22.self_attn.distance_embedding.weight', 'encoder.layers.22.self_attn.linear_k.bias', 'encoder.layers.22.self_attn.linear_k.weight', 'encoder.layers.22.self_attn.linear_out.bias', 'encoder.layers.22.self_attn.linear_out.weight', 'encoder.layers.22.self_attn.linear_q.bias', 'encoder.layers.22.self_attn.linear_q.weight', 'encoder.layers.22.self_attn.linear_v.bias', 'encoder.layers.22.self_attn.linear_v.weight', 'encoder.layers.22.self_attn_layer_norm.bias', 'encoder.layers.22.self_attn_layer_norm.weight', 'encoder.layers.23.conv_module.depthwise_conv.weight', 'encoder.layers.23.conv_module.depthwise_layer_norm.bias', 'encoder.layers.23.conv_module.depthwise_layer_norm.weight', 'encoder.layers.23.conv_module.layer_norm.bias', 'encoder.layers.23.conv_module.layer_norm.weight', 'encoder.layers.23.conv_module.pointwise_conv1.weight', 'encoder.layers.23.conv_module.pointwise_conv2.weight', 'encoder.layers.23.ffn1.intermediate_dense.bias', 'encoder.layers.23.ffn1.intermediate_dense.weight', 'encoder.layers.23.ffn1.output_dense.bias', 'encoder.layers.23.ffn1.output_dense.weight', 'encoder.layers.23.ffn1_layer_norm.bias', 'encoder.layers.23.ffn1_layer_norm.weight', 'encoder.layers.23.ffn2.intermediate_dense.bias', 'encoder.layers.23.ffn2.intermediate_dense.weight', 'encoder.layers.23.ffn2.output_dense.bias', 'encoder.layers.23.ffn2.output_dense.weight', 'encoder.layers.23.ffn2_layer_norm.bias', 'encoder.layers.23.ffn2_layer_norm.weight', 'encoder.layers.23.final_layer_norm.bias', 'encoder.layers.23.final_layer_norm.weight', 'encoder.layers.23.self_attn.distance_embedding.weight', 'encoder.layers.23.self_attn.linear_k.bias', 'encoder.layers.23.self_attn.linear_k.weight', 'encoder.layers.23.self_attn.linear_out.bias', 'encoder.layers.23.self_attn.linear_out.weight', 'encoder.layers.23.self_attn.linear_q.bias', 'encoder.layers.23.self_attn.linear_q.weight', 'encoder.layers.23.self_attn.linear_v.bias', 'encoder.layers.23.self_attn.linear_v.weight', 'encoder.layers.23.self_attn_layer_norm.bias', 'encoder.layers.23.self_attn_layer_norm.weight', 'encoder.layers.6.conv_module.depthwise_conv.weight', 'encoder.layers.6.conv_module.depthwise_layer_norm.bias', 'encoder.layers.6.conv_module.depthwise_layer_norm.weight', 'encoder.layers.6.conv_module.layer_norm.bias', 'encoder.layers.6.conv_module.layer_norm.weight', 'encoder.layers.6.conv_module.pointwise_conv1.weight', 'encoder.layers.6.conv_module.pointwise_conv2.weight', 'encoder.layers.6.ffn1.intermediate_dense.bias', 'encoder.layers.6.ffn1.intermediate_dense.weight', 'encoder.layers.6.ffn1.output_dense.bias', 'encoder.layers.6.ffn1.output_dense.weight', 'encoder.layers.6.ffn1_layer_norm.bias', 'encoder.layers.6.ffn1_layer_norm.weight', 'encoder.layers.6.ffn2.intermediate_dense.bias', 'encoder.layers.6.ffn2.intermediate_dense.weight', 'encoder.layers.6.ffn2.output_dense.bias', 'encoder.layers.6.ffn2.output_dense.weight', 'encoder.layers.6.ffn2_layer_norm.bias', 'encoder.layers.6.ffn2_layer_norm.weight', 'encoder.layers.6.final_layer_norm.bias', 'encoder.layers.6.final_layer_norm.weight', 'encoder.layers.6.self_attn.distance_embedding.weight', 'encoder.layers.6.self_attn.linear_k.bias', 'encoder.layers.6.self_attn.linear_k.weight', 'encoder.layers.6.self_attn.linear_out.bias', 'encoder.layers.6.self_attn.linear_out.weight', 'encoder.layers.6.self_attn.linear_q.bias', 'encoder.layers.6.self_attn.linear_q.weight', 'encoder.layers.6.self_attn.linear_v.bias', 'encoder.layers.6.self_attn.linear_v.weight', 'encoder.layers.6.self_attn_layer_norm.bias', 'encoder.layers.6.self_attn_layer_norm.weight', 'encoder.layers.7.conv_module.depthwise_conv.weight', 'encoder.layers.7.conv_module.depthwise_layer_norm.bias', 'encoder.layers.7.conv_module.depthwise_layer_norm.weight', 'encoder.layers.7.conv_module.layer_norm.bias', 'encoder.layers.7.conv_module.layer_norm.weight', 'encoder.layers.7.conv_module.pointwise_conv1.weight', 'encoder.layers.7.conv_module.pointwise_conv2.weight', 'encoder.layers.7.ffn1.intermediate_dense.bias', 'encoder.layers.7.ffn1.intermediate_dense.weight', 'encoder.layers.7.ffn1.output_dense.bias', 'encoder.layers.7.ffn1.output_dense.weight', 'encoder.layers.7.ffn1_layer_norm.bias', 'encoder.layers.7.ffn1_layer_norm.weight', 'encoder.layers.7.ffn2.intermediate_dense.bias', 'encoder.layers.7.ffn2.intermediate_dense.weight', 'encoder.layers.7.ffn2.output_dense.bias', 'encoder.layers.7.ffn2.output_dense.weight', 'encoder.layers.7.ffn2_layer_norm.bias', 'encoder.layers.7.ffn2_layer_norm.weight', 'encoder.layers.7.final_layer_norm.bias', 'encoder.layers.7.final_layer_norm.weight', 'encoder.layers.7.self_attn.distance_embedding.weight', 'encoder.layers.7.self_attn.linear_k.bias', 'encoder.layers.7.self_attn.linear_k.weight', 'encoder.layers.7.self_attn.linear_out.bias', 'encoder.layers.7.self_attn.linear_out.weight', 'encoder.layers.7.self_attn.linear_q.bias', 'encoder.layers.7.self_attn.linear_q.weight', 'encoder.layers.7.self_attn.linear_v.bias', 'encoder.layers.7.self_attn.linear_v.weight', 'encoder.layers.7.self_attn_layer_norm.bias', 'encoder.layers.7.self_attn_layer_norm.weight', 'encoder.layers.8.conv_module.depthwise_conv.weight', 'encoder.layers.8.conv_module.depthwise_layer_norm.bias', 'encoder.layers.8.conv_module.depthwise_layer_norm.weight', 'encoder.layers.8.conv_module.layer_norm.bias', 'encoder.layers.8.conv_module.layer_norm.weight', 'encoder.layers.8.conv_module.pointwise_conv1.weight', 'encoder.layers.8.conv_module.pointwise_conv2.weight', 'encoder.layers.8.ffn1.intermediate_dense.bias', 'encoder.layers.8.ffn1.intermediate_dense.weight', 'encoder.layers.8.ffn1.output_dense.bias', 'encoder.layers.8.ffn1.output_dense.weight', 'encoder.layers.8.ffn1_layer_norm.bias', 'encoder.layers.8.ffn1_layer_norm.weight', 'encoder.layers.8.ffn2.intermediate_dense.bias', 'encoder.layers.8.ffn2.intermediate_dense.weight', 'encoder.layers.8.ffn2.output_dense.bias', 'encoder.layers.8.ffn2.output_dense.weight', 'encoder.layers.8.ffn2_layer_norm.bias', 'encoder.layers.8.ffn2_layer_norm.weight', 'encoder.layers.8.final_layer_norm.bias', 'encoder.layers.8.final_layer_norm.weight', 'encoder.layers.8.self_attn.distance_embedding.weight', 'encoder.layers.8.self_attn.linear_k.bias', 'encoder.layers.8.self_attn.linear_k.weight', 'encoder.layers.8.self_attn.linear_out.bias', 'encoder.layers.8.self_attn.linear_out.weight', 'encoder.layers.8.self_attn.linear_q.bias', 'encoder.layers.8.self_attn.linear_q.weight', 'encoder.layers.8.self_attn.linear_v.bias', 'encoder.layers.8.self_attn.linear_v.weight', 'encoder.layers.8.self_attn_layer_norm.bias', 'encoder.layers.8.self_attn_layer_norm.weight', 'encoder.layers.9.conv_module.depthwise_conv.weight', 'encoder.layers.9.conv_module.depthwise_layer_norm.bias', 'encoder.layers.9.conv_module.depthwise_layer_norm.weight', 'encoder.layers.9.conv_module.layer_norm.bias', 'encoder.layers.9.conv_module.layer_norm.weight', 'encoder.layers.9.conv_module.pointwise_conv1.weight', 'encoder.layers.9.conv_module.pointwise_conv2.weight', 'encoder.layers.9.ffn1.intermediate_dense.bias', 'encoder.layers.9.ffn1.intermediate_dense.weight', 'encoder.layers.9.ffn1.output_dense.bias', 'encoder.layers.9.ffn1.output_dense.weight', 'encoder.layers.9.ffn1_layer_norm.bias', 'encoder.layers.9.ffn1_layer_norm.weight', 'encoder.layers.9.ffn2.intermediate_dense.bias', 'encoder.layers.9.ffn2.intermediate_dense.weight', 'encoder.layers.9.ffn2.output_dense.bias', 'encoder.layers.9.ffn2.output_dense.weight', 'encoder.layers.9.ffn2_layer_norm.bias', 'encoder.layers.9.ffn2_layer_norm.weight', 'encoder.layers.9.final_layer_norm.bias', 'encoder.layers.9.final_layer_norm.weight', 'encoder.layers.9.self_attn.distance_embedding.weight', 'encoder.layers.9.self_attn.linear_k.bias', 'encoder.layers.9.self_attn.linear_k.weight', 'encoder.layers.9.self_attn.linear_out.bias', 'encoder.layers.9.self_attn.linear_out.weight', 'encoder.layers.9.self_attn.linear_q.bias', 'encoder.layers.9.self_attn.linear_q.weight', 'encoder.layers.9.self_attn.linear_v.bias', 'encoder.layers.9.self_attn.linear_v.weight', 'encoder.layers.9.self_attn_layer_norm.bias', 'encoder.layers.9.self_attn_layer_norm.weight']
- This IS expected if you are initializing Wav2Vec2BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing Wav2Vec2BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
2025-02-06 10:30:45,122 (infer:201) INFO: params.model_file: /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_w2v-bert2_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/best-valid-der.pt
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py:203: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  torch.load(params.model_file, map_location=device)["model"]
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/ts_vad_dataset.py:398: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  feature = torch.load(path, map_location="cpu")
2025-02-06 10:36:17,390 (infer:89) INFO: frame_len: 0.04!!
self.wavlm_fuse_feat_post_norm: False
Model DER:  1.0
Model ACC:  0.8314988093552543
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:09,  2.43it/s]  8%|▊         | 2/25 [00:00<00:09,  2.44it/s] 12%|█▏        | 3/25 [00:01<00:09,  2.42it/s] 16%|█▌        | 4/25 [00:01<00:08,  2.41it/s] 20%|██        | 5/25 [00:02<00:08,  2.22it/s] 24%|██▍       | 6/25 [00:02<00:08,  2.16it/s] 28%|██▊       | 7/25 [00:03<00:08,  2.11it/s] 32%|███▏      | 8/25 [00:03<00:08,  2.10it/s] 36%|███▌      | 9/25 [00:04<00:07,  2.08it/s] 40%|████      | 10/25 [00:04<00:08,  1.69it/s] 44%|████▍     | 11/25 [00:05<00:08,  1.73it/s] 48%|████▊     | 12/25 [00:06<00:07,  1.76it/s] 52%|█████▏    | 13/25 [00:06<00:06,  1.78it/s] 56%|█████▌    | 14/25 [00:07<00:06,  1.80it/s] 60%|██████    | 15/25 [00:07<00:05,  1.87it/s] 64%|██████▍   | 16/25 [00:08<00:04,  1.91it/s] 68%|██████▊   | 17/25 [00:08<00:03,  2.01it/s] 72%|███████▏  | 18/25 [00:08<00:03,  2.12it/s] 76%|███████▌  | 19/25 [00:09<00:02,  2.08it/s] 80%|████████  | 20/25 [00:10<00:02,  1.67it/s] 84%|████████▍ | 21/25 [00:10<00:02,  1.77it/s] 88%|████████▊ | 22/25 [00:11<00:01,  1.84it/s] 92%|█████████▏| 23/25 [00:11<00:01,  1.80it/s] 96%|█████████▌| 24/25 [00:12<00:00,  1.77it/s]100%|██████████| 25/25 [00:13<00:00,  1.75it/s]100%|██████████| 25/25 [00:13<00:00,  1.91it/s]
Eval for threshold 0.2 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.3 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.35 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.4 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.45 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.5 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.55 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.6 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.7 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.8 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


2025-02-06 10:36:39,396 (infer:256) INFO: infer data_cfg: TSVADDataConfig(data_dir='/mntcephfs/lab_data/maduo/datasets/alimeeting', ts_len=6000, rs_len=10, segment_shift=1, spk_path='/mntcephfs/lab_data/maduo/model_hub/ts_vad/spk_embed/alimeeting/SpeakerEmbedding', speech_encoder_type='w2v-bert2', speaker_embedding_name_dir='cam++_zh-cn_200k_feature_dir', speaker_embed_dim=192, noise_ratio=0.8, zero_ratio=0.3, sample_rate=16000, max_num_speaker=7, dataset_name='alimeeting', embed_input=False, embed_len=1, embed_shift=0.4, label_rate=25, random_channel=False, random_mask_speaker_prob=0.0, random_mask_speaker_step=0, musan_path='/mntcephfs/lee_dataset/asr/musan', rir_path='/mntcephfs/lee_dataset/asr/RIRS_NOISES')
2025-02-06 10:36:39,396 (infer:257) INFO: currently, it will infer Test set.
  0%|          | 0/60 [00:00<?, ?it/s] 70%|███████   | 42/60 [00:00<00:00, 411.74it/s]100%|██████████| 60/60 [00:00<00:00, 409.95it/s]
2025-02-06 10:36:39,556 (ts_vad_dataset:152) INFO: model expect fbank as input , fbank_input should be True !!!
2025-02-06 10:36:39,556 (ts_vad_dataset:160) INFO: loaded sentence=38807, shortest sent=640.0, longest sent=160000.0, rs_len=10, segment_shift=1,  rir=False, musan=False, noise_ratio=0.8, zero_ratio=0.3 
2025-02-06 10:36:39,627 (infer:279) INFO: Device: cuda:0
2025-02-06 10:36:39,627 (infer:297) INFO: infer model_cfg: TSVADConfig(speech_encoder_path='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/w2v-bert2.0/model.safetensors', speech_encoder_type='w2v-bert2', freeze_speech_encoder_updates=4000, num_attention_head=4, num_transformer_layer=2, transformer_embed_dim=384, transformer_ffn_embed_dim=1536, speaker_embed_dim=192, dropout=0.1, use_spk_embed=True, feature_grad_mult=0.1, whisper_n_mels=80, select_encoder_layer_nums=6, wavlm_fuse_feat_post_norm=False, speech_encoder_config='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/w2v-bert2.0/config.json', single_backend_type='mamba2', multi_backend_type='transformer', d_state=256, expand=4)
Some weights of the model checkpoint at /mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/w2v-bert2.0/model.safetensors were not used when initializing Wav2Vec2BertModel: ['encoder.layers.10.conv_module.depthwise_conv.weight', 'encoder.layers.10.conv_module.depthwise_layer_norm.bias', 'encoder.layers.10.conv_module.depthwise_layer_norm.weight', 'encoder.layers.10.conv_module.layer_norm.bias', 'encoder.layers.10.conv_module.layer_norm.weight', 'encoder.layers.10.conv_module.pointwise_conv1.weight', 'encoder.layers.10.conv_module.pointwise_conv2.weight', 'encoder.layers.10.ffn1.intermediate_dense.bias', 'encoder.layers.10.ffn1.intermediate_dense.weight', 'encoder.layers.10.ffn1.output_dense.bias', 'encoder.layers.10.ffn1.output_dense.weight', 'encoder.layers.10.ffn1_layer_norm.bias', 'encoder.layers.10.ffn1_layer_norm.weight', 'encoder.layers.10.ffn2.intermediate_dense.bias', 'encoder.layers.10.ffn2.intermediate_dense.weight', 'encoder.layers.10.ffn2.output_dense.bias', 'encoder.layers.10.ffn2.output_dense.weight', 'encoder.layers.10.ffn2_layer_norm.bias', 'encoder.layers.10.ffn2_layer_norm.weight', 'encoder.layers.10.final_layer_norm.bias', 'encoder.layers.10.final_layer_norm.weight', 'encoder.layers.10.self_attn.distance_embedding.weight', 'encoder.layers.10.self_attn.linear_k.bias', 'encoder.layers.10.self_attn.linear_k.weight', 'encoder.layers.10.self_attn.linear_out.bias', 'encoder.layers.10.self_attn.linear_out.weight', 'encoder.layers.10.self_attn.linear_q.bias', 'encoder.layers.10.self_attn.linear_q.weight', 'encoder.layers.10.self_attn.linear_v.bias', 'encoder.layers.10.self_attn.linear_v.weight', 'encoder.layers.10.self_attn_layer_norm.bias', 'encoder.layers.10.self_attn_layer_norm.weight', 'encoder.layers.11.conv_module.depthwise_conv.weight', 'encoder.layers.11.conv_module.depthwise_layer_norm.bias', 'encoder.layers.11.conv_module.depthwise_layer_norm.weight', 'encoder.layers.11.conv_module.layer_norm.bias', 'encoder.layers.11.conv_module.layer_norm.weight', 'encoder.layers.11.conv_module.pointwise_conv1.weight', 'encoder.layers.11.conv_module.pointwise_conv2.weight', 'encoder.layers.11.ffn1.intermediate_dense.bias', 'encoder.layers.11.ffn1.intermediate_dense.weight', 'encoder.layers.11.ffn1.output_dense.bias', 'encoder.layers.11.ffn1.output_dense.weight', 'encoder.layers.11.ffn1_layer_norm.bias', 'encoder.layers.11.ffn1_layer_norm.weight', 'encoder.layers.11.ffn2.intermediate_dense.bias', 'encoder.layers.11.ffn2.intermediate_dense.weight', 'encoder.layers.11.ffn2.output_dense.bias', 'encoder.layers.11.ffn2.output_dense.weight', 'encoder.layers.11.ffn2_layer_norm.bias', 'encoder.layers.11.ffn2_layer_norm.weight', 'encoder.layers.11.final_layer_norm.bias', 'encoder.layers.11.final_layer_norm.weight', 'encoder.layers.11.self_attn.distance_embedding.weight', 'encoder.layers.11.self_attn.linear_k.bias', 'encoder.layers.11.self_attn.linear_k.weight', 'encoder.layers.11.self_attn.linear_out.bias', 'encoder.layers.11.self_attn.linear_out.weight', 'encoder.layers.11.self_attn.linear_q.bias', 'encoder.layers.11.self_attn.linear_q.weight', 'encoder.layers.11.self_attn.linear_v.bias', 'encoder.layers.11.self_attn.linear_v.weight', 'encoder.layers.11.self_attn_layer_norm.bias', 'encoder.layers.11.self_attn_layer_norm.weight', 'encoder.layers.12.conv_module.depthwise_conv.weight', 'encoder.layers.12.conv_module.depthwise_layer_norm.bias', 'encoder.layers.12.conv_module.depthwise_layer_norm.weight', 'encoder.layers.12.conv_module.layer_norm.bias', 'encoder.layers.12.conv_module.layer_norm.weight', 'encoder.layers.12.conv_module.pointwise_conv1.weight', 'encoder.layers.12.conv_module.pointwise_conv2.weight', 'encoder.layers.12.ffn1.intermediate_dense.bias', 'encoder.layers.12.ffn1.intermediate_dense.weight', 'encoder.layers.12.ffn1.output_dense.bias', 'encoder.layers.12.ffn1.output_dense.weight', 'encoder.layers.12.ffn1_layer_norm.bias', 'encoder.layers.12.ffn1_layer_norm.weight', 'encoder.layers.12.ffn2.intermediate_dense.bias', 'encoder.layers.12.ffn2.intermediate_dense.weight', 'encoder.layers.12.ffn2.output_dense.bias', 'encoder.layers.12.ffn2.output_dense.weight', 'encoder.layers.12.ffn2_layer_norm.bias', 'encoder.layers.12.ffn2_layer_norm.weight', 'encoder.layers.12.final_layer_norm.bias', 'encoder.layers.12.final_layer_norm.weight', 'encoder.layers.12.self_attn.distance_embedding.weight', 'encoder.layers.12.self_attn.linear_k.bias', 'encoder.layers.12.self_attn.linear_k.weight', 'encoder.layers.12.self_attn.linear_out.bias', 'encoder.layers.12.self_attn.linear_out.weight', 'encoder.layers.12.self_attn.linear_q.bias', 'encoder.layers.12.self_attn.linear_q.weight', 'encoder.layers.12.self_attn.linear_v.bias', 'encoder.layers.12.self_attn.linear_v.weight', 'encoder.layers.12.self_attn_layer_norm.bias', 'encoder.layers.12.self_attn_layer_norm.weight', 'encoder.layers.13.conv_module.depthwise_conv.weight', 'encoder.layers.13.conv_module.depthwise_layer_norm.bias', 'encoder.layers.13.conv_module.depthwise_layer_norm.weight', 'encoder.layers.13.conv_module.layer_norm.bias', 'encoder.layers.13.conv_module.layer_norm.weight', 'encoder.layers.13.conv_module.pointwise_conv1.weight', 'encoder.layers.13.conv_module.pointwise_conv2.weight', 'encoder.layers.13.ffn1.intermediate_dense.bias', 'encoder.layers.13.ffn1.intermediate_dense.weight', 'encoder.layers.13.ffn1.output_dense.bias', 'encoder.layers.13.ffn1.output_dense.weight', 'encoder.layers.13.ffn1_layer_norm.bias', 'encoder.layers.13.ffn1_layer_norm.weight', 'encoder.layers.13.ffn2.intermediate_dense.bias', 'encoder.layers.13.ffn2.intermediate_dense.weight', 'encoder.layers.13.ffn2.output_dense.bias', 'encoder.layers.13.ffn2.output_dense.weight', 'encoder.layers.13.ffn2_layer_norm.bias', 'encoder.layers.13.ffn2_layer_norm.weight', 'encoder.layers.13.final_layer_norm.bias', 'encoder.layers.13.final_layer_norm.weight', 'encoder.layers.13.self_attn.distance_embedding.weight', 'encoder.layers.13.self_attn.linear_k.bias', 'encoder.layers.13.self_attn.linear_k.weight', 'encoder.layers.13.self_attn.linear_out.bias', 'encoder.layers.13.self_attn.linear_out.weight', 'encoder.layers.13.self_attn.linear_q.bias', 'encoder.layers.13.self_attn.linear_q.weight', 'encoder.layers.13.self_attn.linear_v.bias', 'encoder.layers.13.self_attn.linear_v.weight', 'encoder.layers.13.self_attn_layer_norm.bias', 'encoder.layers.13.self_attn_layer_norm.weight', 'encoder.layers.14.conv_module.depthwise_conv.weight', 'encoder.layers.14.conv_module.depthwise_layer_norm.bias', 'encoder.layers.14.conv_module.depthwise_layer_norm.weight', 'encoder.layers.14.conv_module.layer_norm.bias', 'encoder.layers.14.conv_module.layer_norm.weight', 'encoder.layers.14.conv_module.pointwise_conv1.weight', 'encoder.layers.14.conv_module.pointwise_conv2.weight', 'encoder.layers.14.ffn1.intermediate_dense.bias', 'encoder.layers.14.ffn1.intermediate_dense.weight', 'encoder.layers.14.ffn1.output_dense.bias', 'encoder.layers.14.ffn1.output_dense.weight', 'encoder.layers.14.ffn1_layer_norm.bias', 'encoder.layers.14.ffn1_layer_norm.weight', 'encoder.layers.14.ffn2.intermediate_dense.bias', 'encoder.layers.14.ffn2.intermediate_dense.weight', 'encoder.layers.14.ffn2.output_dense.bias', 'encoder.layers.14.ffn2.output_dense.weight', 'encoder.layers.14.ffn2_layer_norm.bias', 'encoder.layers.14.ffn2_layer_norm.weight', 'encoder.layers.14.final_layer_norm.bias', 'encoder.layers.14.final_layer_norm.weight', 'encoder.layers.14.self_attn.distance_embedding.weight', 'encoder.layers.14.self_attn.linear_k.bias', 'encoder.layers.14.self_attn.linear_k.weight', 'encoder.layers.14.self_attn.linear_out.bias', 'encoder.layers.14.self_attn.linear_out.weight', 'encoder.layers.14.self_attn.linear_q.bias', 'encoder.layers.14.self_attn.linear_q.weight', 'encoder.layers.14.self_attn.linear_v.bias', 'encoder.layers.14.self_attn.linear_v.weight', 'encoder.layers.14.self_attn_layer_norm.bias', 'encoder.layers.14.self_attn_layer_norm.weight', 'encoder.layers.15.conv_module.depthwise_conv.weight', 'encoder.layers.15.conv_module.depthwise_layer_norm.bias', 'encoder.layers.15.conv_module.depthwise_layer_norm.weight', 'encoder.layers.15.conv_module.layer_norm.bias', 'encoder.layers.15.conv_module.layer_norm.weight', 'encoder.layers.15.conv_module.pointwise_conv1.weight', 'encoder.layers.15.conv_module.pointwise_conv2.weight', 'encoder.layers.15.ffn1.intermediate_dense.bias', 'encoder.layers.15.ffn1.intermediate_dense.weight', 'encoder.layers.15.ffn1.output_dense.bias', 'encoder.layers.15.ffn1.output_dense.weight', 'encoder.layers.15.ffn1_layer_norm.bias', 'encoder.layers.15.ffn1_layer_norm.weight', 'encoder.layers.15.ffn2.intermediate_dense.bias', 'encoder.layers.15.ffn2.intermediate_dense.weight', 'encoder.layers.15.ffn2.output_dense.bias', 'encoder.layers.15.ffn2.output_dense.weight', 'encoder.layers.15.ffn2_layer_norm.bias', 'encoder.layers.15.ffn2_layer_norm.weight', 'encoder.layers.15.final_layer_norm.bias', 'encoder.layers.15.final_layer_norm.weight', 'encoder.layers.15.self_attn.distance_embedding.weight', 'encoder.layers.15.self_attn.linear_k.bias', 'encoder.layers.15.self_attn.linear_k.weight', 'encoder.layers.15.self_attn.linear_out.bias', 'encoder.layers.15.self_attn.linear_out.weight', 'encoder.layers.15.self_attn.linear_q.bias', 'encoder.layers.15.self_attn.linear_q.weight', 'encoder.layers.15.self_attn.linear_v.bias', 'encoder.layers.15.self_attn.linear_v.weight', 'encoder.layers.15.self_attn_layer_norm.bias', 'encoder.layers.15.self_attn_layer_norm.weight', 'encoder.layers.16.conv_module.depthwise_conv.weight', 'encoder.layers.16.conv_module.depthwise_layer_norm.bias', 'encoder.layers.16.conv_module.depthwise_layer_norm.weight', 'encoder.layers.16.conv_module.layer_norm.bias', 'encoder.layers.16.conv_module.layer_norm.weight', 'encoder.layers.16.conv_module.pointwise_conv1.weight', 'encoder.layers.16.conv_module.pointwise_conv2.weight', 'encoder.layers.16.ffn1.intermediate_dense.bias', 'encoder.layers.16.ffn1.intermediate_dense.weight', 'encoder.layers.16.ffn1.output_dense.bias', 'encoder.layers.16.ffn1.output_dense.weight', 'encoder.layers.16.ffn1_layer_norm.bias', 'encoder.layers.16.ffn1_layer_norm.weight', 'encoder.layers.16.ffn2.intermediate_dense.bias', 'encoder.layers.16.ffn2.intermediate_dense.weight', 'encoder.layers.16.ffn2.output_dense.bias', 'encoder.layers.16.ffn2.output_dense.weight', 'encoder.layers.16.ffn2_layer_norm.bias', 'encoder.layers.16.ffn2_layer_norm.weight', 'encoder.layers.16.final_layer_norm.bias', 'encoder.layers.16.final_layer_norm.weight', 'encoder.layers.16.self_attn.distance_embedding.weight', 'encoder.layers.16.self_attn.linear_k.bias', 'encoder.layers.16.self_attn.linear_k.weight', 'encoder.layers.16.self_attn.linear_out.bias', 'encoder.layers.16.self_attn.linear_out.weight', 'encoder.layers.16.self_attn.linear_q.bias', 'encoder.layers.16.self_attn.linear_q.weight', 'encoder.layers.16.self_attn.linear_v.bias', 'encoder.layers.16.self_attn.linear_v.weight', 'encoder.layers.16.self_attn_layer_norm.bias', 'encoder.layers.16.self_attn_layer_norm.weight', 'encoder.layers.17.conv_module.depthwise_conv.weight', 'encoder.layers.17.conv_module.depthwise_layer_norm.bias', 'encoder.layers.17.conv_module.depthwise_layer_norm.weight', 'encoder.layers.17.conv_module.layer_norm.bias', 'encoder.layers.17.conv_module.layer_norm.weight', 'encoder.layers.17.conv_module.pointwise_conv1.weight', 'encoder.layers.17.conv_module.pointwise_conv2.weight', 'encoder.layers.17.ffn1.intermediate_dense.bias', 'encoder.layers.17.ffn1.intermediate_dense.weight', 'encoder.layers.17.ffn1.output_dense.bias', 'encoder.layers.17.ffn1.output_dense.weight', 'encoder.layers.17.ffn1_layer_norm.bias', 'encoder.layers.17.ffn1_layer_norm.weight', 'encoder.layers.17.ffn2.intermediate_dense.bias', 'encoder.layers.17.ffn2.intermediate_dense.weight', 'encoder.layers.17.ffn2.output_dense.bias', 'encoder.layers.17.ffn2.output_dense.weight', 'encoder.layers.17.ffn2_layer_norm.bias', 'encoder.layers.17.ffn2_layer_norm.weight', 'encoder.layers.17.final_layer_norm.bias', 'encoder.layers.17.final_layer_norm.weight', 'encoder.layers.17.self_attn.distance_embedding.weight', 'encoder.layers.17.self_attn.linear_k.bias', 'encoder.layers.17.self_attn.linear_k.weight', 'encoder.layers.17.self_attn.linear_out.bias', 'encoder.layers.17.self_attn.linear_out.weight', 'encoder.layers.17.self_attn.linear_q.bias', 'encoder.layers.17.self_attn.linear_q.weight', 'encoder.layers.17.self_attn.linear_v.bias', 'encoder.layers.17.self_attn.linear_v.weight', 'encoder.layers.17.self_attn_layer_norm.bias', 'encoder.layers.17.self_attn_layer_norm.weight', 'encoder.layers.18.conv_module.depthwise_conv.weight', 'encoder.layers.18.conv_module.depthwise_layer_norm.bias', 'encoder.layers.18.conv_module.depthwise_layer_norm.weight', 'encoder.layers.18.conv_module.layer_norm.bias', 'encoder.layers.18.conv_module.layer_norm.weight', 'encoder.layers.18.conv_module.pointwise_conv1.weight', 'encoder.layers.18.conv_module.pointwise_conv2.weight', 'encoder.layers.18.ffn1.intermediate_dense.bias', 'encoder.layers.18.ffn1.intermediate_dense.weight', 'encoder.layers.18.ffn1.output_dense.bias', 'encoder.layers.18.ffn1.output_dense.weight', 'encoder.layers.18.ffn1_layer_norm.bias', 'encoder.layers.18.ffn1_layer_norm.weight', 'encoder.layers.18.ffn2.intermediate_dense.bias', 'encoder.layers.18.ffn2.intermediate_dense.weight', 'encoder.layers.18.ffn2.output_dense.bias', 'encoder.layers.18.ffn2.output_dense.weight', 'encoder.layers.18.ffn2_layer_norm.bias', 'encoder.layers.18.ffn2_layer_norm.weight', 'encoder.layers.18.final_layer_norm.bias', 'encoder.layers.18.final_layer_norm.weight', 'encoder.layers.18.self_attn.distance_embedding.weight', 'encoder.layers.18.self_attn.linear_k.bias', 'encoder.layers.18.self_attn.linear_k.weight', 'encoder.layers.18.self_attn.linear_out.bias', 'encoder.layers.18.self_attn.linear_out.weight', 'encoder.layers.18.self_attn.linear_q.bias', 'encoder.layers.18.self_attn.linear_q.weight', 'encoder.layers.18.self_attn.linear_v.bias', 'encoder.layers.18.self_attn.linear_v.weight', 'encoder.layers.18.self_attn_layer_norm.bias', 'encoder.layers.18.self_attn_layer_norm.weight', 'encoder.layers.19.conv_module.depthwise_conv.weight', 'encoder.layers.19.conv_module.depthwise_layer_norm.bias', 'encoder.layers.19.conv_module.depthwise_layer_norm.weight', 'encoder.layers.19.conv_module.layer_norm.bias', 'encoder.layers.19.conv_module.layer_norm.weight', 'encoder.layers.19.conv_module.pointwise_conv1.weight', 'encoder.layers.19.conv_module.pointwise_conv2.weight', 'encoder.layers.19.ffn1.intermediate_dense.bias', 'encoder.layers.19.ffn1.intermediate_dense.weight', 'encoder.layers.19.ffn1.output_dense.bias', 'encoder.layers.19.ffn1.output_dense.weight', 'encoder.layers.19.ffn1_layer_norm.bias', 'encoder.layers.19.ffn1_layer_norm.weight', 'encoder.layers.19.ffn2.intermediate_dense.bias', 'encoder.layers.19.ffn2.intermediate_dense.weight', 'encoder.layers.19.ffn2.output_dense.bias', 'encoder.layers.19.ffn2.output_dense.weight', 'encoder.layers.19.ffn2_layer_norm.bias', 'encoder.layers.19.ffn2_layer_norm.weight', 'encoder.layers.19.final_layer_norm.bias', 'encoder.layers.19.final_layer_norm.weight', 'encoder.layers.19.self_attn.distance_embedding.weight', 'encoder.layers.19.self_attn.linear_k.bias', 'encoder.layers.19.self_attn.linear_k.weight', 'encoder.layers.19.self_attn.linear_out.bias', 'encoder.layers.19.self_attn.linear_out.weight', 'encoder.layers.19.self_attn.linear_q.bias', 'encoder.layers.19.self_attn.linear_q.weight', 'encoder.layers.19.self_attn.linear_v.bias', 'encoder.layers.19.self_attn.linear_v.weight', 'encoder.layers.19.self_attn_layer_norm.bias', 'encoder.layers.19.self_attn_layer_norm.weight', 'encoder.layers.20.conv_module.depthwise_conv.weight', 'encoder.layers.20.conv_module.depthwise_layer_norm.bias', 'encoder.layers.20.conv_module.depthwise_layer_norm.weight', 'encoder.layers.20.conv_module.layer_norm.bias', 'encoder.layers.20.conv_module.layer_norm.weight', 'encoder.layers.20.conv_module.pointwise_conv1.weight', 'encoder.layers.20.conv_module.pointwise_conv2.weight', 'encoder.layers.20.ffn1.intermediate_dense.bias', 'encoder.layers.20.ffn1.intermediate_dense.weight', 'encoder.layers.20.ffn1.output_dense.bias', 'encoder.layers.20.ffn1.output_dense.weight', 'encoder.layers.20.ffn1_layer_norm.bias', 'encoder.layers.20.ffn1_layer_norm.weight', 'encoder.layers.20.ffn2.intermediate_dense.bias', 'encoder.layers.20.ffn2.intermediate_dense.weight', 'encoder.layers.20.ffn2.output_dense.bias', 'encoder.layers.20.ffn2.output_dense.weight', 'encoder.layers.20.ffn2_layer_norm.bias', 'encoder.layers.20.ffn2_layer_norm.weight', 'encoder.layers.20.final_layer_norm.bias', 'encoder.layers.20.final_layer_norm.weight', 'encoder.layers.20.self_attn.distance_embedding.weight', 'encoder.layers.20.self_attn.linear_k.bias', 'encoder.layers.20.self_attn.linear_k.weight', 'encoder.layers.20.self_attn.linear_out.bias', 'encoder.layers.20.self_attn.linear_out.weight', 'encoder.layers.20.self_attn.linear_q.bias', 'encoder.layers.20.self_attn.linear_q.weight', 'encoder.layers.20.self_attn.linear_v.bias', 'encoder.layers.20.self_attn.linear_v.weight', 'encoder.layers.20.self_attn_layer_norm.bias', 'encoder.layers.20.self_attn_layer_norm.weight', 'encoder.layers.21.conv_module.depthwise_conv.weight', 'encoder.layers.21.conv_module.depthwise_layer_norm.bias', 'encoder.layers.21.conv_module.depthwise_layer_norm.weight', 'encoder.layers.21.conv_module.layer_norm.bias', 'encoder.layers.21.conv_module.layer_norm.weight', 'encoder.layers.21.conv_module.pointwise_conv1.weight', 'encoder.layers.21.conv_module.pointwise_conv2.weight', 'encoder.layers.21.ffn1.intermediate_dense.bias', 'encoder.layers.21.ffn1.intermediate_dense.weight', 'encoder.layers.21.ffn1.output_dense.bias', 'encoder.layers.21.ffn1.output_dense.weight', 'encoder.layers.21.ffn1_layer_norm.bias', 'encoder.layers.21.ffn1_layer_norm.weight', 'encoder.layers.21.ffn2.intermediate_dense.bias', 'encoder.layers.21.ffn2.intermediate_dense.weight', 'encoder.layers.21.ffn2.output_dense.bias', 'encoder.layers.21.ffn2.output_dense.weight', 'encoder.layers.21.ffn2_layer_norm.bias', 'encoder.layers.21.ffn2_layer_norm.weight', 'encoder.layers.21.final_layer_norm.bias', 'encoder.layers.21.final_layer_norm.weight', 'encoder.layers.21.self_attn.distance_embedding.weight', 'encoder.layers.21.self_attn.linear_k.bias', 'encoder.layers.21.self_attn.linear_k.weight', 'encoder.layers.21.self_attn.linear_out.bias', 'encoder.layers.21.self_attn.linear_out.weight', 'encoder.layers.21.self_attn.linear_q.bias', 'encoder.layers.21.self_attn.linear_q.weight', 'encoder.layers.21.self_attn.linear_v.bias', 'encoder.layers.21.self_attn.linear_v.weight', 'encoder.layers.21.self_attn_layer_norm.bias', 'encoder.layers.21.self_attn_layer_norm.weight', 'encoder.layers.22.conv_module.depthwise_conv.weight', 'encoder.layers.22.conv_module.depthwise_layer_norm.bias', 'encoder.layers.22.conv_module.depthwise_layer_norm.weight', 'encoder.layers.22.conv_module.layer_norm.bias', 'encoder.layers.22.conv_module.layer_norm.weight', 'encoder.layers.22.conv_module.pointwise_conv1.weight', 'encoder.layers.22.conv_module.pointwise_conv2.weight', 'encoder.layers.22.ffn1.intermediate_dense.bias', 'encoder.layers.22.ffn1.intermediate_dense.weight', 'encoder.layers.22.ffn1.output_dense.bias', 'encoder.layers.22.ffn1.output_dense.weight', 'encoder.layers.22.ffn1_layer_norm.bias', 'encoder.layers.22.ffn1_layer_norm.weight', 'encoder.layers.22.ffn2.intermediate_dense.bias', 'encoder.layers.22.ffn2.intermediate_dense.weight', 'encoder.layers.22.ffn2.output_dense.bias', 'encoder.layers.22.ffn2.output_dense.weight', 'encoder.layers.22.ffn2_layer_norm.bias', 'encoder.layers.22.ffn2_layer_norm.weight', 'encoder.layers.22.final_layer_norm.bias', 'encoder.layers.22.final_layer_norm.weight', 'encoder.layers.22.self_attn.distance_embedding.weight', 'encoder.layers.22.self_attn.linear_k.bias', 'encoder.layers.22.self_attn.linear_k.weight', 'encoder.layers.22.self_attn.linear_out.bias', 'encoder.layers.22.self_attn.linear_out.weight', 'encoder.layers.22.self_attn.linear_q.bias', 'encoder.layers.22.self_attn.linear_q.weight', 'encoder.layers.22.self_attn.linear_v.bias', 'encoder.layers.22.self_attn.linear_v.weight', 'encoder.layers.22.self_attn_layer_norm.bias', 'encoder.layers.22.self_attn_layer_norm.weight', 'encoder.layers.23.conv_module.depthwise_conv.weight', 'encoder.layers.23.conv_module.depthwise_layer_norm.bias', 'encoder.layers.23.conv_module.depthwise_layer_norm.weight', 'encoder.layers.23.conv_module.layer_norm.bias', 'encoder.layers.23.conv_module.layer_norm.weight', 'encoder.layers.23.conv_module.pointwise_conv1.weight', 'encoder.layers.23.conv_module.pointwise_conv2.weight', 'encoder.layers.23.ffn1.intermediate_dense.bias', 'encoder.layers.23.ffn1.intermediate_dense.weight', 'encoder.layers.23.ffn1.output_dense.bias', 'encoder.layers.23.ffn1.output_dense.weight', 'encoder.layers.23.ffn1_layer_norm.bias', 'encoder.layers.23.ffn1_layer_norm.weight', 'encoder.layers.23.ffn2.intermediate_dense.bias', 'encoder.layers.23.ffn2.intermediate_dense.weight', 'encoder.layers.23.ffn2.output_dense.bias', 'encoder.layers.23.ffn2.output_dense.weight', 'encoder.layers.23.ffn2_layer_norm.bias', 'encoder.layers.23.ffn2_layer_norm.weight', 'encoder.layers.23.final_layer_norm.bias', 'encoder.layers.23.final_layer_norm.weight', 'encoder.layers.23.self_attn.distance_embedding.weight', 'encoder.layers.23.self_attn.linear_k.bias', 'encoder.layers.23.self_attn.linear_k.weight', 'encoder.layers.23.self_attn.linear_out.bias', 'encoder.layers.23.self_attn.linear_out.weight', 'encoder.layers.23.self_attn.linear_q.bias', 'encoder.layers.23.self_attn.linear_q.weight', 'encoder.layers.23.self_attn.linear_v.bias', 'encoder.layers.23.self_attn.linear_v.weight', 'encoder.layers.23.self_attn_layer_norm.bias', 'encoder.layers.23.self_attn_layer_norm.weight', 'encoder.layers.6.conv_module.depthwise_conv.weight', 'encoder.layers.6.conv_module.depthwise_layer_norm.bias', 'encoder.layers.6.conv_module.depthwise_layer_norm.weight', 'encoder.layers.6.conv_module.layer_norm.bias', 'encoder.layers.6.conv_module.layer_norm.weight', 'encoder.layers.6.conv_module.pointwise_conv1.weight', 'encoder.layers.6.conv_module.pointwise_conv2.weight', 'encoder.layers.6.ffn1.intermediate_dense.bias', 'encoder.layers.6.ffn1.intermediate_dense.weight', 'encoder.layers.6.ffn1.output_dense.bias', 'encoder.layers.6.ffn1.output_dense.weight', 'encoder.layers.6.ffn1_layer_norm.bias', 'encoder.layers.6.ffn1_layer_norm.weight', 'encoder.layers.6.ffn2.intermediate_dense.bias', 'encoder.layers.6.ffn2.intermediate_dense.weight', 'encoder.layers.6.ffn2.output_dense.bias', 'encoder.layers.6.ffn2.output_dense.weight', 'encoder.layers.6.ffn2_layer_norm.bias', 'encoder.layers.6.ffn2_layer_norm.weight', 'encoder.layers.6.final_layer_norm.bias', 'encoder.layers.6.final_layer_norm.weight', 'encoder.layers.6.self_attn.distance_embedding.weight', 'encoder.layers.6.self_attn.linear_k.bias', 'encoder.layers.6.self_attn.linear_k.weight', 'encoder.layers.6.self_attn.linear_out.bias', 'encoder.layers.6.self_attn.linear_out.weight', 'encoder.layers.6.self_attn.linear_q.bias', 'encoder.layers.6.self_attn.linear_q.weight', 'encoder.layers.6.self_attn.linear_v.bias', 'encoder.layers.6.self_attn.linear_v.weight', 'encoder.layers.6.self_attn_layer_norm.bias', 'encoder.layers.6.self_attn_layer_norm.weight', 'encoder.layers.7.conv_module.depthwise_conv.weight', 'encoder.layers.7.conv_module.depthwise_layer_norm.bias', 'encoder.layers.7.conv_module.depthwise_layer_norm.weight', 'encoder.layers.7.conv_module.layer_norm.bias', 'encoder.layers.7.conv_module.layer_norm.weight', 'encoder.layers.7.conv_module.pointwise_conv1.weight', 'encoder.layers.7.conv_module.pointwise_conv2.weight', 'encoder.layers.7.ffn1.intermediate_dense.bias', 'encoder.layers.7.ffn1.intermediate_dense.weight', 'encoder.layers.7.ffn1.output_dense.bias', 'encoder.layers.7.ffn1.output_dense.weight', 'encoder.layers.7.ffn1_layer_norm.bias', 'encoder.layers.7.ffn1_layer_norm.weight', 'encoder.layers.7.ffn2.intermediate_dense.bias', 'encoder.layers.7.ffn2.intermediate_dense.weight', 'encoder.layers.7.ffn2.output_dense.bias', 'encoder.layers.7.ffn2.output_dense.weight', 'encoder.layers.7.ffn2_layer_norm.bias', 'encoder.layers.7.ffn2_layer_norm.weight', 'encoder.layers.7.final_layer_norm.bias', 'encoder.layers.7.final_layer_norm.weight', 'encoder.layers.7.self_attn.distance_embedding.weight', 'encoder.layers.7.self_attn.linear_k.bias', 'encoder.layers.7.self_attn.linear_k.weight', 'encoder.layers.7.self_attn.linear_out.bias', 'encoder.layers.7.self_attn.linear_out.weight', 'encoder.layers.7.self_attn.linear_q.bias', 'encoder.layers.7.self_attn.linear_q.weight', 'encoder.layers.7.self_attn.linear_v.bias', 'encoder.layers.7.self_attn.linear_v.weight', 'encoder.layers.7.self_attn_layer_norm.bias', 'encoder.layers.7.self_attn_layer_norm.weight', 'encoder.layers.8.conv_module.depthwise_conv.weight', 'encoder.layers.8.conv_module.depthwise_layer_norm.bias', 'encoder.layers.8.conv_module.depthwise_layer_norm.weight', 'encoder.layers.8.conv_module.layer_norm.bias', 'encoder.layers.8.conv_module.layer_norm.weight', 'encoder.layers.8.conv_module.pointwise_conv1.weight', 'encoder.layers.8.conv_module.pointwise_conv2.weight', 'encoder.layers.8.ffn1.intermediate_dense.bias', 'encoder.layers.8.ffn1.intermediate_dense.weight', 'encoder.layers.8.ffn1.output_dense.bias', 'encoder.layers.8.ffn1.output_dense.weight', 'encoder.layers.8.ffn1_layer_norm.bias', 'encoder.layers.8.ffn1_layer_norm.weight', 'encoder.layers.8.ffn2.intermediate_dense.bias', 'encoder.layers.8.ffn2.intermediate_dense.weight', 'encoder.layers.8.ffn2.output_dense.bias', 'encoder.layers.8.ffn2.output_dense.weight', 'encoder.layers.8.ffn2_layer_norm.bias', 'encoder.layers.8.ffn2_layer_norm.weight', 'encoder.layers.8.final_layer_norm.bias', 'encoder.layers.8.final_layer_norm.weight', 'encoder.layers.8.self_attn.distance_embedding.weight', 'encoder.layers.8.self_attn.linear_k.bias', 'encoder.layers.8.self_attn.linear_k.weight', 'encoder.layers.8.self_attn.linear_out.bias', 'encoder.layers.8.self_attn.linear_out.weight', 'encoder.layers.8.self_attn.linear_q.bias', 'encoder.layers.8.self_attn.linear_q.weight', 'encoder.layers.8.self_attn.linear_v.bias', 'encoder.layers.8.self_attn.linear_v.weight', 'encoder.layers.8.self_attn_layer_norm.bias', 'encoder.layers.8.self_attn_layer_norm.weight', 'encoder.layers.9.conv_module.depthwise_conv.weight', 'encoder.layers.9.conv_module.depthwise_layer_norm.bias', 'encoder.layers.9.conv_module.depthwise_layer_norm.weight', 'encoder.layers.9.conv_module.layer_norm.bias', 'encoder.layers.9.conv_module.layer_norm.weight', 'encoder.layers.9.conv_module.pointwise_conv1.weight', 'encoder.layers.9.conv_module.pointwise_conv2.weight', 'encoder.layers.9.ffn1.intermediate_dense.bias', 'encoder.layers.9.ffn1.intermediate_dense.weight', 'encoder.layers.9.ffn1.output_dense.bias', 'encoder.layers.9.ffn1.output_dense.weight', 'encoder.layers.9.ffn1_layer_norm.bias', 'encoder.layers.9.ffn1_layer_norm.weight', 'encoder.layers.9.ffn2.intermediate_dense.bias', 'encoder.layers.9.ffn2.intermediate_dense.weight', 'encoder.layers.9.ffn2.output_dense.bias', 'encoder.layers.9.ffn2.output_dense.weight', 'encoder.layers.9.ffn2_layer_norm.bias', 'encoder.layers.9.ffn2_layer_norm.weight', 'encoder.layers.9.final_layer_norm.bias', 'encoder.layers.9.final_layer_norm.weight', 'encoder.layers.9.self_attn.distance_embedding.weight', 'encoder.layers.9.self_attn.linear_k.bias', 'encoder.layers.9.self_attn.linear_k.weight', 'encoder.layers.9.self_attn.linear_out.bias', 'encoder.layers.9.self_attn.linear_out.weight', 'encoder.layers.9.self_attn.linear_q.bias', 'encoder.layers.9.self_attn.linear_q.weight', 'encoder.layers.9.self_attn.linear_v.bias', 'encoder.layers.9.self_attn.linear_v.weight', 'encoder.layers.9.self_attn_layer_norm.bias', 'encoder.layers.9.self_attn_layer_norm.weight']
- This IS expected if you are initializing Wav2Vec2BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing Wav2Vec2BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
2025-02-06 10:36:40,527 (infer:201) INFO: params.model_file: /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_w2v-bert2_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/best-valid-der.pt
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py:203: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  torch.load(params.model_file, map_location=device)["model"]
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/ts_vad_dataset.py:398: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  feature = torch.load(path, map_location="cpu")
2025-02-06 10:50:42,527 (infer:89) INFO: frame_len: 0.04!!
self.wavlm_fuse_feat_post_norm: False
Model DER:  1.0
Model ACC:  0.8328180897519811
  0%|          | 0/60 [00:00<?, ?it/s]  2%|▏         | 1/60 [00:00<00:33,  1.78it/s]  3%|▎         | 2/60 [00:01<00:32,  1.80it/s]  5%|▌         | 3/60 [00:01<00:31,  1.81it/s]  7%|▋         | 4/60 [00:02<00:31,  1.80it/s]  8%|▊         | 5/60 [00:02<00:30,  1.79it/s] 10%|█         | 6/60 [00:03<00:29,  1.81it/s] 12%|█▏        | 7/60 [00:03<00:29,  1.82it/s] 13%|█▎        | 8/60 [00:04<00:28,  1.82it/s] 15%|█▌        | 9/60 [00:04<00:28,  1.80it/s] 17%|█▋        | 10/60 [00:05<00:27,  1.79it/s] 18%|█▊        | 11/60 [00:06<00:27,  1.79it/s] 20%|██        | 12/60 [00:06<00:26,  1.79it/s] 22%|██▏       | 13/60 [00:07<00:25,  1.81it/s] 23%|██▎       | 14/60 [00:08<00:35,  1.30it/s] 25%|██▌       | 15/60 [00:08<00:31,  1.44it/s] 27%|██▋       | 16/60 [00:09<00:28,  1.56it/s] 28%|██▊       | 17/60 [00:09<00:25,  1.68it/s] 30%|███       | 18/60 [00:10<00:23,  1.77it/s] 32%|███▏      | 19/60 [00:10<00:22,  1.84it/s] 33%|███▎      | 20/60 [00:11<00:21,  1.90it/s] 35%|███▌      | 21/60 [00:11<00:20,  1.92it/s] 37%|███▋      | 22/60 [00:12<00:19,  1.94it/s] 38%|███▊      | 23/60 [00:12<00:18,  1.95it/s] 40%|████      | 24/60 [00:13<00:18,  1.98it/s] 42%|████▏     | 25/60 [00:13<00:17,  1.99it/s] 43%|████▎     | 26/60 [00:14<00:16,  2.01it/s] 45%|████▌     | 27/60 [00:14<00:16,  2.03it/s] 47%|████▋     | 28/60 [00:15<00:15,  2.05it/s] 48%|████▊     | 29/60 [00:15<00:15,  2.05it/s] 50%|█████     | 30/60 [00:16<00:14,  2.07it/s] 52%|█████▏    | 31/60 [00:16<00:13,  2.08it/s] 53%|█████▎    | 32/60 [00:17<00:13,  2.08it/s] 55%|█████▌    | 33/60 [00:18<00:18,  1.47it/s] 57%|█████▋    | 34/60 [00:19<00:16,  1.58it/s] 58%|█████▊    | 35/60 [00:19<00:14,  1.68it/s] 60%|██████    | 36/60 [00:20<00:13,  1.74it/s] 62%|██████▏   | 37/60 [00:20<00:12,  1.82it/s] 63%|██████▎   | 38/60 [00:21<00:11,  1.86it/s] 65%|██████▌   | 39/60 [00:21<00:10,  1.94it/s] 67%|██████▋   | 40/60 [00:21<00:10,  1.98it/s] 68%|██████▊   | 41/60 [00:22<00:09,  1.97it/s] 70%|███████   | 42/60 [00:23<00:09,  1.94it/s] 72%|███████▏  | 43/60 [00:23<00:08,  1.96it/s] 73%|███████▎  | 44/60 [00:24<00:08,  1.96it/s] 75%|███████▌  | 45/60 [00:24<00:07,  1.99it/s] 77%|███████▋  | 46/60 [00:24<00:06,  2.03it/s] 78%|███████▊  | 47/60 [00:25<00:06,  2.02it/s] 80%|████████  | 48/60 [00:25<00:05,  2.04it/s] 82%|████████▏ | 49/60 [00:26<00:05,  1.99it/s] 83%|████████▎ | 50/60 [00:27<00:05,  1.97it/s] 85%|████████▌ | 51/60 [00:27<00:04,  1.96it/s] 87%|████████▋ | 52/60 [00:28<00:05,  1.40it/s] 88%|████████▊ | 53/60 [00:29<00:04,  1.56it/s] 90%|█████████ | 54/60 [00:29<00:03,  1.70it/s] 92%|█████████▏| 55/60 [00:30<00:02,  1.81it/s] 93%|█████████▎| 56/60 [00:30<00:02,  1.89it/s] 95%|█████████▌| 57/60 [00:31<00:01,  1.94it/s] 97%|█████████▋| 58/60 [00:31<00:01,  1.98it/s] 98%|█████████▊| 59/60 [00:32<00:00,  2.00it/s]100%|██████████| 60/60 [00:32<00:00,  2.03it/s]100%|██████████| 60/60 [00:32<00:00,  1.84it/s]
Eval for threshold 0.2 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.3 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.35 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.4 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.45 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.5 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.55 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.6 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.7 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


Eval for threshold 0.8 DER=100.00, miss=100.00, falarm=0.00, confusion=0.00


