2025-02-10 16:50:53,757 (train_accelerate_ddp:857) INFO: params: {'best_train_loss': inf, 'best_valid_loss': inf, 'best_train_der': inf, 'best_valid_der': inf, 'best_train_epoch': -1, 'best_valid_epoch': -1, 'batch_idx_train': 0, 'log_interval': 500, 'reset_interval': 200, 'valid_interval': 500, 'batch_size': 64, 'verbose': 1, 'world_size': 2, 'tensorboard': True, 'num_epochs': 20, 'max_updates': 40000, 'warmup_updates': 4000, 'freeze_updates': 4000, 'start_batch': 0, 'start_epoch': 1, 'seed': 1337, 'exp_dir': PosixPath('/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8'), 'save_every_n': 1500, 'keep_last_k': 1, 'keep_last_epoch': 1, 'grad_clip': True, 'feature_grad_mult': 0.1, 'lr': 0.0002, 'average_period': 200, 'train_on_average': False, 'musan_path': '/mntcephfs/lee_dataset/asr/musan', 'rir_path': '/mntcephfs/lee_dataset/asr/RIRS_NOISES', 'spk_path': '/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/data/alimeeting_ami_aishell_4', 'speaker_embedding_name_dir': 'cam++_zh-cn_200k_feature_dir', 'data_dir': '/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/data/alimeeting_ami_aishell_4', 'dataset_name': 'alimeeting_ami_aishell_4', 'max_num_speaker': 7, 'speech_encoder_path': '/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/zh/modelscope/speech_campplus_sv_zh-cn_16k-common/campplus_cn_common.bin', 'select_encoder_layer_nums': 6, 'wavlm_fuse_feat_post_norm': False, 'speech_encoder_config': '/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/wav-bert2.0/config.json', 'num_transformer_layer': 2, 'd_state': 256, 'expand': 4, 'speech_encoder_type': 'CAM++', 'speaker_embed_dim': 192, 'rs_len': 8, 'segment_shift': 2, 'single_backend_type': 'conformer', 'multi_backend_type': 'transformer', 'do_finetune': False, 'init_modules': None, 'finetune_ckpt': None}
2025-02-10 16:50:53,757 (train_accelerate_ddp:857) INFO: params: {'best_train_loss': inf, 'best_valid_loss': inf, 'best_train_der': inf, 'best_valid_der': inf, 'best_train_epoch': -1, 'best_valid_epoch': -1, 'batch_idx_train': 0, 'log_interval': 500, 'reset_interval': 200, 'valid_interval': 500, 'batch_size': 64, 'verbose': 1, 'world_size': 2, 'tensorboard': True, 'num_epochs': 20, 'max_updates': 40000, 'warmup_updates': 4000, 'freeze_updates': 4000, 'start_batch': 0, 'start_epoch': 1, 'seed': 1337, 'exp_dir': PosixPath('/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8'), 'save_every_n': 1500, 'keep_last_k': 1, 'keep_last_epoch': 1, 'grad_clip': True, 'feature_grad_mult': 0.1, 'lr': 0.0002, 'average_period': 200, 'train_on_average': False, 'musan_path': '/mntcephfs/lee_dataset/asr/musan', 'rir_path': '/mntcephfs/lee_dataset/asr/RIRS_NOISES', 'spk_path': '/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/data/alimeeting_ami_aishell_4', 'speaker_embedding_name_dir': 'cam++_zh-cn_200k_feature_dir', 'data_dir': '/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/data/alimeeting_ami_aishell_4', 'dataset_name': 'alimeeting_ami_aishell_4', 'max_num_speaker': 7, 'speech_encoder_path': '/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/zh/modelscope/speech_campplus_sv_zh-cn_16k-common/campplus_cn_common.bin', 'select_encoder_layer_nums': 6, 'wavlm_fuse_feat_post_norm': False, 'speech_encoder_config': '/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/wav-bert2.0/config.json', 'num_transformer_layer': 2, 'd_state': 256, 'expand': 4, 'speech_encoder_type': 'CAM++', 'speaker_embed_dim': 192, 'rs_len': 8, 'segment_shift': 2, 'single_backend_type': 'conformer', 'multi_backend_type': 'transformer', 'do_finetune': False, 'init_modules': None, 'finetune_ckpt': None}
2025-02-10 16:50:53,774 (train_accelerate_ddp:873) INFO: data_cfg: TSVADDataConfig(data_dir='/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/data/alimeeting_ami_aishell_4', ts_len=6000, rs_len=8, segment_shift=2, spk_path='/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/data/alimeeting_ami_aishell_4', speech_encoder_type='CAM++', speaker_embedding_name_dir='cam++_zh-cn_200k_feature_dir', speaker_embed_dim=192, noise_ratio=0.8, zero_ratio=0.3, sample_rate=16000, max_num_speaker=7, dataset_name='alimeeting', embed_input=False, embed_len=1, embed_shift=0.4, label_rate=25, random_channel=False, random_mask_speaker_prob=0.0, random_mask_speaker_step=0, musan_path='/mntcephfs/lee_dataset/asr/musan', rir_path='/mntcephfs/lee_dataset/asr/RIRS_NOISES')
2025-02-10 16:50:53,774 (train_accelerate_ddp:873) INFO: data_cfg: TSVADDataConfig(data_dir='/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/data/alimeeting_ami_aishell_4', ts_len=6000, rs_len=8, segment_shift=2, spk_path='/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/data/alimeeting_ami_aishell_4', speech_encoder_type='CAM++', speaker_embedding_name_dir='cam++_zh-cn_200k_feature_dir', speaker_embed_dim=192, noise_ratio=0.8, zero_ratio=0.3, sample_rate=16000, max_num_speaker=7, dataset_name='alimeeting', embed_input=False, embed_len=1, embed_shift=0.4, label_rate=25, random_channel=False, random_mask_speaker_prob=0.0, random_mask_speaker_step=0, musan_path='/mntcephfs/lee_dataset/asr/musan', rir_path='/mntcephfs/lee_dataset/asr/RIRS_NOISES')
  0%|          | 0/145 [00:00<?, ?it/s] 19%|█▊        | 27/145 [00:00<00:00, 260.89it/s]  0%|          | 0/145 [00:00<?, ?it/s] 45%|████▍     | 65/145 [00:00<00:00, 327.30it/s] 29%|██▉       | 42/145 [00:00<00:00, 411.36it/s] 77%|███████▋  | 112/145 [00:00<00:00, 388.28it/s] 60%|██████    | 87/145 [00:00<00:00, 429.34it/s]100%|██████████| 145/145 [00:00<00:00, 387.61it/s]
2025-02-10 16:50:54,205 (ts_vad_dataset:152) INFO: model expect fbank as input , fbank_input should be True !!!
2025-02-10 16:50:54,205 (ts_vad_dataset:160) INFO: loaded sentence=35332, shortest sent=640.0, longest sent=128000.0, rs_len=8, segment_shift=2,  rir=False, musan=False, noise_ratio=0.8, zero_ratio=0.3 
 95%|█████████▌| 138/145 [00:00<00:00, 463.98it/s]100%|██████████| 145/145 [00:00<00:00, 453.55it/s]
2025-02-10 16:50:54,291 (ts_vad_dataset:152) INFO: model expect fbank as input , fbank_input should be True !!!
2025-02-10 16:50:54,291 (ts_vad_dataset:160) INFO: loaded sentence=35332, shortest sent=640.0, longest sent=128000.0, rs_len=8, segment_shift=2,  rir=False, musan=False, noise_ratio=0.8, zero_ratio=0.3 
  0%|          | 0/2080 [00:00<?, ?it/s]  0%|          | 0/2080 [00:00<?, ?it/s]  1%|          | 14/2080 [00:00<00:15, 137.13it/s]  1%|▏         | 28/2080 [00:00<00:22, 92.69it/s]   1%|▏         | 28/2080 [00:00<00:15, 128.64it/s]  3%|▎         | 53/2080 [00:00<00:13, 146.41it/s]  3%|▎         | 55/2080 [00:00<00:10, 184.20it/s]  4%|▍         | 78/2080 [00:00<00:11, 179.58it/s]  4%|▍         | 80/2080 [00:00<00:09, 205.11it/s]  5%|▍         | 98/2080 [00:00<00:10, 182.06it/s]  5%|▍         | 103/2080 [00:00<00:09, 201.90it/s]  6%|▌         | 123/2080 [00:00<00:09, 203.10it/s]  6%|▌         | 129/2080 [00:00<00:08, 217.81it/s]  7%|▋         | 145/2080 [00:00<00:13, 140.48it/s]  7%|▋         | 152/2080 [00:00<00:13, 146.43it/s]  8%|▊         | 170/2080 [00:01<00:11, 164.21it/s]  9%|▊         | 178/2080 [00:01<00:11, 171.37it/s] 10%|▉         | 198/2080 [00:01<00:09, 191.75it/s] 10%|▉         | 205/2080 [00:01<00:09, 194.98it/s] 11%|█         | 222/2080 [00:01<00:09, 203.75it/s] 11%|█         | 230/2080 [00:01<00:08, 206.83it/s] 12%|█▏        | 248/2080 [00:01<00:08, 218.74it/s] 12%|█▏        | 257/2080 [00:01<00:08, 223.44it/s] 13%|█▎        | 273/2080 [00:01<00:07, 226.12it/s] 14%|█▎        | 282/2080 [00:01<00:07, 228.29it/s] 14%|█▍        | 297/2080 [00:01<00:12, 144.52it/s] 15%|█▍        | 307/2080 [00:01<00:12, 147.08it/s] 16%|█▌        | 325/2080 [00:01<00:10, 170.78it/s] 16%|█▌        | 336/2080 [00:01<00:09, 175.21it/s] 17%|█▋        | 357/2080 [00:01<00:08, 203.13it/s] 18%|█▊        | 366/2080 [00:01<00:08, 202.45it/s] 18%|█▊        | 384/2080 [00:02<00:07, 218.29it/s] 19%|█▉        | 391/2080 [00:02<00:07, 212.57it/s] 20%|█▉        | 410/2080 [00:02<00:07, 222.44it/s] 20%|██        | 416/2080 [00:02<00:07, 221.76it/s] 21%|██        | 441/2080 [00:02<00:06, 245.24it/s] 21%|██▏       | 447/2080 [00:02<00:06, 244.99it/s] 23%|██▎       | 474/2080 [00:02<00:05, 268.11it/s] 23%|██▎       | 484/2080 [00:02<00:05, 279.03it/s] 24%|██▍       | 507/2080 [00:02<00:05, 282.97it/s] 25%|██▍       | 514/2080 [00:02<00:05, 284.14it/s] 26%|██▌       | 537/2080 [00:02<00:05, 273.60it/s] 26%|██▌       | 544/2080 [00:02<00:05, 268.92it/s] 27%|██▋       | 566/2080 [00:02<00:05, 274.58it/s] 28%|██▊       | 576/2080 [00:02<00:05, 281.41it/s] 29%|██▊       | 595/2080 [00:03<00:08, 166.43it/s] 29%|██▉       | 605/2080 [00:03<00:08, 167.39it/s] 30%|███       | 629/2080 [00:03<00:07, 199.78it/s] 31%|███       | 640/2080 [00:03<00:07, 202.16it/s] 32%|███▏      | 658/2080 [00:03<00:06, 217.96it/s] 32%|███▏      | 670/2080 [00:03<00:06, 221.27it/s] 33%|███▎      | 693/2080 [00:03<00:05, 246.96it/s] 34%|███▍      | 705/2080 [00:03<00:05, 251.14it/s] 35%|███▌      | 730/2080 [00:03<00:04, 275.41it/s] 36%|███▌      | 742/2080 [00:03<00:04, 279.59it/s] 37%|███▋      | 765/2080 [00:03<00:04, 294.05it/s] 37%|███▋      | 774/2080 [00:03<00:04, 281.89it/s] 38%|███▊      | 800/2080 [00:03<00:04, 304.24it/s] 39%|███▉      | 812/2080 [00:03<00:04, 306.01it/s] 40%|████      | 837/2080 [00:03<00:03, 316.84it/s] 41%|████      | 847/2080 [00:03<00:03, 317.02it/s] 42%|████▏     | 871/2080 [00:03<00:03, 322.17it/s] 42%|████▏     | 883/2080 [00:03<00:03, 328.72it/s] 44%|████▍     | 910/2080 [00:03<00:03, 331.77it/s] 44%|████▍     | 918/2080 [00:03<00:03, 334.23it/s] 46%|████▌     | 950/2080 [00:04<00:03, 343.20it/s] 46%|████▌     | 958/2080 [00:04<00:03, 351.47it/s] 48%|████▊     | 993/2080 [00:04<00:02, 365.47it/s] 48%|████▊     | 997/2080 [00:04<00:02, 361.86it/s] 50%|████▉     | 1030/2080 [00:04<00:02, 357.14it/s] 50%|████▉     | 1034/2080 [00:04<00:02, 354.10it/s] 51%|█████▏    | 1070/2080 [00:04<00:02, 368.41it/s] 52%|█████▏    | 1076/2080 [00:04<00:02, 371.13it/s] 53%|█████▎    | 1112/2080 [00:04<00:02, 382.52it/s] 54%|█████▍    | 1119/2080 [00:04<00:02, 386.43it/s] 55%|█████▌    | 1151/2080 [00:04<00:02, 349.04it/s] 56%|█████▌    | 1158/2080 [00:04<00:02, 348.12it/s] 57%|█████▋    | 1187/2080 [00:04<00:02, 350.82it/s] 57%|█████▊    | 1196/2080 [00:04<00:02, 355.58it/s] 59%|█████▉    | 1230/2080 [00:04<00:02, 372.83it/s] 60%|█████▉    | 1239/2080 [00:04<00:02, 374.59it/s] 61%|██████    | 1268/2080 [00:04<00:02, 371.66it/s] 61%|██████▏   | 1278/2080 [00:04<00:02, 375.44it/s] 63%|██████▎   | 1311/2080 [00:05<00:01, 388.27it/s] 64%|██████▎   | 1322/2080 [00:04<00:01, 392.57it/s] 65%|██████▌   | 1358/2080 [00:05<00:01, 409.96it/s] 66%|██████▌   | 1366/2080 [00:05<00:01, 405.31it/s] 67%|██████▋   | 1400/2080 [00:05<00:01, 412.83it/s] 68%|██████▊   | 1411/2080 [00:05<00:01, 416.16it/s] 69%|██████▉   | 1443/2080 [00:05<00:01, 416.49it/s] 70%|██████▉   | 1453/2080 [00:05<00:01, 372.67it/s] 71%|███████▏  | 1485/2080 [00:05<00:01, 369.75it/s] 72%|███████▏  | 1492/2080 [00:05<00:01, 375.25it/s] 73%|███████▎  | 1527/2080 [00:05<00:01, 382.32it/s] 74%|███████▍  | 1537/2080 [00:05<00:01, 395.80it/s] 76%|███████▌  | 1576/2080 [00:05<00:01, 410.58it/s] 76%|███████▋  | 1586/2080 [00:05<00:01, 422.08it/s] 78%|███████▊  | 1618/2080 [00:05<00:01, 406.27it/s] 78%|███████▊  | 1629/2080 [00:05<00:01, 414.52it/s] 80%|████████  | 1665/2080 [00:05<00:00, 424.34it/s] 81%|████████  | 1677/2080 [00:05<00:00, 431.44it/s] 82%|████████▏ | 1708/2080 [00:06<00:00, 390.37it/s] 83%|████████▎ | 1721/2080 [00:05<00:00, 399.37it/s] 85%|████████▍ | 1758/2080 [00:06<00:00, 418.46it/s] 85%|████████▌ | 1772/2080 [00:06<00:00, 429.19it/s] 87%|████████▋ | 1801/2080 [00:06<00:00, 421.44it/s] 87%|████████▋ | 1816/2080 [00:06<00:00, 426.20it/s] 89%|████████▉ | 1851/2080 [00:06<00:00, 431.06it/s] 89%|████████▉ | 1860/2080 [00:06<00:00, 427.32it/s] 91%|█████████▏| 1899/2080 [00:06<00:00, 443.47it/s] 92%|█████████▏| 1909/2080 [00:06<00:00, 444.25it/s] 93%|█████████▎| 1944/2080 [00:06<00:00, 445.34it/s] 94%|█████████▍| 1954/2080 [00:06<00:00, 436.75it/s] 96%|█████████▌| 1993/2080 [00:06<00:00, 455.84it/s] 96%|█████████▋| 2003/2080 [00:06<00:00, 449.68it/s] 98%|█████████▊| 2041/2080 [00:06<00:00, 461.24it/s] 99%|█████████▊| 2052/2080 [00:06<00:00, 460.88it/s]100%|██████████| 2080/2080 [00:06<00:00, 304.15it/s]
100%|██████████| 2080/2080 [00:06<00:00, 307.44it/s]
2025-02-10 16:51:01,638 (ts_vad_dataset:152) INFO: model expect fbank as input , fbank_input should be True !!!
2025-02-10 16:51:01,638 (ts_vad_dataset:152) INFO: model expect fbank as input , fbank_input should be True !!!
2025-02-10 16:51:01,650 (ts_vad_dataset:160) INFO: loaded sentence=526485, shortest sent=48640.0, longest sent=128000.0, rs_len=8, segment_shift=2,  rir=True, musan=True, noise_ratio=0.8, zero_ratio=0.3 
2025-02-10 16:51:01,650 (ts_vad_dataset:160) INFO: loaded sentence=526485, shortest sent=48640.0, longest sent=128000.0, rs_len=8, segment_shift=2,  rir=True, musan=True, noise_ratio=0.8, zero_ratio=0.3 
2025-02-10 16:51:01,650 (train_accelerate_ddp:908) INFO: The scale window is set to 8192.
2025-02-10 16:51:01,650 (train_accelerate_ddp:908) INFO: The scale window is set to 8192.
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/accelerate/accelerator.py:494: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  self.scaler = torch.cuda.amp.GradScaler(**kwargs)
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/accelerate/accelerator.py:494: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  self.scaler = torch.cuda.amp.GradScaler(**kwargs)
2025-02-10 16:51:01,878 (train_accelerate_ddp:946) INFO: model_cfg: TSVADConfig(speech_encoder_path='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/zh/modelscope/speech_campplus_sv_zh-cn_16k-common/campplus_cn_common.bin', speech_encoder_type='CAM++', freeze_speech_encoder_updates=4000, num_attention_head=4, num_transformer_layer=2, transformer_embed_dim=384, transformer_ffn_embed_dim=1536, speaker_embed_dim=192, dropout=0.1, use_spk_embed=True, feature_grad_mult=0.1, whisper_n_mels=80, select_encoder_layer_nums=6, wavlm_fuse_feat_post_norm=False, speech_encoder_config='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/wav-bert2.0/config.json', single_backend_type='conformer', multi_backend_type='transformer', d_state=256, expand=4)
2025-02-10 16:51:01,878 (other:349) WARNING: Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
2025-02-10 16:51:01,878 (train_accelerate_ddp:946) INFO: model_cfg: TSVADConfig(speech_encoder_path='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/zh/modelscope/speech_campplus_sv_zh-cn_16k-common/campplus_cn_common.bin', speech_encoder_type='CAM++', freeze_speech_encoder_updates=4000, num_attention_head=4, num_transformer_layer=2, transformer_embed_dim=384, transformer_ffn_embed_dim=1536, speaker_embed_dim=192, dropout=0.1, use_spk_embed=True, feature_grad_mult=0.1, whisper_n_mels=80, select_encoder_layer_nums=6, wavlm_fuse_feat_post_norm=False, speech_encoder_config='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/wav-bert2.0/config.json', single_backend_type='conformer', multi_backend_type='transformer', d_state=256, expand=4)
self.wavlm_fuse_feat_post_norm: False
self.wavlm_fuse_feat_post_norm: False
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/model.py:953: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loadedState = torch.load(model_path, map_location=device)
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/model.py:953: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loadedState = torch.load(model_path, map_location=device)
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
2025-02-10 16:51:02,406 (train_accelerate_ddp:949) INFO: model: TSVADModel(
  (rs_dropout): Dropout(p=0.1, inplace=False)
  (speech_encoder): CAMPPlus(
    (head): FCM(
      (conv1): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (layer1): Sequential(
        (0): BasicResBlock(
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(2, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (shortcut): Sequential(
            (0): Conv2d(32, 32, kernel_size=(1, 1), stride=(2, 1), bias=False)
            (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicResBlock(
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (shortcut): Sequential()
        )
      )
      (layer2): Sequential(
        (0): BasicResBlock(
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(2, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (shortcut): Sequential(
            (0): Conv2d(32, 32, kernel_size=(1, 1), stride=(2, 1), bias=False)
            (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicResBlock(
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (shortcut): Sequential()
        )
      )
      (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(2, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (xvector): Sequential(
      (tdnn): TDNNLayer(
        (linear): Conv1d(320, 128, kernel_size=(5,), stride=(2,), padding=(2,), bias=False)
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
      )
      (block1): CAMDenseTDNNBlock(
        (0): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (1): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(160, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (2): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(192, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (3): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(224, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (4): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(256, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (5): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(288, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (6): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(320, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (7): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(352, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(352, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (8): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(384, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (9): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(416, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(416, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (10): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(448, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (11): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(480, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(480, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
      )
      (transit1): TransitLayer(
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
        (linear): Conv1d(512, 256, kernel_size=(1,), stride=(1,), bias=False)
      )
      (block2): CAMDenseTDNNBlock(
        (0): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(256, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (1): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(288, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (2): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(320, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (3): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(352, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(352, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (4): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(384, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (5): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(416, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(416, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (6): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(448, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (7): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(480, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(480, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (8): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(512, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (9): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(544, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(544, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (10): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(576, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (11): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(608, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(608, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (12): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(640, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (13): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(672, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(672, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (14): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(704, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(704, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (15): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(736, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(736, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (16): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(768, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (17): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(800, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(800, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (18): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(832, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(832, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (19): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(864, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(864, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (20): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(896, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(896, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (21): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(928, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(928, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (22): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(960, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(960, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (23): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(992, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(992, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
      )
      (transit2): TransitLayer(
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
        (linear): Conv1d(1024, 512, kernel_size=(1,), stride=(1,), bias=False)
      )
      (block3): CAMDenseTDNNBlock(
        (0): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(512, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (1): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(544, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(544, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (2): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(576, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (3): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(608, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(608, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (4): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(640, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (5): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(672, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(672, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (6): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(704, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(704, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (7): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(736, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(736, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (8): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(768, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (9): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(800, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(800, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (10): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(832, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(832, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (11): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(864, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(864, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (12): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(896, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(896, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (13): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(928, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(928, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (14): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(960, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(960, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (15): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(992, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(992, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
      )
      (transit3): TransitLayer(
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
        (linear): Conv1d(1024, 512, kernel_size=(1,), stride=(1,), bias=False)
      )
      (out_nonlinear): Sequential(
        (batchnorm): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (stats): StatsPool()
      (dense): DenseLayer(
        (linear): Conv1d(1024, 192, kernel_size=(1,), stride=(1,), bias=False)
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(192, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
        )
      )
    )
  )
  (speech_down_or_up): Sequential(
    (0): Conv1d(512, 192, kernel_size=(5,), stride=(2,), padding=(2,))
    (1): BatchNorm1D(
      (bn): BatchNorm1d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (2): ReLU()
  )
  (pos_encoder): PositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (single_backend): Conformer(
    (conformer_layers): ModuleList(
      (0-1): 2 x ConformerLayer(
        (ffn1): _FeedForwardModule(
          (sequential): Sequential(
            (0): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (1): Linear(in_features=384, out_features=1536, bias=True)
            (2): SiLU()
            (3): Dropout(p=0.0, inplace=False)
            (4): Linear(in_features=1536, out_features=384, bias=True)
            (5): Dropout(p=0.0, inplace=False)
          )
        )
        (self_attn_layer_norm): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=384, out_features=384, bias=True)
        )
        (self_attn_dropout): Dropout(p=0.0, inplace=False)
        (conv_module): _ConvolutionModule(
          (layer_norm): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (sequential): Sequential(
            (0): Conv1d(384, 768, kernel_size=(1,), stride=(1,))
            (1): GLU(dim=1)
            (2): Conv1d(384, 384, kernel_size=(31,), stride=(1,), padding=(15,), groups=384)
            (3): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (4): SiLU()
            (5): Conv1d(384, 384, kernel_size=(1,), stride=(1,))
            (6): Dropout(p=0.0, inplace=False)
          )
        )
        (ffn2): _FeedForwardModule(
          (sequential): Sequential(
            (0): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (1): Linear(in_features=384, out_features=1536, bias=True)
            (2): SiLU()
            (3): Dropout(p=0.0, inplace=False)
            (4): Linear(in_features=1536, out_features=384, bias=True)
            (5): Dropout(p=0.0, inplace=False)
          )
        )
        (final_layer_norm): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
      )
    )
  )
  (backend_down): Sequential(
    (0): Conv1d(2688, 384, kernel_size=(5,), stride=(1,), padding=(2,))
    (1): BatchNorm1D(
      (bn): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (2): ReLU()
  )
  (multi_backend): TransformerEncoder(
    (layers): ModuleList(
      (0-1): 2 x TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=384, out_features=384, bias=True)
        )
        (linear1): Linear(in_features=384, out_features=1536, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=1536, out_features=384, bias=True)
        (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc): Linear(in_features=384, out_features=7, bias=True)
)
2025-02-10 16:51:02,406 (train_accelerate_ddp:949) INFO: model: TSVADModel(
  (rs_dropout): Dropout(p=0.1, inplace=False)
  (speech_encoder): CAMPPlus(
    (head): FCM(
      (conv1): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (layer1): Sequential(
        (0): BasicResBlock(
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(2, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (shortcut): Sequential(
            (0): Conv2d(32, 32, kernel_size=(1, 1), stride=(2, 1), bias=False)
            (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicResBlock(
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (shortcut): Sequential()
        )
      )
      (layer2): Sequential(
        (0): BasicResBlock(
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(2, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (shortcut): Sequential(
            (0): Conv2d(32, 32, kernel_size=(1, 1), stride=(2, 1), bias=False)
            (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicResBlock(
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (shortcut): Sequential()
        )
      )
      (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(2, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (xvector): Sequential(
      (tdnn): TDNNLayer(
        (linear): Conv1d(320, 128, kernel_size=(5,), stride=(2,), padding=(2,), bias=False)
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
      )
      (block1): CAMDenseTDNNBlock(
        (0): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (1): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(160, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (2): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(192, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (3): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(224, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (4): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(256, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (5): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(288, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (6): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(320, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (7): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(352, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(352, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (8): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(384, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (9): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(416, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(416, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (10): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(448, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (11): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(480, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(480, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
      )
      (transit1): TransitLayer(
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
        (linear): Conv1d(512, 256, kernel_size=(1,), stride=(1,), bias=False)
      )
      (block2): CAMDenseTDNNBlock(
        (0): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(256, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (1): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(288, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (2): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(320, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (3): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(352, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(352, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (4): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(384, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (5): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(416, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(416, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (6): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(448, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (7): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(480, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(480, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (8): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(512, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (9): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(544, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(544, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (10): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(576, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (11): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(608, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(608, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (12): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(640, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (13): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(672, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(672, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (14): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(704, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(704, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (15): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(736, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(736, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (16): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(768, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (17): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(800, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(800, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (18): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(832, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(832, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (19): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(864, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(864, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (20): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(896, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(896, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (21): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(928, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(928, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (22): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(960, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(960, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (23): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(992, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(992, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
      )
      (transit2): TransitLayer(
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
        (linear): Conv1d(1024, 512, kernel_size=(1,), stride=(1,), bias=False)
      )
      (block3): CAMDenseTDNNBlock(
        (0): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(512, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (1): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(544, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(544, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (2): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(576, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (3): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(608, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(608, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (4): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(640, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (5): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(672, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(672, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (6): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(704, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(704, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (7): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(736, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(736, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (8): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(768, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (9): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(800, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(800, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (10): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(832, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(832, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (11): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(864, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(864, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (12): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(896, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(896, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (13): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(928, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(928, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (14): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(960, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(960, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (15): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(992, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(992, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
      )
      (transit3): TransitLayer(
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
        (linear): Conv1d(1024, 512, kernel_size=(1,), stride=(1,), bias=False)
      )
      (out_nonlinear): Sequential(
        (batchnorm): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (stats): StatsPool()
      (dense): DenseLayer(
        (linear): Conv1d(1024, 192, kernel_size=(1,), stride=(1,), bias=False)
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(192, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
        )
      )
    )
  )
  (speech_down_or_up): Sequential(
    (0): Conv1d(512, 192, kernel_size=(5,), stride=(2,), padding=(2,))
    (1): BatchNorm1D(
      (bn): BatchNorm1d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (2): ReLU()
  )
  (pos_encoder): PositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (single_backend): Conformer(
    (conformer_layers): ModuleList(
      (0-1): 2 x ConformerLayer(
        (ffn1): _FeedForwardModule(
          (sequential): Sequential(
            (0): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (1): Linear(in_features=384, out_features=1536, bias=True)
            (2): SiLU()
            (3): Dropout(p=0.0, inplace=False)
            (4): Linear(in_features=1536, out_features=384, bias=True)
            (5): Dropout(p=0.0, inplace=False)
          )
        )
        (self_attn_layer_norm): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=384, out_features=384, bias=True)
        )
        (self_attn_dropout): Dropout(p=0.0, inplace=False)
        (conv_module): _ConvolutionModule(
          (layer_norm): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (sequential): Sequential(
            (0): Conv1d(384, 768, kernel_size=(1,), stride=(1,))
            (1): GLU(dim=1)
            (2): Conv1d(384, 384, kernel_size=(31,), stride=(1,), padding=(15,), groups=384)
            (3): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (4): SiLU()
            (5): Conv1d(384, 384, kernel_size=(1,), stride=(1,))
            (6): Dropout(p=0.0, inplace=False)
          )
        )
        (ffn2): _FeedForwardModule(
          (sequential): Sequential(
            (0): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (1): Linear(in_features=384, out_features=1536, bias=True)
            (2): SiLU()
            (3): Dropout(p=0.0, inplace=False)
            (4): Linear(in_features=1536, out_features=384, bias=True)
            (5): Dropout(p=0.0, inplace=False)
          )
        )
        (final_layer_norm): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
      )
    )
  )
  (backend_down): Sequential(
    (0): Conv1d(2688, 384, kernel_size=(5,), stride=(1,), padding=(2,))
    (1): BatchNorm1D(
      (bn): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (2): ReLU()
  )
  (multi_backend): TransformerEncoder(
    (layers): ModuleList(
      (0-1): 2 x TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=384, out_features=384, bias=True)
        )
        (linear1): Linear(in_features=384, out_features=1536, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=1536, out_features=384, bias=True)
        (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc): Linear(in_features=384, out_features=7, bias=True)
)
2025-02-10 16:51:02,407 (train_accelerate_ddp:951) INFO: Number of model parameters: 22884199
2025-02-10 16:51:02,407 (train_accelerate_ddp:951) INFO: Number of model parameters: 22884199
pgpu23:1924631:1924631 [0] NCCL INFO Bootstrap : Using ib1:20.20.20.23<0>
pgpu23:1924631:1924631 [0] NCCL INFO NET/Plugin : dlerror=libnccl-net.so: cannot open shared object file: No such file or directory No plugin found (libnccl-net.so), using internal implementation
pgpu23:1924631:1924631 [0] NCCL INFO cudaDriverVersion 12040
NCCL version 2.20.5+cuda11.0
pgpu23:1924632:1924632 [1] NCCL INFO cudaDriverVersion 12040
pgpu23:1924632:1924632 [1] NCCL INFO Bootstrap : Using ib1:20.20.20.23<0>
pgpu23:1924632:1924632 [1] NCCL INFO NET/Plugin : dlerror=libnccl-net.so: cannot open shared object file: No such file or directory No plugin found (libnccl-net.so), using internal implementation
pgpu23:1924632:1924691 [1] NCCL INFO NET/IB : Using [0]mlx5_0:1/RoCE [1]mlx5_1:1/IB [2]mlx5_3:1/IB [RO]; OOB ib1:20.20.20.23<0>
pgpu23:1924632:1924691 [1] NCCL INFO Using non-device net plugin version 0
pgpu23:1924632:1924691 [1] NCCL INFO Using network IB
pgpu23:1924631:1924695 [0] NCCL INFO NET/IB : Using [0]mlx5_0:1/RoCE [1]mlx5_1:1/IB [2]mlx5_3:1/IB [RO]; OOB ib1:20.20.20.23<0>
pgpu23:1924631:1924695 [0] NCCL INFO Using non-device net plugin version 0
pgpu23:1924631:1924695 [0] NCCL INFO Using network IB
pgpu23:1924632:1924691 [1] NCCL INFO comm 0x55555ef58f10 rank 1 nranks 2 cudaDev 1 nvmlDev 1 busId 9f000 commId 0xf3a7d22286bc2df - Init START
pgpu23:1924631:1924695 [0] NCCL INFO comm 0x55555eedf500 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 2b000 commId 0xf3a7d22286bc2df - Init START
pgpu23:1924631:1924695 [0] NCCL INFO Setting affinity for GPU 0 to 6f00,00000000,00000000,00000000,00006f00
pgpu23:1924631:1924695 [0] NCCL INFO comm 0x55555eedf500 rank 0 nRanks 2 nNodes 1 localRanks 2 localRank 0 MNNVL 0
pgpu23:1924632:1924691 [1] NCCL INFO comm 0x55555ef58f10 rank 1 nRanks 2 nNodes 1 localRanks 2 localRank 1 MNNVL 0
pgpu23:1924631:1924695 [0] NCCL INFO Channel 00/16 :    0   1
pgpu23:1924631:1924695 [0] NCCL INFO Channel 01/16 :    0   1
pgpu23:1924631:1924695 [0] NCCL INFO Channel 02/16 :    0   1
pgpu23:1924631:1924695 [0] NCCL INFO Channel 03/16 :    0   1
pgpu23:1924631:1924695 [0] NCCL INFO Channel 04/16 :    0   1
pgpu23:1924631:1924695 [0] NCCL INFO Channel 05/16 :    0   1
pgpu23:1924631:1924695 [0] NCCL INFO Channel 06/16 :    0   1
pgpu23:1924631:1924695 [0] NCCL INFO Channel 07/16 :    0   1
pgpu23:1924631:1924695 [0] NCCL INFO Channel 08/16 :    0   1
pgpu23:1924631:1924695 [0] NCCL INFO Channel 09/16 :    0   1
pgpu23:1924631:1924695 [0] NCCL INFO Channel 10/16 :    0   1
pgpu23:1924632:1924691 [1] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] -1/-1/-1->1->0 [2] -1/-1/-1->1->0 [3] -1/-1/-1->1->0 [4] 0/-1/-1->1->-1 [5] 0/-1/-1->1->-1 [6] 0/-1/-1->1->-1 [7] 0/-1/-1->1->-1 [8] -1/-1/-1->1->0 [9] -1/-1/-1->1->0 [10] -1/-1/-1->1->0 [11] -1/-1/-1->1->0 [12] 0/-1/-1->1->-1 [13] 0/-1/-1->1->-1 [14] 0/-1/-1->1->-1 [15] 0/-1/-1->1->-1
pgpu23:1924631:1924695 [0] NCCL INFO Channel 11/16 :    0   1
pgpu23:1924632:1924691 [1] NCCL INFO P2P Chunksize set to 524288
pgpu23:1924631:1924695 [0] NCCL INFO Channel 12/16 :    0   1
pgpu23:1924631:1924695 [0] NCCL INFO Channel 13/16 :    0   1
pgpu23:1924631:1924695 [0] NCCL INFO Channel 14/16 :    0   1
pgpu23:1924631:1924695 [0] NCCL INFO Channel 15/16 :    0   1
pgpu23:1924631:1924695 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1 [2] 1/-1/-1->0->-1 [3] 1/-1/-1->0->-1 [4] -1/-1/-1->0->1 [5] -1/-1/-1->0->1 [6] -1/-1/-1->0->1 [7] -1/-1/-1->0->1 [8] 1/-1/-1->0->-1 [9] 1/-1/-1->0->-1 [10] 1/-1/-1->0->-1 [11] 1/-1/-1->0->-1 [12] -1/-1/-1->0->1 [13] -1/-1/-1->0->1 [14] -1/-1/-1->0->1 [15] -1/-1/-1->0->1
pgpu23:1924631:1924695 [0] NCCL INFO P2P Chunksize set to 524288
pgpu23:1924632:1924691 [1] NCCL INFO Channel 00/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu23:1924631:1924695 [0] NCCL INFO Channel 00/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu23:1924632:1924691 [1] NCCL INFO Channel 01/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu23:1924631:1924695 [0] NCCL INFO Channel 01/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu23:1924632:1924691 [1] NCCL INFO Channel 02/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu23:1924631:1924695 [0] NCCL INFO Channel 02/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu23:1924632:1924691 [1] NCCL INFO Channel 03/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu23:1924631:1924695 [0] NCCL INFO Channel 03/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu23:1924632:1924691 [1] NCCL INFO Channel 04/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu23:1924631:1924695 [0] NCCL INFO Channel 04/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu23:1924632:1924691 [1] NCCL INFO Channel 05/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu23:1924631:1924695 [0] NCCL INFO Channel 05/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu23:1924632:1924691 [1] NCCL INFO Channel 06/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu23:1924631:1924695 [0] NCCL INFO Channel 06/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu23:1924632:1924691 [1] NCCL INFO Channel 07/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu23:1924631:1924695 [0] NCCL INFO Channel 07/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu23:1924632:1924691 [1] NCCL INFO Channel 08/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu23:1924631:1924695 [0] NCCL INFO Channel 08/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu23:1924632:1924691 [1] NCCL INFO Channel 09/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu23:1924631:1924695 [0] NCCL INFO Channel 09/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu23:1924632:1924691 [1] NCCL INFO Channel 10/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu23:1924631:1924695 [0] NCCL INFO Channel 10/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu23:1924632:1924691 [1] NCCL INFO Channel 11/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu23:1924631:1924695 [0] NCCL INFO Channel 11/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu23:1924632:1924691 [1] NCCL INFO Channel 12/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu23:1924631:1924695 [0] NCCL INFO Channel 12/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu23:1924632:1924691 [1] NCCL INFO Channel 13/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu23:1924631:1924695 [0] NCCL INFO Channel 13/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu23:1924632:1924691 [1] NCCL INFO Channel 14/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu23:1924631:1924695 [0] NCCL INFO Channel 14/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu23:1924632:1924691 [1] NCCL INFO Channel 15/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu23:1924631:1924695 [0] NCCL INFO Channel 15/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu23:1924632:1924691 [1] NCCL INFO Connected all rings
pgpu23:1924632:1924691 [1] NCCL INFO Connected all trees
pgpu23:1924632:1924691 [1] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
pgpu23:1924632:1924691 [1] NCCL INFO 16 coll channels, 0 collnet channels, 0 nvls channels, 16 p2p channels, 16 p2p channels per peer
pgpu23:1924631:1924695 [0] NCCL INFO Connected all rings
pgpu23:1924631:1924695 [0] NCCL INFO Connected all trees
pgpu23:1924631:1924695 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
pgpu23:1924631:1924695 [0] NCCL INFO 16 coll channels, 0 collnet channels, 0 nvls channels, 16 p2p channels, 16 p2p channels per peer
pgpu23:1924632:1924691 [1] NCCL INFO comm 0x55555ef58f10 rank 1 nranks 2 cudaDev 1 nvmlDev 1 busId 9f000 commId 0xf3a7d22286bc2df - Init COMPLETE
pgpu23:1924631:1924695 [0] NCCL INFO comm 0x55555eedf500 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 2b000 commId 0xf3a7d22286bc2df - Init COMPLETE
2025-02-10 16:51:04,203 (train_accelerate_ddp:1032) INFO: start training from epoch 1
2025-02-10 16:51:04,203 (train_accelerate_ddp:1032) INFO: start training from epoch 1
2025-02-10 16:51:04,203 (train_accelerate_ddp:1033) INFO: Train set grouped total_num_itrs = 4114
2025-02-10 16:51:04,203 (train_accelerate_ddp:1033) INFO: Train set grouped total_num_itrs = 4114
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/ts_vad_dataset.py:398: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  feature = torch.load(path, map_location="cpu")
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/ts_vad_dataset.py:398: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  feature = torch.load(path, map_location="cpu")
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/ts_vad_dataset.py:392: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  feature = torch.load(path, map_location="cpu")
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/ts_vad_dataset.py:392: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  feature = torch.load(path, map_location="cpu")
2025-02-10 16:51:14,996 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 0, num_updates: 0, {'loss': 0.7255326509475708, 'DER': 2.6724272257242014, 'ACC': np.float64(0.4945870535714285), 'MI': 0.0191231673631277, 'FA': 2.1183511580140237, 'CF': 0.5349529003470501}, batch size: 64, grad_norm: 2.3564975261688232, grad_scale: , lr: 1.00e-07, 
2025-02-10 16:51:14,996 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 0, num_updates: 0, {'loss': 0.7191768288612366, 'DER': 2.5515534781413254, 'ACC': np.float64(0.5061049107142856), 'MI': 0.023164696178168822, 'FA': 2.0380808358537257, 'CF': 0.49030794610943085}, batch size: 64, grad_norm: 2.3564975261688232, grad_scale: , lr: 1.00e-07, 
2025-02-10 17:03:12,517 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 500, num_updates: 500, {'loss': 0.31163346767425537, 'DER': 0.7878239903556359, 'ACC': np.float64(0.8674107142857143), 'MI': 0.6467751657625075, 'FA': 0.03375527426160337, 'CF': 0.10729355033152502}, batch size: 64, grad_norm: 0.40969371795654297, grad_scale: , lr: 5.01e-05, 
2025-02-10 17:03:12,518 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 500, num_updates: 500, {'loss': 0.3251288831233978, 'DER': 0.7764499358584835, 'ACC': np.float64(0.8551897321428571), 'MI': 0.6626156235230571, 'FA': 0.014246168388360002, 'CF': 0.09958814394706637}, batch size: 64, grad_norm: 0.40969371795654297, grad_scale: , lr: 5.01e-05, 
2025-02-10 17:03:12,518 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 17:03:12,518 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 17:04:02,918 (model:925) WARNING: All labels are zero
2025-02-10 17:04:02,991 (model:925) WARNING: All labels are zero
2025-02-10 17:04:03,504 (model:925) WARNING: All labels are zero
2025-02-10 17:05:36,427 (model:925) WARNING: All labels are zero
2025-02-10 17:05:48,524 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 500,  validation: loss=0.3257, DER=0.9641, ACC=0.8497, MI=0.932, FA=0.0005853, CF=0.03153, over 0.00 frames. 
2025-02-10 17:05:48,524 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6824MB
2025-02-10 17:05:49,078 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 500,  validation: loss=0.3235, DER=0.9611, ACC=0.8485, MI=0.9314, FA=0.0004653, CF=0.02927, over 0.00 frames. 
2025-02-10 17:05:49,078 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6824MB
2025-02-10 17:16:50,608 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 1000, num_updates: 1000, {'loss': 0.23091427981853485, 'DER': 0.5890036900369003, 'ACC': np.float64(0.8953794642857144), 'MI': 0.3847232472324723, 'FA': 0.1014760147601476, 'CF': 0.10280442804428044}, batch size: 64, grad_norm: 0.7042917609214783, grad_scale: , lr: 1.00e-04, 
2025-02-10 17:16:50,608 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 1000, num_updates: 1000, {'loss': 0.252215176820755, 'DER': 0.641090208857947, 'ACC': np.float64(0.8814955357142857), 'MI': 0.4103095837653681, 'FA': 0.0854688194341579, 'CF': 0.14531180565842097}, batch size: 64, grad_norm: 0.7042917609214783, grad_scale: , lr: 1.00e-04, 
2025-02-10 17:16:50,609 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 17:16:50,609 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 17:17:39,351 (model:925) WARNING: All labels are zero
2025-02-10 17:17:39,418 (model:925) WARNING: All labels are zero
2025-02-10 17:17:39,927 (model:925) WARNING: All labels are zero
2025-02-10 17:19:09,165 (model:925) WARNING: All labels are zero
2025-02-10 17:19:20,942 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 1000,  validation: loss=0.3535, DER=0.9835, ACC=0.8512, MI=0.9833, FA=1.783e-05, CF=0.0002642, over 0.00 frames. 
2025-02-10 17:19:20,942 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6824MB
2025-02-10 17:19:22,359 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 1000,  validation: loss=0.3559, DER=0.9849, ACC=0.8492, MI=0.9846, FA=2.22e-06, CF=0.000284, over 0.00 frames. 
2025-02-10 17:19:22,359 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6824MB
2025-02-10 17:30:21,824 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-1500.pt
2025-02-10 17:30:22,192 (checkpoint:355) WARNING: No checkpoints found in /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8
2025-02-10 17:30:23,281 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 1500, num_updates: 1500, {'loss': 0.20325595140457153, 'DER': 0.4866813386962131, 'ACC': np.float64(0.9103236607142857), 'MI': 0.28101995901950366, 'FA': 0.0825681111026789, 'CF': 0.12309326857403051}, batch size: 64, grad_norm: 0.8215035200119019, grad_scale: , lr: 1.50e-04, 
2025-02-10 17:30:23,281 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 17:30:23,281 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 1500, num_updates: 1500, {'loss': 0.19970785081386566, 'DER': 0.42538373115153155, 'ACC': np.float64(0.909330357142857), 'MI': 0.25045642031239435, 'FA': 0.05098383934005004, 'CF': 0.12394347149908716}, batch size: 64, grad_norm: 0.8215035200119019, grad_scale: , lr: 1.50e-04, 
2025-02-10 17:30:23,281 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 17:31:11,866 (model:925) WARNING: All labels are zero
2025-02-10 17:31:12,441 (model:925) WARNING: All labels are zero
2025-02-10 17:31:18,855 (model:925) WARNING: All labels are zero
2025-02-10 17:32:53,494 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 1500,  validation: loss=0.4107, DER=0.8754, ACC=0.8506, MI=0.7203, FA=0.04982, CF=0.1053, over 0.00 frames. 
2025-02-10 17:32:53,495 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6824MB
2025-02-10 17:33:01,183 (model:925) WARNING: All labels are zero
2025-02-10 17:33:13,970 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 1500,  validation: loss=0.3969, DER=0.8676, ACC=0.8536, MI=0.7135, FA=0.04837, CF=0.1057, over 0.00 frames. 
2025-02-10 17:33:13,971 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6824MB
2025-02-10 17:44:09,933 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 2000, num_updates: 2000, {'loss': 0.1975773125886917, 'DER': 0.4177500181567289, 'ACC': np.float64(0.9195982142857143), 'MI': 0.2620379112499092, 'FA': 0.050257825550148884, 'CF': 0.10545428135667079}, batch size: 64, grad_norm: 0.42078715562820435, grad_scale: , lr: 2.00e-04, 
2025-02-10 17:44:09,933 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 2000, num_updates: 2000, {'loss': 0.20681846141815186, 'DER': 0.5099475632325725, 'ACC': np.float64(0.9141183035714286), 'MI': 0.33590376310919184, 'FA': 0.09060764959901295, 'CF': 0.08343615052436767}, batch size: 64, grad_norm: 0.42078715562820435, grad_scale: , lr: 2.00e-04, 
2025-02-10 17:44:09,933 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 17:44:09,933 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 17:44:59,481 (model:925) WARNING: All labels are zero
2025-02-10 17:45:00,076 (model:925) WARNING: All labels are zero
2025-02-10 17:45:00,213 (model:925) WARNING: All labels are zero
2025-02-10 17:46:35,117 (model:925) WARNING: All labels are zero
2025-02-10 17:46:46,869 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 2000,  validation: loss=0.3094, DER=0.7195, ACC=0.8843, MI=0.6913, FA=0.002617, CF=0.02557, over 0.00 frames. 
2025-02-10 17:46:46,869 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6824MB
2025-02-10 17:46:47,313 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 2000,  validation: loss=0.3107, DER=0.7317, ACC=0.8841, MI=0.703, FA=0.003273, CF=0.02539, over 0.00 frames. 
2025-02-10 17:46:47,313 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6824MB
2025-02-10 17:58:44,936 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 2500, num_updates: 2500, {'loss': 0.19147346913814545, 'DER': 0.4260215053763441, 'ACC': np.float64(0.9175284355666341), 'MI': 0.26057347670250897, 'FA': 0.06494623655913978, 'CF': 0.10050179211469534}, batch size: 64, grad_norm: 0.3378654420375824, grad_scale: , lr: 1.94e-04, 
2025-02-10 17:58:44,936 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 2500, num_updates: 2500, {'loss': 0.18193182349205017, 'DER': 0.39505007983742196, 'ACC': np.float64(0.9257589285714286), 'MI': 0.23806067644070256, 'FA': 0.06924081869647264, 'CF': 0.08774858470024677}, batch size: 64, grad_norm: 0.3378654420375824, grad_scale: , lr: 1.94e-04, 
2025-02-10 17:58:44,937 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 17:58:44,937 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 17:59:34,552 (model:925) WARNING: All labels are zero
2025-02-10 17:59:35,036 (model:925) WARNING: All labels are zero
2025-02-10 17:59:35,137 (model:925) WARNING: All labels are zero
2025-02-10 18:01:06,993 (model:925) WARNING: All labels are zero
2025-02-10 18:01:19,157 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 2500,  validation: loss=0.1652, DER=0.385, ACC=0.925, MI=0.1791, FA=0.107, CF=0.09889, over 0.00 frames. 
2025-02-10 18:01:19,157 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6824MB
2025-02-10 18:01:19,796 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 2500,  validation: loss=0.1692, DER=0.3927, ACC=0.9222, MI=0.1791, FA=0.1076, CF=0.1059, over 0.00 frames. 
2025-02-10 18:01:19,796 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6824MB
2025-02-10 18:12:21,647 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-3000.pt
2025-02-10 18:12:21,991 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-10 18:12:22,001 (checkpoint:355) WARNING: No checkpoints found in /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8
2025-02-10 18:12:23,480 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 3000, num_updates: 3000, {'loss': 0.16925936937332153, 'DER': 0.3796355385378997, 'ACC': np.float64(0.9296725769118407), 'MI': 0.24767779904984755, 'FA': 0.06778699567467915, 'CF': 0.06417074381337304}, batch size: 64, grad_norm: 0.34693655371665955, grad_scale: , lr: 1.89e-04, 
2025-02-10 18:12:23,480 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 18:12:23,480 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 3000, num_updates: 3000, {'loss': 0.171647846698761, 'DER': 0.4115076474872542, 'ACC': np.float64(0.9214955357142857), 'MI': 0.24209759650400584, 'FA': 0.06860888565185724, 'CF': 0.10080116533139112}, batch size: 64, grad_norm: 0.34693655371665955, grad_scale: , lr: 1.89e-04, 
2025-02-10 18:12:23,480 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 18:13:12,835 (model:925) WARNING: All labels are zero
2025-02-10 18:13:13,425 (model:925) WARNING: All labels are zero
2025-02-10 18:13:13,524 (model:925) WARNING: All labels are zero
2025-02-10 18:14:45,390 (model:925) WARNING: All labels are zero
2025-02-10 18:14:56,470 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 3000,  validation: loss=0.1402, DER=0.3141, ACC=0.9391, MI=0.1821, FA=0.07067, CF=0.06135, over 0.00 frames. 
2025-02-10 18:14:56,471 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6824MB
2025-02-10 18:14:57,402 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 3000,  validation: loss=0.1383, DER=0.3111, ACC=0.9406, MI=0.1804, FA=0.07114, CF=0.05961, over 0.00 frames. 
2025-02-10 18:14:57,402 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6824MB
2025-02-10 18:25:48,644 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 3500, num_updates: 3500, {'loss': 0.19611570239067078, 'DER': 0.4358852325265162, 'ACC': np.float64(0.9141517857142857), 'MI': 0.2909301060647267, 'FA': 0.05785966820777808, 'CF': 0.08709545825401142}, batch size: 64, grad_norm: 0.3611780107021332, grad_scale: , lr: 1.83e-04, 
2025-02-10 18:25:48,644 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 3500, num_updates: 3500, {'loss': 0.1828344762325287, 'DER': 0.4412798086267474, 'ACC': np.float64(0.9193268077186136), 'MI': 0.2640352844434477, 'FA': 0.08066083576287658, 'CF': 0.09658368842042311}, batch size: 64, grad_norm: 0.3611780107021332, grad_scale: , lr: 1.83e-04, 
2025-02-10 18:25:48,644 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 18:25:48,644 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 18:26:38,782 (model:925) WARNING: All labels are zero
2025-02-10 18:26:39,370 (model:925) WARNING: All labels are zero
2025-02-10 18:26:39,489 (model:925) WARNING: All labels are zero
2025-02-10 18:28:12,982 (model:925) WARNING: All labels are zero
2025-02-10 18:28:24,568 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 3500,  validation: loss=0.1312, DER=0.308, ACC=0.9415, MI=0.2189, FA=0.03455, CF=0.05455, over 0.00 frames. 
2025-02-10 18:28:24,569 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6824MB
2025-02-10 18:28:25,252 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 3500,  validation: loss=0.1284, DER=0.3039, ACC=0.9431, MI=0.2164, FA=0.03451, CF=0.05305, over 0.00 frames. 
2025-02-10 18:28:25,253 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 6824MB
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
2025-02-10 18:39:13,913 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 4000, num_updates: 4000, {'loss': 0.1839129626750946, 'DER': 0.4180889861415025, 'ACC': np.float64(0.9251004464285714), 'MI': 0.28081692195477753, 'FA': 0.06586433260393873, 'CF': 0.0714077315827863}, batch size: 64, grad_norm: 0.3833117187023163, grad_scale: , lr: 1.78e-04, 
2025-02-10 18:39:13,913 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 18:39:13,915 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 4000, num_updates: 4000, {'loss': 0.1602434664964676, 'DER': 0.365491270112975, 'ACC': np.float64(0.92890625), 'MI': 0.2388223211229031, 'FA': 0.05600821636425882, 'CF': 0.07066073262581307}, batch size: 64, grad_norm: 0.3833117187023163, grad_scale: , lr: 1.78e-04, 
2025-02-10 18:39:13,915 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 18:40:03,508 (model:925) WARNING: All labels are zero
2025-02-10 18:40:04,015 (model:925) WARNING: All labels are zero
2025-02-10 18:40:04,100 (model:925) WARNING: All labels are zero
2025-02-10 18:41:35,563 (model:925) WARNING: All labels are zero
2025-02-10 18:41:47,642 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 4000,  validation: loss=0.1298, DER=0.3021, ACC=0.9414, MI=0.1936, FA=0.04497, CF=0.06358, over 0.00 frames. 
2025-02-10 18:41:47,643 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 18:41:47,773 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 4000,  validation: loss=0.1308, DER=0.3036, ACC=0.9405, MI=0.1947, FA=0.0465, CF=0.06242, over 0.00 frames. 
2025-02-10 18:41:47,773 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 18:44:49,517 (train_accelerate_ddp:713) INFO: end of epoch 1, batch_idx: 4113 batch_idx_train: 4113, {'loss': 0.15038882195949554, 'DER': 0.35604871852349995, 'ACC': np.float64(0.9321316964285714), 'MI': 0.17664200851826944, 'FA': 0.08107300306358814, 'CF': 0.09833370694164238}, batch size: 64, grad_norm: 0.34602421522140503, grad_scale: , lr: 1.77e-04, 
2025-02-10 18:44:49,519 (train_accelerate_ddp:713) INFO: end of epoch 1, batch_idx: 4113 batch_idx_train: 4113, {'loss': 0.17765288054943085, 'DER': 0.3613335173937051, 'ACC': np.float64(0.9245535714285714), 'MI': 0.2032716731087797, 'FA': 0.0528023191606847, 'CF': 0.10525952512424075}, batch size: 64, grad_norm: 0.34602421522140503, grad_scale: , lr: 1.77e-04, 
2025-02-10 18:44:49,520 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-1.pt
2025-02-10 18:44:49,838 (train_accelerate_ddp:561) INFO:  end of epoch 1, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-1.pt 
2025-02-10 18:44:53,157 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 4114, num_updates: 4000, {'loss': 0.14488379657268524, 'DER': 0.32867438305306834, 'ACC': np.float64(0.9396218355141869), 'MI': 0.19152653417776808, 'FA': 0.07483438887675621, 'CF': 0.062313459998544075}, batch size: 64, grad_norm: 0.2700190246105194, grad_scale: , lr: 1.77e-04, 
2025-02-10 18:44:53,157 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 4114, num_updates: 4000, {'loss': 0.12910987436771393, 'DER': 0.30485040797824114, 'ACC': np.float64(0.9448325892857143), 'MI': 0.14944091870655787, 'FA': 0.08680870353581142, 'CF': 0.06860078573587186}, batch size: 64, grad_norm: 0.2700190246105194, grad_scale: , lr: 1.77e-04, 
2025-02-10 18:54:38,119 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-4500.pt
2025-02-10 18:54:38,534 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-10 18:57:28,365 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 4614, num_updates: 4500, {'loss': 0.1296001821756363, 'DER': 0.3010215838390045, 'ACC': np.float64(0.9449776785714286), 'MI': 0.1296566556571165, 'FA': 0.09370919425455104, 'CF': 0.07765573392733698}, batch size: 64, grad_norm: 0.25174275040626526, grad_scale: , lr: 1.71e-04, 
2025-02-10 18:57:28,366 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 18:57:28,367 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 4614, num_updates: 4500, {'loss': 0.1302706003189087, 'DER': 0.3438843298163345, 'ACC': np.float64(0.9427120535714286), 'MI': 0.1968737788198515, 'FA': 0.08972254787026182, 'CF': 0.05728800312622118}, batch size: 64, grad_norm: 0.25174275040626526, grad_scale: , lr: 1.71e-04, 
2025-02-10 18:57:28,367 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 18:58:17,839 (model:925) WARNING: All labels are zero
2025-02-10 18:58:18,235 (model:925) WARNING: All labels are zero
2025-02-10 18:58:18,427 (model:925) WARNING: All labels are zero
2025-02-10 18:59:48,959 (model:925) WARNING: All labels are zero
2025-02-10 19:00:00,881 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 4614,  validation: loss=0.1093, DER=0.2561, ACC=0.9493, MI=0.1426, FA=0.05622, CF=0.05733, over 0.00 frames. 
2025-02-10 19:00:00,881 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 19:00:01,295 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 4614,  validation: loss=0.1108, DER=0.2576, ACC=0.9484, MI=0.1422, FA=0.0558, CF=0.05956, over 0.00 frames. 
2025-02-10 19:00:01,295 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 19:12:10,392 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 5114, num_updates: 5000, {'loss': 0.15613014996051788, 'DER': 0.3591015169194866, 'ACC': np.float64(0.9278459821428571), 'MI': 0.17378938156359394, 'FA': 0.07292882147024504, 'CF': 0.11238331388564761}, batch size: 64, grad_norm: 0.2742801904678345, grad_scale: , lr: 1.65e-04, 
2025-02-10 19:12:10,393 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 19:12:10,394 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 5114, num_updates: 5000, {'loss': 0.14992265403270721, 'DER': 0.3244650900900901, 'ACC': np.float64(0.9359933035714286), 'MI': 0.17004504504504506, 'FA': 0.0752393018018018, 'CF': 0.07918074324324324}, batch size: 64, grad_norm: 0.2742801904678345, grad_scale: , lr: 1.65e-04, 
2025-02-10 19:12:10,394 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 19:12:59,674 (model:925) WARNING: All labels are zero
2025-02-10 19:13:00,177 (model:925) WARNING: All labels are zero
2025-02-10 19:13:00,267 (model:925) WARNING: All labels are zero
2025-02-10 19:14:30,208 (model:925) WARNING: All labels are zero
2025-02-10 19:14:42,258 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 5114,  validation: loss=0.1162, DER=0.266, ACC=0.9478, MI=0.1523, FA=0.05473, CF=0.05901, over 0.00 frames. 
2025-02-10 19:14:42,258 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 19:14:42,779 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 5114,  validation: loss=0.1175, DER=0.2625, ACC=0.9472, MI=0.1473, FA=0.05363, CF=0.06156, over 0.00 frames. 
2025-02-10 19:14:42,780 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 19:26:48,161 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 5614, num_updates: 5500, {'loss': 0.13233782351016998, 'DER': 0.28751280925193967, 'ACC': np.float64(0.9469419642857143), 'MI': 0.12889767237593325, 'FA': 0.0981554677206851, 'CF': 0.060459669155321326}, batch size: 64, grad_norm: 0.2221386879682541, grad_scale: , lr: 1.60e-04, 
2025-02-10 19:26:48,161 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 19:26:48,164 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 5614, num_updates: 5500, {'loss': 0.15861687064170837, 'DER': 0.34391423165860835, 'ACC': np.float64(0.930859375), 'MI': 0.17174689930628548, 'FA': 0.08198444397729661, 'CF': 0.09018288837502628}, batch size: 64, grad_norm: 0.2221386879682541, grad_scale: , lr: 1.60e-04, 
2025-02-10 19:26:48,165 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 19:27:38,134 (model:925) WARNING: All labels are zero
2025-02-10 19:27:38,697 (model:925) WARNING: All labels are zero
2025-02-10 19:27:38,738 (model:925) WARNING: All labels are zero
2025-02-10 19:29:10,352 (model:925) WARNING: All labels are zero
2025-02-10 19:29:22,581 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 5614,  validation: loss=0.1089, DER=0.2508, ACC=0.9497, MI=0.1159, FA=0.0703, CF=0.06463, over 0.00 frames. 
2025-02-10 19:29:22,581 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 19:29:22,590 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 5614,  validation: loss=0.1103, DER=0.2483, ACC=0.9486, MI=0.1153, FA=0.06806, CF=0.06491, over 0.00 frames. 
2025-02-10 19:29:22,590 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 19:38:36,877 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-6000.pt
2025-02-10 19:38:37,325 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-10 19:41:22,216 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 6114, num_updates: 6000, {'loss': 0.13652311265468597, 'DER': 0.3217462199822117, 'ACC': np.float64(0.9404352678571429), 'MI': 0.16172546694337386, 'FA': 0.08619922917284317, 'CF': 0.07382152386599466}, batch size: 64, grad_norm: 0.25446617603302, grad_scale: , lr: 1.54e-04, 
2025-02-10 19:41:22,216 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 19:41:22,218 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 6114, num_updates: 6000, {'loss': 0.16853241622447968, 'DER': 0.37522709576953023, 'ACC': np.float64(0.919888392857143), 'MI': 0.22248896963405138, 'FA': 0.062224240851284716, 'CF': 0.09051388528419413}, batch size: 64, grad_norm: 0.25446617603302, grad_scale: , lr: 1.54e-04, 
2025-02-10 19:41:22,218 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 19:42:12,023 (model:925) WARNING: All labels are zero
2025-02-10 19:42:12,200 (model:925) WARNING: All labels are zero
2025-02-10 19:42:12,606 (model:925) WARNING: All labels are zero
2025-02-10 19:43:49,832 (model:925) WARNING: All labels are zero
2025-02-10 19:44:02,413 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 6114,  validation: loss=0.09492, DER=0.2226, ACC=0.9562, MI=0.1311, FA=0.04864, CF=0.0429, over 0.00 frames. 
2025-02-10 19:44:02,413 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 19:44:02,916 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 6114,  validation: loss=0.09554, DER=0.218, ACC=0.9557, MI=0.1291, FA=0.04451, CF=0.04443, over 0.00 frames. 
2025-02-10 19:44:02,916 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 19:57:14,004 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 6614, num_updates: 6500, {'loss': 0.1497933268547058, 'DER': 0.3632771731027285, 'ACC': np.float64(0.93140625), 'MI': 0.17280453257790368, 'FA': 0.09557179066646787, 'CF': 0.09490084985835694}, batch size: 64, grad_norm: 0.17412056028842926, grad_scale: , lr: 1.49e-04, 
2025-02-10 19:57:14,005 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 19:57:14,006 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 6614, num_updates: 6500, {'loss': 0.12679290771484375, 'DER': 0.299653932279297, 'ACC': np.float64(0.9428794642857143), 'MI': 0.19529076474180634, 'FA': 0.05672796362896112, 'CF': 0.04763520390852955}, batch size: 64, grad_norm: 0.17412056028842926, grad_scale: , lr: 1.49e-04, 
2025-02-10 19:57:14,006 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 19:58:04,465 (model:925) WARNING: All labels are zero
2025-02-10 19:58:04,888 (model:925) WARNING: All labels are zero
2025-02-10 19:58:05,073 (model:925) WARNING: All labels are zero
2025-02-10 19:59:37,132 (model:925) WARNING: All labels are zero
2025-02-10 19:59:49,504 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 6614,  validation: loss=0.09039, DER=0.2103, ACC=0.9588, MI=0.12, FA=0.05349, CF=0.03676, over 0.00 frames. 
2025-02-10 19:59:49,504 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 19:59:50,053 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 6614,  validation: loss=0.0929, DER=0.2124, ACC=0.9574, MI=0.1217, FA=0.05208, CF=0.03868, over 0.00 frames. 
2025-02-10 19:59:50,053 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 20:11:59,649 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 7114, num_updates: 7000, {'loss': 0.13463443517684937, 'DER': 0.3344601884485363, 'ACC': np.float64(0.9366183035714286), 'MI': 0.19377112853341005, 'FA': 0.06667625692296626, 'CF': 0.07401280299215997}, batch size: 64, grad_norm: 0.20318955183029175, grad_scale: , lr: 1.43e-04, 
2025-02-10 20:11:59,650 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 20:11:59,651 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 7114, num_updates: 7000, {'loss': 0.17737524211406708, 'DER': 0.39822050290135397, 'ACC': np.float64(0.9278013392857143), 'MI': 0.19837524177949709, 'FA': 0.09756286266924565, 'CF': 0.10228239845261122}, batch size: 64, grad_norm: 0.20318955183029175, grad_scale: , lr: 1.43e-04, 
2025-02-10 20:11:59,651 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 20:12:49,061 (model:925) WARNING: All labels are zero
2025-02-10 20:12:49,603 (model:925) WARNING: All labels are zero
2025-02-10 20:12:49,646 (model:925) WARNING: All labels are zero
2025-02-10 20:14:22,193 (model:925) WARNING: All labels are zero
2025-02-10 20:14:34,469 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 7114,  validation: loss=0.08649, DER=0.2038, ACC=0.9603, MI=0.1225, FA=0.04948, CF=0.0318, over 0.00 frames. 
2025-02-10 20:14:34,470 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 20:14:34,514 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 7114,  validation: loss=0.08903, DER=0.2106, ACC=0.9586, MI=0.1264, FA=0.04992, CF=0.03427, over 0.00 frames. 
2025-02-10 20:14:34,515 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 20:23:57,808 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-7500.pt
2025-02-10 20:23:58,280 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-10 20:26:42,464 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 7614, num_updates: 7500, {'loss': 0.13653609156608582, 'DER': 0.3126569913480324, 'ACC': np.float64(0.9385411008509867), 'MI': 0.19048283561261511, 'FA': 0.05588891989952554, 'CF': 0.06628523583589171}, batch size: 64, grad_norm: 0.18222619593143463, grad_scale: , lr: 1.38e-04, 
2025-02-10 20:26:42,465 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 20:26:42,465 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 7614, num_updates: 7500, {'loss': 0.12585705518722534, 'DER': 0.297704719339444, 'ACC': np.float64(0.9471547450822062), 'MI': 0.15620028785698054, 'FA': 0.08226649496250284, 'CF': 0.05923793651996061}, batch size: 64, grad_norm: 0.18222619593143463, grad_scale: , lr: 1.38e-04, 
2025-02-10 20:26:42,466 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 20:27:32,423 (model:925) WARNING: All labels are zero
2025-02-10 20:27:32,971 (model:925) WARNING: All labels are zero
2025-02-10 20:27:33,007 (model:925) WARNING: All labels are zero
2025-02-10 20:29:06,005 (model:925) WARNING: All labels are zero
2025-02-10 20:29:18,450 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 7614,  validation: loss=0.08855, DER=0.2045, ACC=0.9599, MI=0.1314, FA=0.04042, CF=0.03268, over 0.00 frames. 
2025-02-10 20:29:18,450 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 20:29:18,457 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 7614,  validation: loss=0.09007, DER=0.2051, ACC=0.9591, MI=0.1335, FA=0.03874, CF=0.03286, over 0.00 frames. 
2025-02-10 20:29:18,457 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 20:41:34,538 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 8114, num_updates: 8000, {'loss': 0.14218616485595703, 'DER': 0.33073220536756126, 'ACC': np.float64(0.936171875), 'MI': 0.15475495915985998, 'FA': 0.08962952158693116, 'CF': 0.08634772462077013}, batch size: 64, grad_norm: 0.14851711690425873, grad_scale: , lr: 1.32e-04, 
2025-02-10 20:41:34,539 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 20:41:34,540 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 8114, num_updates: 8000, {'loss': 0.11315605044364929, 'DER': 0.2487217202493521, 'ACC': np.float64(0.9515401785714286), 'MI': 0.1287385305036072, 'FA': 0.06457939342999229, 'CF': 0.05540379631575261}, batch size: 64, grad_norm: 0.14851711690425873, grad_scale: , lr: 1.32e-04, 
2025-02-10 20:41:34,540 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 20:42:27,615 (model:925) WARNING: All labels are zero
2025-02-10 20:42:27,976 (model:925) WARNING: All labels are zero
2025-02-10 20:42:28,201 (model:925) WARNING: All labels are zero
2025-02-10 20:43:59,645 (model:925) WARNING: All labels are zero
2025-02-10 20:44:11,684 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 8114,  validation: loss=0.09458, DER=0.207, ACC=0.9595, MI=0.1011, FA=0.0713, CF=0.03454, over 0.00 frames. 
2025-02-10 20:44:11,684 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 20:44:11,963 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 8114,  validation: loss=0.09588, DER=0.208, ACC=0.9588, MI=0.1021, FA=0.07105, CF=0.03486, over 0.00 frames. 
2025-02-10 20:44:11,963 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 20:47:36,365 (train_accelerate_ddp:713) INFO: end of epoch 2, batch_idx: 4113 batch_idx_train: 8227, {'loss': 0.1271832287311554, 'DER': 0.30414746543778803, 'ACC': np.float64(0.9433202931786502), 'MI': 0.17734735023041476, 'FA': 0.06790034562211981, 'CF': 0.058899769585253454}, batch size: 64, grad_norm: 0.2416108399629593, grad_scale: , lr: 1.31e-04, 
2025-02-10 20:47:36,365 (train_accelerate_ddp:713) INFO: end of epoch 2, batch_idx: 4113 batch_idx_train: 8227, {'loss': 0.11791250109672546, 'DER': 0.2855963371613, 'ACC': np.float64(0.9452678571428571), 'MI': 0.13120168130300983, 'FA': 0.07190572693837724, 'CF': 0.08248892891991293}, batch size: 64, grad_norm: 0.2416108399629593, grad_scale: , lr: 1.31e-04, 
2025-02-10 20:47:36,367 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-2.pt
2025-02-10 20:47:36,691 (train_accelerate_ddp:561) INFO:  end of epoch 2, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-2.pt 
2025-02-10 20:47:39,607 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 8228, num_updates: 8000, {'loss': 0.12919701635837555, 'DER': 0.27831159917638987, 'ACC': np.float64(0.9428125), 'MI': 0.14495538778311598, 'FA': 0.05998627316403569, 'CF': 0.07336993822923817}, batch size: 64, grad_norm: 0.2001752108335495, grad_scale: , lr: 1.31e-04, 
2025-02-10 20:47:39,608 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 8228, num_updates: 8000, {'loss': 0.1284549981355667, 'DER': 0.2752339098383896, 'ACC': np.float64(0.9461495535714286), 'MI': 0.14573291749362063, 'FA': 0.06273036574992912, 'CF': 0.0667706265948398}, batch size: 64, grad_norm: 0.2001752108335495, grad_scale: , lr: 1.31e-04, 
2025-02-10 21:00:01,039 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 8728, num_updates: 8500, {'loss': 0.12634427845478058, 'DER': 0.3060752575152407, 'ACC': np.float64(0.942466517857143), 'MI': 0.19697288206853059, 'FA': 0.05395557424146871, 'CF': 0.055146801205241396}, batch size: 64, grad_norm: 0.19427217543125153, grad_scale: , lr: 1.25e-04, 
2025-02-10 21:00:01,039 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 21:00:01,041 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 8728, num_updates: 8500, {'loss': 0.12247449159622192, 'DER': 0.31941342861396455, 'ACC': np.float64(0.9443002572994742), 'MI': 0.18587166889980647, 'FA': 0.08232842042578532, 'CF': 0.05121333928837279}, batch size: 64, grad_norm: 0.19427217543125153, grad_scale: , lr: 1.25e-04, 
2025-02-10 21:00:01,041 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 21:00:52,134 (model:925) WARNING: All labels are zero
2025-02-10 21:00:52,376 (model:925) WARNING: All labels are zero
2025-02-10 21:00:52,974 (model:925) WARNING: All labels are zero
2025-02-10 21:02:24,416 (model:925) WARNING: All labels are zero
2025-02-10 21:02:36,624 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 8728,  validation: loss=0.08486, DER=0.1929, ACC=0.9618, MI=0.1029, FA=0.05892, CF=0.03101, over 0.00 frames. 
2025-02-10 21:02:36,624 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 21:02:37,190 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 8728,  validation: loss=0.08667, DER=0.1938, ACC=0.9609, MI=0.1035, FA=0.0574, CF=0.03289, over 0.00 frames. 
2025-02-10 21:02:37,190 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 21:09:03,773 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-9000.pt
2025-02-10 21:09:04,209 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-10 21:09:04,218 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-10 21:14:32,823 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 9228, num_updates: 9000, {'loss': 0.1238158792257309, 'DER': 0.3000450856627592, 'ACC': np.float64(0.9433977015088735), 'MI': 0.13112413585813046, 'FA': 0.0881424706943192, 'CF': 0.0807784791103096}, batch size: 64, grad_norm: 0.21436801552772522, grad_scale: , lr: 1.20e-04, 
2025-02-10 21:14:32,823 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 21:14:32,824 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 9228, num_updates: 9000, {'loss': 0.1370987892150879, 'DER': 0.2873232226275037, 'ACC': np.float64(0.9438727678571429), 'MI': 0.2034299609649965, 'FA': 0.04940167658539707, 'CF': 0.03449158507711013}, batch size: 64, grad_norm: 0.21436801552772522, grad_scale: , lr: 1.20e-04, 
2025-02-10 21:14:32,824 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 21:15:23,446 (model:925) WARNING: All labels are zero
2025-02-10 21:15:23,928 (model:925) WARNING: All labels are zero
2025-02-10 21:15:24,043 (model:925) WARNING: All labels are zero
2025-02-10 21:16:55,516 (model:925) WARNING: All labels are zero
2025-02-10 21:17:07,422 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 9228,  validation: loss=0.08565, DER=0.1973, ACC=0.9603, MI=0.08556, FA=0.07267, CF=0.03911, over 0.00 frames. 
2025-02-10 21:17:07,422 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 21:17:08,300 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 9228,  validation: loss=0.08635, DER=0.1965, ACC=0.96, MI=0.08716, FA=0.07069, CF=0.03866, over 0.00 frames. 
2025-02-10 21:17:08,301 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 21:29:01,976 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 9728, num_updates: 9500, {'loss': 0.1307966560125351, 'DER': 0.3051478974982891, 'ACC': np.float64(0.9454464285714286), 'MI': 0.14455174511443997, 'FA': 0.09406128811497225, 'CF': 0.06653486426887689}, batch size: 64, grad_norm: 0.16554956138134003, grad_scale: , lr: 1.14e-04, 
2025-02-10 21:29:01,977 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 21:29:01,978 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 9728, num_updates: 9500, {'loss': 0.10021907836198807, 'DER': 0.24557554482960361, 'ACC': np.float64(0.9550669642857144), 'MI': 0.10918531519672371, 'FA': 0.08753839403247038, 'CF': 0.04885183560040954}, batch size: 64, grad_norm: 0.16554956138134003, grad_scale: , lr: 1.14e-04, 
2025-02-10 21:29:01,978 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 21:29:52,320 (model:925) WARNING: All labels are zero
2025-02-10 21:29:52,737 (model:925) WARNING: All labels are zero
2025-02-10 21:29:52,918 (model:925) WARNING: All labels are zero
2025-02-10 21:31:25,413 (model:925) WARNING: All labels are zero
2025-02-10 21:31:37,609 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 9728,  validation: loss=0.0826, DER=0.1891, ACC=0.9622, MI=0.09947, FA=0.05716, CF=0.0325, over 0.00 frames. 
2025-02-10 21:31:37,609 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 21:31:37,646 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 9728,  validation: loss=0.08421, DER=0.1912, ACC=0.9609, MI=0.09998, FA=0.05518, CF=0.03606, over 0.00 frames. 
2025-02-10 21:31:37,647 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 21:44:07,347 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 10228, num_updates: 10000, {'loss': 0.1303057223558426, 'DER': 0.3035494831200752, 'ACC': np.float64(0.9417857142857143), 'MI': 0.1700281934504446, 'FA': 0.06000144581797152, 'CF': 0.07351984385165908}, batch size: 64, grad_norm: 0.22072544693946838, grad_scale: , lr: 1.09e-04, 
2025-02-10 21:44:07,348 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 21:44:07,349 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 10228, num_updates: 10000, {'loss': 0.15624548494815826, 'DER': 0.37035979440319816, 'ACC': np.float64(0.9311272321428571), 'MI': 0.21202170188463734, 'FA': 0.08816390633923472, 'CF': 0.0701741861793261}, batch size: 64, grad_norm: 0.22072544693946838, grad_scale: , lr: 1.09e-04, 
2025-02-10 21:44:07,349 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 21:44:57,132 (model:925) WARNING: All labels are zero
2025-02-10 21:44:57,345 (model:925) WARNING: All labels are zero
2025-02-10 21:44:57,927 (model:925) WARNING: All labels are zero
2025-02-10 21:46:28,416 (model:925) WARNING: All labels are zero
2025-02-10 21:46:40,404 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 10228,  validation: loss=0.08001, DER=0.1894, ACC=0.9623, MI=0.09145, FA=0.06446, CF=0.03347, over 0.00 frames. 
2025-02-10 21:46:40,405 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 21:46:40,721 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 10228,  validation: loss=0.08094, DER=0.1856, ACC=0.9622, MI=0.09198, FA=0.06097, CF=0.03262, over 0.00 frames. 
2025-02-10 21:46:40,721 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 21:53:23,030 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-10500.pt
2025-02-10 21:53:23,458 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-10 21:58:56,664 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 10728, num_updates: 10500, {'loss': 0.1123105138540268, 'DER': 0.2751019175600181, 'ACC': np.float64(0.9498325892857143), 'MI': 0.13377623433489355, 'FA': 0.07707987316925864, 'CF': 0.06424581005586592}, batch size: 64, grad_norm: 0.16410593688488007, grad_scale: , lr: 1.03e-04, 
2025-02-10 21:58:56,665 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 21:58:56,666 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 10728, num_updates: 10500, {'loss': 0.10517594963312149, 'DER': 0.23979160799774712, 'ACC': np.float64(0.9536607142857143), 'MI': 0.138552520416784, 'FA': 0.0487186707969586, 'CF': 0.05252041678400451}, batch size: 64, grad_norm: 0.16410593688488007, grad_scale: , lr: 1.03e-04, 
2025-02-10 21:58:56,667 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 21:59:46,990 (model:925) WARNING: All labels are zero
2025-02-10 21:59:47,431 (model:925) WARNING: All labels are zero
2025-02-10 21:59:47,592 (model:925) WARNING: All labels are zero
2025-02-10 22:01:20,209 (model:925) WARNING: All labels are zero
2025-02-10 22:01:32,715 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 10728,  validation: loss=0.08154, DER=0.1889, ACC=0.9621, MI=0.08816, FA=0.06615, CF=0.03461, over 0.00 frames. 
2025-02-10 22:01:32,715 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 22:01:33,292 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 10728,  validation: loss=0.08361, DER=0.1922, ACC=0.9606, MI=0.08964, FA=0.06537, CF=0.0372, over 0.00 frames. 
2025-02-10 22:01:33,292 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 22:13:45,312 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 11228, num_updates: 11000, {'loss': 0.11265724152326584, 'DER': 0.25365918272733295, 'ACC': np.float64(0.9509933035714286), 'MI': 0.17365388436320287, 'FA': 0.042850519901980265, 'CF': 0.03715477846214981}, batch size: 64, grad_norm: 0.20354551076889038, grad_scale: , lr: 9.75e-05, 
2025-02-10 22:13:45,313 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 22:13:45,314 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 11228, num_updates: 11000, {'loss': 0.13106609880924225, 'DER': 0.3069627074800604, 'ACC': np.float64(0.943002232142857), 'MI': 0.17791190630164547, 'FA': 0.06905223826974204, 'CF': 0.059998562908672844}, batch size: 64, grad_norm: 0.20354551076889038, grad_scale: , lr: 9.75e-05, 
2025-02-10 22:13:45,314 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 22:14:35,762 (model:925) WARNING: All labels are zero
2025-02-10 22:14:36,267 (model:925) WARNING: All labels are zero
2025-02-10 22:14:36,362 (model:925) WARNING: All labels are zero
2025-02-10 22:16:07,984 (model:925) WARNING: All labels are zero
2025-02-10 22:16:20,116 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 11228,  validation: loss=0.07612, DER=0.1783, ACC=0.9643, MI=0.1063, FA=0.04415, CF=0.02782, over 0.00 frames. 
2025-02-10 22:16:20,117 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 22:16:20,513 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 11228,  validation: loss=0.07795, DER=0.1793, ACC=0.9633, MI=0.1076, FA=0.04134, CF=0.03045, over 0.00 frames. 
2025-02-10 22:16:20,513 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 22:28:27,102 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 11728, num_updates: 11500, {'loss': 0.09800887852907181, 'DER': 0.23515527034004574, 'ACC': np.float64(0.9563882547429741), 'MI': 0.13682968208305674, 'FA': 0.04742937228000295, 'CF': 0.050896215976986056}, batch size: 64, grad_norm: 0.15413586795330048, grad_scale: , lr: 9.19e-05, 
2025-02-10 22:28:27,103 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 22:28:27,104 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 11728, num_updates: 11500, {'loss': 0.11871093511581421, 'DER': 0.26871794871794874, 'ACC': np.float64(0.9484709821428571), 'MI': 0.127985347985348, 'FA': 0.07120879120879121, 'CF': 0.06952380952380953}, batch size: 64, grad_norm: 0.15413586795330048, grad_scale: , lr: 9.19e-05, 
2025-02-10 22:28:27,104 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 22:29:16,525 (model:925) WARNING: All labels are zero
2025-02-10 22:29:17,075 (model:925) WARNING: All labels are zero
2025-02-10 22:29:17,113 (model:925) WARNING: All labels are zero
2025-02-10 22:30:47,570 (model:925) WARNING: All labels are zero
2025-02-10 22:30:59,494 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 11728,  validation: loss=0.07743, DER=0.1771, ACC=0.9644, MI=0.09477, FA=0.05387, CF=0.02846, over 0.00 frames. 
2025-02-10 22:30:59,494 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 22:30:59,650 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 11728,  validation: loss=0.07921, DER=0.1793, ACC=0.9633, MI=0.09618, FA=0.05212, CF=0.03104, over 0.00 frames. 
2025-02-10 22:30:59,650 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 22:38:10,691 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-12000.pt
2025-02-10 22:38:11,112 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-10 22:43:49,706 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 12228, num_updates: 12000, {'loss': 0.10860363394021988, 'DER': 0.2633388133313406, 'ACC': np.float64(0.9527790178571429), 'MI': 0.13181886115677777, 'FA': 0.07868778956807652, 'CF': 0.05283216260648632}, batch size: 64, grad_norm: 0.2124992311000824, grad_scale: , lr: 8.63e-05, 
2025-02-10 22:43:49,707 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 22:43:49,707 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 12228, num_updates: 12000, {'loss': 0.15015137195587158, 'DER': 0.3338412522510043, 'ACC': np.float64(0.9319642857142857), 'MI': 0.1793184651613797, 'FA': 0.0661448954148774, 'CF': 0.08837789167474719}, batch size: 64, grad_norm: 0.2124992311000824, grad_scale: , lr: 8.63e-05, 
2025-02-10 22:43:49,708 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 22:44:39,134 (model:925) WARNING: All labels are zero
2025-02-10 22:44:39,608 (model:925) WARNING: All labels are zero
2025-02-10 22:44:39,709 (model:925) WARNING: All labels are zero
2025-02-10 22:46:11,313 (model:925) WARNING: All labels are zero
2025-02-10 22:46:22,873 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 12228,  validation: loss=0.08444, DER=0.1891, ACC=0.9606, MI=0.1019, FA=0.05025, CF=0.03697, over 0.00 frames. 
2025-02-10 22:46:22,874 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 22:46:23,248 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 12228,  validation: loss=0.08433, DER=0.191, ACC=0.9607, MI=0.09964, FA=0.05311, CF=0.03821, over 0.00 frames. 
2025-02-10 22:46:23,248 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 22:49:06,736 (train_accelerate_ddp:713) INFO: end of epoch 3, batch_idx: 4113 batch_idx_train: 12341, {'loss': 0.10250173509120941, 'DER': 0.21615645083269988, 'ACC': np.float64(0.9584040178571429), 'MI': 0.13730910096054177, 'FA': 0.03745421878239237, 'CF': 0.041393131089765736}, batch size: 64, grad_norm: 0.15071417391300201, grad_scale: , lr: 8.51e-05, 
2025-02-10 22:49:06,738 (train_accelerate_ddp:713) INFO: end of epoch 3, batch_idx: 4113 batch_idx_train: 12341, {'loss': 0.1161850169301033, 'DER': 0.24790530655672297, 'ACC': np.float64(0.9508370535714286), 'MI': 0.15254688123420668, 'FA': 0.05033914084319723, 'CF': 0.045019284479319056}, batch size: 64, grad_norm: 0.15071417391300201, grad_scale: , lr: 8.51e-05, 
2025-02-10 22:49:06,739 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-3.pt
2025-02-10 22:49:07,045 (train_accelerate_ddp:561) INFO:  end of epoch 3, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-3.pt 
2025-02-10 22:49:09,716 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 12342, num_updates: 12000, {'loss': 0.12150046974420547, 'DER': 0.28521690690063367, 'ACC': np.float64(0.9462165178571429), 'MI': 0.16259313418285634, 'FA': 0.07227908919991644, 'CF': 0.05034468351786087}, batch size: 64, grad_norm: 0.13502375781536102, grad_scale: , lr: 8.51e-05, 
2025-02-10 22:49:09,718 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 12342, num_updates: 12000, {'loss': 0.09712615609169006, 'DER': 0.21278052491441612, 'ACC': np.float64(0.9631361607142856), 'MI': 0.1107645492582731, 'FA': 0.06352225180677064, 'CF': 0.038493723849372385}, batch size: 64, grad_norm: 0.13502375781536102, grad_scale: , lr: 8.51e-05, 
2025-02-10 23:01:19,850 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 12842, num_updates: 12500, {'loss': 0.10305227339267731, 'DER': 0.23022629702393946, 'ACC': np.float64(0.9565625), 'MI': 0.12246234446627374, 'FA': 0.05479153023357346, 'CF': 0.052972422324092265}, batch size: 64, grad_norm: 0.17781169712543488, grad_scale: , lr: 7.95e-05, 
2025-02-10 23:01:19,851 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 23:01:19,853 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 12842, num_updates: 12500, {'loss': 0.1283034086227417, 'DER': 0.29546844214960255, 'ACC': np.float64(0.9408258928571429), 'MI': 0.1938990420544874, 'FA': 0.0368231537468578, 'CF': 0.06474624634825736}, batch size: 64, grad_norm: 0.17781169712543488, grad_scale: , lr: 7.95e-05, 
2025-02-10 23:01:19,853 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 23:02:09,438 (model:925) WARNING: All labels are zero
2025-02-10 23:02:10,010 (model:925) WARNING: All labels are zero
2025-02-10 23:02:10,030 (model:925) WARNING: All labels are zero
2025-02-10 23:03:41,330 (model:925) WARNING: All labels are zero
2025-02-10 23:03:53,445 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 12842,  validation: loss=0.07867, DER=0.1785, ACC=0.9634, MI=0.08929, FA=0.05913, CF=0.03004, over 0.00 frames. 
2025-02-10 23:03:53,446 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 23:03:53,455 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 12842,  validation: loss=0.0773, DER=0.1763, ACC=0.9643, MI=0.08679, FA=0.05979, CF=0.02968, over 0.00 frames. 
2025-02-10 23:03:53,455 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 23:15:57,275 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 13342, num_updates: 13000, {'loss': 0.11300496011972427, 'DER': 0.260236643958408, 'ACC': np.float64(0.9513950892857143), 'MI': 0.13166009322337754, 'FA': 0.07651487988526354, 'CF': 0.05206167084976694}, batch size: 64, grad_norm: 0.1632942408323288, grad_scale: , lr: 7.40e-05, 
2025-02-10 23:15:57,276 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 23:15:57,277 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 13342, num_updates: 13000, {'loss': 0.10310418158769608, 'DER': 0.24045773882813065, 'ACC': np.float64(0.9558963772424858), 'MI': 0.13348301586151953, 'FA': 0.062721807778663, 'CF': 0.04425291518794814}, batch size: 64, grad_norm: 0.1632942408323288, grad_scale: , lr: 7.40e-05, 
2025-02-10 23:15:57,278 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 23:16:47,210 (model:925) WARNING: All labels are zero
2025-02-10 23:16:47,793 (model:925) WARNING: All labels are zero
2025-02-10 23:16:47,801 (model:925) WARNING: All labels are zero
2025-02-10 23:18:19,982 (model:925) WARNING: All labels are zero
2025-02-10 23:18:32,086 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 13342,  validation: loss=0.07808, DER=0.1772, ACC=0.9638, MI=0.09791, FA=0.05016, CF=0.02909, over 0.00 frames. 
2025-02-10 23:18:32,087 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 23:18:32,115 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 13342,  validation: loss=0.07616, DER=0.1735, ACC=0.9651, MI=0.09579, FA=0.0507, CF=0.02704, over 0.00 frames. 
2025-02-10 23:18:32,116 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 23:22:20,439 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-13500.pt
2025-02-10 23:22:21,687 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-10 23:22:21,706 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-10 23:30:41,797 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 13842, num_updates: 13500, {'loss': 0.12010371685028076, 'DER': 0.24994729815192185, 'ACC': np.float64(0.9516964285714287), 'MI': 0.14911109549574872, 'FA': 0.04665870283184597, 'CF': 0.05417749982432717}, batch size: 64, grad_norm: 0.17905962467193604, grad_scale: , lr: 6.84e-05, 
2025-02-10 23:30:41,798 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 13842, num_updates: 13500, {'loss': 0.1032017320394516, 'DER': 0.2687336570788196, 'ACC': np.float64(0.9543449715497795), 'MI': 0.1612252521479268, 'FA': 0.07231976092641015, 'CF': 0.03518864400448263}, batch size: 64, grad_norm: 0.17905962467193604, grad_scale: , lr: 6.84e-05, 
2025-02-10 23:30:41,798 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 23:30:41,798 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 23:31:35,083 (model:925) WARNING: All labels are zero
2025-02-10 23:31:35,204 (model:925) WARNING: All labels are zero
2025-02-10 23:31:35,684 (model:925) WARNING: All labels are zero
2025-02-10 23:33:09,808 (model:925) WARNING: All labels are zero
2025-02-10 23:33:22,148 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 13842,  validation: loss=0.07423, DER=0.1722, ACC=0.9656, MI=0.1013, FA=0.04646, CF=0.02438, over 0.00 frames. 
2025-02-10 23:33:22,148 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 23:33:22,619 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 13842,  validation: loss=0.07575, DER=0.1731, ACC=0.9647, MI=0.1028, FA=0.04407, CF=0.02623, over 0.00 frames. 
2025-02-10 23:33:22,620 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 23:46:35,672 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 14342, num_updates: 14000, {'loss': 0.0991741195321083, 'DER': 0.23811902383330955, 'ACC': np.float64(0.9567299107142857), 'MI': 0.14742400456686172, 'FA': 0.05216212359069502, 'CF': 0.03853289567575282}, batch size: 64, grad_norm: 0.1666269153356552, grad_scale: , lr: 6.29e-05, 
2025-02-10 23:46:35,673 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 23:46:35,674 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 14342, num_updates: 14000, {'loss': 0.1130414679646492, 'DER': 0.25803476410074494, 'ACC': np.float64(0.9496875), 'MI': 0.14395175594182333, 'FA': 0.0522880454061724, 'CF': 0.061794962752749205}, batch size: 64, grad_norm: 0.1666269153356552, grad_scale: , lr: 6.29e-05, 
2025-02-10 23:46:35,674 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-10 23:47:28,374 (model:925) WARNING: All labels are zero
2025-02-10 23:47:28,954 (model:925) WARNING: All labels are zero
2025-02-10 23:47:29,002 (model:925) WARNING: All labels are zero
2025-02-10 23:49:03,349 (model:925) WARNING: All labels are zero
2025-02-10 23:49:15,686 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 14342,  validation: loss=0.07748, DER=0.1796, ACC=0.9637, MI=0.09368, FA=0.05356, CF=0.03234, over 0.00 frames. 
2025-02-10 23:49:15,687 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-10 23:49:15,832 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 14342,  validation: loss=0.07828, DER=0.1776, ACC=0.9632, MI=0.09377, FA=0.05079, CF=0.033, over 0.00 frames. 
2025-02-10 23:49:15,833 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 00:01:20,405 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 14842, num_updates: 14500, {'loss': 0.12441329658031464, 'DER': 0.26423916123547747, 'ACC': np.float64(0.94921875), 'MI': 0.16690280532728818, 'FA': 0.03924624539529612, 'CF': 0.05809011051289317}, batch size: 64, grad_norm: 0.19290806353092194, grad_scale: , lr: 5.73e-05, 
2025-02-11 00:01:20,406 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 00:01:20,406 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 14842, num_updates: 14500, {'loss': 0.10735467821359634, 'DER': 0.2588139241445855, 'ACC': np.float64(0.9516977307280815), 'MI': 0.13248719661545313, 'FA': 0.06680026720106881, 'CF': 0.05952646032806354}, batch size: 64, grad_norm: 0.19290806353092194, grad_scale: , lr: 5.73e-05, 
2025-02-11 00:01:20,407 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 00:02:10,960 (model:925) WARNING: All labels are zero
2025-02-11 00:02:11,524 (model:925) WARNING: All labels are zero
2025-02-11 00:02:11,566 (model:925) WARNING: All labels are zero
2025-02-11 00:03:44,561 (model:925) WARNING: All labels are zero
2025-02-11 00:03:55,650 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 14842,  validation: loss=0.07746, DER=0.1769, ACC=0.9636, MI=0.09319, FA=0.05301, CF=0.0307, over 0.00 frames. 
2025-02-11 00:03:55,650 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 00:03:56,541 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 14842,  validation: loss=0.07665, DER=0.1775, ACC=0.9643, MI=0.09245, FA=0.05556, CF=0.02951, over 0.00 frames. 
2025-02-11 00:03:56,541 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 00:07:43,666 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-15000.pt
2025-02-11 00:07:44,099 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-11 00:16:00,283 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 15342, num_updates: 15000, {'loss': 0.10717907547950745, 'DER': 0.24556295063782585, 'ACC': np.float64(0.9529129464285714), 'MI': 0.14371880199667222, 'FA': 0.05490848585690516, 'CF': 0.046935662784248475}, batch size: 64, grad_norm: 0.16856563091278076, grad_scale: , lr: 5.17e-05, 
2025-02-11 00:16:00,284 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 00:16:00,284 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 15342, num_updates: 15000, {'loss': 0.104720838367939, 'DER': 0.2398069442443452, 'ACC': np.float64(0.9554799107142857), 'MI': 0.12130816885175047, 'FA': 0.07095519377611295, 'CF': 0.04754358161648178}, batch size: 64, grad_norm: 0.16856563091278076, grad_scale: , lr: 5.17e-05, 
2025-02-11 00:16:00,285 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 00:16:51,145 (model:925) WARNING: All labels are zero
2025-02-11 00:16:51,696 (model:925) WARNING: All labels are zero
2025-02-11 00:16:51,758 (model:925) WARNING: All labels are zero
2025-02-11 00:18:24,664 (model:925) WARNING: All labels are zero
2025-02-11 00:18:36,791 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 15342,  validation: loss=0.07669, DER=0.1757, ACC=0.9646, MI=0.0903, FA=0.05637, CF=0.02899, over 0.00 frames. 
2025-02-11 00:18:36,792 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 00:18:36,873 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 15342,  validation: loss=0.07833, DER=0.1776, ACC=0.9634, MI=0.09204, FA=0.05513, CF=0.03046, over 0.00 frames. 
2025-02-11 00:18:36,873 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 00:31:09,352 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 15842, num_updates: 15500, {'loss': 0.10704169422388077, 'DER': 0.24511740179942945, 'ACC': np.float64(0.9564174107142857), 'MI': 0.13312852022529442, 'FA': 0.0714651451978641, 'CF': 0.040523736376270936}, batch size: 64, grad_norm: 0.16931301355361938, grad_scale: , lr: 4.62e-05, 
2025-02-11 00:31:09,352 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 00:31:09,353 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 15842, num_updates: 15500, {'loss': 0.09558865427970886, 'DER': 0.26579131380623106, 'ACC': np.float64(0.9563727678571429), 'MI': 0.13270142180094788, 'FA': 0.09517520006215523, 'CF': 0.037914691943127965}, batch size: 64, grad_norm: 0.16931301355361938, grad_scale: , lr: 4.62e-05, 
2025-02-11 00:31:09,353 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 00:31:59,702 (model:925) WARNING: All labels are zero
2025-02-11 00:31:59,848 (model:925) WARNING: All labels are zero
2025-02-11 00:32:00,310 (model:925) WARNING: All labels are zero
2025-02-11 00:33:32,523 (model:925) WARNING: All labels are zero
2025-02-11 00:33:44,639 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 15842,  validation: loss=0.07744, DER=0.1757, ACC=0.9648, MI=0.09146, FA=0.05698, CF=0.02721, over 0.00 frames. 
2025-02-11 00:33:44,640 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 00:33:44,903 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 15842,  validation: loss=0.07888, DER=0.1766, ACC=0.9637, MI=0.09276, FA=0.05431, CF=0.02952, over 0.00 frames. 
2025-02-11 00:33:44,903 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 00:46:27,037 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 16342, num_updates: 16000, {'loss': 0.11947968602180481, 'DER': 0.244426483464673, 'ACC': np.float64(0.9506361607142857), 'MI': 0.1495925102714353, 'FA': 0.04135515592375564, 'CF': 0.05347881726948205}, batch size: 64, grad_norm: 0.1592191606760025, grad_scale: , lr: 4.06e-05, 
2025-02-11 00:46:27,038 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 00:46:27,039 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 16342, num_updates: 16000, {'loss': 0.10639102011919022, 'DER': 0.24187698911997632, 'ACC': np.float64(0.9558482142857143), 'MI': 0.13714750943675524, 'FA': 0.05380800828954185, 'CF': 0.050921471393679224}, batch size: 64, grad_norm: 0.1592191606760025, grad_scale: , lr: 4.06e-05, 
2025-02-11 00:46:27,039 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 00:47:16,379 (model:925) WARNING: All labels are zero
2025-02-11 00:47:16,752 (model:925) WARNING: All labels are zero
2025-02-11 00:47:16,961 (model:925) WARNING: All labels are zero
2025-02-11 00:48:46,605 (model:925) WARNING: All labels are zero
2025-02-11 00:48:58,519 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 16342,  validation: loss=0.07456, DER=0.1726, ACC=0.9652, MI=0.09412, FA=0.05117, CF=0.02732, over 0.00 frames. 
2025-02-11 00:48:58,520 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 00:49:00,622 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 16342,  validation: loss=0.07618, DER=0.1729, ACC=0.9643, MI=0.09531, FA=0.04876, CF=0.02888, over 0.00 frames. 
2025-02-11 00:49:00,622 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 00:51:47,148 (train_accelerate_ddp:713) INFO: end of epoch 4, batch_idx: 4113 batch_idx_train: 16455, {'loss': 0.10953649878501892, 'DER': 0.26983655274888557, 'ACC': np.float64(0.9517857142857143), 'MI': 0.17652303120356613, 'FA': 0.04219910846953938, 'CF': 0.05111441307578009}, batch size: 64, grad_norm: 0.18554744124412537, grad_scale: , lr: 3.94e-05, 
2025-02-11 00:51:47,149 (train_accelerate_ddp:713) INFO: end of epoch 4, batch_idx: 4113 batch_idx_train: 16455, {'loss': 0.11180341243743896, 'DER': 0.2753433616742969, 'ACC': np.float64(0.9482142857142857), 'MI': 0.15158782065256884, 'FA': 0.06191410507957271, 'CF': 0.06184143594215537}, batch size: 64, grad_norm: 0.18554744124412537, grad_scale: , lr: 3.94e-05, 
2025-02-11 00:51:47,150 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-4.pt
2025-02-11 00:51:47,485 (train_accelerate_ddp:561) INFO:  end of epoch 4, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-4.pt 
2025-02-11 00:51:50,280 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 16456, num_updates: 16000, {'loss': 0.10184343159198761, 'DER': 0.25442086648983203, 'ACC': np.float64(0.9543303571428571), 'MI': 0.13807839669908636, 'FA': 0.06926024167403477, 'CF': 0.047082228116710874}, batch size: 64, grad_norm: 0.12275785207748413, grad_scale: , lr: 3.94e-05, 
2025-02-11 00:51:50,282 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 16456, num_updates: 16000, {'loss': 0.09257842600345612, 'DER': 0.20756370008030955, 'ACC': np.float64(0.9628683035714286), 'MI': 0.11206833613199971, 'FA': 0.06015915893991385, 'CF': 0.035336205008396}, batch size: 64, grad_norm: 0.12275785207748413, grad_scale: , lr: 3.94e-05, 
2025-02-11 00:52:52,796 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-16500.pt
2025-02-11 00:52:53,229 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-11 00:52:53,232 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-11 01:04:00,023 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 16956, num_updates: 16500, {'loss': 0.11016184836626053, 'DER': 0.24541017894492215, 'ACC': np.float64(0.954486607142857), 'MI': 0.1116275466728639, 'FA': 0.06328917809280347, 'CF': 0.07049345417925479}, batch size: 64, grad_norm: 0.2311488837003708, grad_scale: , lr: 3.38e-05, 
2025-02-11 01:04:00,023 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 01:04:00,024 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 16956, num_updates: 16500, {'loss': 0.1273977905511856, 'DER': 0.30253164556962026, 'ACC': np.float64(0.9412702153687305), 'MI': 0.16969057665260198, 'FA': 0.06736990154711674, 'CF': 0.06547116736990155}, batch size: 64, grad_norm: 0.2311488837003708, grad_scale: , lr: 3.38e-05, 
2025-02-11 01:04:00,024 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 01:04:49,278 (model:925) WARNING: All labels are zero
2025-02-11 01:04:49,445 (model:925) WARNING: All labels are zero
2025-02-11 01:04:49,872 (model:925) WARNING: All labels are zero
2025-02-11 01:06:20,010 (model:925) WARNING: All labels are zero
2025-02-11 01:06:31,822 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 16956,  validation: loss=0.07201, DER=0.1663, ACC=0.9665, MI=0.09222, FA=0.04929, CF=0.02477, over 0.00 frames. 
2025-02-11 01:06:31,822 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 01:06:33,103 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 16956,  validation: loss=0.07372, DER=0.1686, ACC=0.9653, MI=0.0943, FA=0.04728, CF=0.02704, over 0.00 frames. 
2025-02-11 01:06:33,103 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 01:18:45,452 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 17456, num_updates: 17000, {'loss': 0.10866890102624893, 'DER': 0.26689306258229956, 'ACC': np.float64(0.9499665178571429), 'MI': 0.1591932912883776, 'FA': 0.06389909210617506, 'CF': 0.043800679187746897}, batch size: 64, grad_norm: 0.14578230679035187, grad_scale: , lr: 2.83e-05, 
2025-02-11 01:18:45,452 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 01:18:45,453 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 17456, num_updates: 17000, {'loss': 0.0875832661986351, 'DER': 0.2071044602644196, 'ACC': np.float64(0.9626674107142857), 'MI': 0.10845561528403312, 'FA': 0.06276332994333866, 'CF': 0.0358855150370478}, batch size: 64, grad_norm: 0.14578230679035187, grad_scale: , lr: 2.83e-05, 
2025-02-11 01:18:45,453 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 01:19:34,725 (model:925) WARNING: All labels are zero
2025-02-11 01:19:34,826 (model:925) WARNING: All labels are zero
2025-02-11 01:19:35,314 (model:925) WARNING: All labels are zero
2025-02-11 01:21:04,202 (model:925) WARNING: All labels are zero
2025-02-11 01:21:16,150 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 17456,  validation: loss=0.07564, DER=0.1757, ACC=0.9645, MI=0.09625, FA=0.05092, CF=0.02855, over 0.00 frames. 
2025-02-11 01:21:16,150 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 01:21:17,792 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 17456,  validation: loss=0.07715, DER=0.1755, ACC=0.9636, MI=0.09731, FA=0.04751, CF=0.03068, over 0.00 frames. 
2025-02-11 01:21:17,792 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 01:33:47,831 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 17956, num_updates: 17500, {'loss': 0.12084084749221802, 'DER': 0.27433267676424644, 'ACC': np.float64(0.9445424107142857), 'MI': 0.15581063641920803, 'FA': 0.055355566121035114, 'CF': 0.06316647422400326}, batch size: 64, grad_norm: 0.17295043170452118, grad_scale: , lr: 2.27e-05, 
2025-02-11 01:33:47,832 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 01:33:47,833 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 17956, num_updates: 17500, {'loss': 0.11466348171234131, 'DER': 0.2580197102983002, 'ACC': np.float64(0.9491183035714286), 'MI': 0.16184932865930288, 'FA': 0.05264898472121172, 'CF': 0.04352139691778557}, batch size: 64, grad_norm: 0.17295043170452118, grad_scale: , lr: 2.27e-05, 
2025-02-11 01:33:47,833 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 01:34:37,809 (model:925) WARNING: All labels are zero
2025-02-11 01:34:38,313 (model:925) WARNING: All labels are zero
2025-02-11 01:34:38,405 (model:925) WARNING: All labels are zero
2025-02-11 01:36:09,395 (model:925) WARNING: All labels are zero
2025-02-11 01:36:21,357 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 17956,  validation: loss=0.07477, DER=0.1708, ACC=0.9654, MI=0.08396, FA=0.0592, CF=0.02763, over 0.00 frames. 
2025-02-11 01:36:21,357 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 01:36:21,669 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 17956,  validation: loss=0.07562, DER=0.171, ACC=0.9646, MI=0.08583, FA=0.0562, CF=0.02893, over 0.00 frames. 
2025-02-11 01:36:21,670 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 01:37:29,247 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-18000.pt
2025-02-11 01:37:30,554 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-11 01:48:44,949 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 18456, num_updates: 18000, {'loss': 0.10668138414621353, 'DER': 0.25498485168745155, 'ACC': np.float64(0.9519754464285713), 'MI': 0.1576833650391038, 'FA': 0.049108715564010426, 'CF': 0.04819277108433735}, batch size: 64, grad_norm: 0.21963949501514435, grad_scale: , lr: 1.71e-05, 
2025-02-11 01:48:44,950 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 01:48:44,951 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 18456, num_updates: 18000, {'loss': 0.11493102461099625, 'DER': 0.26410076976906927, 'ACC': np.float64(0.950669642857143), 'MI': 0.15402379286214135, 'FA': 0.0648705388383485, 'CF': 0.04520643806857943}, batch size: 64, grad_norm: 0.21963949501514435, grad_scale: , lr: 1.71e-05, 
2025-02-11 01:48:44,951 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 01:49:34,255 (model:925) WARNING: All labels are zero
2025-02-11 01:49:34,795 (model:925) WARNING: All labels are zero
2025-02-11 01:49:34,850 (model:925) WARNING: All labels are zero
2025-02-11 01:51:05,085 (model:925) WARNING: All labels are zero
2025-02-11 01:51:16,962 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 18456,  validation: loss=0.07384, DER=0.1696, ACC=0.9656, MI=0.08399, FA=0.05785, CF=0.02774, over 0.00 frames. 
2025-02-11 01:51:16,963 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 01:51:17,085 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 18456,  validation: loss=0.07524, DER=0.1693, ACC=0.9647, MI=0.08447, FA=0.05488, CF=0.02997, over 0.00 frames. 
2025-02-11 01:51:17,085 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 02:03:09,738 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 18956, num_updates: 18500, {'loss': 0.12045911699533463, 'DER': 0.2714243279370266, 'ACC': np.float64(0.9490659857546029), 'MI': 0.12839744541809, 'FA': 0.07671171840190108, 'CF': 0.0663151641170355}, batch size: 64, grad_norm: 0.20936907827854156, grad_scale: , lr: 1.16e-05, 
2025-02-11 02:03:09,739 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 02:03:09,740 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 18956, num_updates: 18500, {'loss': 0.11489417403936386, 'DER': 0.2562386728007807, 'ACC': np.float64(0.9513058035714286), 'MI': 0.15258608671406665, 'FA': 0.055764673079604074, 'CF': 0.04788791300711}, batch size: 64, grad_norm: 0.20936907827854156, grad_scale: , lr: 1.16e-05, 
2025-02-11 02:03:09,740 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 02:03:59,280 (model:925) WARNING: All labels are zero
2025-02-11 02:03:59,860 (model:925) WARNING: All labels are zero
2025-02-11 02:03:59,865 (model:925) WARNING: All labels are zero
2025-02-11 02:05:31,265 (model:925) WARNING: All labels are zero
2025-02-11 02:05:43,187 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 18956,  validation: loss=0.07526, DER=0.1701, ACC=0.9646, MI=0.09083, FA=0.04944, CF=0.02979, over 0.00 frames. 
2025-02-11 02:05:43,187 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 02:05:43,237 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 18956,  validation: loss=0.07398, DER=0.1699, ACC=0.9654, MI=0.08977, FA=0.05197, CF=0.02816, over 0.00 frames. 
2025-02-11 02:05:43,237 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 02:17:42,444 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 19456, num_updates: 19000, {'loss': 0.08947901427745819, 'DER': 0.2382613972540393, 'ACC': np.float64(0.957620734244111), 'MI': 0.1187134946522036, 'FA': 0.07191079420465751, 'CF': 0.047637108397178184}, batch size: 64, grad_norm: 0.1545262336730957, grad_scale: , lr: 6.03e-06, 
2025-02-11 02:17:42,444 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 02:17:42,446 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 19456, num_updates: 19000, {'loss': 0.11254892498254776, 'DER': 0.24945006599208094, 'ACC': np.float64(0.9524778602737275), 'MI': 0.12707141809649508, 'FA': 0.060199442733538645, 'CF': 0.062179205162047224}, batch size: 64, grad_norm: 0.1545262336730957, grad_scale: , lr: 6.03e-06, 
2025-02-11 02:17:42,447 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 02:18:31,557 (model:925) WARNING: All labels are zero
2025-02-11 02:18:31,704 (model:925) WARNING: All labels are zero
2025-02-11 02:18:32,139 (model:925) WARNING: All labels are zero
2025-02-11 02:20:01,753 (model:925) WARNING: All labels are zero
2025-02-11 02:20:13,712 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 19456,  validation: loss=0.07354, DER=0.1686, ACC=0.9657, MI=0.08733, FA=0.05379, CF=0.02745, over 0.00 frames. 
2025-02-11 02:20:13,712 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 02:20:14,798 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 19456,  validation: loss=0.07482, DER=0.1692, ACC=0.9649, MI=0.08883, FA=0.05146, CF=0.02892, over 0.00 frames. 
2025-02-11 02:20:14,798 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 02:21:15,596 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-19500.pt
2025-02-11 02:21:16,194 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-11 02:32:50,156 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 19956, num_updates: 19500, {'loss': 0.09954830259084702, 'DER': 0.23771676300578035, 'ACC': np.float64(0.9548214285714286), 'MI': 0.11184971098265896, 'FA': 0.07109826589595376, 'CF': 0.05476878612716763}, batch size: 64, grad_norm: 0.14253808557987213, grad_scale: , lr: 4.78e-07, 
2025-02-11 02:32:50,156 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 02:32:50,158 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 19956, num_updates: 19500, {'loss': 0.08903659880161285, 'DER': 0.2080663948747816, 'ACC': np.float64(0.9611495535714286), 'MI': 0.11014851485148515, 'FA': 0.05256260920209668, 'CF': 0.045355270821199764}, batch size: 64, grad_norm: 0.14253808557987213, grad_scale: , lr: 4.78e-07, 
2025-02-11 02:32:50,158 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 02:33:40,036 (model:925) WARNING: All labels are zero
2025-02-11 02:33:40,537 (model:925) WARNING: All labels are zero
2025-02-11 02:33:40,630 (model:925) WARNING: All labels are zero
2025-02-11 02:35:11,990 (model:925) WARNING: All labels are zero
2025-02-11 02:35:24,008 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 19956,  validation: loss=0.07277, DER=0.1677, ACC=0.9661, MI=0.08794, FA=0.05335, CF=0.02644, over 0.00 frames. 
2025-02-11 02:35:24,009 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 02:35:24,134 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 19956,  validation: loss=0.07428, DER=0.1676, ACC=0.9651, MI=0.08899, FA=0.05038, CF=0.02822, over 0.00 frames. 
2025-02-11 02:35:24,135 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 02:47:30,288 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 20456, num_updates: 20000, {'loss': 0.10573149472475052, 'DER': 0.2411604714415231, 'ACC': np.float64(0.9524521430257523), 'MI': 0.134876909128949, 'FA': 0.05244438245344864, 'CF': 0.05383917985912546}, batch size: 64, grad_norm: 0.17341011762619019, grad_scale: , lr: 0.00e+00, 
2025-02-11 02:47:30,289 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 02:47:30,290 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 20456, num_updates: 20000, {'loss': 0.11163946241140366, 'DER': 0.26715359224664653, 'ACC': np.float64(0.9490178571428571), 'MI': 0.14713111875833976, 'FA': 0.06636702015590983, 'CF': 0.053655453332396935}, batch size: 64, grad_norm: 0.17341011762619019, grad_scale: , lr: 0.00e+00, 
2025-02-11 02:47:30,290 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 02:48:20,286 (model:925) WARNING: All labels are zero
2025-02-11 02:48:20,869 (model:925) WARNING: All labels are zero
2025-02-11 02:48:20,889 (model:925) WARNING: All labels are zero
2025-02-11 02:49:53,204 (model:925) WARNING: All labels are zero
2025-02-11 02:50:05,336 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 20456,  validation: loss=0.07455, DER=0.1685, ACC=0.965, MI=0.09143, FA=0.04866, CF=0.02845, over 0.00 frames. 
2025-02-11 02:50:05,336 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 02:50:05,361 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 20456,  validation: loss=0.07314, DER=0.1686, ACC=0.9659, MI=0.09053, FA=0.05141, CF=0.02667, over 0.00 frames. 
2025-02-11 02:50:05,362 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 02:52:45,232 (train_accelerate_ddp:713) INFO: end of epoch 5, batch_idx: 4113 batch_idx_train: 20569, {'loss': 0.10243218392133713, 'DER': 0.22944883030346924, 'ACC': np.float64(0.9572879464285714), 'MI': 0.11878032881871514, 'FA': 0.06293908886796552, 'CF': 0.047729412616788584}, batch size: 64, grad_norm: 0.14357131719589233, grad_scale: , lr: 0.00e+00, 
2025-02-11 02:52:45,235 (train_accelerate_ddp:713) INFO: end of epoch 5, batch_idx: 4113 batch_idx_train: 20569, {'loss': 0.10653489828109741, 'DER': 0.23114212265883216, 'ACC': np.float64(0.9582924107142857), 'MI': 0.1266984943077488, 'FA': 0.06110907087770841, 'CF': 0.04333455747337495}, batch size: 64, grad_norm: 0.14357131719589233, grad_scale: , lr: 0.00e+00, 
2025-02-11 02:52:45,235 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-5.pt
2025-02-11 02:52:45,531 (train_accelerate_ddp:561) INFO:  end of epoch 5, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-5.pt 
2025-02-11 02:52:48,149 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 20570, num_updates: 20000, {'loss': 0.08883535861968994, 'DER': 0.2114156192046157, 'ACC': np.float64(0.9603571428571429), 'MI': 0.12528332989903151, 'FA': 0.053575108180506904, 'CF': 0.03255718112507727}, batch size: 64, grad_norm: 0.13460573554039001, grad_scale: , lr: 0.00e+00, 
2025-02-11 02:52:48,151 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 20570, num_updates: 20000, {'loss': 0.07849939912557602, 'DER': 0.19560011972463334, 'ACC': np.float64(0.9650669642857143), 'MI': 0.09151451661179287, 'FA': 0.06547440885962287, 'CF': 0.0386111942532176}, batch size: 64, grad_norm: 0.13460573554039001, grad_scale: , lr: 0.00e+00, 
2025-02-11 03:03:08,792 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-21000.pt
2025-02-11 03:03:09,220 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-11 03:03:09,222 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-11 03:04:50,593 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 21070, num_updates: 20500, {'loss': 0.09163228422403336, 'DER': 0.2380097268986158, 'ACC': np.float64(0.9573995535714286), 'MI': 0.11387953610175833, 'FA': 0.07654320987654321, 'CF': 0.047586980920314256}, batch size: 64, grad_norm: 0.14640027284622192, grad_scale: , lr: 0.00e+00, 
2025-02-11 03:04:50,594 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 03:04:50,595 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 21070, num_updates: 20500, {'loss': 0.0847000703215599, 'DER': 0.1772609466648479, 'ACC': np.float64(0.9676785714285714), 'MI': 0.11601418633201473, 'FA': 0.040990315100259175, 'CF': 0.020256445232574}, batch size: 64, grad_norm: 0.14640027284622192, grad_scale: , lr: 0.00e+00, 
2025-02-11 03:04:50,595 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 03:05:40,057 (model:925) WARNING: All labels are zero
2025-02-11 03:05:40,451 (model:925) WARNING: All labels are zero
2025-02-11 03:05:40,643 (model:925) WARNING: All labels are zero
2025-02-11 03:07:11,248 (model:925) WARNING: All labels are zero
2025-02-11 03:07:23,222 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 21070,  validation: loss=0.07335, DER=0.169, ACC=0.9658, MI=0.09006, FA=0.05219, CF=0.02676, over 0.00 frames. 
2025-02-11 03:07:23,222 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 03:07:23,469 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 21070,  validation: loss=0.07473, DER=0.1695, ACC=0.9649, MI=0.09136, FA=0.04958, CF=0.02852, over 0.00 frames. 
2025-02-11 03:07:23,470 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 03:19:21,210 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 21570, num_updates: 21000, {'loss': 0.08495689928531647, 'DER': 0.20912326578048956, 'ACC': np.float64(0.9627790178571429), 'MI': 0.11832643277402484, 'FA': 0.0576741483257064, 'CF': 0.03312268468075834}, batch size: 64, grad_norm: 0.14354294538497925, grad_scale: , lr: 0.00e+00, 
2025-02-11 03:19:21,211 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 03:19:21,212 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 21570, num_updates: 21000, {'loss': 0.10228082537651062, 'DER': 0.23661634634568066, 'ACC': np.float64(0.9552120535714286), 'MI': 0.15076145507747557, 'FA': 0.055596196049743966, 'CF': 0.03025869521846113}, batch size: 64, grad_norm: 0.14354294538497925, grad_scale: , lr: 0.00e+00, 
2025-02-11 03:19:21,212 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 03:20:11,068 (model:925) WARNING: All labels are zero
2025-02-11 03:20:11,093 (model:925) WARNING: All labels are zero
2025-02-11 03:20:11,675 (model:925) WARNING: All labels are zero
2025-02-11 03:21:42,553 (model:925) WARNING: All labels are zero
2025-02-11 03:21:54,601 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 21570,  validation: loss=0.07293, DER=0.1678, ACC=0.966, MI=0.09077, FA=0.05073, CF=0.02631, over 0.00 frames. 
2025-02-11 03:21:54,602 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 03:21:55,835 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 21570,  validation: loss=0.07426, DER=0.1681, ACC=0.9651, MI=0.09229, FA=0.04783, CF=0.02795, over 0.00 frames. 
2025-02-11 03:21:55,836 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 03:34:54,054 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 22070, num_updates: 21500, {'loss': 0.11628197133541107, 'DER': 0.2650560224089636, 'ACC': np.float64(0.9481696428571429), 'MI': 0.14985994397759103, 'FA': 0.05504201680672269, 'CF': 0.06015406162464986}, batch size: 64, grad_norm: 0.16112008690834045, grad_scale: , lr: 0.00e+00, 
2025-02-11 03:34:54,055 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 03:34:54,056 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 22070, num_updates: 21500, {'loss': 0.11912328749895096, 'DER': 0.27530593478107096, 'ACC': np.float64(0.9495200892857143), 'MI': 0.16806960458371648, 'FA': 0.06260168352550045, 'CF': 0.044634646671854}, batch size: 64, grad_norm: 0.16112008690834045, grad_scale: , lr: 0.00e+00, 
2025-02-11 03:34:54,057 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 03:35:44,146 (model:925) WARNING: All labels are zero
2025-02-11 03:35:44,716 (model:925) WARNING: All labels are zero
2025-02-11 03:35:44,759 (model:925) WARNING: All labels are zero
2025-02-11 03:37:16,744 (model:925) WARNING: All labels are zero
2025-02-11 03:37:28,853 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 22070,  validation: loss=0.07328, DER=0.1685, ACC=0.9658, MI=0.08992, FA=0.05158, CF=0.02699, over 0.00 frames. 
2025-02-11 03:37:28,853 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 03:37:28,929 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 22070,  validation: loss=0.07455, DER=0.1683, ACC=0.965, MI=0.09096, FA=0.0488, CF=0.02857, over 0.00 frames. 
2025-02-11 03:37:28,929 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 03:47:43,881 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-22500.pt
2025-02-11 03:47:44,317 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-11 03:49:27,543 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 22570, num_updates: 22000, {'loss': 0.09944961220026016, 'DER': 0.2178843020097773, 'ACC': np.float64(0.9597767857142857), 'MI': 0.1484926670287887, 'FA': 0.04257197175448126, 'CF': 0.026819663226507334}, batch size: 64, grad_norm: 0.12284045666456223, grad_scale: , lr: 0.00e+00, 
2025-02-11 03:49:27,543 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 03:49:27,545 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 22570, num_updates: 22000, {'loss': 0.07845927774906158, 'DER': 0.16993855836954894, 'ACC': np.float64(0.97046875), 'MI': 0.08287127229132324, 'FA': 0.058744193016634194, 'CF': 0.02832309306159149}, batch size: 64, grad_norm: 0.12284045666456223, grad_scale: , lr: 0.00e+00, 
2025-02-11 03:49:27,545 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 03:50:17,112 (model:925) WARNING: All labels are zero
2025-02-11 03:50:17,477 (model:925) WARNING: All labels are zero
2025-02-11 03:50:17,693 (model:925) WARNING: All labels are zero
2025-02-11 03:51:46,199 (model:925) WARNING: All labels are zero
2025-02-11 03:51:57,969 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 22570,  validation: loss=0.07305, DER=0.168, ACC=0.9659, MI=0.08936, FA=0.05149, CF=0.02712, over 0.00 frames. 
2025-02-11 03:51:57,970 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 03:51:59,708 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 22570,  validation: loss=0.0743, DER=0.1678, ACC=0.965, MI=0.09061, FA=0.04843, CF=0.02873, over 0.00 frames. 
2025-02-11 03:51:59,708 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 04:03:49,097 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 23070, num_updates: 22500, {'loss': 0.10234473645687103, 'DER': 0.21380920613742496, 'ACC': np.float64(0.9584486607142857), 'MI': 0.12615076717811874, 'FA': 0.053102068045363576, 'CF': 0.034556370913942626}, batch size: 64, grad_norm: 0.13814030587673187, grad_scale: , lr: 0.00e+00, 
2025-02-11 04:03:49,097 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 04:03:49,099 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 23070, num_updates: 22500, {'loss': 0.09314730018377304, 'DER': 0.20498225406817117, 'ACC': np.float64(0.961997767857143), 'MI': 0.14759258019152213, 'FA': 0.03435344538940601, 'CF': 0.02303622848724302}, batch size: 64, grad_norm: 0.13814030587673187, grad_scale: , lr: 0.00e+00, 
2025-02-11 04:03:49,099 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 04:04:37,030 (model:925) WARNING: All labels are zero
2025-02-11 04:04:37,164 (model:925) WARNING: All labels are zero
2025-02-11 04:04:37,598 (model:925) WARNING: All labels are zero
2025-02-11 04:06:05,194 (model:925) WARNING: All labels are zero
2025-02-11 04:06:17,428 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 23070,  validation: loss=0.07364, DER=0.1694, ACC=0.9656, MI=0.09044, FA=0.05144, CF=0.02749, over 0.00 frames. 
2025-02-11 04:06:17,428 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 04:06:18,914 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 23070,  validation: loss=0.075, DER=0.1696, ACC=0.9647, MI=0.09189, FA=0.04868, CF=0.02904, over 0.00 frames. 
2025-02-11 04:06:18,915 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 04:18:18,507 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 23570, num_updates: 23000, {'loss': 0.09042296558618546, 'DER': 0.20403885123331703, 'ACC': np.float64(0.9633370535714286), 'MI': 0.13367339808538886, 'FA': 0.04486059674376354, 'CF': 0.025504856404164628}, batch size: 64, grad_norm: 0.1842603087425232, grad_scale: , lr: 0.00e+00, 
2025-02-11 04:18:18,508 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 04:18:18,510 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 23570, num_updates: 23000, {'loss': 0.10412391275167465, 'DER': 0.24035112163856764, 'ACC': np.float64(0.9559933035714286), 'MI': 0.15180437508708375, 'FA': 0.054200919604291485, 'CF': 0.03434582694719242}, batch size: 64, grad_norm: 0.1842603087425232, grad_scale: , lr: 0.00e+00, 
2025-02-11 04:18:18,510 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 04:19:07,640 (model:925) WARNING: All labels are zero
2025-02-11 04:19:08,222 (model:925) WARNING: All labels are zero
2025-02-11 04:19:08,662 (model:925) WARNING: All labels are zero
2025-02-11 04:20:37,832 (model:925) WARNING: All labels are zero
2025-02-11 04:20:52,754 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 23570,  validation: loss=0.07467, DER=0.1684, ACC=0.9649, MI=0.08944, FA=0.05029, CF=0.02872, over 0.00 frames. 
2025-02-11 04:20:52,755 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 04:20:52,790 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 23570,  validation: loss=0.07317, DER=0.1682, ACC=0.9659, MI=0.08818, FA=0.05301, CF=0.02699, over 0.00 frames. 
2025-02-11 04:20:52,790 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 04:32:17,408 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-24000.pt
2025-02-11 04:32:18,516 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-11 04:34:01,396 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 24070, num_updates: 23500, {'loss': 0.10171091556549072, 'DER': 0.2554844606946984, 'ACC': np.float64(0.9561495535714286), 'MI': 0.11418342474101158, 'FA': 0.09750152346130408, 'CF': 0.043799512492382696}, batch size: 64, grad_norm: 0.15368181467056274, grad_scale: , lr: 0.00e+00, 
2025-02-11 04:34:01,397 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 04:34:02,202 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 24070, num_updates: 23500, {'loss': 0.07707291096448898, 'DER': 0.16810089020771513, 'ACC': np.float64(0.9720982142857143), 'MI': 0.09859050445103858, 'FA': 0.0521513353115727, 'CF': 0.017359050445103857}, batch size: 64, grad_norm: 0.15368181467056274, grad_scale: , lr: 0.00e+00, 
2025-02-11 04:34:02,203 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 04:34:50,491 (model:925) WARNING: All labels are zero
2025-02-11 04:34:50,541 (model:925) WARNING: All labels are zero
2025-02-11 04:34:51,117 (model:925) WARNING: All labels are zero
2025-02-11 04:36:18,738 (model:925) WARNING: All labels are zero
2025-02-11 04:36:30,321 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 24070,  validation: loss=0.07315, DER=0.1682, ACC=0.9659, MI=0.08712, FA=0.05399, CF=0.02708, over 0.00 frames. 
2025-02-11 04:36:30,321 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 04:36:31,841 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 24070,  validation: loss=0.07449, DER=0.1679, ACC=0.965, MI=0.08815, FA=0.05102, CF=0.02871, over 0.00 frames. 
2025-02-11 04:36:31,841 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 04:48:22,169 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 24570, num_updates: 24000, {'loss': 0.10510273277759552, 'DER': 0.24438832772166105, 'ACC': np.float64(0.9560044642857143), 'MI': 0.16091470258136925, 'FA': 0.05134680134680135, 'CF': 0.03212682379349046}, batch size: 64, grad_norm: 0.15689916908740997, grad_scale: , lr: 0.00e+00, 
2025-02-11 04:48:22,170 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 04:48:22,171 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 24570, num_updates: 24000, {'loss': 0.12599019706249237, 'DER': 0.28646306520371795, 'ACC': np.float64(0.9461049107142857), 'MI': 0.1728282898874834, 'FA': 0.06261793276958558, 'CF': 0.05101684254664896}, batch size: 64, grad_norm: 0.15689916908740997, grad_scale: , lr: 0.00e+00, 
2025-02-11 04:48:22,171 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 04:49:11,004 (model:925) WARNING: All labels are zero
2025-02-11 04:49:11,457 (model:925) WARNING: All labels are zero
2025-02-11 04:49:11,574 (model:925) WARNING: All labels are zero
2025-02-11 04:50:39,090 (model:925) WARNING: All labels are zero
2025-02-11 04:50:50,667 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 24570,  validation: loss=0.07293, DER=0.1677, ACC=0.9659, MI=0.0883, FA=0.05259, CF=0.02681, over 0.00 frames. 
2025-02-11 04:50:50,668 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 04:50:52,137 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 24570,  validation: loss=0.0745, DER=0.1682, ACC=0.965, MI=0.08951, FA=0.04983, CF=0.02881, over 0.00 frames. 
2025-02-11 04:50:52,137 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 04:53:31,657 (train_accelerate_ddp:713) INFO: end of epoch 6, batch_idx: 4113 batch_idx_train: 24683, {'loss': 0.08004499971866608, 'DER': 0.18065014393035175, 'ACC': np.float64(0.9666964285714286), 'MI': 0.10117250579231904, 'FA': 0.0506213578600014, 'CF': 0.028856280278031315}, batch size: 64, grad_norm: 0.1296813040971756, grad_scale: , lr: 0.00e+00, 
2025-02-11 04:53:31,659 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-6.pt
2025-02-11 04:53:31,659 (train_accelerate_ddp:713) INFO: end of epoch 6, batch_idx: 4113 batch_idx_train: 24683, {'loss': 0.07894855737686157, 'DER': 0.1940113652921463, 'ACC': np.float64(0.9644308035714286), 'MI': 0.10593035115838555, 'FA': 0.049905289232114236, 'CF': 0.03817572490164651}, batch size: 64, grad_norm: 0.1296813040971756, grad_scale: , lr: 0.00e+00, 
2025-02-11 04:53:31,959 (train_accelerate_ddp:561) INFO:  end of epoch 6, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-6.pt 
2025-02-11 04:53:34,395 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 24684, num_updates: 24000, {'loss': 0.10002753138542175, 'DER': 0.2510347999386785, 'ACC': np.float64(0.95796875), 'MI': 0.1418059175226123, 'FA': 0.07159282538709183, 'CF': 0.0376360570289744}, batch size: 64, grad_norm: 0.16594667732715607, grad_scale: , lr: 0.00e+00, 
2025-02-11 04:53:34,396 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 24684, num_updates: 24000, {'loss': 0.09211214631795883, 'DER': 0.19639776412945967, 'ACC': np.float64(0.9622879464285714), 'MI': 0.110413360016562, 'FA': 0.04920295355738044, 'CF': 0.036781450555517216}, batch size: 64, grad_norm: 0.16594667732715607, grad_scale: , lr: 0.00e+00, 
2025-02-11 05:05:31,275 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 25184, num_updates: 24500, {'loss': 0.09018725901842117, 'DER': 0.19229932564716118, 'ACC': np.float64(0.9668080357142856), 'MI': 0.11848306866797187, 'FA': 0.05046769632368936, 'CF': 0.023348560655499964}, batch size: 64, grad_norm: 0.16415756940841675, grad_scale: , lr: 0.00e+00, 
2025-02-11 05:05:31,275 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 05:05:31,277 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 25184, num_updates: 24500, {'loss': 0.1065673902630806, 'DER': 0.25616767338621643, 'ACC': np.float64(0.9489285714285713), 'MI': 0.12146132013681682, 'FA': 0.057856051233534676, 'CF': 0.07685030201586493}, batch size: 64, grad_norm: 0.16415756940841675, grad_scale: , lr: 0.00e+00, 
2025-02-11 05:05:31,277 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 05:06:19,689 (model:925) WARNING: All labels are zero
2025-02-11 05:06:19,843 (model:925) WARNING: All labels are zero
2025-02-11 05:06:20,273 (model:925) WARNING: All labels are zero
2025-02-11 05:07:48,361 (model:925) WARNING: All labels are zero
2025-02-11 05:08:00,064 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 25184,  validation: loss=0.07301, DER=0.1676, ACC=0.966, MI=0.08925, FA=0.05151, CF=0.02682, over 0.00 frames. 
2025-02-11 05:08:00,065 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 05:08:01,651 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 25184,  validation: loss=0.07448, DER=0.1681, ACC=0.965, MI=0.09068, FA=0.04882, CF=0.02863, over 0.00 frames. 
2025-02-11 05:08:01,651 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 05:15:27,180 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-25500.pt
2025-02-11 05:15:27,599 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-11 05:15:27,618 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-11 05:19:53,222 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 25684, num_updates: 25000, {'loss': 0.09995235502719879, 'DER': 0.24342572850035538, 'ACC': np.float64(0.9570982142857143), 'MI': 0.1415778251599147, 'FA': 0.07206823027718551, 'CF': 0.029779673063255154}, batch size: 64, grad_norm: 0.1822545975446701, grad_scale: , lr: 0.00e+00, 
2025-02-11 05:19:53,222 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 05:19:53,224 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 25684, num_updates: 25000, {'loss': 0.1292664259672165, 'DER': 0.2721359630717583, 'ACC': np.float64(0.9452008928571429), 'MI': 0.1399496433067562, 'FA': 0.06091761085466499, 'CF': 0.07126870891033711}, batch size: 64, grad_norm: 0.1822545975446701, grad_scale: , lr: 0.00e+00, 
2025-02-11 05:19:53,224 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 05:20:41,610 (model:925) WARNING: All labels are zero
2025-02-11 05:20:44,432 (model:925) WARNING: All labels are zero
2025-02-11 05:20:45,051 (model:925) WARNING: All labels are zero
2025-02-11 05:22:13,509 (model:925) WARNING: All labels are zero
2025-02-11 05:22:25,401 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 25684,  validation: loss=0.073, DER=0.1682, ACC=0.9659, MI=0.08894, FA=0.05267, CF=0.02654, over 0.00 frames. 
2025-02-11 05:22:25,402 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 05:22:34,487 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 25684,  validation: loss=0.07441, DER=0.1682, ACC=0.965, MI=0.08978, FA=0.0501, CF=0.0283, over 0.00 frames. 
2025-02-11 05:22:34,487 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 05:35:33,497 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 26184, num_updates: 25500, {'loss': 0.09700366854667664, 'DER': 0.20485458781092658, 'ACC': np.float64(0.9624776785714286), 'MI': 0.11009243255429473, 'FA': 0.046967761328624034, 'CF': 0.047794393928007814}, batch size: 64, grad_norm: 0.21268562972545624, grad_scale: , lr: 0.00e+00, 
2025-02-11 05:35:33,498 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 05:35:33,500 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 26184, num_updates: 25500, {'loss': 0.10082769393920898, 'DER': 0.23241118902673963, 'ACC': np.float64(0.9587946428571429), 'MI': 0.11119673268089697, 'FA': 0.06912229328812515, 'CF': 0.0520921630577175}, batch size: 64, grad_norm: 0.21268562972545624, grad_scale: , lr: 0.00e+00, 
2025-02-11 05:35:33,500 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 05:36:22,043 (model:925) WARNING: All labels are zero
2025-02-11 05:36:22,347 (model:925) WARNING: All labels are zero
2025-02-11 05:36:22,924 (model:925) WARNING: All labels are zero
2025-02-11 05:37:51,568 (model:925) WARNING: All labels are zero
2025-02-11 05:38:03,453 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 26184,  validation: loss=0.07357, DER=0.169, ACC=0.9657, MI=0.08994, FA=0.0519, CF=0.02721, over 0.00 frames. 
2025-02-11 05:38:03,453 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 05:38:05,902 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 26184,  validation: loss=0.07491, DER=0.1693, ACC=0.9648, MI=0.09105, FA=0.04923, CF=0.02905, over 0.00 frames. 
2025-02-11 05:38:05,902 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 05:50:01,151 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 26684, num_updates: 26000, {'loss': 0.10025140643119812, 'DER': 0.23987604760898654, 'ACC': np.float64(0.9571428571428571), 'MI': 0.1628283681949433, 'FA': 0.046482146630044366, 'CF': 0.030565532783998872}, batch size: 64, grad_norm: 0.196351557970047, grad_scale: , lr: 0.00e+00, 
2025-02-11 05:50:01,151 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 05:50:01,153 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 26684, num_updates: 26000, {'loss': 0.12542247772216797, 'DER': 0.30780593997823047, 'ACC': np.float64(0.9447767857142857), 'MI': 0.15573005753382055, 'FA': 0.07518270875447053, 'CF': 0.07689317368993935}, batch size: 64, grad_norm: 0.196351557970047, grad_scale: , lr: 0.00e+00, 
2025-02-11 05:50:01,153 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 05:50:49,049 (model:925) WARNING: All labels are zero
2025-02-11 05:50:49,344 (model:925) WARNING: All labels are zero
2025-02-11 05:50:49,915 (model:925) WARNING: All labels are zero
2025-02-11 05:52:17,564 (model:925) WARNING: All labels are zero
2025-02-11 05:52:29,454 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 26684,  validation: loss=0.07343, DER=0.1685, ACC=0.9659, MI=0.08933, FA=0.05267, CF=0.02648, over 0.00 frames. 
2025-02-11 05:52:29,455 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 05:52:31,774 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 26684,  validation: loss=0.07483, DER=0.1689, ACC=0.965, MI=0.09048, FA=0.05018, CF=0.02819, over 0.00 frames. 
2025-02-11 05:52:31,774 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 05:59:56,647 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-27000.pt
2025-02-11 05:59:57,045 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-11 06:04:22,771 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 27184, num_updates: 26500, {'loss': 0.09618658572435379, 'DER': 0.23521653110573754, 'ACC': np.float64(0.958359375), 'MI': 0.13446178647321755, 'FA': 0.06257785593903421, 'CF': 0.03817688869348575}, batch size: 64, grad_norm: 0.17365922033786774, grad_scale: , lr: 0.00e+00, 
2025-02-11 06:04:22,771 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 06:04:22,773 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 27184, num_updates: 26500, {'loss': 0.10118812322616577, 'DER': 0.2403583950136346, 'ACC': np.float64(0.9569419642857143), 'MI': 0.12162056875730425, 'FA': 0.05851188157382158, 'CF': 0.06022594468250877}, batch size: 64, grad_norm: 0.17365922033786774, grad_scale: , lr: 0.00e+00, 
2025-02-11 06:04:22,773 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 06:05:11,866 (model:925) WARNING: All labels are zero
2025-02-11 06:05:12,310 (model:925) WARNING: All labels are zero
2025-02-11 06:05:12,449 (model:925) WARNING: All labels are zero
2025-02-11 06:06:44,000 (model:925) WARNING: All labels are zero
2025-02-11 06:06:56,239 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 27184,  validation: loss=0.07347, DER=0.1691, ACC=0.9657, MI=0.08717, FA=0.05453, CF=0.02741, over 0.00 frames. 
2025-02-11 06:06:56,239 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 06:06:56,886 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 27184,  validation: loss=0.0748, DER=0.1693, ACC=0.9648, MI=0.08841, FA=0.05196, CF=0.02896, over 0.00 frames. 
2025-02-11 06:06:56,887 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 06:18:45,641 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 27684, num_updates: 27000, {'loss': 0.08815181255340576, 'DER': 0.1995368024896866, 'ACC': np.float64(0.9622209821428571), 'MI': 0.09271187667366287, 'FA': 0.06137367011652312, 'CF': 0.04545125569950061}, batch size: 64, grad_norm: 0.1660180240869522, grad_scale: , lr: 0.00e+00, 
2025-02-11 06:18:45,642 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 06:18:45,644 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 27684, num_updates: 27000, {'loss': 0.11669835448265076, 'DER': 0.2676308539944904, 'ACC': np.float64(0.946484375), 'MI': 0.14552341597796142, 'FA': 0.05950413223140496, 'CF': 0.06260330578512396}, batch size: 64, grad_norm: 0.1660180240869522, grad_scale: , lr: 0.00e+00, 
2025-02-11 06:18:45,644 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 06:19:33,786 (model:925) WARNING: All labels are zero
2025-02-11 06:19:34,102 (model:925) WARNING: All labels are zero
2025-02-11 06:19:34,357 (model:925) WARNING: All labels are zero
2025-02-11 06:21:06,735 (model:925) WARNING: All labels are zero
2025-02-11 06:21:18,978 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 27684,  validation: loss=0.07283, DER=0.1675, ACC=0.9661, MI=0.08784, FA=0.05323, CF=0.02641, over 0.00 frames. 
2025-02-11 06:21:18,978 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 06:21:19,513 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 27684,  validation: loss=0.07429, DER=0.1676, ACC=0.9652, MI=0.08905, FA=0.05044, CF=0.02808, over 0.00 frames. 
2025-02-11 06:21:19,513 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 06:34:18,798 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 28184, num_updates: 27500, {'loss': 0.0986202210187912, 'DER': 0.25767477203647415, 'ACC': np.float64(0.9547095577140174), 'MI': 0.15478723404255318, 'FA': 0.052659574468085106, 'CF': 0.05022796352583587}, batch size: 64, grad_norm: 0.19038188457489014, grad_scale: , lr: 0.00e+00, 
2025-02-11 06:34:18,798 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 06:34:18,800 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 28184, num_updates: 27500, {'loss': 0.11319645494222641, 'DER': 0.2577194752774975, 'ACC': np.float64(0.9473772321428571), 'MI': 0.14618230743356878, 'FA': 0.0520686175580222, 'CF': 0.059468550285906495}, batch size: 64, grad_norm: 0.19038188457489014, grad_scale: , lr: 0.00e+00, 
2025-02-11 06:34:18,800 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 06:35:07,226 (model:925) WARNING: All labels are zero
2025-02-11 06:35:07,296 (model:925) WARNING: All labels are zero
2025-02-11 06:35:07,797 (model:925) WARNING: All labels are zero
2025-02-11 06:36:36,974 (model:925) WARNING: All labels are zero
2025-02-11 06:36:48,821 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 28184,  validation: loss=0.07329, DER=0.1684, ACC=0.9659, MI=0.08977, FA=0.05208, CF=0.02659, over 0.00 frames. 
2025-02-11 06:36:48,821 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 06:36:49,640 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 28184,  validation: loss=0.07463, DER=0.1692, ACC=0.9649, MI=0.09119, FA=0.04954, CF=0.02846, over 0.00 frames. 
2025-02-11 06:36:49,641 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 06:44:19,220 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-28500.pt
2025-02-11 06:44:19,612 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-11 06:48:43,346 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 28684, num_updates: 28000, {'loss': 0.10630745440721512, 'DER': 0.24107075719978946, 'ACC': np.float64(0.9563950892857143), 'MI': 0.1226408000601549, 'FA': 0.06571922700954959, 'CF': 0.05271073013008497}, batch size: 64, grad_norm: 0.16636015474796295, grad_scale: , lr: 0.00e+00, 
2025-02-11 06:48:43,347 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 06:48:43,349 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 28684, num_updates: 28000, {'loss': 0.09122269600629807, 'DER': 0.2258963834895067, 'ACC': np.float64(0.9604129464285713), 'MI': 0.11314179509021915, 'FA': 0.0639665453419035, 'CF': 0.04878804305738403}, batch size: 64, grad_norm: 0.16636015474796295, grad_scale: , lr: 0.00e+00, 
2025-02-11 06:48:43,349 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 06:49:31,783 (model:925) WARNING: All labels are zero
2025-02-11 06:49:32,029 (model:925) WARNING: All labels are zero
2025-02-11 06:49:32,601 (model:925) WARNING: All labels are zero
2025-02-11 06:51:01,038 (model:925) WARNING: All labels are zero
2025-02-11 06:51:13,191 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 28684,  validation: loss=0.0737, DER=0.1689, ACC=0.9657, MI=0.08724, FA=0.05408, CF=0.02759, over 0.00 frames. 
2025-02-11 06:51:13,191 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 06:51:15,418 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 28684,  validation: loss=0.07496, DER=0.1691, ACC=0.9648, MI=0.08845, FA=0.05157, CF=0.02904, over 0.00 frames. 
2025-02-11 06:51:15,418 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 06:53:54,925 (train_accelerate_ddp:713) INFO: end of epoch 7, batch_idx: 4113 batch_idx_train: 28797, {'loss': 0.11376389861106873, 'DER': 0.2437316951210801, 'ACC': np.float64(0.9526339285714286), 'MI': 0.12072290877919852, 'FA': 0.06357596971212229, 'CF': 0.05943281662975927}, batch size: 64, grad_norm: 0.23966239392757416, grad_scale: , lr: 0.00e+00, 
2025-02-11 06:53:54,927 (train_accelerate_ddp:713) INFO: end of epoch 7, batch_idx: 4113 batch_idx_train: 28797, {'loss': 0.1466570794582367, 'DER': 0.3334049255441008, 'ACC': np.float64(0.9371763392857143), 'MI': 0.20661512027491408, 'FA': 0.05720217640320733, 'CF': 0.06958762886597938}, batch size: 64, grad_norm: 0.23966239392757416, grad_scale: , lr: 0.00e+00, 
2025-02-11 06:53:54,928 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-7.pt
2025-02-11 06:53:55,247 (train_accelerate_ddp:561) INFO:  end of epoch 7, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-7.pt 
2025-02-11 06:53:58,005 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 28798, num_updates: 28000, {'loss': 0.1064179539680481, 'DER': 0.27573092464939386, 'ACC': np.float64(0.9499665178571429), 'MI': 0.12241502258141193, 'FA': 0.07384517867046986, 'CF': 0.07947072339751209}, batch size: 64, grad_norm: 0.2217276245355606, grad_scale: , lr: 0.00e+00, 
2025-02-11 06:53:58,008 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 28798, num_updates: 28000, {'loss': 0.10619043558835983, 'DER': 0.23649974562104803, 'ACC': np.float64(0.9567075892857143), 'MI': 0.12936986699614797, 'FA': 0.061705065775129006, 'CF': 0.04542481284977106}, batch size: 64, grad_norm: 0.2217276245355606, grad_scale: , lr: 0.00e+00, 
2025-02-11 07:05:49,251 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 29298, num_updates: 28500, {'loss': 0.0976620689034462, 'DER': 0.21308358566298147, 'ACC': np.float64(0.9607779360468376), 'MI': 0.13287796634039856, 'FA': 0.04703894091965354, 'CF': 0.03316667840292937}, batch size: 64, grad_norm: 0.20025871694087982, grad_scale: , lr: 0.00e+00, 
2025-02-11 07:05:49,252 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 07:05:49,253 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 29298, num_updates: 28500, {'loss': 0.10880228132009506, 'DER': 0.217774438144682, 'ACC': np.float64(0.9571428571428571), 'MI': 0.12494022815766104, 'FA': 0.04829564860987772, 'CF': 0.044538561377143245}, batch size: 64, grad_norm: 0.20025871694087982, grad_scale: , lr: 0.00e+00, 
2025-02-11 07:05:49,254 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 07:06:38,623 (model:925) WARNING: All labels are zero
2025-02-11 07:06:39,154 (model:925) WARNING: All labels are zero
2025-02-11 07:06:39,211 (model:925) WARNING: All labels are zero
2025-02-11 07:08:09,830 (model:925) WARNING: All labels are zero
2025-02-11 07:08:21,901 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 29298,  validation: loss=0.07295, DER=0.1681, ACC=0.9659, MI=0.08966, FA=0.05161, CF=0.0268, over 0.00 frames. 
2025-02-11 07:08:21,901 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 07:08:22,066 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 29298,  validation: loss=0.07433, DER=0.1681, ACC=0.965, MI=0.0908, FA=0.0488, CF=0.02846, over 0.00 frames. 
2025-02-11 07:08:22,067 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 07:20:33,600 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 29798, num_updates: 29000, {'loss': 0.12124078720808029, 'DER': 0.2802061855670103, 'ACC': np.float64(0.9428683035714286), 'MI': 0.15168384879725086, 'FA': 0.05690721649484536, 'CF': 0.0716151202749141}, batch size: 64, grad_norm: 0.25513941049575806, grad_scale: , lr: 0.00e+00, 
2025-02-11 07:20:33,601 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 07:20:33,601 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 29798, num_updates: 29000, {'loss': 0.12483630329370499, 'DER': 0.29880478087649404, 'ACC': np.float64(0.9437388392857143), 'MI': 0.16544730170228178, 'FA': 0.06700470843897138, 'CF': 0.06635277073524086}, batch size: 64, grad_norm: 0.25513941049575806, grad_scale: , lr: 0.00e+00, 
2025-02-11 07:20:33,601 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 07:21:22,151 (model:925) WARNING: All labels are zero
2025-02-11 07:21:22,477 (model:925) WARNING: All labels are zero
2025-02-11 07:21:23,056 (model:925) WARNING: All labels are zero
2025-02-11 07:22:50,784 (model:925) WARNING: All labels are zero
2025-02-11 07:23:02,468 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 29798,  validation: loss=0.07301, DER=0.1681, ACC=0.9659, MI=0.08863, FA=0.0524, CF=0.02709, over 0.00 frames. 
2025-02-11 07:23:02,468 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 07:23:04,755 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 29798,  validation: loss=0.07435, DER=0.1679, ACC=0.965, MI=0.08976, FA=0.04961, CF=0.02852, over 0.00 frames. 
2025-02-11 07:23:04,755 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 07:28:12,144 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-30000.pt
2025-02-11 07:28:12,563 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-11 07:28:12,565 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-11 07:35:14,200 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 30298, num_updates: 29500, {'loss': 0.09837261587381363, 'DER': 0.23395996651191112, 'ACC': np.float64(0.9602582930684634), 'MI': 0.13806225740162875, 'FA': 0.060050232133343484, 'CF': 0.03584747697693889}, batch size: 64, grad_norm: 0.15236875414848328, grad_scale: , lr: 0.00e+00, 
2025-02-11 07:35:14,200 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 07:35:14,202 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 30298, num_updates: 29500, {'loss': 0.10349614918231964, 'DER': 0.23591599262097346, 'ACC': np.float64(0.954140625), 'MI': 0.12572725982687669, 'FA': 0.054562225060309354, 'CF': 0.055626507733787425}, batch size: 64, grad_norm: 0.15236875414848328, grad_scale: , lr: 0.00e+00, 
2025-02-11 07:35:14,202 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 07:36:03,146 (model:925) WARNING: All labels are zero
2025-02-11 07:36:03,730 (model:925) WARNING: All labels are zero
2025-02-11 07:36:03,736 (model:925) WARNING: All labels are zero
2025-02-11 07:37:33,532 (model:925) WARNING: All labels are zero
2025-02-11 07:37:45,318 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 30298,  validation: loss=0.07333, DER=0.1687, ACC=0.9658, MI=0.08879, FA=0.05291, CF=0.02698, over 0.00 frames. 
2025-02-11 07:37:45,318 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 07:37:45,405 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 30298,  validation: loss=0.07466, DER=0.169, ACC=0.9649, MI=0.09027, FA=0.05021, CF=0.0285, over 0.00 frames. 
2025-02-11 07:37:45,405 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 07:49:32,623 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 30798, num_updates: 30000, {'loss': 0.11363700032234192, 'DER': 0.232507927940085, 'ACC': np.float64(0.9521763392857143), 'MI': 0.1308953511908778, 'FA': 0.045003710950678094, 'CF': 0.05660886579852911}, batch size: 64, grad_norm: 0.26417192816734314, grad_scale: , lr: 0.00e+00, 
2025-02-11 07:49:32,624 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 07:49:32,625 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 30798, num_updates: 30000, {'loss': 0.08712722361087799, 'DER': 0.23034547886991422, 'ACC': np.float64(0.96234375), 'MI': 0.09199653734162273, 'FA': 0.10317148028645629, 'CF': 0.03517746124183521}, batch size: 64, grad_norm: 0.26417192816734314, grad_scale: , lr: 0.00e+00, 
2025-02-11 07:49:32,625 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 07:50:22,011 (model:925) WARNING: All labels are zero
2025-02-11 07:50:22,437 (model:925) WARNING: All labels are zero
2025-02-11 07:50:22,599 (model:925) WARNING: All labels are zero
2025-02-11 07:51:53,185 (model:925) WARNING: All labels are zero
2025-02-11 07:52:04,897 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 30798,  validation: loss=0.07283, DER=0.1685, ACC=0.966, MI=0.09186, FA=0.05026, CF=0.02642, over 0.00 frames. 
2025-02-11 07:52:04,897 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 07:52:05,667 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 30798,  validation: loss=0.07434, DER=0.1682, ACC=0.9651, MI=0.09277, FA=0.04739, CF=0.02806, over 0.00 frames. 
2025-02-11 07:52:05,667 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 08:03:49,124 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 31298, num_updates: 30500, {'loss': 0.09822838753461838, 'DER': 0.20037292025243833, 'ACC': np.float64(0.9616183035714286), 'MI': 0.09954102122776821, 'FA': 0.0545754446356856, 'CF': 0.04625645438898451}, batch size: 64, grad_norm: 0.16009552776813507, grad_scale: , lr: 0.00e+00, 
2025-02-11 08:03:49,124 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 08:03:49,126 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 31298, num_updates: 30500, {'loss': 0.08598509430885315, 'DER': 0.19583001520306959, 'ACC': np.float64(0.9643638392857143), 'MI': 0.11351625280532832, 'FA': 0.04698472453485847, 'CF': 0.035329037862882794}, batch size: 64, grad_norm: 0.16009552776813507, grad_scale: , lr: 0.00e+00, 
2025-02-11 08:03:49,126 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 08:04:38,466 (model:925) WARNING: All labels are zero
2025-02-11 08:04:39,028 (model:925) WARNING: All labels are zero
2025-02-11 08:04:39,062 (model:925) WARNING: All labels are zero
2025-02-11 08:06:10,089 (model:925) WARNING: All labels are zero
2025-02-11 08:06:22,118 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 31298,  validation: loss=0.07306, DER=0.1684, ACC=0.9659, MI=0.09165, FA=0.05052, CF=0.02627, over 0.00 frames. 
2025-02-11 08:06:22,118 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 08:06:22,121 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 31298,  validation: loss=0.0745, DER=0.1683, ACC=0.9651, MI=0.09276, FA=0.04765, CF=0.02792, over 0.00 frames. 
2025-02-11 08:06:22,122 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 08:11:07,983 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-31500.pt
2025-02-11 08:11:08,403 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-11 08:18:25,828 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 31798, num_updates: 31000, {'loss': 0.13538148999214172, 'DER': 0.29666533811611534, 'ACC': np.float64(0.9420870535714286), 'MI': 0.18380496877906205, 'FA': 0.06483326690580576, 'CF': 0.04802710243124751}, batch size: 64, grad_norm: 0.18521979451179504, grad_scale: , lr: 0.00e+00, 
2025-02-11 08:18:25,829 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 08:18:25,831 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 31798, num_updates: 31000, {'loss': 0.11350066214799881, 'DER': 0.2742330832652455, 'ACC': np.float64(0.9486160714285714), 'MI': 0.13956770407784297, 'FA': 0.06692416251949788, 'CF': 0.06774121666790463}, batch size: 64, grad_norm: 0.18521979451179504, grad_scale: , lr: 0.00e+00, 
2025-02-11 08:18:25,831 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 08:19:14,637 (model:925) WARNING: All labels are zero
2025-02-11 08:19:14,922 (model:925) WARNING: All labels are zero
2025-02-11 08:19:15,219 (model:925) WARNING: All labels are zero
2025-02-11 08:20:45,636 (model:925) WARNING: All labels are zero
2025-02-11 08:20:57,687 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 31798,  validation: loss=0.07284, DER=0.1679, ACC=0.966, MI=0.08816, FA=0.05303, CF=0.02669, over 0.00 frames. 
2025-02-11 08:20:57,687 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 08:20:58,186 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 31798,  validation: loss=0.07435, DER=0.168, ACC=0.965, MI=0.08932, FA=0.05022, CF=0.02846, over 0.00 frames. 
2025-02-11 08:20:58,186 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 08:33:26,157 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 32298, num_updates: 31500, {'loss': 0.10294512659311295, 'DER': 0.23862180567729754, 'ACC': np.float64(0.9523883928571429), 'MI': 0.14388780257568606, 'FA': 0.045715056300991166, 'CF': 0.04901894680062032}, batch size: 64, grad_norm: 0.16553770005702972, grad_scale: , lr: 0.00e+00, 
2025-02-11 08:33:26,158 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 08:33:26,160 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 32298, num_updates: 31500, {'loss': 0.09815517067909241, 'DER': 0.23775587566338136, 'ACC': np.float64(0.9573772321428571), 'MI': 0.09476876421531463, 'FA': 0.09120545868081881, 'CF': 0.051781652767247915}, batch size: 64, grad_norm: 0.16553770005702972, grad_scale: , lr: 0.00e+00, 
2025-02-11 08:33:26,160 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 08:34:14,705 (model:925) WARNING: All labels are zero
2025-02-11 08:34:15,112 (model:925) WARNING: All labels are zero
2025-02-11 08:34:15,289 (model:925) WARNING: All labels are zero
2025-02-11 08:35:44,396 (model:925) WARNING: All labels are zero
2025-02-11 08:35:56,095 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 32298,  validation: loss=0.07297, DER=0.1682, ACC=0.9659, MI=0.09144, FA=0.0503, CF=0.0265, over 0.00 frames. 
2025-02-11 08:35:56,096 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 08:35:56,848 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 32298,  validation: loss=0.07438, DER=0.1679, ACC=0.9651, MI=0.09206, FA=0.04758, CF=0.02823, over 0.00 frames. 
2025-02-11 08:35:56,848 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 08:47:43,520 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 32798, num_updates: 32000, {'loss': 0.09674577414989471, 'DER': 0.21091445427728614, 'ACC': np.float64(0.9605133928571429), 'MI': 0.12403427447675236, 'FA': 0.0493046776232617, 'CF': 0.03757550217727209}, batch size: 64, grad_norm: 0.12178314477205276, grad_scale: , lr: 0.00e+00, 
2025-02-11 08:47:43,520 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 08:47:43,522 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 32798, num_updates: 32000, {'loss': 0.0970507562160492, 'DER': 0.20862447594330205, 'ACC': np.float64(0.9582366071428571), 'MI': 0.11745524722166767, 'FA': 0.050775271178545286, 'CF': 0.04039395754308911}, batch size: 64, grad_norm: 0.12178314477205276, grad_scale: , lr: 0.00e+00, 
2025-02-11 08:47:43,522 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 08:48:32,769 (model:925) WARNING: All labels are zero
2025-02-11 08:48:33,996 (model:925) WARNING: All labels are zero
2025-02-11 08:48:34,611 (model:925) WARNING: All labels are zero
2025-02-11 08:50:01,990 (model:925) WARNING: All labels are zero
2025-02-11 08:50:13,703 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 32798,  validation: loss=0.07309, DER=0.1682, ACC=0.9659, MI=0.08962, FA=0.05147, CF=0.02709, over 0.00 frames. 
2025-02-11 08:50:13,704 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 08:50:20,385 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 32798,  validation: loss=0.07429, DER=0.1676, ACC=0.9651, MI=0.09055, FA=0.04858, CF=0.02849, over 0.00 frames. 
2025-02-11 08:50:20,386 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 08:52:58,628 (train_accelerate_ddp:713) INFO: end of epoch 8, batch_idx: 4113 batch_idx_train: 32911, {'loss': 0.07430383563041687, 'DER': 0.1869772998805257, 'ACC': np.float64(0.9683482142857143), 'MI': 0.10110513739545998, 'FA': 0.061081242532855434, 'CF': 0.024790919952210274}, batch size: 64, grad_norm: 0.16014087200164795, grad_scale: , lr: 0.00e+00, 
2025-02-11 08:52:58,630 (train_accelerate_ddp:713) INFO: end of epoch 8, batch_idx: 4113 batch_idx_train: 32911, {'loss': 0.09838549047708511, 'DER': 0.2310782074505789, 'ACC': np.float64(0.9589955357142856), 'MI': 0.09285658029455778, 'FA': 0.07994014334094668, 'CF': 0.05828148381507443}, batch size: 64, grad_norm: 0.16014087200164795, grad_scale: , lr: 0.00e+00, 
2025-02-11 08:52:58,630 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-8.pt
2025-02-11 08:52:58,954 (train_accelerate_ddp:561) INFO:  end of epoch 8, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-8.pt 
2025-02-11 08:53:01,770 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 32912, num_updates: 32000, {'loss': 0.12122954428195953, 'DER': 0.2938983986747653, 'ACC': np.float64(0.939453125), 'MI': 0.16737990060739924, 'FA': 0.045969077857537274, 'CF': 0.08054942020982882}, batch size: 64, grad_norm: 0.15355609357357025, grad_scale: , lr: 0.00e+00, 
2025-02-11 08:53:01,771 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 32912, num_updates: 32000, {'loss': 0.11104480177164078, 'DER': 0.2636589698046181, 'ACC': np.float64(0.952064732142857), 'MI': 0.1499822380106572, 'FA': 0.07218472468916519, 'CF': 0.04149200710479574}, batch size: 64, grad_norm: 0.15355609357357025, grad_scale: , lr: 0.00e+00, 
2025-02-11 08:55:05,533 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-33000.pt
2025-02-11 08:55:05,963 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-11 08:55:05,966 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-11 09:04:58,095 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 33412, num_updates: 32500, {'loss': 0.09965785592794418, 'DER': 0.2364445741808363, 'ACC': np.float64(0.9574441964285714), 'MI': 0.1317229803692622, 'FA': 0.06290593300737064, 'CF': 0.04181566080420346}, batch size: 64, grad_norm: 0.13412943482398987, grad_scale: , lr: 0.00e+00, 
2025-02-11 09:04:58,095 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 09:04:58,097 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 33412, num_updates: 32500, {'loss': 0.10101068764925003, 'DER': 0.23043574105371445, 'ACC': np.float64(0.9587611607142857), 'MI': 0.12653391138217357, 'FA': 0.06282607098243809, 'CF': 0.0410757586891028}, batch size: 64, grad_norm: 0.13412943482398987, grad_scale: , lr: 0.00e+00, 
2025-02-11 09:04:58,097 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 09:05:47,021 (model:925) WARNING: All labels are zero
2025-02-11 09:05:47,315 (model:925) WARNING: All labels are zero
2025-02-11 09:05:47,601 (model:925) WARNING: All labels are zero
2025-02-11 09:07:16,736 (model:925) WARNING: All labels are zero
2025-02-11 09:07:28,481 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 33412,  validation: loss=0.07298, DER=0.168, ACC=0.966, MI=0.08935, FA=0.05201, CF=0.02661, over 0.00 frames. 
2025-02-11 09:07:28,482 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 09:07:29,519 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 33412,  validation: loss=0.07441, DER=0.1682, ACC=0.965, MI=0.0898, FA=0.04978, CF=0.02858, over 0.00 frames. 
2025-02-11 09:07:29,519 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 09:19:50,727 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 33912, num_updates: 33000, {'loss': 0.10392133891582489, 'DER': 0.24033090574842678, 'ACC': np.float64(0.9552120535714286), 'MI': 0.13116029131018878, 'FA': 0.06575691154634802, 'CF': 0.043413702891889984}, batch size: 64, grad_norm: 0.13563497364521027, grad_scale: , lr: 0.00e+00, 
2025-02-11 09:19:50,728 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 09:19:50,730 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 33912, num_updates: 33000, {'loss': 0.08857858180999756, 'DER': 0.20197183098591548, 'ACC': np.float64(0.9603125), 'MI': 0.10464788732394366, 'FA': 0.04887323943661972, 'CF': 0.048450704225352116}, batch size: 64, grad_norm: 0.13563497364521027, grad_scale: , lr: 0.00e+00, 
2025-02-11 09:19:50,730 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 09:20:39,721 (model:925) WARNING: All labels are zero
2025-02-11 09:20:39,801 (model:925) WARNING: All labels are zero
2025-02-11 09:20:40,383 (model:925) WARNING: All labels are zero
2025-02-11 09:22:09,257 (model:925) WARNING: All labels are zero
2025-02-11 09:22:21,092 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 33912,  validation: loss=0.07267, DER=0.1671, ACC=0.9661, MI=0.09035, FA=0.05021, CF=0.02654, over 0.00 frames. 
2025-02-11 09:22:21,092 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 09:22:22,712 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 33912,  validation: loss=0.07417, DER=0.1674, ACC=0.9651, MI=0.09157, FA=0.04734, CF=0.02848, over 0.00 frames. 
2025-02-11 09:22:22,712 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 09:34:22,891 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 34412, num_updates: 33500, {'loss': 0.0936533659696579, 'DER': 0.20648030495552733, 'ACC': np.float64(0.9612276785714287), 'MI': 0.1144289143018495, 'FA': 0.05329662572356346, 'CF': 0.03875476493011436}, batch size: 64, grad_norm: 0.13842886686325073, grad_scale: , lr: 0.00e+00, 
2025-02-11 09:34:22,892 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 09:34:22,893 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 34412, num_updates: 33500, {'loss': 0.10144563019275665, 'DER': 0.22681645948281592, 'ACC': np.float64(0.9565401785714286), 'MI': 0.13926743335770791, 'FA': 0.055507545037558996, 'CF': 0.03204148108754903}, batch size: 64, grad_norm: 0.13842886686325073, grad_scale: , lr: 0.00e+00, 
2025-02-11 09:34:22,893 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 09:35:11,171 (model:925) WARNING: All labels are zero
2025-02-11 09:35:11,504 (model:925) WARNING: All labels are zero
2025-02-11 09:35:11,738 (model:925) WARNING: All labels are zero
2025-02-11 09:36:40,377 (model:925) WARNING: All labels are zero
2025-02-11 09:36:51,944 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 34412,  validation: loss=0.07305, DER=0.168, ACC=0.9659, MI=0.09071, FA=0.05062, CF=0.02671, over 0.00 frames. 
2025-02-11 09:36:51,944 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 09:36:52,706 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 34412,  validation: loss=0.0744, DER=0.1679, ACC=0.9651, MI=0.09172, FA=0.04783, CF=0.0283, over 0.00 frames. 
2025-02-11 09:36:52,706 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 09:38:56,163 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-34500.pt
2025-02-11 09:38:56,586 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-11 09:48:39,728 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 34912, num_updates: 34000, {'loss': 0.11166920512914658, 'DER': 0.2810130105058095, 'ACC': np.float64(0.9482700892857143), 'MI': 0.17365894385305783, 'FA': 0.06588742781604397, 'CF': 0.04146663883670772}, batch size: 64, grad_norm: 0.13486787676811218, grad_scale: , lr: 0.00e+00, 
2025-02-11 09:48:39,729 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 09:48:39,730 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 34912, num_updates: 34000, {'loss': 0.08847683668136597, 'DER': 0.2076894082171127, 'ACC': np.float64(0.9660825892857143), 'MI': 0.10629476064832265, 'FA': 0.07998492272898605, 'CF': 0.021409724839803995}, batch size: 64, grad_norm: 0.13486787676811218, grad_scale: , lr: 0.00e+00, 
2025-02-11 09:48:39,730 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 09:49:28,527 (model:925) WARNING: All labels are zero
2025-02-11 09:49:29,105 (model:925) WARNING: All labels are zero
2025-02-11 09:49:29,110 (model:925) WARNING: All labels are zero
2025-02-11 09:50:58,925 (model:925) WARNING: All labels are zero
2025-02-11 09:51:10,718 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 34912,  validation: loss=0.07449, DER=0.1681, ACC=0.965, MI=0.08977, FA=0.04989, CF=0.02845, over 0.00 frames. 
2025-02-11 09:51:10,719 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 09:51:10,731 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 34912,  validation: loss=0.07302, DER=0.1684, ACC=0.9659, MI=0.08906, FA=0.05284, CF=0.02646, over 0.00 frames. 
2025-02-11 09:51:10,731 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 10:02:54,614 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 35412, num_updates: 34500, {'loss': 0.10736298561096191, 'DER': 0.23105719237435007, 'ACC': np.float64(0.9552790178571429), 'MI': 0.14086655112651647, 'FA': 0.04346620450606586, 'CF': 0.046724436741767766}, batch size: 64, grad_norm: 0.16853085160255432, grad_scale: , lr: 0.00e+00, 
2025-02-11 10:02:54,615 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 10:02:54,616 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 35412, num_updates: 34500, {'loss': 0.09933827072381973, 'DER': 0.24881995954147, 'ACC': np.float64(0.9539955357142857), 'MI': 0.12587098224320073, 'FA': 0.06293549112160036, 'CF': 0.06001348617666891}, batch size: 64, grad_norm: 0.16853085160255432, grad_scale: , lr: 0.00e+00, 
2025-02-11 10:02:54,616 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 10:03:43,172 (model:925) WARNING: All labels are zero
2025-02-11 10:03:43,441 (model:925) WARNING: All labels are zero
2025-02-11 10:03:43,746 (model:925) WARNING: All labels are zero
2025-02-11 10:05:13,373 (model:925) WARNING: All labels are zero
2025-02-11 10:05:25,310 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 35412,  validation: loss=0.07278, DER=0.1673, ACC=0.9661, MI=0.08974, FA=0.05125, CF=0.02628, over 0.00 frames. 
2025-02-11 10:05:25,310 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 10:05:25,837 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 35412,  validation: loss=0.07424, DER=0.1671, ACC=0.9652, MI=0.09067, FA=0.04831, CF=0.02816, over 0.00 frames. 
2025-02-11 10:05:25,837 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 10:17:10,397 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 35912, num_updates: 35000, {'loss': 0.11086532473564148, 'DER': 0.23614392763113481, 'ACC': np.float64(0.9515959821428571), 'MI': 0.1223249848106393, 'FA': 0.05717950448929994, 'CF': 0.05663943833119557}, batch size: 64, grad_norm: 0.2337873876094818, grad_scale: , lr: 0.00e+00, 
2025-02-11 10:17:10,398 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 10:17:10,400 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 35912, num_updates: 35000, {'loss': 0.12875206768512726, 'DER': 0.27496740547588006, 'ACC': np.float64(0.9425892857142857), 'MI': 0.15691003911342893, 'FA': 0.057692307692307696, 'CF': 0.06036505867014342}, batch size: 64, grad_norm: 0.2337873876094818, grad_scale: , lr: 0.00e+00, 
2025-02-11 10:17:10,400 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 10:17:58,544 (model:925) WARNING: All labels are zero
2025-02-11 10:17:58,942 (model:925) WARNING: All labels are zero
2025-02-11 10:17:59,116 (model:925) WARNING: All labels are zero
2025-02-11 10:19:27,462 (model:925) WARNING: All labels are zero
2025-02-11 10:19:39,114 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 35912,  validation: loss=0.07315, DER=0.1686, ACC=0.9659, MI=0.08955, FA=0.0521, CF=0.02694, over 0.00 frames. 
2025-02-11 10:19:39,114 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 10:19:39,776 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 35912,  validation: loss=0.07454, DER=0.168, ACC=0.965, MI=0.09016, FA=0.04918, CF=0.02866, over 0.00 frames. 
2025-02-11 10:19:39,776 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 10:21:42,626 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-36000.pt
2025-02-11 10:21:43,037 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-11 10:31:26,016 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 36412, num_updates: 35500, {'loss': 0.08568736165761948, 'DER': 0.19107861060329068, 'ACC': np.float64(0.9655245535714286), 'MI': 0.11144424131627056, 'FA': 0.04482632541133455, 'CF': 0.034808043875685556}, batch size: 64, grad_norm: 0.1673198789358139, grad_scale: , lr: 0.00e+00, 
2025-02-11 10:31:26,017 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 10:31:26,019 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 36412, num_updates: 35500, {'loss': 0.08562205731868744, 'DER': 0.1948335327655381, 'ACC': np.float64(0.9630803571428571), 'MI': 0.09650172450200606, 'FA': 0.06032237629337651, 'CF': 0.038009431970155556}, batch size: 64, grad_norm: 0.1673198789358139, grad_scale: , lr: 0.00e+00, 
2025-02-11 10:31:26,020 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 10:32:14,733 (model:925) WARNING: All labels are zero
2025-02-11 10:32:14,749 (model:925) WARNING: All labels are zero
2025-02-11 10:32:15,339 (model:925) WARNING: All labels are zero
2025-02-11 10:33:49,761 (model:925) WARNING: All labels are zero
2025-02-11 10:34:02,046 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 36412,  validation: loss=0.07313, DER=0.1684, ACC=0.9658, MI=0.08959, FA=0.05178, CF=0.02703, over 0.00 frames. 
2025-02-11 10:34:02,046 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 10:34:03,074 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 36412,  validation: loss=0.07461, DER=0.1685, ACC=0.9649, MI=0.09057, FA=0.04919, CF=0.02877, over 0.00 frames. 
2025-02-11 10:34:03,074 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 10:46:50,523 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 36912, num_updates: 36000, {'loss': 0.1284269243478775, 'DER': 0.3065198366394399, 'ACC': np.float64(0.9431919642857143), 'MI': 0.18006126021003502, 'FA': 0.06177071178529755, 'CF': 0.06468786464410735}, batch size: 64, grad_norm: 0.22266235947608948, grad_scale: , lr: 0.00e+00, 
2025-02-11 10:46:50,524 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 10:46:50,526 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 36912, num_updates: 36000, {'loss': 0.10569385439157486, 'DER': 0.2585204269414796, 'ACC': np.float64(0.9535714285714286), 'MI': 0.1451601030548399, 'FA': 0.06566065513433934, 'CF': 0.047699668752300334}, batch size: 64, grad_norm: 0.22266235947608948, grad_scale: , lr: 0.00e+00, 
2025-02-11 10:46:50,526 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 10:47:39,447 (model:925) WARNING: All labels are zero
2025-02-11 10:47:39,860 (model:925) WARNING: All labels are zero
2025-02-11 10:47:40,016 (model:925) WARNING: All labels are zero
2025-02-11 10:49:10,855 (model:925) WARNING: All labels are zero
2025-02-11 10:49:22,923 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 36912,  validation: loss=0.07446, DER=0.1681, ACC=0.965, MI=0.09061, FA=0.04895, CF=0.02856, over 0.00 frames. 
2025-02-11 10:49:22,923 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 10:49:22,953 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 36912,  validation: loss=0.07311, DER=0.1681, ACC=0.9659, MI=0.08939, FA=0.05184, CF=0.02687, over 0.00 frames. 
2025-02-11 10:49:22,953 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 10:52:01,423 (train_accelerate_ddp:713) INFO: end of epoch 9, batch_idx: 4113 batch_idx_train: 37025, {'loss': 0.11814769357442856, 'DER': 0.24454839375386944, 'ACC': np.float64(0.9540625), 'MI': 0.15787301368920686, 'FA': 0.048084198940634246, 'CF': 0.03859118112402834}, batch size: 64, grad_norm: 0.21892796456813812, grad_scale: , lr: 0.00e+00, 
2025-02-11 10:52:01,426 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-9.pt
2025-02-11 10:52:01,426 (train_accelerate_ddp:713) INFO: end of epoch 9, batch_idx: 4113 batch_idx_train: 37025, {'loss': 0.10738600790500641, 'DER': 0.2269301283357099, 'ACC': np.float64(0.9548772321428571), 'MI': 0.1290826373327901, 'FA': 0.05024784409587832, 'CF': 0.047599646907041486}, batch size: 64, grad_norm: 0.21892796456813812, grad_scale: , lr: 0.00e+00, 
2025-02-11 10:52:01,742 (train_accelerate_ddp:561) INFO:  end of epoch 9, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-9.pt 
2025-02-11 10:52:04,319 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 37026, num_updates: 36000, {'loss': 0.09643001109361649, 'DER': 0.2026759505768312, 'ACC': np.float64(0.9610714285714286), 'MI': 0.12772202880742714, 'FA': 0.03952488224452181, 'CF': 0.035429039524882244}, batch size: 64, grad_norm: 0.1745399385690689, grad_scale: , lr: 0.00e+00, 
2025-02-11 10:52:04,320 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 37026, num_updates: 36000, {'loss': 0.11066269129514694, 'DER': 0.24297657603374256, 'ACC': np.float64(0.9549665178571429), 'MI': 0.10770505385252693, 'FA': 0.07433908262408677, 'CF': 0.06093243955712887}, batch size: 64, grad_norm: 0.1745399385690689, grad_scale: , lr: 0.00e+00, 
2025-02-11 11:03:07,667 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-37500.pt
2025-02-11 11:03:08,089 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-11 11:03:08,091 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-11 11:03:45,210 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 37526, num_updates: 36500, {'loss': 0.10277705639600754, 'DER': 0.22172040022234574, 'ACC': np.float64(0.958125), 'MI': 0.1231934408004447, 'FA': 0.059546970539188435, 'CF': 0.03897998888271262}, batch size: 64, grad_norm: 0.1657523661851883, grad_scale: , lr: 0.00e+00, 
2025-02-11 11:03:45,210 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 11:03:45,212 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 37526, num_updates: 36500, {'loss': 0.08427248150110245, 'DER': 0.20510689733323262, 'ACC': np.float64(0.963844245255605), 'MI': 0.10689733323260557, 'FA': 0.05892573846037622, 'CF': 0.03928382564025081}, batch size: 64, grad_norm: 0.1657523661851883, grad_scale: , lr: 0.00e+00, 
2025-02-11 11:03:45,212 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 11:04:33,487 (model:925) WARNING: All labels are zero
2025-02-11 11:04:33,976 (model:925) WARNING: All labels are zero
2025-02-11 11:04:34,057 (model:925) WARNING: All labels are zero
2025-02-11 11:06:03,191 (model:925) WARNING: All labels are zero
2025-02-11 11:06:14,982 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 37526,  validation: loss=0.0727, DER=0.1675, ACC=0.966, MI=0.09018, FA=0.05083, CF=0.02647, over 0.00 frames. 
2025-02-11 11:06:14,982 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 11:06:15,225 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 37526,  validation: loss=0.07421, DER=0.1677, ACC=0.9651, MI=0.09107, FA=0.04815, CF=0.02845, over 0.00 frames. 
2025-02-11 11:06:15,226 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 11:17:54,255 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 38026, num_updates: 37000, {'loss': 0.09128124266862869, 'DER': 0.22178555539077563, 'ACC': np.float64(0.961640625), 'MI': 0.13658608927776955, 'FA': 0.052128132878540706, 'CF': 0.03307133323446537}, batch size: 64, grad_norm: 0.17663908004760742, grad_scale: , lr: 0.00e+00, 
2025-02-11 11:17:54,255 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 11:17:54,257 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 38026, num_updates: 37000, {'loss': 0.10203511267900467, 'DER': 0.2378864284148213, 'ACC': np.float64(0.9587065788004021), 'MI': 0.13447343418840899, 'FA': 0.07111013666593584, 'CF': 0.0323028575604765}, batch size: 64, grad_norm: 0.17663908004760742, grad_scale: , lr: 0.00e+00, 
2025-02-11 11:17:54,257 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 11:18:42,536 (model:925) WARNING: All labels are zero
2025-02-11 11:18:42,740 (model:925) WARNING: All labels are zero
2025-02-11 11:18:43,104 (model:925) WARNING: All labels are zero
2025-02-11 11:20:13,311 (model:925) WARNING: All labels are zero
2025-02-11 11:20:25,163 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 38026,  validation: loss=0.07292, DER=0.1679, ACC=0.966, MI=0.08821, FA=0.05303, CF=0.02663, over 0.00 frames. 
2025-02-11 11:20:25,163 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 11:20:25,493 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 38026,  validation: loss=0.07423, DER=0.1681, ACC=0.9651, MI=0.08919, FA=0.05039, CF=0.02847, over 0.00 frames. 
2025-02-11 11:20:25,494 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 11:32:24,516 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 38526, num_updates: 37500, {'loss': 0.09579486399888992, 'DER': 0.22898206935045, 'ACC': np.float64(0.9571428571428571), 'MI': 0.13214260796762714, 'FA': 0.05790832344938254, 'CF': 0.038931137933440316}, batch size: 64, grad_norm: 0.127411350607872, grad_scale: , lr: 0.00e+00, 
2025-02-11 11:32:24,517 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 11:32:24,518 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 38526, num_updates: 37500, {'loss': 0.09530533105134964, 'DER': 0.2334638816362054, 'ACC': np.float64(0.9586666666666667), 'MI': 0.14033942558746737, 'FA': 0.05903684363214389, 'CF': 0.03408761241659414}, batch size: 64, grad_norm: 0.127411350607872, grad_scale: , lr: 0.00e+00, 
2025-02-11 11:32:24,518 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 11:33:14,641 (model:925) WARNING: All labels are zero
2025-02-11 11:33:15,114 (model:925) WARNING: All labels are zero
2025-02-11 11:33:15,240 (model:925) WARNING: All labels are zero
2025-02-11 11:34:45,305 (model:925) WARNING: All labels are zero
2025-02-11 11:34:57,235 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 38526,  validation: loss=0.07265, DER=0.1675, ACC=0.9661, MI=0.09017, FA=0.05124, CF=0.02606, over 0.00 frames. 
2025-02-11 11:34:57,235 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 11:34:57,743 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 38526,  validation: loss=0.07417, DER=0.1671, ACC=0.9652, MI=0.09106, FA=0.04813, CF=0.02796, over 0.00 frames. 
2025-02-11 11:34:57,743 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 11:46:28,383 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-39000.pt
2025-02-11 11:46:28,782 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-11 11:47:06,785 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 39026, num_updates: 38000, {'loss': 0.0914633721113205, 'DER': 0.22299168975069253, 'ACC': np.float64(0.9623772321428571), 'MI': 0.1527190552558682, 'FA': 0.04752879428488118, 'CF': 0.02274384020994314}, batch size: 64, grad_norm: 0.16165564954280853, grad_scale: , lr: 0.00e+00, 
2025-02-11 11:47:06,785 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 11:47:06,787 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 39026, num_updates: 38000, {'loss': 0.12190499156713486, 'DER': 0.285444366689993, 'ACC': np.float64(0.9439212472920337), 'MI': 0.14086773967809657, 'FA': 0.08040587823652905, 'CF': 0.0641707487753674}, batch size: 64, grad_norm: 0.16165564954280853, grad_scale: , lr: 0.00e+00, 
2025-02-11 11:47:06,788 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 11:47:56,015 (model:925) WARNING: All labels are zero
2025-02-11 11:47:56,560 (model:925) WARNING: All labels are zero
2025-02-11 11:47:56,605 (model:925) WARNING: All labels are zero
2025-02-11 11:49:27,368 (model:925) WARNING: All labels are zero
2025-02-11 11:49:39,146 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 39026,  validation: loss=0.07308, DER=0.1681, ACC=0.966, MI=0.08732, FA=0.05407, CF=0.02668, over 0.00 frames. 
2025-02-11 11:49:39,147 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 11:49:39,357 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 39026,  validation: loss=0.07459, DER=0.1682, ACC=0.965, MI=0.08826, FA=0.05122, CF=0.02871, over 0.00 frames. 
2025-02-11 11:49:39,358 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 12:01:26,920 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 39526, num_updates: 38500, {'loss': 0.12713623046875, 'DER': 0.2515840220385675, 'ACC': np.float64(0.9471428571428571), 'MI': 0.1252754820936639, 'FA': 0.05172176308539945, 'CF': 0.07458677685950413}, batch size: 64, grad_norm: 0.1717463880777359, grad_scale: , lr: 0.00e+00, 
2025-02-11 12:01:26,921 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 12:01:26,921 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 39526, num_updates: 38500, {'loss': 0.08809874206781387, 'DER': 0.21096445177741113, 'ACC': np.float64(0.9637723214285714), 'MI': 0.11736913154342282, 'FA': 0.06112194390280486, 'CF': 0.03247337633118344}, batch size: 64, grad_norm: 0.1717463880777359, grad_scale: , lr: 0.00e+00, 
2025-02-11 12:01:26,922 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 12:02:16,738 (model:925) WARNING: All labels are zero
2025-02-11 12:02:17,325 (model:925) WARNING: All labels are zero
2025-02-11 12:02:17,339 (model:925) WARNING: All labels are zero
2025-02-11 12:03:49,360 (model:925) WARNING: All labels are zero
2025-02-11 12:04:01,544 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 39526,  validation: loss=0.07486, DER=0.169, ACC=0.9649, MI=0.0894, FA=0.05088, CF=0.02872, over 0.00 frames. 
2025-02-11 12:04:01,545 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 12:04:01,551 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 39526,  validation: loss=0.07347, DER=0.1691, ACC=0.9658, MI=0.0884, FA=0.05364, CF=0.02704, over 0.00 frames. 
2025-02-11 12:04:01,552 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 12:15:44,323 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 40026, num_updates: 39000, {'loss': 0.10181426256895065, 'DER': 0.23811563169164882, 'ACC': np.float64(0.9544960258293068), 'MI': 0.13533190578158458, 'FA': 0.051177730192719484, 'CF': 0.051605995717344755}, batch size: 64, grad_norm: 0.16354894638061523, grad_scale: , lr: 0.00e+00, 
2025-02-11 12:15:44,324 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 12:15:44,325 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 40026, num_updates: 39000, {'loss': 0.10624212771654129, 'DER': 0.2549048641445177, 'ACC': np.float64(0.9547767857142857), 'MI': 0.12904419930406455, 'FA': 0.08077293255349079, 'CF': 0.04508773228696231}, batch size: 64, grad_norm: 0.16354894638061523, grad_scale: , lr: 0.00e+00, 
2025-02-11 12:15:44,326 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 12:16:33,121 (model:925) WARNING: All labels are zero
2025-02-11 12:16:34,473 (model:925) WARNING: All labels are zero
2025-02-11 12:16:35,076 (model:925) WARNING: All labels are zero
2025-02-11 12:18:01,258 (model:925) WARNING: All labels are zero
2025-02-11 12:18:12,821 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 40026,  validation: loss=0.07275, DER=0.1675, ACC=0.9661, MI=0.0905, FA=0.05082, CF=0.02622, over 0.00 frames. 
2025-02-11 12:18:12,821 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 12:18:20,050 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 40026,  validation: loss=0.07425, DER=0.1675, ACC=0.9651, MI=0.09128, FA=0.04805, CF=0.02814, over 0.00 frames. 
2025-02-11 12:18:20,050 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 12:29:57,998 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-40500.pt
2025-02-11 12:29:58,451 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-11 12:30:39,951 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 40526, num_updates: 39500, {'loss': 0.10305286198854446, 'DER': 0.2620249172054881, 'ACC': np.float64(0.9569754464285714), 'MI': 0.1382274089260369, 'FA': 0.0818482889134206, 'CF': 0.0419492193660306}, batch size: 64, grad_norm: 0.21763814985752106, grad_scale: , lr: 0.00e+00, 
2025-02-11 12:30:39,951 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 12:30:39,953 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 40526, num_updates: 39500, {'loss': 0.11023381352424622, 'DER': 0.25570608157855984, 'ACC': np.float64(0.9526116071428571), 'MI': 0.12627006331909882, 'FA': 0.07252245619201884, 'CF': 0.056913562067442205}, batch size: 64, grad_norm: 0.21763814985752106, grad_scale: , lr: 0.00e+00, 
2025-02-11 12:30:39,954 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 12:31:28,715 (model:925) WARNING: All labels are zero
2025-02-11 12:31:28,788 (model:925) WARNING: All labels are zero
2025-02-11 12:31:29,298 (model:925) WARNING: All labels are zero
2025-02-11 12:32:59,295 (model:925) WARNING: All labels are zero
2025-02-11 12:33:11,195 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 40526,  validation: loss=0.07332, DER=0.1686, ACC=0.9658, MI=0.08609, FA=0.05519, CF=0.02733, over 0.00 frames. 
2025-02-11 12:33:11,195 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 12:33:11,701 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 40526,  validation: loss=0.07459, DER=0.169, ACC=0.9649, MI=0.08708, FA=0.0527, CF=0.02924, over 0.00 frames. 
2025-02-11 12:33:11,701 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 12:45:11,855 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 41026, num_updates: 40000, {'loss': 0.08594508469104767, 'DER': 0.19677486619865156, 'ACC': np.float64(0.9651227678571429), 'MI': 0.12566900674219783, 'FA': 0.050670744422047685, 'CF': 0.02043511503440606}, batch size: 64, grad_norm: 0.1806250810623169, grad_scale: , lr: 0.00e+00, 
2025-02-11 12:45:11,856 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 12:45:11,857 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 41026, num_updates: 40000, {'loss': 0.11407635360956192, 'DER': 0.25788834951456313, 'ACC': np.float64(0.950234375), 'MI': 0.15055285868392665, 'FA': 0.06459007551240561, 'CF': 0.04274541531823085}, batch size: 64, grad_norm: 0.1806250810623169, grad_scale: , lr: 0.00e+00, 
2025-02-11 12:45:11,857 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 12:46:00,421 (model:925) WARNING: All labels are zero
2025-02-11 12:46:00,969 (model:925) WARNING: All labels are zero
2025-02-11 12:46:01,000 (model:925) WARNING: All labels are zero
2025-02-11 12:47:30,058 (model:925) WARNING: All labels are zero
2025-02-11 12:47:41,763 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 41026,  validation: loss=0.07288, DER=0.1681, ACC=0.966, MI=0.09277, FA=0.04892, CF=0.02642, over 0.00 frames. 
2025-02-11 12:47:41,763 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 12:47:41,848 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 41026,  validation: loss=0.07423, DER=0.1678, ACC=0.9651, MI=0.09384, FA=0.04584, CF=0.02813, over 0.00 frames. 
2025-02-11 12:47:41,848 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 12:50:20,169 (train_accelerate_ddp:713) INFO: end of epoch 10, batch_idx: 4113 batch_idx_train: 41139, {'loss': 0.10053262114524841, 'DER': 0.24528301886792453, 'ACC': np.float64(0.95703125), 'MI': 0.12999554300995395, 'FA': 0.07458030010399644, 'CF': 0.04070717575397415}, batch size: 64, grad_norm: 0.14234203100204468, grad_scale: , lr: 0.00e+00, 
2025-02-11 12:50:20,171 (train_accelerate_ddp:713) INFO: end of epoch 10, batch_idx: 4113 batch_idx_train: 41139, {'loss': 0.09422837942838669, 'DER': 0.1956029313790806, 'ACC': np.float64(0.9643861607142857), 'MI': 0.12205196535642905, 'FA': 0.05656229180546302, 'CF': 0.01698867421718854}, batch size: 64, grad_norm: 0.14234203100204468, grad_scale: , lr: 0.00e+00, 
2025-02-11 12:50:20,172 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-10.pt
2025-02-11 12:50:20,476 (train_accelerate_ddp:561) INFO:  end of epoch 10, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-10.pt 
2025-02-11 12:50:22,897 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 41140, num_updates: 40000, {'loss': 0.11833661049604416, 'DER': 0.28490874016916456, 'ACC': np.float64(0.9471316964285714), 'MI': 0.1441608547262205, 'FA': 0.07419498441905327, 'CF': 0.06655290102389079}, batch size: 64, grad_norm: 0.1561480313539505, grad_scale: , lr: 0.00e+00, 
2025-02-11 12:50:22,897 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 41140, num_updates: 40000, {'loss': 0.08990428596735, 'DER': 0.21373820754716982, 'ACC': np.float64(0.9611830357142856), 'MI': 0.10790094339622641, 'FA': 0.0632370283018868, 'CF': 0.0426002358490566}, batch size: 64, grad_norm: 0.1561480313539505, grad_scale: , lr: 0.00e+00, 
2025-02-11 13:02:06,914 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 41640, num_updates: 40500, {'loss': 0.10065658390522003, 'DER': 0.23417336666441457, 'ACC': np.float64(0.9560491071428571), 'MI': 0.14174717924464564, 'FA': 0.06053645023984866, 'CF': 0.031889737179920274}, batch size: 64, grad_norm: 0.15373101830482483, grad_scale: , lr: 0.00e+00, 
2025-02-11 13:02:06,915 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 13:02:06,916 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 41640, num_updates: 40500, {'loss': 0.11040739715099335, 'DER': 0.2914769550283569, 'ACC': np.float64(0.9515721362855121), 'MI': 0.13763080118220306, 'FA': 0.10096653087307293, 'CF': 0.052879622973080916}, batch size: 64, grad_norm: 0.15373101830482483, grad_scale: , lr: 0.00e+00, 
2025-02-11 13:02:06,916 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 13:02:55,322 (model:925) WARNING: All labels are zero
2025-02-11 13:02:55,847 (model:925) WARNING: All labels are zero
2025-02-11 13:02:55,901 (model:925) WARNING: All labels are zero
2025-02-11 13:04:25,076 (model:925) WARNING: All labels are zero
2025-02-11 13:04:36,762 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 41640,  validation: loss=0.07291, DER=0.1683, ACC=0.9659, MI=0.0909, FA=0.05037, CF=0.02705, over 0.00 frames. 
2025-02-11 13:04:36,762 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 13:04:36,836 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 41640,  validation: loss=0.07427, DER=0.168, ACC=0.965, MI=0.0919, FA=0.0474, CF=0.02868, over 0.00 frames. 
2025-02-11 13:04:36,836 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 13:13:03,084 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-42000.pt
2025-02-11 13:13:03,487 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-11 13:13:03,506 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-11 13:16:22,909 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 42140, num_updates: 41000, {'loss': 0.09432860463857651, 'DER': 0.22190510167677488, 'ACC': np.float64(0.9601227678571429), 'MI': 0.11894398858366037, 'FA': 0.06992508027113807, 'CF': 0.03303603282197645}, batch size: 64, grad_norm: 0.2077975869178772, grad_scale: , lr: 0.00e+00, 
2025-02-11 13:16:22,910 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 13:16:22,911 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 42140, num_updates: 41000, {'loss': 0.1314472109079361, 'DER': 0.3028632880763544, 'ACC': np.float64(0.9384040178571429), 'MI': 0.2016400053770668, 'FA': 0.033136174216964645, 'CF': 0.0680871084823229}, batch size: 64, grad_norm: 0.2077975869178772, grad_scale: , lr: 0.00e+00, 
2025-02-11 13:16:22,911 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 13:17:11,178 (model:925) WARNING: All labels are zero
2025-02-11 13:17:11,457 (model:925) WARNING: All labels are zero
2025-02-11 13:17:11,756 (model:925) WARNING: All labels are zero
2025-02-11 13:18:39,627 (model:925) WARNING: All labels are zero
2025-02-11 13:18:51,234 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 42140,  validation: loss=0.07285, DER=0.1676, ACC=0.966, MI=0.08883, FA=0.05209, CF=0.02665, over 0.00 frames. 
2025-02-11 13:18:51,234 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 13:18:52,523 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 42140,  validation: loss=0.07428, DER=0.1676, ACC=0.9651, MI=0.08951, FA=0.04964, CF=0.02843, over 0.00 frames. 
2025-02-11 13:18:52,523 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 13:31:16,193 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 42640, num_updates: 41500, {'loss': 0.0934009701013565, 'DER': 0.22268163024217366, 'ACC': np.float64(0.960546875), 'MI': 0.13371234494979325, 'FA': 0.0506497341996456, 'CF': 0.03831955109273479}, batch size: 64, grad_norm: 0.20253804326057434, grad_scale: , lr: 0.00e+00, 
2025-02-11 13:31:16,194 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 13:31:16,196 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 42640, num_updates: 41500, {'loss': 0.10021229088306427, 'DER': 0.24160046643830624, 'ACC': np.float64(0.9562363238512035), 'MI': 0.13125865461701042, 'FA': 0.06624881568398805, 'CF': 0.04409299613730778}, batch size: 64, grad_norm: 0.20253804326057434, grad_scale: , lr: 0.00e+00, 
2025-02-11 13:31:16,196 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 13:32:04,760 (model:925) WARNING: All labels are zero
2025-02-11 13:32:05,118 (model:925) WARNING: All labels are zero
2025-02-11 13:32:05,341 (model:925) WARNING: All labels are zero
2025-02-11 13:33:34,236 (model:925) WARNING: All labels are zero
2025-02-11 13:33:46,146 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 42640,  validation: loss=0.07272, DER=0.1675, ACC=0.9661, MI=0.08916, FA=0.0521, CF=0.0262, over 0.00 frames. 
2025-02-11 13:33:46,146 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 13:33:46,677 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 42640,  validation: loss=0.07431, DER=0.1679, ACC=0.9651, MI=0.08996, FA=0.04964, CF=0.0283, over 0.00 frames. 
2025-02-11 13:33:46,677 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 13:45:39,405 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 43140, num_updates: 42000, {'loss': 0.08439911901950836, 'DER': 0.20052847915443336, 'ACC': np.float64(0.9660602678571429), 'MI': 0.1176600117439812, 'FA': 0.06018790369935408, 'CF': 0.022680563711098063}, batch size: 64, grad_norm: 0.1802079677581787, grad_scale: , lr: 0.00e+00, 
2025-02-11 13:45:39,406 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 13:45:39,407 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 43140, num_updates: 42000, {'loss': 0.11742249131202698, 'DER': 0.28243398392652125, 'ACC': np.float64(0.9481473214285714), 'MI': 0.1879516444924698, 'FA': 0.06314580941446613, 'CF': 0.031336530019585335}, batch size: 64, grad_norm: 0.1802079677581787, grad_scale: , lr: 0.00e+00, 
2025-02-11 13:45:39,407 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 13:46:28,563 (model:925) WARNING: All labels are zero
2025-02-11 13:46:29,038 (model:925) WARNING: All labels are zero
2025-02-11 13:46:29,144 (model:925) WARNING: All labels are zero
2025-02-11 13:47:58,635 (model:925) WARNING: All labels are zero
2025-02-11 13:48:10,406 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 43140,  validation: loss=0.073, DER=0.1681, ACC=0.9659, MI=0.08786, FA=0.05323, CF=0.027, over 0.00 frames. 
2025-02-11 13:48:10,406 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 13:48:11,074 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 43140,  validation: loss=0.07439, DER=0.1683, ACC=0.965, MI=0.08896, FA=0.0506, CF=0.02871, over 0.00 frames. 
2025-02-11 13:48:11,075 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 13:56:35,792 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-43500.pt
2025-02-11 13:56:36,203 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-11 13:59:53,836 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 43640, num_updates: 42500, {'loss': 0.11637347936630249, 'DER': 0.25823576467166026, 'ACC': np.float64(0.9504129464285714), 'MI': 0.12268198676459893, 'FA': 0.07068576830775944, 'CF': 0.06486800959930186}, batch size: 64, grad_norm: 0.2693372368812561, grad_scale: , lr: 0.00e+00, 
2025-02-11 13:59:53,837 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 13:59:53,839 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 43640, num_updates: 42500, {'loss': 0.11029313504695892, 'DER': 0.261955205811138, 'ACC': np.float64(0.953126397709992), 'MI': 0.13665254237288135, 'FA': 0.07006658595641646, 'CF': 0.055236077481840194}, batch size: 64, grad_norm: 0.2693372368812561, grad_scale: , lr: 0.00e+00, 
2025-02-11 13:59:53,839 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 14:00:42,113 (model:925) WARNING: All labels are zero
2025-02-11 14:00:42,496 (model:925) WARNING: All labels are zero
2025-02-11 14:00:42,688 (model:925) WARNING: All labels are zero
2025-02-11 14:02:10,872 (model:925) WARNING: All labels are zero
2025-02-11 14:02:22,468 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 43640,  validation: loss=0.07348, DER=0.169, ACC=0.9658, MI=0.08842, FA=0.05371, CF=0.0269, over 0.00 frames. 
2025-02-11 14:02:22,469 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 14:02:23,297 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 43640,  validation: loss=0.07482, DER=0.1687, ACC=0.965, MI=0.08941, FA=0.05091, CF=0.02833, over 0.00 frames. 
2025-02-11 14:02:23,297 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 14:14:05,782 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 44140, num_updates: 43000, {'loss': 0.15277479588985443, 'DER': 0.34577431697657246, 'ACC': np.float64(0.929955357142857), 'MI': 0.19816070349734846, 'FA': 0.07209505269517352, 'CF': 0.07551856078405048}, batch size: 64, grad_norm: 0.16141879558563232, grad_scale: , lr: 0.00e+00, 
2025-02-11 14:14:05,783 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 14:14:05,784 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 44140, num_updates: 43000, {'loss': 0.08625856786966324, 'DER': 0.2069840781478348, 'ACC': np.float64(0.9658796494469101), 'MI': 0.116914083532036, 'FA': 0.06407199446196446, 'CF': 0.02599800015383432}, batch size: 64, grad_norm: 0.16141879558563232, grad_scale: , lr: 0.00e+00, 
2025-02-11 14:14:05,784 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 14:14:54,387 (model:925) WARNING: All labels are zero
2025-02-11 14:14:54,929 (model:925) WARNING: All labels are zero
2025-02-11 14:14:54,962 (model:925) WARNING: All labels are zero
2025-02-11 14:16:24,735 (model:925) WARNING: All labels are zero
2025-02-11 14:16:36,594 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 44140,  validation: loss=0.07446, DER=0.168, ACC=0.9651, MI=0.09074, FA=0.04877, CF=0.02845, over 0.00 frames. 
2025-02-11 14:16:36,594 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 14:16:36,606 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 44140,  validation: loss=0.073, DER=0.168, ACC=0.9659, MI=0.08966, FA=0.05159, CF=0.02677, over 0.00 frames. 
2025-02-11 14:16:36,607 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 14:29:02,143 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 44640, num_updates: 43500, {'loss': 0.11993203312158585, 'DER': 0.27025670443137817, 'ACC': np.float64(0.94546875), 'MI': 0.12297432955686219, 'FA': 0.06718772407858885, 'CF': 0.08009465079592715}, batch size: 64, grad_norm: 0.16284558176994324, grad_scale: , lr: 0.00e+00, 
2025-02-11 14:29:02,143 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 14:29:02,145 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 44640, num_updates: 43500, {'loss': 0.10649175196886063, 'DER': 0.24373624813684436, 'ACC': np.float64(0.9551897321428571), 'MI': 0.1506849315068493, 'FA': 0.05181347150259067, 'CF': 0.04123784512740436}, batch size: 64, grad_norm: 0.16284558176994324, grad_scale: , lr: 0.00e+00, 
2025-02-11 14:29:02,146 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 14:29:51,071 (model:925) WARNING: All labels are zero
2025-02-11 14:29:51,787 (model:925) WARNING: All labels are zero
2025-02-11 14:29:52,388 (model:925) WARNING: All labels are zero
2025-02-11 14:31:19,662 (model:925) WARNING: All labels are zero
2025-02-11 14:31:31,301 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 44640,  validation: loss=0.07326, DER=0.1682, ACC=0.9658, MI=0.088, FA=0.05293, CF=0.0273, over 0.00 frames. 
2025-02-11 14:31:31,301 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 14:31:36,612 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 44640,  validation: loss=0.07457, DER=0.1682, ACC=0.9649, MI=0.08912, FA=0.05016, CF=0.02894, over 0.00 frames. 
2025-02-11 14:31:36,612 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 14:40:06,286 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-45000.pt
2025-02-11 14:40:06,685 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-11 14:43:23,542 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 45140, num_updates: 44000, {'loss': 0.0956776887178421, 'DER': 0.20621615607150806, 'ACC': np.float64(0.963046875), 'MI': 0.1098583191157926, 'FA': 0.056969067576589275, 'CF': 0.03938876937912618}, batch size: 64, grad_norm: 0.18003018200397491, grad_scale: , lr: 0.00e+00, 
2025-02-11 14:43:23,542 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 14:43:23,543 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 45140, num_updates: 44000, {'loss': 0.1172478124499321, 'DER': 0.25436179981634527, 'ACC': np.float64(0.9518303571428571), 'MI': 0.15123260577806033, 'FA': 0.05262414353323444, 'CF': 0.050505050505050504}, batch size: 64, grad_norm: 0.18003018200397491, grad_scale: , lr: 0.00e+00, 
2025-02-11 14:43:23,544 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 14:44:12,730 (model:925) WARNING: All labels are zero
2025-02-11 14:44:13,246 (model:925) WARNING: All labels are zero
2025-02-11 14:44:13,849 (model:925) WARNING: All labels are zero
2025-02-11 14:45:41,214 (model:925) WARNING: All labels are zero
2025-02-11 14:45:52,745 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 45140,  validation: loss=0.07337, DER=0.1684, ACC=0.9658, MI=0.08725, FA=0.0541, CF=0.02705, over 0.00 frames. 
2025-02-11 14:45:52,745 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 14:45:57,361 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 45140,  validation: loss=0.07487, DER=0.1692, ACC=0.9648, MI=0.08848, FA=0.05173, CF=0.02896, over 0.00 frames. 
2025-02-11 14:45:57,362 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 14:48:36,504 (train_accelerate_ddp:713) INFO: end of epoch 11, batch_idx: 4113 batch_idx_train: 45253, {'loss': 0.1041872501373291, 'DER': 0.2506990434142752, 'ACC': np.float64(0.955669642857143), 'MI': 0.14503311258278145, 'FA': 0.06409124356144223, 'CF': 0.04157468727005151}, batch size: 64, grad_norm: 0.1580193042755127, grad_scale: , lr: 0.00e+00, 
2025-02-11 14:48:36,506 (train_accelerate_ddp:713) INFO: end of epoch 11, batch_idx: 4113 batch_idx_train: 45253, {'loss': 0.10765773802995682, 'DER': 0.22313406437920055, 'ACC': np.float64(0.9568973214285714), 'MI': 0.13682348779625045, 'FA': 0.03622214361513972, 'CF': 0.050088432967810397}, batch size: 64, grad_norm: 0.1580193042755127, grad_scale: , lr: 0.00e+00, 
2025-02-11 14:48:36,506 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-11.pt
2025-02-11 14:48:36,798 (train_accelerate_ddp:561) INFO:  end of epoch 11, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-11.pt 
2025-02-11 14:48:39,264 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 45254, num_updates: 44000, {'loss': 0.11203120648860931, 'DER': 0.2513125656282814, 'ACC': np.float64(0.9532477678571429), 'MI': 0.15589779488974448, 'FA': 0.053482674133706685, 'CF': 0.041932096604830243}, batch size: 64, grad_norm: 0.16844740509986877, grad_scale: , lr: 0.00e+00, 
2025-02-11 14:48:39,267 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 45254, num_updates: 44000, {'loss': 0.09264030307531357, 'DER': 0.22159302585500334, 'ACC': np.float64(0.9603571428571429), 'MI': 0.10722002831383652, 'FA': 0.07130616198494896, 'CF': 0.04306683555621787}, batch size: 64, grad_norm: 0.16844740509986877, grad_scale: , lr: 0.00e+00, 
2025-02-11 15:00:25,878 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 45754, num_updates: 44500, {'loss': 0.11400691419839859, 'DER': 0.293355063338025, 'ACC': np.float64(0.9484821428571429), 'MI': 0.16623453589154752, 'FA': 0.078524335135936, 'CF': 0.04859619231054152}, batch size: 64, grad_norm: 0.19753481447696686, grad_scale: , lr: 0.00e+00, 
2025-02-11 15:00:25,879 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 15:00:25,880 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 45754, num_updates: 44500, {'loss': 0.11304894089698792, 'DER': 0.2090813785873411, 'ACC': np.float64(0.9574776785714286), 'MI': 0.11859520377407941, 'FA': 0.04992792556676713, 'CF': 0.04055824924649456}, batch size: 64, grad_norm: 0.19753481447696686, grad_scale: , lr: 0.00e+00, 
2025-02-11 15:00:25,880 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 15:01:14,041 (model:925) WARNING: All labels are zero
2025-02-11 15:01:14,367 (model:925) WARNING: All labels are zero
2025-02-11 15:01:14,614 (model:925) WARNING: All labels are zero
2025-02-11 15:02:42,851 (model:925) WARNING: All labels are zero
2025-02-11 15:02:54,434 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 45754,  validation: loss=0.0731, DER=0.1684, ACC=0.9658, MI=0.0913, FA=0.05006, CF=0.02705, over 0.00 frames. 
2025-02-11 15:02:54,434 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 15:02:55,276 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 45754,  validation: loss=0.07448, DER=0.1685, ACC=0.965, MI=0.09259, FA=0.04726, CF=0.02861, over 0.00 frames. 
2025-02-11 15:02:55,276 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 15:14:42,065 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 46254, num_updates: 45000, {'loss': 0.0925903394818306, 'DER': 0.21449648180373762, 'ACC': np.float64(0.9598214285714286), 'MI': 0.10849663312400697, 'FA': 0.04811984565332526, 'CF': 0.057880003026405384}, batch size: 64, grad_norm: 0.19424015283584595, grad_scale: , lr: 0.00e+00, 
2025-02-11 15:14:42,065 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 15:14:42,067 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 46254, num_updates: 45000, {'loss': 0.12393520772457123, 'DER': 0.2809061910031899, 'ACC': np.float64(0.9434598214285714), 'MI': 0.19022199075581017, 'FA': 0.04179415402643057, 'CF': 0.048890046220949154}, batch size: 64, grad_norm: 0.19424015283584595, grad_scale: , lr: 0.00e+00, 
2025-02-11 15:14:42,067 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 15:15:31,057 (model:925) WARNING: All labels are zero
2025-02-11 15:15:31,082 (model:925) WARNING: All labels are zero
2025-02-11 15:15:31,641 (model:925) WARNING: All labels are zero
2025-02-11 15:17:04,347 (model:925) WARNING: All labels are zero
2025-02-11 15:17:16,355 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 46254,  validation: loss=0.073, DER=0.1679, ACC=0.9661, MI=0.08777, FA=0.0539, CF=0.02625, over 0.00 frames. 
2025-02-11 15:17:16,356 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 15:17:16,418 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 46254,  validation: loss=0.07447, DER=0.1678, ACC=0.9651, MI=0.08871, FA=0.05095, CF=0.02812, over 0.00 frames. 
2025-02-11 15:17:16,419 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 15:23:57,418 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-46500.pt
2025-02-11 15:23:57,815 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-11 15:23:57,817 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-11 15:30:06,932 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 46754, num_updates: 45500, {'loss': 0.0900537520647049, 'DER': 0.21403385049365303, 'ACC': np.float64(0.9602566964285714), 'MI': 0.11502115655853315, 'FA': 0.06191819464033851, 'CF': 0.03709449929478138}, batch size: 64, grad_norm: 0.12611910700798035, grad_scale: , lr: 0.00e+00, 
2025-02-11 15:30:06,932 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 15:30:06,933 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 46754, num_updates: 45500, {'loss': 0.072532057762146, 'DER': 0.15479283467797073, 'ACC': np.float64(0.970390625), 'MI': 0.07746478873239436, 'FA': 0.050731573909476274, 'CF': 0.026596472036100095}, batch size: 64, grad_norm: 0.12611910700798035, grad_scale: , lr: 0.00e+00, 
2025-02-11 15:30:06,933 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 15:30:55,139 (model:925) WARNING: All labels are zero
2025-02-11 15:30:55,582 (model:925) WARNING: All labels are zero
2025-02-11 15:30:55,708 (model:925) WARNING: All labels are zero
2025-02-11 15:32:24,495 (model:925) WARNING: All labels are zero
2025-02-11 15:32:36,328 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 46754,  validation: loss=0.0729, DER=0.1679, ACC=0.966, MI=0.08873, FA=0.05218, CF=0.02698, over 0.00 frames. 
2025-02-11 15:32:36,328 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 15:32:37,107 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 46754,  validation: loss=0.07425, DER=0.168, ACC=0.965, MI=0.08978, FA=0.04958, CF=0.02869, over 0.00 frames. 
2025-02-11 15:32:37,107 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 15:44:14,240 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 47254, num_updates: 46000, {'loss': 0.129202738404274, 'DER': 0.2762366634335596, 'ACC': np.float64(0.9432700892857143), 'MI': 0.1859036534109279, 'FA': 0.03789201422567087, 'CF': 0.052440995796960876}, batch size: 64, grad_norm: 0.14319729804992676, grad_scale: , lr: 0.00e+00, 
2025-02-11 15:44:14,241 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 15:44:14,243 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 47254, num_updates: 46000, {'loss': 0.10432426631450653, 'DER': 0.26154068090017313, 'ACC': np.float64(0.9536941964285713), 'MI': 0.12918349682631275, 'FA': 0.0946335833814195, 'CF': 0.03772360069244085}, batch size: 64, grad_norm: 0.14319729804992676, grad_scale: , lr: 0.00e+00, 
2025-02-11 15:44:14,243 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 15:45:02,859 (model:925) WARNING: All labels are zero
2025-02-11 15:45:03,352 (model:925) WARNING: All labels are zero
2025-02-11 15:45:03,435 (model:925) WARNING: All labels are zero
2025-02-11 15:46:32,606 (model:925) WARNING: All labels are zero
2025-02-11 15:46:44,473 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 47254,  validation: loss=0.07352, DER=0.1693, ACC=0.9657, MI=0.08985, FA=0.05238, CF=0.02709, over 0.00 frames. 
2025-02-11 15:46:44,473 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 15:46:44,773 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 47254,  validation: loss=0.07487, DER=0.169, ACC=0.9648, MI=0.09115, FA=0.0493, CF=0.02859, over 0.00 frames. 
2025-02-11 15:46:44,773 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 15:58:26,724 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 47754, num_updates: 46500, {'loss': 0.1257113665342331, 'DER': 0.2779949255982994, 'ACC': np.float64(0.943002232142857), 'MI': 0.14194610162518, 'FA': 0.06384145923335391, 'CF': 0.07220736473976548}, batch size: 64, grad_norm: 0.1879158765077591, grad_scale: , lr: 0.00e+00, 
2025-02-11 15:58:26,725 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 15:58:26,726 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 47754, num_updates: 46500, {'loss': 0.12328533828258514, 'DER': 0.25245368865778356, 'ACC': np.float64(0.945), 'MI': 0.13220669483262917, 'FA': 0.052388690282742935, 'CF': 0.06785830354241144}, batch size: 64, grad_norm: 0.1879158765077591, grad_scale: , lr: 0.00e+00, 
2025-02-11 15:58:26,727 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 15:59:14,909 (model:925) WARNING: All labels are zero
2025-02-11 15:59:15,281 (model:925) WARNING: All labels are zero
2025-02-11 15:59:15,479 (model:925) WARNING: All labels are zero
2025-02-11 16:00:44,803 (model:925) WARNING: All labels are zero
2025-02-11 16:00:56,791 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 47754,  validation: loss=0.07286, DER=0.1679, ACC=0.9659, MI=0.0884, FA=0.05259, CF=0.02693, over 0.00 frames. 
2025-02-11 16:00:56,792 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 16:00:57,400 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 47754,  validation: loss=0.0742, DER=0.1681, ACC=0.965, MI=0.08949, FA=0.04989, CF=0.02868, over 0.00 frames. 
2025-02-11 16:00:57,400 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 16:06:43,778 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-48000.pt
2025-02-11 16:06:44,193 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-11 16:12:39,110 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 48254, num_updates: 47000, {'loss': 0.09554032981395721, 'DER': 0.23028559962544312, 'ACC': np.float64(0.9539732142857144), 'MI': 0.135910641428667, 'FA': 0.04882616547388135, 'CF': 0.04554879272289479}, batch size: 64, grad_norm: 0.1467207372188568, grad_scale: , lr: 0.00e+00, 
2025-02-11 16:12:39,111 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 16:12:39,112 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 48254, num_updates: 47000, {'loss': 0.08150814473628998, 'DER': 0.19947916666666668, 'ACC': np.float64(0.9669308035714286), 'MI': 0.12157738095238095, 'FA': 0.056919642857142856, 'CF': 0.020982142857142855}, batch size: 64, grad_norm: 0.1467207372188568, grad_scale: , lr: 0.00e+00, 
2025-02-11 16:12:39,113 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 16:13:27,301 (model:925) WARNING: All labels are zero
2025-02-11 16:13:27,587 (model:925) WARNING: All labels are zero
2025-02-11 16:13:27,877 (model:925) WARNING: All labels are zero
2025-02-11 16:14:56,814 (model:925) WARNING: All labels are zero
2025-02-11 16:15:08,638 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 48254,  validation: loss=0.07285, DER=0.1678, ACC=0.966, MI=0.09108, FA=0.05031, CF=0.02637, over 0.00 frames. 
2025-02-11 16:15:08,639 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 16:15:09,475 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 48254,  validation: loss=0.07434, DER=0.1677, ACC=0.9651, MI=0.09188, FA=0.04746, CF=0.02837, over 0.00 frames. 
2025-02-11 16:15:09,476 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 16:27:38,105 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 48754, num_updates: 47500, {'loss': 0.10273616760969162, 'DER': 0.2432621631081554, 'ACC': np.float64(0.95546875), 'MI': 0.14364718235911797, 'FA': 0.06356317815890794, 'CF': 0.03605180259012951}, batch size: 64, grad_norm: 0.1594734638929367, grad_scale: , lr: 0.00e+00, 
2025-02-11 16:27:38,106 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 16:27:38,107 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 48754, num_updates: 47500, {'loss': 0.11104725301265717, 'DER': 0.23943661971830985, 'ACC': np.float64(0.9567410714285713), 'MI': 0.1093527456876088, 'FA': 0.06282639658173762, 'CF': 0.06725747744896345}, batch size: 64, grad_norm: 0.1594734638929367, grad_scale: , lr: 0.00e+00, 
2025-02-11 16:27:38,108 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 16:28:26,767 (model:925) WARNING: All labels are zero
2025-02-11 16:28:26,868 (model:925) WARNING: All labels are zero
2025-02-11 16:28:27,351 (model:925) WARNING: All labels are zero
2025-02-11 16:29:57,394 (model:925) WARNING: All labels are zero
2025-02-11 16:30:09,480 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 48754,  validation: loss=0.07301, DER=0.1679, ACC=0.966, MI=0.08973, FA=0.05157, CF=0.02659, over 0.00 frames. 
2025-02-11 16:30:09,480 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 16:30:10,017 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 48754,  validation: loss=0.07451, DER=0.1684, ACC=0.965, MI=0.09085, FA=0.04907, CF=0.02852, over 0.00 frames. 
2025-02-11 16:30:10,017 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 16:41:56,810 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 49254, num_updates: 48000, {'loss': 0.10704201459884644, 'DER': 0.2549543218552354, 'ACC': np.float64(0.951015625), 'MI': 0.1286015460295151, 'FA': 0.07287420941672523, 'CF': 0.05347856640899508}, batch size: 64, grad_norm: 0.19975003600120544, grad_scale: , lr: 0.00e+00, 
2025-02-11 16:41:56,810 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 16:41:56,812 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 49254, num_updates: 48000, {'loss': 0.12171078473329544, 'DER': 0.29426129426129427, 'ACC': np.float64(0.9436941964285714), 'MI': 0.15341521223874166, 'FA': 0.0727573080514257, 'CF': 0.0680887739711269}, batch size: 64, grad_norm: 0.19975003600120544, grad_scale: , lr: 0.00e+00, 
2025-02-11 16:41:56,812 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 16:42:45,168 (model:925) WARNING: All labels are zero
2025-02-11 16:42:45,681 (model:925) WARNING: All labels are zero
2025-02-11 16:42:45,751 (model:925) WARNING: All labels are zero
2025-02-11 16:44:13,106 (model:925) WARNING: All labels are zero
2025-02-11 16:44:24,616 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 49254,  validation: loss=0.07302, DER=0.1684, ACC=0.9658, MI=0.08795, FA=0.05318, CF=0.02728, over 0.00 frames. 
2025-02-11 16:44:24,616 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 16:44:25,652 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 49254,  validation: loss=0.07427, DER=0.1683, ACC=0.965, MI=0.08917, FA=0.05036, CF=0.02881, over 0.00 frames. 
2025-02-11 16:44:25,653 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 16:47:05,052 (train_accelerate_ddp:713) INFO: end of epoch 12, batch_idx: 4113 batch_idx_train: 49367, {'loss': 0.09203945845365524, 'DER': 0.21731859822597063, 'ACC': np.float64(0.9622767857142857), 'MI': 0.13981387232805, 'FA': 0.04907663225243566, 'CF': 0.028428093645484948}, batch size: 64, grad_norm: 0.13779547810554504, grad_scale: , lr: 0.00e+00, 
2025-02-11 16:47:05,054 (train_accelerate_ddp:713) INFO: end of epoch 12, batch_idx: 4113 batch_idx_train: 49367, {'loss': 0.10662069171667099, 'DER': 0.24562924432885422, 'ACC': np.float64(0.9560602678571429), 'MI': 0.13386793815922554, 'FA': 0.07296633434474786, 'CF': 0.0387949718248808}, batch size: 64, grad_norm: 0.13779547810554504, grad_scale: , lr: 0.00e+00, 
2025-02-11 16:47:05,055 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-12.pt
2025-02-11 16:47:05,350 (train_accelerate_ddp:561) INFO:  end of epoch 12, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-12.pt 
2025-02-11 16:47:07,720 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 49368, num_updates: 48000, {'loss': 0.13572733104228973, 'DER': 0.3101589103291714, 'ACC': np.float64(0.9414955357142857), 'MI': 0.16962258796821794, 'FA': 0.07881668558456299, 'CF': 0.06171963677639047}, batch size: 64, grad_norm: 0.1954495906829834, grad_scale: , lr: 0.00e+00, 
2025-02-11 16:47:07,723 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 49368, num_updates: 48000, {'loss': 0.08232313394546509, 'DER': 0.18014204749264653, 'ACC': np.float64(0.96796875), 'MI': 0.09928976253676734, 'FA': 0.0550972092689576, 'CF': 0.025755075686921588}, batch size: 64, grad_norm: 0.1954495906829834, grad_scale: , lr: 0.00e+00, 
2025-02-11 16:50:10,383 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-49500.pt
2025-02-11 16:50:10,807 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-11 16:50:10,811 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-11 16:58:46,997 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 49868, num_updates: 48500, {'loss': 0.09886298328638077, 'DER': 0.25396462336078074, 'ACC': np.float64(0.955625), 'MI': 0.10849344312290332, 'FA': 0.09629460201280879, 'CF': 0.049176578225068615}, batch size: 64, grad_norm: 0.12878482043743134, grad_scale: , lr: 0.00e+00, 
2025-02-11 16:58:46,997 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 16:58:46,999 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 49868, num_updates: 48500, {'loss': 0.09431508928537369, 'DER': 0.23970534069981583, 'ACC': np.float64(0.9563169642857143), 'MI': 0.12375690607734807, 'FA': 0.06732965009208103, 'CF': 0.04861878453038674}, batch size: 64, grad_norm: 0.12878482043743134, grad_scale: , lr: 0.00e+00, 
2025-02-11 16:58:46,999 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 16:59:35,055 (model:925) WARNING: All labels are zero
2025-02-11 16:59:35,167 (model:925) WARNING: All labels are zero
2025-02-11 16:59:35,629 (model:925) WARNING: All labels are zero
2025-02-11 17:01:04,094 (model:925) WARNING: All labels are zero
2025-02-11 17:01:15,813 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 49868,  validation: loss=0.07286, DER=0.168, ACC=0.966, MI=0.08833, FA=0.0532, CF=0.02645, over 0.00 frames. 
2025-02-11 17:01:15,814 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 17:01:16,404 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 49868,  validation: loss=0.07432, DER=0.1679, ACC=0.9651, MI=0.08925, FA=0.05042, CF=0.02821, over 0.00 frames. 
2025-02-11 17:01:16,405 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 17:13:01,528 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 50368, num_updates: 49000, {'loss': 0.11401353776454926, 'DER': 0.2470953308796998, 'ACC': np.float64(0.9524888392857143), 'MI': 0.1373313126939453, 'FA': 0.04964999639171538, 'CF': 0.060114021794039116}, batch size: 64, grad_norm: 0.22850960493087769, grad_scale: , lr: 0.00e+00, 
2025-02-11 17:13:01,528 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 17:13:01,530 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 50368, num_updates: 49000, {'loss': 0.10312462598085403, 'DER': 0.24211943047389672, 'ACC': np.float64(0.9512276785714286), 'MI': 0.10703407239498477, 'FA': 0.06764893390947085, 'CF': 0.0674364241694411}, batch size: 64, grad_norm: 0.22850960493087769, grad_scale: , lr: 0.00e+00, 
2025-02-11 17:13:01,530 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 17:13:54,479 (model:925) WARNING: All labels are zero
2025-02-11 17:13:55,021 (model:925) WARNING: All labels are zero
2025-02-11 17:13:55,084 (model:925) WARNING: All labels are zero
2025-02-11 17:15:27,351 (model:925) WARNING: All labels are zero
2025-02-11 17:15:39,556 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 50368,  validation: loss=0.07287, DER=0.1683, ACC=0.966, MI=0.09083, FA=0.05124, CF=0.02626, over 0.00 frames. 
2025-02-11 17:15:39,556 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 17:15:39,718 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 50368,  validation: loss=0.07437, DER=0.1682, ACC=0.9651, MI=0.09174, FA=0.04831, CF=0.0282, over 0.00 frames. 
2025-02-11 17:15:39,718 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 17:28:28,773 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 50868, num_updates: 49500, {'loss': 0.09350641816854477, 'DER': 0.23321734087284327, 'ACC': np.float64(0.9552901785714286), 'MI': 0.11671741336813107, 'FA': 0.05930114542554734, 'CF': 0.05719878207916485}, batch size: 64, grad_norm: 0.17126718163490295, grad_scale: , lr: 0.00e+00, 
2025-02-11 17:28:28,773 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 17:28:28,774 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 50868, num_updates: 49500, {'loss': 0.08832608163356781, 'DER': 0.20595892392247614, 'ACC': np.float64(0.9631473214285714), 'MI': 0.12221579404107608, 'FA': 0.050911194677466014, 'CF': 0.03283193520393405}, batch size: 64, grad_norm: 0.17126718163490295, grad_scale: , lr: 0.00e+00, 
2025-02-11 17:28:28,774 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 17:29:17,890 (model:925) WARNING: All labels are zero
2025-02-11 17:29:17,897 (model:925) WARNING: All labels are zero
2025-02-11 17:29:18,486 (model:925) WARNING: All labels are zero
2025-02-11 17:30:47,906 (model:925) WARNING: All labels are zero
2025-02-11 17:30:59,695 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 50868,  validation: loss=0.07312, DER=0.1681, ACC=0.9658, MI=0.08776, FA=0.05274, CF=0.02756, over 0.00 frames. 
2025-02-11 17:30:59,695 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 17:31:01,530 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 50868,  validation: loss=0.0745, DER=0.1686, ACC=0.9649, MI=0.08933, FA=0.05001, CF=0.02923, over 0.00 frames. 
2025-02-11 17:31:01,531 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 17:34:08,028 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-51000.pt
2025-02-11 17:34:08,458 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-11 17:42:42,258 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 51368, num_updates: 50000, {'loss': 0.10115589201450348, 'DER': 0.2706830391404451, 'ACC': np.float64(0.9525223214285714), 'MI': 0.12287029930928627, 'FA': 0.09201841903300077, 'CF': 0.0557943207981581}, batch size: 64, grad_norm: 0.15190641582012177, grad_scale: , lr: 0.00e+00, 
2025-02-11 17:42:42,259 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 17:42:42,260 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 51368, num_updates: 50000, {'loss': 0.10327932983636856, 'DER': 0.236178775683118, 'ACC': np.float64(0.9566763985368637), 'MI': 0.1259620136976629, 'FA': 0.07293652474758172, 'CF': 0.03728023723787333}, batch size: 64, grad_norm: 0.15190641582012177, grad_scale: , lr: 0.00e+00, 
2025-02-11 17:42:42,260 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 17:43:31,483 (model:925) WARNING: All labels are zero
2025-02-11 17:43:32,031 (model:925) WARNING: All labels are zero
2025-02-11 17:43:32,079 (model:925) WARNING: All labels are zero
2025-02-11 17:45:02,954 (model:925) WARNING: All labels are zero
2025-02-11 17:45:14,853 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 51368,  validation: loss=0.07332, DER=0.1685, ACC=0.9658, MI=0.089, FA=0.05275, CF=0.0268, over 0.00 frames. 
2025-02-11 17:45:14,854 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 17:45:14,891 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 51368,  validation: loss=0.07472, DER=0.1689, ACC=0.9649, MI=0.09017, FA=0.05021, CF=0.02853, over 0.00 frames. 
2025-02-11 17:45:14,892 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 17:56:57,655 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 51868, num_updates: 50500, {'loss': 0.10150903463363647, 'DER': 0.2479151426481346, 'ACC': np.float64(0.9543861607142857), 'MI': 0.11316752011704462, 'FA': 0.08368690563277249, 'CF': 0.05106071689831748}, batch size: 64, grad_norm: 0.13765668869018555, grad_scale: , lr: 0.00e+00, 
2025-02-11 17:56:57,656 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 17:56:57,657 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 51868, num_updates: 50500, {'loss': 0.09298127889633179, 'DER': 0.21580651829394337, 'ACC': np.float64(0.9585602678571429), 'MI': 0.11052160132295184, 'FA': 0.06525184317508441, 'CF': 0.04003307379590712}, batch size: 64, grad_norm: 0.13765668869018555, grad_scale: , lr: 0.00e+00, 
2025-02-11 17:56:57,658 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 17:57:46,669 (model:925) WARNING: All labels are zero
2025-02-11 17:57:47,259 (model:925) WARNING: All labels are zero
2025-02-11 17:57:47,335 (model:925) WARNING: All labels are zero
2025-02-11 17:59:18,240 (model:925) WARNING: All labels are zero
2025-02-11 17:59:29,251 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 51868,  validation: loss=0.07453, DER=0.1675, ACC=0.9652, MI=0.09016, FA=0.04934, CF=0.02796, over 0.00 frames. 
2025-02-11 17:59:29,252 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 17:59:30,055 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 51868,  validation: loss=0.07301, DER=0.1674, ACC=0.9661, MI=0.08948, FA=0.05184, CF=0.02604, over 0.00 frames. 
2025-02-11 17:59:30,055 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 18:11:14,806 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 52368, num_updates: 51000, {'loss': 0.11602307856082916, 'DER': 0.2582402615091256, 'ACC': np.float64(0.94890625), 'MI': 0.1510487605557069, 'FA': 0.05366385181149551, 'CF': 0.053527649141923185}, batch size: 64, grad_norm: 0.18553729355335236, grad_scale: , lr: 0.00e+00, 
2025-02-11 18:11:14,807 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 18:11:14,808 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 52368, num_updates: 51000, {'loss': 0.10304723680019379, 'DER': 0.24850342075256557, 'ACC': np.float64(0.9550558035714286), 'MI': 0.1373289623717218, 'FA': 0.07269099201824401, 'CF': 0.03848346636259977}, batch size: 64, grad_norm: 0.18553729355335236, grad_scale: , lr: 0.00e+00, 
2025-02-11 18:11:14,809 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 18:12:03,514 (model:925) WARNING: All labels are zero
2025-02-11 18:12:04,006 (model:925) WARNING: All labels are zero
2025-02-11 18:12:04,107 (model:925) WARNING: All labels are zero
2025-02-11 18:13:36,607 (model:925) WARNING: All labels are zero
2025-02-11 18:13:48,457 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 52368,  validation: loss=0.07285, DER=0.1679, ACC=0.966, MI=0.08858, FA=0.05246, CF=0.02686, over 0.00 frames. 
2025-02-11 18:13:48,457 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 18:13:48,696 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 52368,  validation: loss=0.07431, DER=0.168, ACC=0.9651, MI=0.08983, FA=0.04962, CF=0.02851, over 0.00 frames. 
2025-02-11 18:13:48,696 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 18:17:39,916 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-52500.pt
2025-02-11 18:17:40,329 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-11 18:26:36,583 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 52868, num_updates: 51500, {'loss': 0.1145683079957962, 'DER': 0.2675967910708057, 'ACC': np.float64(0.945625), 'MI': 0.1386815486571329, 'FA': 0.056644576212068365, 'CF': 0.07227066620160447}, batch size: 64, grad_norm: 0.18471695482730865, grad_scale: , lr: 0.00e+00, 
2025-02-11 18:26:36,583 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 18:26:36,585 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 52868, num_updates: 51500, {'loss': 0.09593304246664047, 'DER': 0.250595009596929, 'ACC': np.float64(0.9557924107142857), 'MI': 0.13305182341650673, 'FA': 0.06403071017274473, 'CF': 0.05351247600767754}, batch size: 64, grad_norm: 0.18471695482730865, grad_scale: , lr: 0.00e+00, 
2025-02-11 18:26:36,585 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 18:27:25,336 (model:925) WARNING: All labels are zero
2025-02-11 18:27:25,916 (model:925) WARNING: All labels are zero
2025-02-11 18:27:25,952 (model:925) WARNING: All labels are zero
2025-02-11 18:28:57,299 (model:925) WARNING: All labels are zero
2025-02-11 18:29:09,356 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 52868,  validation: loss=0.07465, DER=0.1682, ACC=0.965, MI=0.09026, FA=0.04935, CF=0.02861, over 0.00 frames. 
2025-02-11 18:29:09,356 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 18:29:09,372 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 52868,  validation: loss=0.07327, DER=0.1686, ACC=0.9658, MI=0.08929, FA=0.0522, CF=0.02706, over 0.00 frames. 
2025-02-11 18:29:09,372 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 18:40:56,249 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 53368, num_updates: 52000, {'loss': 0.11280599236488342, 'DER': 0.2625250501002004, 'ACC': np.float64(0.948359375), 'MI': 0.1121528771829373, 'FA': 0.0817348983681649, 'CF': 0.0686372745490982}, batch size: 64, grad_norm: 0.1656658947467804, grad_scale: , lr: 0.00e+00, 
2025-02-11 18:40:56,250 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 18:40:56,251 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 53368, num_updates: 52000, {'loss': 0.0972612202167511, 'DER': 0.20886162235855488, 'ACC': np.float64(0.9599107142857143), 'MI': 0.1296523517382413, 'FA': 0.04321745057941377, 'CF': 0.0359918200408998}, batch size: 64, grad_norm: 0.1656658947467804, grad_scale: , lr: 0.00e+00, 
2025-02-11 18:40:56,251 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 18:41:44,851 (model:925) WARNING: All labels are zero
2025-02-11 18:41:45,432 (model:925) WARNING: All labels are zero
2025-02-11 18:41:45,444 (model:925) WARNING: All labels are zero
2025-02-11 18:43:16,833 (model:925) WARNING: All labels are zero
2025-02-11 18:43:28,882 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 53368,  validation: loss=0.07461, DER=0.1683, ACC=0.965, MI=0.0904, FA=0.04935, CF=0.0286, over 0.00 frames. 
2025-02-11 18:43:28,883 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 18:43:28,917 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 53368,  validation: loss=0.07321, DER=0.1681, ACC=0.9659, MI=0.08934, FA=0.052, CF=0.02681, over 0.00 frames. 
2025-02-11 18:43:28,917 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 18:46:07,020 (train_accelerate_ddp:713) INFO: end of epoch 13, batch_idx: 4113 batch_idx_train: 53481, {'loss': 0.10697463899850845, 'DER': 0.2504316492755799, 'ACC': np.float64(0.9547544642857143), 'MI': 0.1180842279108175, 'FA': 0.07844756399669695, 'CF': 0.05389985736806546}, batch size: 64, grad_norm: 0.1305113434791565, grad_scale: , lr: 0.00e+00, 
2025-02-11 18:46:07,021 (train_accelerate_ddp:713) INFO: end of epoch 13, batch_idx: 4113 batch_idx_train: 53481, {'loss': 0.10813484340906143, 'DER': 0.23300714096799788, 'ACC': np.float64(0.9531026785714286), 'MI': 0.13819095477386933, 'FA': 0.0499867759851891, 'CF': 0.044829410208939435}, batch size: 64, grad_norm: 0.1305113434791565, grad_scale: , lr: 0.00e+00, 
2025-02-11 18:46:07,023 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-13.pt
2025-02-11 18:46:07,354 (train_accelerate_ddp:561) INFO:  end of epoch 13, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-13.pt 
2025-02-11 18:46:10,177 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 53482, num_updates: 52000, {'loss': 0.09373833984136581, 'DER': 0.22607772697583278, 'ACC': np.float64(0.9630580357142857), 'MI': 0.10997713912475507, 'FA': 0.0719301110385369, 'CF': 0.04417047681254082}, batch size: 64, grad_norm: 0.19007937610149384, grad_scale: , lr: 0.00e+00, 
2025-02-11 18:46:10,180 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 53482, num_updates: 52000, {'loss': 0.10609424859285355, 'DER': 0.21939456892714052, 'ACC': np.float64(0.9605022321428571), 'MI': 0.12605727852797152, 'FA': 0.05015580946728001, 'CF': 0.043181480931889005}, batch size: 64, grad_norm: 0.19007937610149384, grad_scale: , lr: 0.00e+00, 
2025-02-11 18:57:55,698 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 53982, num_updates: 52500, {'loss': 0.1016441360116005, 'DER': 0.2456063907044299, 'ACC': np.float64(0.952890625), 'MI': 0.12287581699346405, 'FA': 0.06180101670297749, 'CF': 0.06092955700798838}, batch size: 64, grad_norm: 0.27971410751342773, grad_scale: , lr: 0.00e+00, 
2025-02-11 18:57:55,698 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 18:57:55,700 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 53982, num_updates: 52500, {'loss': 0.13051366806030273, 'DER': 0.2779092568801136, 'ACC': np.float64(0.9412756737438154), 'MI': 0.14781256339171006, 'FA': 0.05247143146933532, 'CF': 0.07762526201906822}, batch size: 64, grad_norm: 0.27971410751342773, grad_scale: , lr: 0.00e+00, 
2025-02-11 18:57:55,700 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 18:58:44,072 (model:925) WARNING: All labels are zero
2025-02-11 18:58:44,654 (model:925) WARNING: All labels are zero
2025-02-11 18:58:44,666 (model:925) WARNING: All labels are zero
2025-02-11 19:00:15,856 (model:925) WARNING: All labels are zero
2025-02-11 19:00:27,871 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 53982,  validation: loss=0.0747, DER=0.1684, ACC=0.9649, MI=0.09017, FA=0.0494, CF=0.02882, over 0.00 frames. 
2025-02-11 19:00:27,871 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 19:00:27,902 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 53982,  validation: loss=0.07329, DER=0.1685, ACC=0.9658, MI=0.08885, FA=0.0524, CF=0.0272, over 0.00 frames. 
2025-02-11 19:00:27,902 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 19:00:51,419 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-54000.pt
2025-02-11 19:00:51,896 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-11 19:00:51,917 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-11 19:12:22,909 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 54482, num_updates: 53000, {'loss': 0.08590984344482422, 'DER': 0.18649683404505965, 'ACC': np.float64(0.964877232142857), 'MI': 0.1076424679723163, 'FA': 0.033647474598733615, 'CF': 0.04520689147400972}, batch size: 64, grad_norm: 0.18990863859653473, grad_scale: , lr: 0.00e+00, 
2025-02-11 19:12:22,909 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 19:12:22,911 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 54482, num_updates: 53000, {'loss': 0.11769171059131622, 'DER': 0.24960493641357515, 'ACC': np.float64(0.9500334821428571), 'MI': 0.09737376777786139, 'FA': 0.06494092858755361, 'CF': 0.08729024004816013}, batch size: 64, grad_norm: 0.18990863859653473, grad_scale: , lr: 0.00e+00, 
2025-02-11 19:12:22,911 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 19:13:12,622 (model:925) WARNING: All labels are zero
2025-02-11 19:13:12,679 (model:925) WARNING: All labels are zero
2025-02-11 19:13:13,208 (model:925) WARNING: All labels are zero
2025-02-11 19:14:42,581 (model:925) WARNING: All labels are zero
2025-02-11 19:14:54,298 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 54482,  validation: loss=0.07326, DER=0.1685, ACC=0.9658, MI=0.08892, FA=0.05274, CF=0.02681, over 0.00 frames. 
2025-02-11 19:14:54,299 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 19:14:54,596 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 54482,  validation: loss=0.07467, DER=0.1685, ACC=0.9649, MI=0.08994, FA=0.05004, CF=0.02857, over 0.00 frames. 
2025-02-11 19:14:54,596 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 19:27:19,334 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 54982, num_updates: 53500, {'loss': 0.10056101530790329, 'DER': 0.23119777158774374, 'ACC': np.float64(0.9553571428571429), 'MI': 0.12924791086350976, 'FA': 0.05459610027855153, 'CF': 0.04735376044568245}, batch size: 64, grad_norm: 0.1599666178226471, grad_scale: , lr: 0.00e+00, 
2025-02-11 19:27:19,335 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 19:27:19,337 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 54982, num_updates: 53500, {'loss': 0.10994312167167664, 'DER': 0.24495519529379575, 'ACC': np.float64(0.953515625), 'MI': 0.15035228127778918, 'FA': 0.05465490115602983, 'CF': 0.03994801285997674}, batch size: 64, grad_norm: 0.1599666178226471, grad_scale: , lr: 0.00e+00, 
2025-02-11 19:27:19,337 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 19:28:08,145 (model:925) WARNING: All labels are zero
2025-02-11 19:28:08,643 (model:925) WARNING: All labels are zero
2025-02-11 19:28:08,729 (model:925) WARNING: All labels are zero
2025-02-11 19:29:37,272 (model:925) WARNING: All labels are zero
2025-02-11 19:29:49,014 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 54982,  validation: loss=0.07272, DER=0.1674, ACC=0.966, MI=0.0876, FA=0.05307, CF=0.02671, over 0.00 frames. 
2025-02-11 19:29:49,014 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 19:29:49,453 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 54982,  validation: loss=0.07419, DER=0.1672, ACC=0.9651, MI=0.08865, FA=0.05005, CF=0.02853, over 0.00 frames. 
2025-02-11 19:29:49,453 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 19:41:33,335 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 55482, num_updates: 54000, {'loss': 0.1104818657040596, 'DER': 0.22425970323333116, 'ACC': np.float64(0.95609375), 'MI': 0.1473465949588544, 'FA': 0.04626449815330785, 'CF': 0.030648610121168925}, batch size: 64, grad_norm: 0.17412900924682617, grad_scale: , lr: 0.00e+00, 
2025-02-11 19:41:33,335 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 19:41:33,337 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 55482, num_updates: 54000, {'loss': 0.11820480227470398, 'DER': 0.25522759362603376, 'ACC': np.float64(0.9489397321428571), 'MI': 0.15296174275532845, 'FA': 0.049889060714045586, 'CF': 0.05237679015665972}, batch size: 64, grad_norm: 0.17412900924682617, grad_scale: , lr: 0.00e+00, 
2025-02-11 19:41:33,337 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 19:42:22,311 (model:925) WARNING: All labels are zero
2025-02-11 19:42:22,868 (model:925) WARNING: All labels are zero
2025-02-11 19:42:22,914 (model:925) WARNING: All labels are zero
2025-02-11 19:43:53,730 (model:925) WARNING: All labels are zero
2025-02-11 19:44:05,570 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 55482,  validation: loss=0.07438, DER=0.1681, ACC=0.965, MI=0.09284, FA=0.04707, CF=0.02818, over 0.00 frames. 
2025-02-11 19:44:05,570 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 19:44:05,613 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 55482,  validation: loss=0.07296, DER=0.1686, ACC=0.9659, MI=0.09194, FA=0.05014, CF=0.02651, over 0.00 frames. 
2025-02-11 19:44:05,614 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 19:44:30,021 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-55500.pt
2025-02-11 19:44:30,415 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-11 19:55:53,761 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 55982, num_updates: 54500, {'loss': 0.10402511060237885, 'DER': 0.2502428454008817, 'ACC': np.float64(0.9526576768605981), 'MI': 0.1244862885750579, 'FA': 0.06067398938952402, 'CF': 0.06508256743629978}, batch size: 64, grad_norm: 0.1301683485507965, grad_scale: , lr: 0.00e+00, 
2025-02-11 19:55:53,761 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 19:55:53,763 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 55982, num_updates: 54500, {'loss': 0.09362207353115082, 'DER': 0.22770236656954018, 'ACC': np.float64(0.9586495535714286), 'MI': 0.13097860848553763, 'FA': 0.06111861274962689, 'CF': 0.035605145334375664}, batch size: 64, grad_norm: 0.1301683485507965, grad_scale: , lr: 0.00e+00, 
2025-02-11 19:55:53,764 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 19:56:42,130 (model:925) WARNING: All labels are zero
2025-02-11 19:56:42,338 (model:925) WARNING: All labels are zero
2025-02-11 19:56:42,698 (model:925) WARNING: All labels are zero
2025-02-11 19:58:11,143 (model:925) WARNING: All labels are zero
2025-02-11 19:58:23,026 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 55982,  validation: loss=0.07323, DER=0.1687, ACC=0.9658, MI=0.09066, FA=0.05116, CF=0.02687, over 0.00 frames. 
2025-02-11 19:58:23,026 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 19:58:24,150 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 55982,  validation: loss=0.07469, DER=0.169, ACC=0.9649, MI=0.09179, FA=0.04866, CF=0.02858, over 0.00 frames. 
2025-02-11 19:58:24,151 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 20:10:25,137 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 56482, num_updates: 55000, {'loss': 0.10655871778726578, 'DER': 0.2368438739162578, 'ACC': np.float64(0.9527455357142857), 'MI': 0.14160897909805767, 'FA': 0.04751663418240473, 'CF': 0.047718260635795415}, batch size: 64, grad_norm: 0.1473878026008606, grad_scale: , lr: 0.00e+00, 
2025-02-11 20:10:25,138 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 20:10:25,140 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 56482, num_updates: 55000, {'loss': 0.10020650923252106, 'DER': 0.27222615954012125, 'ACC': np.float64(0.955435267857143), 'MI': 0.11733207339160563, 'FA': 0.11268603827072998, 'CF': 0.042208047877785655}, batch size: 64, grad_norm: 0.1473878026008606, grad_scale: , lr: 0.00e+00, 
2025-02-11 20:10:25,140 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 20:11:14,834 (model:925) WARNING: All labels are zero
2025-02-11 20:11:15,322 (model:925) WARNING: All labels are zero
2025-02-11 20:11:15,419 (model:925) WARNING: All labels are zero
2025-02-11 20:12:46,424 (model:925) WARNING: All labels are zero
2025-02-11 20:12:58,435 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 56482,  validation: loss=0.07291, DER=0.1685, ACC=0.966, MI=0.09126, FA=0.051, CF=0.02622, over 0.00 frames. 
2025-02-11 20:12:58,435 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 20:12:58,557 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 56482,  validation: loss=0.07441, DER=0.1683, ACC=0.9651, MI=0.09206, FA=0.04803, CF=0.0282, over 0.00 frames. 
2025-02-11 20:12:58,558 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 20:25:09,086 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 56982, num_updates: 55500, {'loss': 0.07232800126075745, 'DER': 0.1603953147877013, 'ACC': np.float64(0.9721428571428571), 'MI': 0.08045387994143485, 'FA': 0.05761346998535871, 'CF': 0.02232796486090776}, batch size: 64, grad_norm: 0.11298855394124985, grad_scale: , lr: 0.00e+00, 
2025-02-11 20:25:09,086 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 56982, num_updates: 55500, {'loss': 0.08836544305086136, 'DER': 0.20199956213967743, 'ACC': np.float64(0.9631473214285714), 'MI': 0.10413778004816464, 'FA': 0.058892213383930525, 'CF': 0.03896956870758228}, batch size: 64, grad_norm: 0.11298855394124985, grad_scale: , lr: 0.00e+00, 
2025-02-11 20:25:09,086 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 20:25:09,086 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 20:25:57,710 (model:925) WARNING: All labels are zero
2025-02-11 20:25:58,010 (model:925) WARNING: All labels are zero
2025-02-11 20:25:58,287 (model:925) WARNING: All labels are zero
2025-02-11 20:27:25,555 (model:925) WARNING: All labels are zero
2025-02-11 20:27:37,054 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 56982,  validation: loss=0.07335, DER=0.1684, ACC=0.9659, MI=0.08834, FA=0.05337, CF=0.02673, over 0.00 frames. 
2025-02-11 20:27:37,054 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 20:27:38,430 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 56982,  validation: loss=0.07473, DER=0.1686, ACC=0.965, MI=0.08958, FA=0.05054, CF=0.02843, over 0.00 frames. 
2025-02-11 20:27:38,430 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 20:28:02,111 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-57000.pt
2025-02-11 20:28:02,508 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-11 20:39:32,482 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 57482, num_updates: 56000, {'loss': 0.10743565112352371, 'DER': 0.2647250126472501, 'ACC': np.float64(0.95328125), 'MI': 0.17684469176844692, 'FA': 0.050083110500831106, 'CF': 0.0377972103779721}, batch size: 64, grad_norm: 0.16534118354320526, grad_scale: , lr: 0.00e+00, 
2025-02-11 20:39:32,483 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 20:39:32,484 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 57482, num_updates: 56000, {'loss': 0.08941807597875595, 'DER': 0.20984133947503109, 'ACC': np.float64(0.9632254464285714), 'MI': 0.11493748629085326, 'FA': 0.06382978723404255, 'CF': 0.031074065950135264}, batch size: 64, grad_norm: 0.16534118354320526, grad_scale: , lr: 0.00e+00, 
2025-02-11 20:39:32,484 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 20:40:21,410 (model:925) WARNING: All labels are zero
2025-02-11 20:40:21,990 (model:925) WARNING: All labels are zero
2025-02-11 20:40:22,058 (model:925) WARNING: All labels are zero
2025-02-11 20:41:51,385 (model:925) WARNING: All labels are zero
2025-02-11 20:42:02,522 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 57482,  validation: loss=0.07422, DER=0.1677, ACC=0.9651, MI=0.09241, FA=0.04717, CF=0.02811, over 0.00 frames. 
2025-02-11 20:42:02,523 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 20:42:03,169 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 57482,  validation: loss=0.07278, DER=0.1673, ACC=0.9661, MI=0.0911, FA=0.04988, CF=0.02637, over 0.00 frames. 
2025-02-11 20:42:03,170 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 20:44:40,553 (train_accelerate_ddp:713) INFO: end of epoch 14, batch_idx: 4113 batch_idx_train: 57595, {'loss': 0.11271290481090546, 'DER': 0.26762429398228854, 'ACC': np.float64(0.9497544642857143), 'MI': 0.1773237570601771, 'FA': 0.043999721079422634, 'CF': 0.046300815842688796}, batch size: 64, grad_norm: 0.18277674913406372, grad_scale: , lr: 0.00e+00, 
2025-02-11 20:44:40,555 (train_accelerate_ddp:713) INFO: end of epoch 14, batch_idx: 4113 batch_idx_train: 57595, {'loss': 0.10120174288749695, 'DER': 0.24306273356126262, 'ACC': np.float64(0.9580580357142857), 'MI': 0.10185258805756539, 'FA': 0.08547348334260953, 'CF': 0.0557366621610877}, batch size: 64, grad_norm: 0.18277674913406372, grad_scale: , lr: 0.00e+00, 
2025-02-11 20:44:40,555 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-14.pt
2025-02-11 20:44:40,877 (train_accelerate_ddp:561) INFO:  end of epoch 14, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-14.pt 
2025-02-11 20:44:43,388 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 57596, num_updates: 56000, {'loss': 0.10665956139564514, 'DER': 0.2469492382121453, 'ACC': np.float64(0.9547991071428571), 'MI': 0.14824175030688136, 'FA': 0.05321683876092136, 'CF': 0.04549064914434255}, batch size: 64, grad_norm: 0.1575799435377121, grad_scale: , lr: 0.00e+00, 
2025-02-11 20:44:43,390 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 57596, num_updates: 56000, {'loss': 0.11156502366065979, 'DER': 0.26469370860927155, 'ACC': np.float64(0.948125), 'MI': 0.1564569536423841, 'FA': 0.05229028697571744, 'CF': 0.05594646799116998}, batch size: 64, grad_norm: 0.1575799435377121, grad_scale: , lr: 0.00e+00, 
2025-02-11 20:56:29,444 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 58096, num_updates: 56500, {'loss': 0.11670492589473724, 'DER': 0.2721703825058765, 'ACC': np.float64(0.950044642857143), 'MI': 0.17102357717786168, 'FA': 0.054491060616853056, 'CF': 0.04665574471116176}, batch size: 64, grad_norm: 0.1996966004371643, grad_scale: , lr: 0.00e+00, 
2025-02-11 20:56:29,445 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 20:56:29,446 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 58096, num_updates: 56500, {'loss': 0.10232524573802948, 'DER': 0.21875211706523948, 'ACC': np.float64(0.9583370535714286), 'MI': 0.13413725357360612, 'FA': 0.05047083530926089, 'CF': 0.03414402818237247}, batch size: 64, grad_norm: 0.1996966004371643, grad_scale: , lr: 0.00e+00, 
2025-02-11 20:56:29,446 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 20:57:17,757 (model:925) WARNING: All labels are zero
2025-02-11 20:57:18,210 (model:925) WARNING: All labels are zero
2025-02-11 20:57:18,348 (model:925) WARNING: All labels are zero
2025-02-11 20:58:46,710 (model:925) WARNING: All labels are zero
2025-02-11 20:58:58,393 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 58096,  validation: loss=0.07291, DER=0.1677, ACC=0.9661, MI=0.08935, FA=0.05215, CF=0.02618, over 0.00 frames. 
2025-02-11 20:58:58,393 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 20:58:58,786 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 58096,  validation: loss=0.07446, DER=0.1677, ACC=0.9651, MI=0.09018, FA=0.04957, CF=0.02798, over 0.00 frames. 
2025-02-11 20:58:58,787 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 21:09:04,166 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-58500.pt
2025-02-11 21:09:04,585 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-11 21:09:04,587 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-11 21:11:24,952 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 58596, num_updates: 57000, {'loss': 0.12383084744215012, 'DER': 0.28003951174768926, 'ACC': np.float64(0.9452455357142857), 'MI': 0.15938756791081635, 'FA': 0.054540323149650745, 'CF': 0.06611162068722218}, batch size: 64, grad_norm: 0.18253245949745178, grad_scale: , lr: 0.00e+00, 
2025-02-11 21:11:24,952 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 21:11:24,954 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 58596, num_updates: 57000, {'loss': 0.08839351683855057, 'DER': 0.17379511788024202, 'ACC': np.float64(0.967265625), 'MI': 0.0935391890952083, 'FA': 0.05007302315877321, 'CF': 0.03018290562626052}, batch size: 64, grad_norm: 0.18253245949745178, grad_scale: , lr: 0.00e+00, 
2025-02-11 21:11:24,954 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 21:12:13,192 (model:925) WARNING: All labels are zero
2025-02-11 21:12:13,645 (model:925) WARNING: All labels are zero
2025-02-11 21:12:13,763 (model:925) WARNING: All labels are zero
2025-02-11 21:13:42,607 (model:925) WARNING: All labels are zero
2025-02-11 21:13:54,399 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 58596,  validation: loss=0.07297, DER=0.1681, ACC=0.966, MI=0.08967, FA=0.05187, CF=0.02658, over 0.00 frames. 
2025-02-11 21:13:54,399 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 21:13:54,473 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 58596,  validation: loss=0.07436, DER=0.1682, ACC=0.9651, MI=0.09073, FA=0.04903, CF=0.02841, over 0.00 frames. 
2025-02-11 21:13:54,473 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 21:25:47,108 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 59096, num_updates: 57500, {'loss': 0.11597027629613876, 'DER': 0.27276059228852073, 'ACC': np.float64(0.9508816964285713), 'MI': 0.1510775546107609, 'FA': 0.0718369740507257, 'CF': 0.04984606362703416}, batch size: 64, grad_norm: 0.16231942176818848, grad_scale: , lr: 0.00e+00, 
2025-02-11 21:25:47,109 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 21:25:47,110 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 59096, num_updates: 57500, {'loss': 0.11336909979581833, 'DER': 0.23478372646056944, 'ACC': np.float64(0.9511160714285714), 'MI': 0.1476958673436596, 'FA': 0.04036249116267112, 'CF': 0.046725367954238706}, batch size: 64, grad_norm: 0.16231942176818848, grad_scale: , lr: 0.00e+00, 
2025-02-11 21:25:47,110 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 21:26:35,625 (model:925) WARNING: All labels are zero
2025-02-11 21:26:36,190 (model:925) WARNING: All labels are zero
2025-02-11 21:26:36,204 (model:925) WARNING: All labels are zero
2025-02-11 21:28:05,759 (model:925) WARNING: All labels are zero
2025-02-11 21:28:17,539 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 59096,  validation: loss=0.0728, DER=0.1677, ACC=0.966, MI=0.09039, FA=0.05091, CF=0.02641, over 0.00 frames. 
2025-02-11 21:28:17,540 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 21:28:17,560 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 59096,  validation: loss=0.07417, DER=0.1679, ACC=0.9651, MI=0.09134, FA=0.04831, CF=0.02822, over 0.00 frames. 
2025-02-11 21:28:17,561 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 21:40:06,142 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 59596, num_updates: 58000, {'loss': 0.09510818123817444, 'DER': 0.22318881916714203, 'ACC': np.float64(0.9596428571428571), 'MI': 0.12842270393610952, 'FA': 0.06011123787792356, 'CF': 0.03465487735310896}, batch size: 64, grad_norm: 0.13768357038497925, grad_scale: , lr: 0.00e+00, 
2025-02-11 21:40:06,143 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 21:40:06,144 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 59596, num_updates: 58000, {'loss': 0.08822944760322571, 'DER': 0.2173755262011903, 'ACC': np.float64(0.959252232142857), 'MI': 0.11678037451008855, 'FA': 0.05298301640296124, 'CF': 0.04761213528814051}, batch size: 64, grad_norm: 0.13768357038497925, grad_scale: , lr: 0.00e+00, 
2025-02-11 21:40:06,144 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 21:40:55,041 (model:925) WARNING: All labels are zero
2025-02-11 21:40:55,621 (model:925) WARNING: All labels are zero
2025-02-11 21:40:55,622 (model:925) WARNING: All labels are zero
2025-02-11 21:42:26,059 (model:925) WARNING: All labels are zero
2025-02-11 21:42:36,998 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 59596,  validation: loss=0.0744, DER=0.1684, ACC=0.965, MI=0.08996, FA=0.04981, CF=0.0286, over 0.00 frames. 
2025-02-11 21:42:36,998 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 21:42:37,775 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 59596,  validation: loss=0.07309, DER=0.1684, ACC=0.9659, MI=0.08899, FA=0.05258, CF=0.02686, over 0.00 frames. 
2025-02-11 21:42:37,775 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 21:52:08,912 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-60000.pt
2025-02-11 21:52:09,305 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-11 21:54:25,951 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 60096, num_updates: 58500, {'loss': 0.10955815017223358, 'DER': 0.2313057233247052, 'ACC': np.float64(0.9546316964285714), 'MI': 0.11123094621800403, 'FA': 0.05910267471958585, 'CF': 0.060972102387115326}, batch size: 64, grad_norm: 0.17692609131336212, grad_scale: , lr: 0.00e+00, 
2025-02-11 21:54:25,952 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 21:54:25,953 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 60096, num_updates: 58500, {'loss': 0.09347731620073318, 'DER': 0.23963963963963963, 'ACC': np.float64(0.9591515219715298), 'MI': 0.11335683509596553, 'FA': 0.08155111633372503, 'CF': 0.04473168820994908}, batch size: 64, grad_norm: 0.17692609131336212, grad_scale: , lr: 0.00e+00, 
2025-02-11 21:54:25,953 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-11 21:55:14,856 (model:925) WARNING: All labels are zero
2025-02-11 21:55:15,323 (model:925) WARNING: All labels are zero
2025-02-11 21:55:15,428 (model:925) WARNING: All labels are zero
2025-02-11 21:56:45,366 (model:925) WARNING: All labels are zero
2025-02-11 21:56:57,323 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 60096,  validation: loss=0.07306, DER=0.1681, ACC=0.966, MI=0.09115, FA=0.05049, CF=0.02643, over 0.00 frames. 
2025-02-11 21:56:57,323 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
2025-02-11 21:56:57,355 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 60096,  validation: loss=0.07446, DER=0.1681, ACC=0.9651, MI=0.0921, FA=0.04775, CF=0.02823, over 0.00 frames. 
2025-02-11 21:56:57,355 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12491MB
slurmstepd: error: *** JOB 219230 ON pgpu23 CANCELLED AT 2025-02-11T22:00:02 ***
