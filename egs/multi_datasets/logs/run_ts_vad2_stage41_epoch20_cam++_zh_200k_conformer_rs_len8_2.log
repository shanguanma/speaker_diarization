2025-02-13 17:08:01,524 (train_accelerate_ddp:857) INFO: params: {'best_train_loss': inf, 'best_valid_loss': inf, 'best_train_der': inf, 'best_valid_der': inf, 'best_train_epoch': -1, 'best_valid_epoch': -1, 'batch_idx_train': 0, 'log_interval': 500, 'reset_interval': 200, 'valid_interval': 500, 'batch_size': 64, 'verbose': 1, 'world_size': 2, 'tensorboard': True, 'num_epochs': 20, 'max_updates': 40000, 'warmup_updates': 4000, 'freeze_updates': 4000, 'start_batch': 0, 'start_epoch': 14, 'seed': 1337, 'exp_dir': PosixPath('/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8'), 'save_every_n': 1500, 'keep_last_k': 1, 'keep_last_epoch': 1, 'grad_clip': True, 'feature_grad_mult': 0.1, 'lr': 0.0002, 'average_period': 200, 'train_on_average': False, 'musan_path': '/mntcephfs/lee_dataset/asr/musan', 'rir_path': '/mntcephfs/lee_dataset/asr/RIRS_NOISES', 'spk_path': '/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/data/alimeeting_ami_aishell_4', 'speaker_embedding_name_dir': 'cam++_zh-cn_200k_feature_dir', 'data_dir': '/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/data/alimeeting_ami_aishell_4', 'dataset_name': 'alimeeting_ami_aishell_4', 'max_num_speaker': 7, 'speech_encoder_path': '/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/zh/modelscope/speech_campplus_sv_zh-cn_16k-common/campplus_cn_common.bin', 'select_encoder_layer_nums': 6, 'wavlm_fuse_feat_post_norm': False, 'speech_encoder_config': '/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/wav-bert2.0/config.json', 'num_transformer_layer': 2, 'd_state': 256, 'expand': 4, 'speech_encoder_type': 'CAM++', 'speaker_embed_dim': 192, 'rs_len': 8, 'segment_shift': 2, 'single_backend_type': 'conformer', 'multi_backend_type': 'transformer', 'do_finetune': False, 'init_modules': None, 'finetune_ckpt': None}
2025-02-13 17:08:01,524 (train_accelerate_ddp:857) INFO: params: {'best_train_loss': inf, 'best_valid_loss': inf, 'best_train_der': inf, 'best_valid_der': inf, 'best_train_epoch': -1, 'best_valid_epoch': -1, 'batch_idx_train': 0, 'log_interval': 500, 'reset_interval': 200, 'valid_interval': 500, 'batch_size': 64, 'verbose': 1, 'world_size': 2, 'tensorboard': True, 'num_epochs': 20, 'max_updates': 40000, 'warmup_updates': 4000, 'freeze_updates': 4000, 'start_batch': 0, 'start_epoch': 14, 'seed': 1337, 'exp_dir': PosixPath('/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8'), 'save_every_n': 1500, 'keep_last_k': 1, 'keep_last_epoch': 1, 'grad_clip': True, 'feature_grad_mult': 0.1, 'lr': 0.0002, 'average_period': 200, 'train_on_average': False, 'musan_path': '/mntcephfs/lee_dataset/asr/musan', 'rir_path': '/mntcephfs/lee_dataset/asr/RIRS_NOISES', 'spk_path': '/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/data/alimeeting_ami_aishell_4', 'speaker_embedding_name_dir': 'cam++_zh-cn_200k_feature_dir', 'data_dir': '/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/data/alimeeting_ami_aishell_4', 'dataset_name': 'alimeeting_ami_aishell_4', 'max_num_speaker': 7, 'speech_encoder_path': '/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/zh/modelscope/speech_campplus_sv_zh-cn_16k-common/campplus_cn_common.bin', 'select_encoder_layer_nums': 6, 'wavlm_fuse_feat_post_norm': False, 'speech_encoder_config': '/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/wav-bert2.0/config.json', 'num_transformer_layer': 2, 'd_state': 256, 'expand': 4, 'speech_encoder_type': 'CAM++', 'speaker_embed_dim': 192, 'rs_len': 8, 'segment_shift': 2, 'single_backend_type': 'conformer', 'multi_backend_type': 'transformer', 'do_finetune': False, 'init_modules': None, 'finetune_ckpt': None}
2025-02-13 17:08:01,528 (train_accelerate_ddp:873) INFO: data_cfg: TSVADDataConfig(data_dir='/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/data/alimeeting_ami_aishell_4', ts_len=6000, rs_len=8, segment_shift=2, spk_path='/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/data/alimeeting_ami_aishell_4', speech_encoder_type='CAM++', speaker_embedding_name_dir='cam++_zh-cn_200k_feature_dir', speaker_embed_dim=192, noise_ratio=0.8, zero_ratio=0.3, sample_rate=16000, max_num_speaker=7, dataset_name='alimeeting', embed_input=False, embed_len=1, embed_shift=0.4, label_rate=25, random_channel=False, random_mask_speaker_prob=0.0, random_mask_speaker_step=0, musan_path='/mntcephfs/lee_dataset/asr/musan', rir_path='/mntcephfs/lee_dataset/asr/RIRS_NOISES')
2025-02-13 17:08:01,528 (train_accelerate_ddp:873) INFO: data_cfg: TSVADDataConfig(data_dir='/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/data/alimeeting_ami_aishell_4', ts_len=6000, rs_len=8, segment_shift=2, spk_path='/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/data/alimeeting_ami_aishell_4', speech_encoder_type='CAM++', speaker_embedding_name_dir='cam++_zh-cn_200k_feature_dir', speaker_embed_dim=192, noise_ratio=0.8, zero_ratio=0.3, sample_rate=16000, max_num_speaker=7, dataset_name='alimeeting', embed_input=False, embed_len=1, embed_shift=0.4, label_rate=25, random_channel=False, random_mask_speaker_prob=0.0, random_mask_speaker_step=0, musan_path='/mntcephfs/lee_dataset/asr/musan', rir_path='/mntcephfs/lee_dataset/asr/RIRS_NOISES')
  0%|          | 0/145 [00:00<?, ?it/s] 15%|█▌        | 22/145 [00:00<00:00, 215.98it/s]  0%|          | 0/145 [00:00<?, ?it/s] 42%|████▏     | 61/145 [00:00<00:00, 314.45it/s] 28%|██▊       | 41/145 [00:00<00:00, 405.80it/s] 72%|███████▏  | 105/145 [00:00<00:00, 369.45it/s] 59%|█████▉    | 86/145 [00:00<00:00, 430.43it/s]100%|██████████| 145/145 [00:00<00:00, 374.25it/s]
2025-02-13 17:08:01,992 (ts_vad_dataset:152) INFO: model expect fbank as input , fbank_input should be True !!!
2025-02-13 17:08:01,993 (ts_vad_dataset:160) INFO: loaded sentence=35332, shortest sent=640.0, longest sent=128000.0, rs_len=8, segment_shift=2,  rir=False, musan=False, noise_ratio=0.8, zero_ratio=0.3 
 94%|█████████▍| 137/145 [00:00<00:00, 464.74it/s]100%|██████████| 145/145 [00:00<00:00, 453.75it/s]
2025-02-13 17:08:02,061 (ts_vad_dataset:152) INFO: model expect fbank as input , fbank_input should be True !!!
2025-02-13 17:08:02,061 (ts_vad_dataset:160) INFO: loaded sentence=35332, shortest sent=640.0, longest sent=128000.0, rs_len=8, segment_shift=2,  rir=False, musan=False, noise_ratio=0.8, zero_ratio=0.3 
  0%|          | 0/2080 [00:00<?, ?it/s]  0%|          | 0/2080 [00:00<?, ?it/s]  1%|          | 17/2080 [00:00<00:12, 168.62it/s]  1%|▏         | 28/2080 [00:00<00:15, 132.84it/s]  2%|▏         | 34/2080 [00:00<00:19, 105.57it/s]  2%|▎         | 52/2080 [00:00<00:11, 175.72it/s]  3%|▎         | 55/2080 [00:00<00:14, 140.21it/s]  4%|▎         | 75/2080 [00:00<00:10, 192.51it/s]  4%|▎         | 77/2080 [00:00<00:12, 165.88it/s]  5%|▍         | 100/2080 [00:00<00:09, 211.70it/s]  5%|▍         | 103/2080 [00:00<00:10, 193.79it/s]  6%|▌         | 128/2080 [00:00<00:08, 232.85it/s]  6%|▋         | 131/2080 [00:00<00:08, 218.43it/s]  7%|▋         | 153/2080 [00:00<00:12, 156.87it/s]  7%|▋         | 154/2080 [00:00<00:12, 150.01it/s]  9%|▊         | 179/2080 [00:00<00:10, 179.94it/s]  9%|▊         | 181/2080 [00:01<00:10, 175.15it/s] 10%|▉         | 204/2080 [00:01<00:09, 194.93it/s] 10%|▉         | 206/2080 [00:01<00:09, 187.40it/s] 11%|█         | 230/2080 [00:01<00:08, 209.67it/s] 11%|█▏        | 235/2080 [00:01<00:08, 212.79it/s] 12%|█▏        | 257/2080 [00:01<00:08, 224.05it/s] 13%|█▎        | 261/2080 [00:01<00:08, 224.66it/s] 14%|█▎        | 283/2080 [00:01<00:07, 233.90it/s] 14%|█▍        | 288/2080 [00:01<00:07, 234.72it/s] 15%|█▍        | 308/2080 [00:01<00:11, 158.24it/s] 15%|█▌        | 313/2080 [00:01<00:11, 157.53it/s] 16%|█▌        | 335/2080 [00:01<00:09, 181.29it/s] 16%|█▋        | 342/2080 [00:01<00:09, 183.18it/s] 17%|█▋        | 363/2080 [00:01<00:08, 203.19it/s] 18%|█▊        | 369/2080 [00:01<00:08, 201.31it/s] 19%|█▉        | 390/2080 [00:01<00:07, 217.01it/s] 19%|█▉        | 399/2080 [00:02<00:07, 224.78it/s] 20%|██        | 417/2080 [00:02<00:07, 230.61it/s] 20%|██        | 426/2080 [00:02<00:07, 235.17it/s] 21%|██▏       | 443/2080 [00:02<00:06, 236.01it/s] 22%|██▏       | 452/2080 [00:02<00:06, 239.46it/s] 23%|██▎       | 480/2080 [00:02<00:05, 271.64it/s] 24%|██▎       | 491/2080 [00:02<00:05, 275.82it/s] 25%|██▍       | 510/2080 [00:02<00:05, 278.62it/s] 25%|██▌       | 520/2080 [00:02<00:05, 275.57it/s] 26%|██▌       | 540/2080 [00:02<00:05, 282.31it/s] 26%|██▋       | 551/2080 [00:02<00:05, 279.78it/s] 27%|██▋       | 571/2080 [00:02<00:05, 288.76it/s] 28%|██▊       | 580/2080 [00:02<00:08, 167.81it/s] 29%|██▉       | 601/2080 [00:02<00:08, 171.95it/s] 30%|██▉       | 615/2080 [00:03<00:07, 201.36it/s] 31%|███       | 635/2080 [00:03<00:07, 204.25it/s] 31%|███▏      | 650/2080 [00:03<00:06, 230.48it/s] 32%|███▏      | 668/2080 [00:03<00:06, 231.70it/s] 33%|███▎      | 680/2080 [00:03<00:05, 246.31it/s] 34%|███▎      | 700/2080 [00:03<00:05, 252.40it/s] 35%|███▍      | 718/2080 [00:03<00:04, 279.25it/s] 36%|███▌      | 739/2080 [00:03<00:04, 287.15it/s] 36%|███▋      | 754/2080 [00:03<00:04, 300.14it/s] 37%|███▋      | 774/2080 [00:03<00:04, 301.92it/s] 38%|███▊      | 793/2080 [00:03<00:03, 324.36it/s] 39%|███▉      | 813/2080 [00:03<00:03, 321.44it/s] 40%|███▉      | 831/2080 [00:03<00:03, 336.16it/s] 41%|████      | 850/2080 [00:03<00:03, 333.26it/s] 42%|████▏     | 867/2080 [00:03<00:03, 338.46it/s] 43%|████▎     | 887/2080 [00:03<00:03, 342.22it/s] 43%|████▎     | 904/2080 [00:03<00:03, 346.31it/s] 44%|████▍     | 923/2080 [00:03<00:03, 343.72it/s] 45%|████▌     | 941/2080 [00:03<00:03, 350.53it/s] 46%|████▋     | 963/2080 [00:03<00:03, 358.10it/s] 47%|████▋     | 983/2080 [00:04<00:02, 367.02it/s] 48%|████▊     | 1000/2080 [00:04<00:03, 359.56it/s] 49%|████▉     | 1021/2080 [00:04<00:02, 355.08it/s] 50%|████▉     | 1037/2080 [00:04<00:02, 360.11it/s] 51%|█████     | 1062/2080 [00:04<00:02, 370.25it/s] 52%|█████▏    | 1079/2080 [00:04<00:02, 375.42it/s] 53%|█████▎    | 1102/2080 [00:04<00:02, 378.12it/s] 54%|█████▍    | 1120/2080 [00:04<00:02, 372.81it/s] 55%|█████▍    | 1141/2080 [00:04<00:02, 371.84it/s] 56%|█████▌    | 1160/2080 [00:04<00:02, 376.38it/s] 57%|█████▋    | 1179/2080 [00:04<00:02, 363.70it/s] 58%|█████▊    | 1198/2080 [00:04<00:02, 370.83it/s] 59%|█████▉    | 1223/2080 [00:04<00:02, 381.24it/s] 60%|█████▉    | 1242/2080 [00:04<00:02, 388.80it/s] 61%|██████    | 1263/2080 [00:04<00:02, 382.88it/s] 62%|██████▏   | 1281/2080 [00:04<00:02, 386.40it/s] 63%|██████▎   | 1306/2080 [00:04<00:01, 395.68it/s] 64%|██████▎   | 1325/2080 [00:04<00:01, 400.89it/s] 65%|██████▌   | 1352/2080 [00:05<00:01, 412.06it/s] 66%|██████▌   | 1369/2080 [00:04<00:01, 411.27it/s] 67%|██████▋   | 1396/2080 [00:05<00:01, 419.16it/s] 68%|██████▊   | 1412/2080 [00:05<00:01, 416.56it/s] 69%|██████▉   | 1438/2080 [00:05<00:01, 416.04it/s] 70%|██████▉   | 1454/2080 [00:05<00:01, 391.22it/s] 71%|███████   | 1480/2080 [00:05<00:01, 384.70it/s] 72%|███████▏  | 1494/2080 [00:05<00:01, 388.53it/s] 73%|███████▎  | 1521/2080 [00:05<00:01, 390.53it/s] 74%|███████▍  | 1539/2080 [00:05<00:01, 404.66it/s] 75%|███████▌  | 1569/2080 [00:05<00:01, 414.44it/s] 76%|███████▋  | 1587/2080 [00:05<00:01, 425.80it/s] 77%|███████▋  | 1611/2080 [00:05<00:01, 413.03it/s] 78%|███████▊  | 1630/2080 [00:05<00:01, 417.24it/s] 80%|███████▉  | 1658/2080 [00:05<00:00, 427.62it/s] 81%|████████  | 1675/2080 [00:05<00:00, 426.18it/s] 82%|████████▏ | 1701/2080 [00:05<00:00, 394.13it/s] 83%|████████▎ | 1718/2080 [00:05<00:00, 395.33it/s] 84%|████████▍ | 1749/2080 [00:06<00:00, 416.03it/s] 85%|████████▌ | 1769/2080 [00:05<00:00, 425.33it/s] 86%|████████▋ | 1795/2080 [00:06<00:00, 416.46it/s] 87%|████████▋ | 1813/2080 [00:06<00:00, 421.72it/s] 89%|████████▊ | 1845/2080 [00:06<00:00, 438.11it/s] 89%|████████▉ | 1857/2080 [00:06<00:00, 425.60it/s] 91%|█████████ | 1890/2080 [00:06<00:00, 437.71it/s] 92%|█████████▏| 1906/2080 [00:06<00:00, 442.66it/s] 93%|█████████▎| 1935/2080 [00:06<00:00, 439.34it/s] 94%|█████████▍| 1951/2080 [00:06<00:00, 435.18it/s] 95%|█████████▌| 1983/2080 [00:06<00:00, 449.10it/s] 96%|█████████▌| 2000/2080 [00:06<00:00, 450.66it/s] 98%|█████████▊| 2031/2080 [00:06<00:00, 456.26it/s] 99%|█████████▊| 2049/2080 [00:06<00:00, 459.73it/s]100%|██████████| 2080/2080 [00:06<00:00, 464.97it/s]100%|██████████| 2080/2080 [00:06<00:00, 309.51it/s]
100%|██████████| 2080/2080 [00:06<00:00, 313.37it/s]
2025-02-13 17:08:09,279 (ts_vad_dataset:152) INFO: model expect fbank as input , fbank_input should be True !!!
2025-02-13 17:08:09,279 (ts_vad_dataset:152) INFO: model expect fbank as input , fbank_input should be True !!!
2025-02-13 17:08:09,290 (ts_vad_dataset:160) INFO: loaded sentence=526485, shortest sent=48640.0, longest sent=128000.0, rs_len=8, segment_shift=2,  rir=True, musan=True, noise_ratio=0.8, zero_ratio=0.3 
2025-02-13 17:08:09,291 (ts_vad_dataset:160) INFO: loaded sentence=526485, shortest sent=48640.0, longest sent=128000.0, rs_len=8, segment_shift=2,  rir=True, musan=True, noise_ratio=0.8, zero_ratio=0.3 
2025-02-13 17:08:09,291 (train_accelerate_ddp:908) INFO: The scale window is set to 8192.
2025-02-13 17:08:09,291 (train_accelerate_ddp:908) INFO: The scale window is set to 8192.
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/accelerate/accelerator.py:494: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  self.scaler = torch.cuda.amp.GradScaler(**kwargs)
2025-02-13 17:08:09,444 (other:349) WARNING: Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
2025-02-13 17:08:09,444 (train_accelerate_ddp:946) INFO: model_cfg: TSVADConfig(speech_encoder_path='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/zh/modelscope/speech_campplus_sv_zh-cn_16k-common/campplus_cn_common.bin', speech_encoder_type='CAM++', freeze_speech_encoder_updates=4000, num_attention_head=4, num_transformer_layer=2, transformer_embed_dim=384, transformer_ffn_embed_dim=1536, speaker_embed_dim=192, dropout=0.1, use_spk_embed=True, feature_grad_mult=0.1, whisper_n_mels=80, select_encoder_layer_nums=6, wavlm_fuse_feat_post_norm=False, speech_encoder_config='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/wav-bert2.0/config.json', single_backend_type='conformer', multi_backend_type='transformer', d_state=256, expand=4)
self.wavlm_fuse_feat_post_norm: False
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/accelerate/accelerator.py:494: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  self.scaler = torch.cuda.amp.GradScaler(**kwargs)
2025-02-13 17:08:09,468 (train_accelerate_ddp:946) INFO: model_cfg: TSVADConfig(speech_encoder_path='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/zh/modelscope/speech_campplus_sv_zh-cn_16k-common/campplus_cn_common.bin', speech_encoder_type='CAM++', freeze_speech_encoder_updates=4000, num_attention_head=4, num_transformer_layer=2, transformer_embed_dim=384, transformer_ffn_embed_dim=1536, speaker_embed_dim=192, dropout=0.1, use_spk_embed=True, feature_grad_mult=0.1, whisper_n_mels=80, select_encoder_layer_nums=6, wavlm_fuse_feat_post_norm=False, speech_encoder_config='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/wav-bert2.0/config.json', single_backend_type='conformer', multi_backend_type='transformer', d_state=256, expand=4)
self.wavlm_fuse_feat_post_norm: False
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/model.py:953: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loadedState = torch.load(model_path, map_location=device)
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/model.py:953: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loadedState = torch.load(model_path, map_location=device)
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
2025-02-13 17:08:09,862 (train_accelerate_ddp:949) INFO: model: TSVADModel(
  (rs_dropout): Dropout(p=0.1, inplace=False)
  (speech_encoder): CAMPPlus(
    (head): FCM(
      (conv1): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (layer1): Sequential(
        (0): BasicResBlock(
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(2, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (shortcut): Sequential(
            (0): Conv2d(32, 32, kernel_size=(1, 1), stride=(2, 1), bias=False)
            (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicResBlock(
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (shortcut): Sequential()
        )
      )
      (layer2): Sequential(
        (0): BasicResBlock(
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(2, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (shortcut): Sequential(
            (0): Conv2d(32, 32, kernel_size=(1, 1), stride=(2, 1), bias=False)
            (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicResBlock(
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (shortcut): Sequential()
        )
      )
      (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(2, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (xvector): Sequential(
      (tdnn): TDNNLayer(
        (linear): Conv1d(320, 128, kernel_size=(5,), stride=(2,), padding=(2,), bias=False)
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
      )
      (block1): CAMDenseTDNNBlock(
        (0): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (1): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(160, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (2): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(192, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (3): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(224, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (4): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(256, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (5): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(288, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (6): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(320, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (7): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(352, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(352, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (8): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(384, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (9): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(416, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(416, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (10): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(448, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (11): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(480, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(480, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
      )
      (transit1): TransitLayer(
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
        (linear): Conv1d(512, 256, kernel_size=(1,), stride=(1,), bias=False)
      )
      (block2): CAMDenseTDNNBlock(
        (0): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(256, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (1): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(288, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (2): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(320, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (3): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(352, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(352, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (4): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(384, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (5): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(416, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(416, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (6): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(448, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (7): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(480, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(480, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (8): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(512, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (9): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(544, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(544, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (10): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(576, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (11): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(608, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(608, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (12): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(640, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (13): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(672, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(672, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (14): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(704, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(704, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (15): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(736, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(736, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (16): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(768, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (17): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(800, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(800, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (18): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(832, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(832, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (19): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(864, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(864, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (20): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(896, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(896, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (21): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(928, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(928, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (22): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(960, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(960, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (23): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(992, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(992, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
      )
      (transit2): TransitLayer(
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
        (linear): Conv1d(1024, 512, kernel_size=(1,), stride=(1,), bias=False)
      )
      (block3): CAMDenseTDNNBlock(
        (0): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(512, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (1): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(544, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(544, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (2): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(576, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (3): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(608, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(608, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (4): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(640, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (5): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(672, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(672, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (6): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(704, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(704, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (7): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(736, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(736, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (8): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(768, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (9): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(800, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(800, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (10): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(832, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(832, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (11): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(864, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(864, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (12): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(896, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(896, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (13): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(928, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(928, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (14): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(960, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(960, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (15): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(992, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(992, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
      )
      (transit3): TransitLayer(
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
        (linear): Conv1d(1024, 512, kernel_size=(1,), stride=(1,), bias=False)
      )
      (out_nonlinear): Sequential(
        (batchnorm): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (stats): StatsPool()
      (dense): DenseLayer(
        (linear): Conv1d(1024, 192, kernel_size=(1,), stride=(1,), bias=False)
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(192, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
        )
      )
    )
  )
  (speech_down_or_up): Sequential(
    (0): Conv1d(512, 192, kernel_size=(5,), stride=(2,), padding=(2,))
    (1): BatchNorm1D(
      (bn): BatchNorm1d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (2): ReLU()
  )
  (pos_encoder): PositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (single_backend): Conformer(
    (conformer_layers): ModuleList(
      (0-1): 2 x ConformerLayer(
        (ffn1): _FeedForwardModule(
          (sequential): Sequential(
            (0): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (1): Linear(in_features=384, out_features=1536, bias=True)
            (2): SiLU()
            (3): Dropout(p=0.0, inplace=False)
            (4): Linear(in_features=1536, out_features=384, bias=True)
            (5): Dropout(p=0.0, inplace=False)
          )
        )
        (self_attn_layer_norm): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=384, out_features=384, bias=True)
        )
        (self_attn_dropout): Dropout(p=0.0, inplace=False)
        (conv_module): _ConvolutionModule(
          (layer_norm): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (sequential): Sequential(
            (0): Conv1d(384, 768, kernel_size=(1,), stride=(1,))
            (1): GLU(dim=1)
            (2): Conv1d(384, 384, kernel_size=(31,), stride=(1,), padding=(15,), groups=384)
            (3): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (4): SiLU()
            (5): Conv1d(384, 384, kernel_size=(1,), stride=(1,))
            (6): Dropout(p=0.0, inplace=False)
          )
        )
        (ffn2): _FeedForwardModule(
          (sequential): Sequential(
            (0): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (1): Linear(in_features=384, out_features=1536, bias=True)
            (2): SiLU()
            (3): Dropout(p=0.0, inplace=False)
            (4): Linear(in_features=1536, out_features=384, bias=True)
            (5): Dropout(p=0.0, inplace=False)
          )
        )
        (final_layer_norm): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
      )
    )
  )
  (backend_down): Sequential(
    (0): Conv1d(2688, 384, kernel_size=(5,), stride=(1,), padding=(2,))
    (1): BatchNorm1D(
      (bn): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (2): ReLU()
  )
  (multi_backend): TransformerEncoder(
    (layers): ModuleList(
      (0-1): 2 x TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=384, out_features=384, bias=True)
        )
        (linear1): Linear(in_features=384, out_features=1536, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=1536, out_features=384, bias=True)
        (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc): Linear(in_features=384, out_features=7, bias=True)
)
2025-02-13 17:08:09,862 (train_accelerate_ddp:949) INFO: model: TSVADModel(
  (rs_dropout): Dropout(p=0.1, inplace=False)
  (speech_encoder): CAMPPlus(
    (head): FCM(
      (conv1): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (layer1): Sequential(
        (0): BasicResBlock(
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(2, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (shortcut): Sequential(
            (0): Conv2d(32, 32, kernel_size=(1, 1), stride=(2, 1), bias=False)
            (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicResBlock(
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (shortcut): Sequential()
        )
      )
      (layer2): Sequential(
        (0): BasicResBlock(
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(2, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (shortcut): Sequential(
            (0): Conv2d(32, 32, kernel_size=(1, 1), stride=(2, 1), bias=False)
            (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicResBlock(
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (shortcut): Sequential()
        )
      )
      (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(2, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (xvector): Sequential(
      (tdnn): TDNNLayer(
        (linear): Conv1d(320, 128, kernel_size=(5,), stride=(2,), padding=(2,), bias=False)
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
      )
      (block1): CAMDenseTDNNBlock(
        (0): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (1): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(160, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (2): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(192, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (3): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(224, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (4): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(256, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (5): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(288, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (6): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(320, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (7): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(352, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(352, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (8): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(384, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (9): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(416, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(416, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (10): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(448, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (11): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(480, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(480, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
      )
      (transit1): TransitLayer(
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
        (linear): Conv1d(512, 256, kernel_size=(1,), stride=(1,), bias=False)
      )
      (block2): CAMDenseTDNNBlock(
        (0): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(256, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (1): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(288, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (2): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(320, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (3): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(352, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(352, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (4): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(384, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (5): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(416, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(416, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (6): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(448, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (7): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(480, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(480, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (8): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(512, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (9): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(544, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(544, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (10): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(576, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (11): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(608, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(608, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (12): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(640, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (13): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(672, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(672, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (14): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(704, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(704, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (15): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(736, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(736, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (16): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(768, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (17): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(800, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(800, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (18): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(832, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(832, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (19): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(864, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(864, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (20): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(896, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(896, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (21): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(928, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(928, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (22): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(960, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(960, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (23): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(992, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(992, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
      )
      (transit2): TransitLayer(
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
        (linear): Conv1d(1024, 512, kernel_size=(1,), stride=(1,), bias=False)
      )
      (block3): CAMDenseTDNNBlock(
        (0): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(512, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (1): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(544, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(544, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (2): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(576, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (3): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(608, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(608, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (4): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(640, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (5): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(672, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(672, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (6): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(704, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(704, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (7): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(736, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(736, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (8): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(768, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (9): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(800, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(800, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (10): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(832, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(832, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (11): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(864, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(864, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (12): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(896, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(896, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (13): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(928, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(928, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (14): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(960, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(960, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (15): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(992, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(992, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
      )
      (transit3): TransitLayer(
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
        (linear): Conv1d(1024, 512, kernel_size=(1,), stride=(1,), bias=False)
      )
      (out_nonlinear): Sequential(
        (batchnorm): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (stats): StatsPool()
      (dense): DenseLayer(
        (linear): Conv1d(1024, 192, kernel_size=(1,), stride=(1,), bias=False)
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(192, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
        )
      )
    )
  )
  (speech_down_or_up): Sequential(
    (0): Conv1d(512, 192, kernel_size=(5,), stride=(2,), padding=(2,))
    (1): BatchNorm1D(
      (bn): BatchNorm1d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (2): ReLU()
  )
  (pos_encoder): PositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (single_backend): Conformer(
    (conformer_layers): ModuleList(
      (0-1): 2 x ConformerLayer(
        (ffn1): _FeedForwardModule(
          (sequential): Sequential(
            (0): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (1): Linear(in_features=384, out_features=1536, bias=True)
            (2): SiLU()
            (3): Dropout(p=0.0, inplace=False)
            (4): Linear(in_features=1536, out_features=384, bias=True)
            (5): Dropout(p=0.0, inplace=False)
          )
        )
        (self_attn_layer_norm): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=384, out_features=384, bias=True)
        )
        (self_attn_dropout): Dropout(p=0.0, inplace=False)
        (conv_module): _ConvolutionModule(
          (layer_norm): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (sequential): Sequential(
            (0): Conv1d(384, 768, kernel_size=(1,), stride=(1,))
            (1): GLU(dim=1)
            (2): Conv1d(384, 384, kernel_size=(31,), stride=(1,), padding=(15,), groups=384)
            (3): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (4): SiLU()
            (5): Conv1d(384, 384, kernel_size=(1,), stride=(1,))
            (6): Dropout(p=0.0, inplace=False)
          )
        )
        (ffn2): _FeedForwardModule(
          (sequential): Sequential(
            (0): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (1): Linear(in_features=384, out_features=1536, bias=True)
            (2): SiLU()
            (3): Dropout(p=0.0, inplace=False)
            (4): Linear(in_features=1536, out_features=384, bias=True)
            (5): Dropout(p=0.0, inplace=False)
          )
        )
        (final_layer_norm): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
      )
    )
  )
  (backend_down): Sequential(
    (0): Conv1d(2688, 384, kernel_size=(5,), stride=(1,), padding=(2,))
    (1): BatchNorm1D(
      (bn): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (2): ReLU()
  )
  (multi_backend): TransformerEncoder(
    (layers): ModuleList(
      (0-1): 2 x TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=384, out_features=384, bias=True)
        )
        (linear1): Linear(in_features=384, out_features=1536, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=1536, out_features=384, bias=True)
        (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc): Linear(in_features=384, out_features=7, bias=True)
)
2025-02-13 17:08:09,864 (train_accelerate_ddp:951) INFO: Number of model parameters: 22884199
2025-02-13 17:08:09,864 (train_accelerate_ddp:951) INFO: Number of model parameters: 22884199
2025-02-13 17:08:09,865 (checkpoint:112) INFO: Loading checkpoint from /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-14.pt
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/checkpoint.py:113: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(filename, map_location="cpu")
2025-02-13 17:08:10,691 (checkpoint:112) INFO: Loading checkpoint from /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-14.pt
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/checkpoint.py:113: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(filename, map_location="cpu")
pgpu25:3760650:3760650 [0] NCCL INFO Bootstrap : Using ib1:20.20.20.25<0>
pgpu25:3760650:3760650 [0] NCCL INFO NET/Plugin : dlerror=libnccl-net.so: cannot open shared object file: No such file or directory No plugin found (libnccl-net.so), using internal implementation
pgpu25:3760650:3760650 [0] NCCL INFO cudaDriverVersion 12040
NCCL version 2.20.5+cuda11.0
pgpu25:3760651:3760651 [1] NCCL INFO cudaDriverVersion 12040
pgpu25:3760651:3760651 [1] NCCL INFO Bootstrap : Using ib1:20.20.20.25<0>
pgpu25:3760651:3760651 [1] NCCL INFO NET/Plugin : dlerror=libnccl-net.so: cannot open shared object file: No such file or directory No plugin found (libnccl-net.so), using internal implementation
pgpu25:3760651:3760986 [1] NCCL INFO NET/IB : Using [0]mlx5_0:1/RoCE [1]mlx5_1:1/IB [2]mlx5_3:1/IB [RO]; OOB ib1:20.20.20.25<0>
pgpu25:3760651:3760986 [1] NCCL INFO Using non-device net plugin version 0
pgpu25:3760651:3760986 [1] NCCL INFO Using network IB
pgpu25:3760650:3760989 [0] NCCL INFO NET/IB : Using [0]mlx5_0:1/RoCE [1]mlx5_1:1/IB [2]mlx5_3:1/IB [RO]; OOB ib1:20.20.20.25<0>
pgpu25:3760650:3760989 [0] NCCL INFO Using non-device net plugin version 0
pgpu25:3760650:3760989 [0] NCCL INFO Using network IB
pgpu25:3760650:3760989 [0] NCCL INFO comm 0x555563820580 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 25000 commId 0x5c7174493a69f7f - Init START
pgpu25:3760651:3760986 [1] NCCL INFO comm 0x5555670c59e0 rank 1 nranks 2 cudaDev 1 nvmlDev 1 busId 2b000 commId 0x5c7174493a69f7f - Init START
pgpu25:3760650:3760989 [0] NCCL INFO Setting affinity for GPU 0 to 01ffe000
pgpu25:3760651:3760986 [1] NCCL INFO Setting affinity for GPU 1 to 01ffe000
pgpu25:3760650:3760989 [0] NCCL INFO comm 0x555563820580 rank 0 nRanks 2 nNodes 1 localRanks 2 localRank 0 MNNVL 0
pgpu25:3760651:3760986 [1] NCCL INFO comm 0x5555670c59e0 rank 1 nRanks 2 nNodes 1 localRanks 2 localRank 1 MNNVL 0
pgpu25:3760650:3760989 [0] NCCL INFO Channel 00/16 :    0   1
pgpu25:3760650:3760989 [0] NCCL INFO Channel 01/16 :    0   1
pgpu25:3760650:3760989 [0] NCCL INFO Channel 02/16 :    0   1
pgpu25:3760650:3760989 [0] NCCL INFO Channel 03/16 :    0   1
pgpu25:3760650:3760989 [0] NCCL INFO Channel 04/16 :    0   1
pgpu25:3760650:3760989 [0] NCCL INFO Channel 05/16 :    0   1
pgpu25:3760650:3760989 [0] NCCL INFO Channel 06/16 :    0   1
pgpu25:3760650:3760989 [0] NCCL INFO Channel 07/16 :    0   1
pgpu25:3760651:3760986 [1] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] -1/-1/-1->1->0 [2] -1/-1/-1->1->0 [3] -1/-1/-1->1->0 [4] 0/-1/-1->1->-1 [5] 0/-1/-1->1->-1 [6] 0/-1/-1->1->-1 [7] 0/-1/-1->1->-1 [8] -1/-1/-1->1->0 [9] -1/-1/-1->1->0 [10] -1/-1/-1->1->0 [11] -1/-1/-1->1->0 [12] 0/-1/-1->1->-1 [13] 0/-1/-1->1->-1 [14] 0/-1/-1->1->-1 [15] 0/-1/-1->1->-1
pgpu25:3760650:3760989 [0] NCCL INFO Channel 08/16 :    0   1
pgpu25:3760650:3760989 [0] NCCL INFO Channel 09/16 :    0   1
pgpu25:3760651:3760986 [1] NCCL INFO P2P Chunksize set to 524288
pgpu25:3760650:3760989 [0] NCCL INFO Channel 10/16 :    0   1
pgpu25:3760650:3760989 [0] NCCL INFO Channel 11/16 :    0   1
pgpu25:3760650:3760989 [0] NCCL INFO Channel 12/16 :    0   1
pgpu25:3760650:3760989 [0] NCCL INFO Channel 13/16 :    0   1
pgpu25:3760650:3760989 [0] NCCL INFO Channel 14/16 :    0   1
pgpu25:3760650:3760989 [0] NCCL INFO Channel 15/16 :    0   1
pgpu25:3760650:3760989 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1 [2] 1/-1/-1->0->-1 [3] 1/-1/-1->0->-1 [4] -1/-1/-1->0->1 [5] -1/-1/-1->0->1 [6] -1/-1/-1->0->1 [7] -1/-1/-1->0->1 [8] 1/-1/-1->0->-1 [9] 1/-1/-1->0->-1 [10] 1/-1/-1->0->-1 [11] 1/-1/-1->0->-1 [12] -1/-1/-1->0->1 [13] -1/-1/-1->0->1 [14] -1/-1/-1->0->1 [15] -1/-1/-1->0->1
pgpu25:3760650:3760989 [0] NCCL INFO P2P Chunksize set to 524288
pgpu25:3760650:3760989 [0] NCCL INFO Channel 00/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu25:3760651:3760986 [1] NCCL INFO Channel 00/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu25:3760650:3760989 [0] NCCL INFO Channel 01/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu25:3760651:3760986 [1] NCCL INFO Channel 01/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu25:3760650:3760989 [0] NCCL INFO Channel 02/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu25:3760651:3760986 [1] NCCL INFO Channel 02/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu25:3760650:3760989 [0] NCCL INFO Channel 03/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu25:3760651:3760986 [1] NCCL INFO Channel 03/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu25:3760650:3760989 [0] NCCL INFO Channel 04/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu25:3760651:3760986 [1] NCCL INFO Channel 04/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu25:3760650:3760989 [0] NCCL INFO Channel 05/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu25:3760651:3760986 [1] NCCL INFO Channel 05/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu25:3760650:3760989 [0] NCCL INFO Channel 06/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu25:3760651:3760986 [1] NCCL INFO Channel 06/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu25:3760650:3760989 [0] NCCL INFO Channel 07/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu25:3760651:3760986 [1] NCCL INFO Channel 07/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu25:3760650:3760989 [0] NCCL INFO Channel 08/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu25:3760651:3760986 [1] NCCL INFO Channel 08/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu25:3760650:3760989 [0] NCCL INFO Channel 09/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu25:3760651:3760986 [1] NCCL INFO Channel 09/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu25:3760650:3760989 [0] NCCL INFO Channel 10/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu25:3760651:3760986 [1] NCCL INFO Channel 10/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu25:3760650:3760989 [0] NCCL INFO Channel 11/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu25:3760651:3760986 [1] NCCL INFO Channel 11/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu25:3760650:3760989 [0] NCCL INFO Channel 12/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu25:3760651:3760986 [1] NCCL INFO Channel 12/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu25:3760650:3760989 [0] NCCL INFO Channel 13/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu25:3760651:3760986 [1] NCCL INFO Channel 13/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu25:3760650:3760989 [0] NCCL INFO Channel 14/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu25:3760651:3760986 [1] NCCL INFO Channel 14/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu25:3760650:3760989 [0] NCCL INFO Channel 15/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu25:3760651:3760986 [1] NCCL INFO Channel 15/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu25:3760650:3760989 [0] NCCL INFO Connected all rings
pgpu25:3760650:3760989 [0] NCCL INFO Connected all trees
pgpu25:3760651:3760986 [1] NCCL INFO Connected all rings
pgpu25:3760651:3760986 [1] NCCL INFO Connected all trees
pgpu25:3760651:3760986 [1] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
pgpu25:3760651:3760986 [1] NCCL INFO 16 coll channels, 0 collnet channels, 0 nvls channels, 16 p2p channels, 16 p2p channels per peer
pgpu25:3760650:3760989 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
pgpu25:3760650:3760989 [0] NCCL INFO 16 coll channels, 0 collnet channels, 0 nvls channels, 16 p2p channels, 16 p2p channels per peer
pgpu25:3760651:3760986 [1] NCCL INFO comm 0x5555670c59e0 rank 1 nranks 2 cudaDev 1 nvmlDev 1 busId 2b000 commId 0x5c7174493a69f7f - Init COMPLETE
pgpu25:3760650:3760989 [0] NCCL INFO comm 0x555563820580 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 25000 commId 0x5c7174493a69f7f - Init COMPLETE
2025-02-13 17:08:12,095 (train_accelerate_ddp:1032) INFO: start training from epoch 14
2025-02-13 17:08:12,095 (train_accelerate_ddp:1032) INFO: start training from epoch 14
2025-02-13 17:08:12,095 (train_accelerate_ddp:1033) INFO: Train set grouped total_num_itrs = 4114
2025-02-13 17:08:12,095 (train_accelerate_ddp:1033) INFO: Train set grouped total_num_itrs = 4114
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/ts_vad_dataset.py:398: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  feature = torch.load(path, map_location="cpu")
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/ts_vad_dataset.py:398: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  feature = torch.load(path, map_location="cpu")
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/ts_vad_dataset.py:392: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  feature = torch.load(path, map_location="cpu")
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/ts_vad_dataset.py:392: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  feature = torch.load(path, map_location="cpu")
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
2025-02-13 17:08:19,894 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 57596, num_updates: 52000, {'loss': 0.0921582356095314, 'DER': 0.20461789078546638, 'ACC': np.float64(0.963783482142857), 'MI': 0.12175083221191302, 'FA': 0.057652808272540546, 'CF': 0.02521425030101282}, batch size: 64, grad_norm: 0.12478303164243698, grad_scale: , lr: 1.00e-07, 
2025-02-13 17:08:19,894 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 57596, num_updates: 52000, {'loss': 0.10263463854789734, 'DER': 0.23577124003299424, 'ACC': np.float64(0.9524330357142857), 'MI': 0.12173494638438273, 'FA': 0.056846301897167995, 'CF': 0.0571899917514435}, batch size: 64, grad_norm: 0.12478303164243698, grad_scale: , lr: 1.00e-07, 
2025-02-13 17:20:44,724 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 58096, num_updates: 52500, {'loss': 0.09710890799760818, 'DER': 0.20241712240902032, 'ACC': np.float64(0.9602566964285714), 'MI': 0.11511714266423605, 'FA': 0.049287691580582, 'CF': 0.03801228816420228}, batch size: 64, grad_norm: 0.14850081503391266, grad_scale: , lr: 5.01e-05, 
2025-02-13 17:20:44,724 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 17:20:44,724 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 58096, num_updates: 52500, {'loss': 0.09126239269971848, 'DER': 0.22573839662447256, 'ACC': np.float64(0.9609486607142856), 'MI': 0.11912296564195299, 'FA': 0.06871609403254973, 'CF': 0.03789933694996986}, batch size: 64, grad_norm: 0.14850081503391266, grad_scale: , lr: 5.01e-05, 
2025-02-13 17:20:44,725 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 17:21:31,928 (model:925) WARNING: All labels are zero
2025-02-13 17:21:32,413 (model:925) WARNING: All labels are zero
2025-02-13 17:21:32,471 (model:925) WARNING: All labels are zero
2025-02-13 17:22:57,976 (model:925) WARNING: All labels are zero
2025-02-13 17:23:09,087 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 58096,  validation: loss=0.07506, DER=0.1734, ACC=0.9647, MI=0.08205, FA=0.06074, CF=0.03062, over 0.00 frames. 
2025-02-13 17:23:09,087 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 17:23:09,445 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 58096,  validation: loss=0.07619, DER=0.1736, ACC=0.9639, MI=0.08323, FA=0.05902, CF=0.03134, over 0.00 frames. 
2025-02-13 17:23:09,445 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 17:32:55,649 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-58500.pt
2025-02-13 17:32:56,072 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-13 17:35:08,982 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 58596, num_updates: 53000, {'loss': 0.09460959583520889, 'DER': 0.21564575645756456, 'ACC': np.float64(0.9601004464285714), 'MI': 0.09645756457564576, 'FA': 0.07099630996309964, 'CF': 0.048191881918819186}, batch size: 64, grad_norm: 0.1763235330581665, grad_scale: , lr: 1.00e-04, 
2025-02-13 17:35:08,983 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 17:35:08,985 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 58596, num_updates: 53000, {'loss': 0.1033497080206871, 'DER': 0.24203821656050956, 'ACC': np.float64(0.9558035714285714), 'MI': 0.1183528366167975, 'FA': 0.07243371352392239, 'CF': 0.05125166641978966}, batch size: 64, grad_norm: 0.1763235330581665, grad_scale: , lr: 1.00e-04, 
2025-02-13 17:35:08,985 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 17:35:54,505 (model:925) WARNING: All labels are zero
2025-02-13 17:35:54,737 (model:925) WARNING: All labels are zero
2025-02-13 17:35:55,050 (model:925) WARNING: All labels are zero
2025-02-13 17:37:18,632 (model:925) WARNING: All labels are zero
2025-02-13 17:37:29,702 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 58596,  validation: loss=0.07545, DER=0.174, ACC=0.9653, MI=0.09969, FA=0.0469, CF=0.02744, over 0.00 frames. 
2025-02-13 17:37:29,702 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 17:37:30,254 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 58596,  validation: loss=0.07749, DER=0.174, ACC=0.9642, MI=0.1026, FA=0.04332, CF=0.02805, over 0.00 frames. 
2025-02-13 17:37:30,255 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 17:48:58,713 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 59096, num_updates: 53500, {'loss': 0.10110046714544296, 'DER': 0.233890053418081, 'ACC': np.float64(0.9518080357142857), 'MI': 0.11880451687064711, 'FA': 0.05700182568124958, 'CF': 0.05808371086618433}, batch size: 64, grad_norm: 0.15378056466579437, grad_scale: , lr: 1.50e-04, 
2025-02-13 17:48:58,713 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 59096, num_updates: 53500, {'loss': 0.1026531457901001, 'DER': 0.2477802231160355, 'ACC': np.float64(0.9547879464285713), 'MI': 0.10624573119830007, 'FA': 0.08188510283068984, 'CF': 0.05964938908704561}, batch size: 64, grad_norm: 0.15378056466579437, grad_scale: , lr: 1.50e-04, 
2025-02-13 17:48:58,713 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 17:48:58,713 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 17:49:44,077 (model:925) WARNING: All labels are zero
2025-02-13 17:49:44,554 (model:925) WARNING: All labels are zero

pgpu25:3760651:3760988 [0] transport/net_ib.cc:100 NCCL WARN NET/IB : mlx5_1:1 Got async event : client reregistration

pgpu25:3760650:3760991 [0] transport/net_ib.cc:100 NCCL WARN NET/IB : mlx5_1:1 Got async event : client reregistration

pgpu25:3760651:3760992 [0] transport/net_ib.cc:100 NCCL WARN NET/IB : mlx5_3:1 Got async event : client reregistration

pgpu25:3760650:3760993 [0] transport/net_ib.cc:100 NCCL WARN NET/IB : mlx5_3:1 Got async event : client reregistration
2025-02-13 17:49:45,109 (model:925) WARNING: All labels are zero
2025-02-13 17:51:06,590 (model:925) WARNING: All labels are zero
2025-02-13 17:51:17,462 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 59096,  validation: loss=0.07948, DER=0.1857, ACC=0.9631, MI=0.08357, FA=0.07068, CF=0.03148, over 0.00 frames. 
2025-02-13 17:51:17,462 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 17:51:21,021 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 59096,  validation: loss=0.081, DER=0.1858, ACC=0.9621, MI=0.08605, FA=0.06712, CF=0.03259, over 0.00 frames. 
2025-02-13 17:51:21,021 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 18:02:36,618 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 59596, num_updates: 54000, {'loss': 0.10540392249822617, 'DER': 0.24388118236618492, 'ACC': np.float64(0.956138392857143), 'MI': 0.10472801220132182, 'FA': 0.09761057447890188, 'CF': 0.04154259568596122}, batch size: 64, grad_norm: 0.21534797549247742, grad_scale: , lr: 2.00e-04, 
2025-02-13 18:02:36,618 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 18:02:36,620 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 59596, num_updates: 54000, {'loss': 0.12837140262126923, 'DER': 0.32541640962368906, 'ACC': np.float64(0.9423883928571429), 'MI': 0.14489512646514496, 'FA': 0.10788093769278223, 'CF': 0.07264034546576187}, batch size: 64, grad_norm: 0.21534797549247742, grad_scale: , lr: 2.00e-04, 
2025-02-13 18:02:36,620 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 18:03:21,184 (model:925) WARNING: All labels are zero
2025-02-13 18:03:21,713 (model:925) WARNING: All labels are zero
2025-02-13 18:03:21,872 (model:925) WARNING: All labels are zero
2025-02-13 18:04:44,720 (model:925) WARNING: All labels are zero
2025-02-13 18:04:55,052 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 59596,  validation: loss=0.08294, DER=0.1897, ACC=0.9612, MI=0.09375, FA=0.05906, CF=0.03689, over 0.00 frames. 
2025-02-13 18:04:55,052 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 18:04:55,647 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 59596,  validation: loss=0.08067, DER=0.1898, ACC=0.9626, MI=0.09384, FA=0.06289, CF=0.03303, over 0.00 frames. 
2025-02-13 18:04:55,648 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 18:13:59,752 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-60000.pt
2025-02-13 18:16:08,702 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 60096, num_updates: 54500, {'loss': 0.10796090960502625, 'DER': 0.2549716940049354, 'ACC': np.float64(0.95359375), 'MI': 0.1304978951952388, 'FA': 0.07766003774132675, 'CF': 0.04681376106836987}, batch size: 64, grad_norm: 0.17562389373779297, grad_scale: , lr: 1.94e-04, 
2025-02-13 18:16:08,703 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 18:16:08,703 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 60096, num_updates: 54500, {'loss': 0.12308196723461151, 'DER': 0.28207885304659497, 'ACC': np.float64(0.9429267580646973), 'MI': 0.11383512544802868, 'FA': 0.08594982078853046, 'CF': 0.08229390681003584}, batch size: 64, grad_norm: 0.17562389373779297, grad_scale: , lr: 1.94e-04, 
2025-02-13 18:16:08,703 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 18:16:53,622 (model:925) WARNING: All labels are zero
2025-02-13 18:16:54,168 (model:925) WARNING: All labels are zero
2025-02-13 18:16:54,382 (model:925) WARNING: All labels are zero
2025-02-13 18:18:17,881 (model:925) WARNING: All labels are zero
2025-02-13 18:18:28,135 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 60096,  validation: loss=0.08548, DER=0.1926, ACC=0.9604, MI=0.09698, FA=0.05949, CF=0.03615, over 0.00 frames. 
2025-02-13 18:18:28,136 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 18:18:29,270 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 60096,  validation: loss=0.0846, DER=0.1925, ACC=0.9613, MI=0.09482, FA=0.06271, CF=0.03498, over 0.00 frames. 
2025-02-13 18:18:29,271 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 18:29:50,396 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 60596, num_updates: 55000, {'loss': 0.11183368414640427, 'DER': 0.2872541879096868, 'ACC': np.float64(0.9478794642857143), 'MI': 0.1688273852876912, 'FA': 0.06554989075018208, 'CF': 0.052876911871813544}, batch size: 64, grad_norm: 0.1992497742176056, grad_scale: , lr: 1.89e-04, 
2025-02-13 18:29:50,396 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 60596, num_updates: 55000, {'loss': 0.11176499724388123, 'DER': 0.25654116145500955, 'ACC': np.float64(0.9507966471156655), 'MI': 0.13217046018577608, 'FA': 0.0704105509466071, 'CF': 0.05396015032262639}, batch size: 64, grad_norm: 0.1992497742176056, grad_scale: , lr: 1.89e-04, 
2025-02-13 18:29:50,397 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 18:29:50,397 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 18:30:35,584 (model:925) WARNING: All labels are zero
2025-02-13 18:30:35,778 (model:925) WARNING: All labels are zero
2025-02-13 18:30:36,126 (model:925) WARNING: All labels are zero
2025-02-13 18:31:58,520 (model:925) WARNING: All labels are zero
2025-02-13 18:32:09,431 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 60596,  validation: loss=0.08779, DER=0.1993, ACC=0.9595, MI=0.114, FA=0.04711, CF=0.03818, over 0.00 frames. 
2025-02-13 18:32:09,431 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 18:32:10,665 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 60596,  validation: loss=0.08876, DER=0.1984, ACC=0.959, MI=0.1135, FA=0.04539, CF=0.03942, over 0.00 frames. 
2025-02-13 18:32:10,666 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 18:43:31,353 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 61096, num_updates: 55500, {'loss': 0.11959873884916306, 'DER': 0.293189803393885, 'ACC': np.float64(0.9478959938107572), 'MI': 0.17664648276893175, 'FA': 0.06234581744785826, 'CF': 0.05419750317709501}, batch size: 64, grad_norm: 0.19440308213233948, grad_scale: , lr: 1.83e-04, 
2025-02-13 18:43:31,354 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 18:43:31,354 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 61096, num_updates: 55500, {'loss': 0.1396673172712326, 'DER': 0.294737557791678, 'ACC': np.float64(0.9441183035714286), 'MI': 0.19220832200163177, 'FA': 0.056839815066630404, 'CF': 0.04568942072341583}, batch size: 64, grad_norm: 0.19440308213233948, grad_scale: , lr: 1.83e-04, 
2025-02-13 18:43:31,354 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 18:44:15,958 (model:925) WARNING: All labels are zero
2025-02-13 18:44:16,492 (model:925) WARNING: All labels are zero
2025-02-13 18:44:16,713 (model:925) WARNING: All labels are zero
2025-02-13 18:45:39,505 (model:925) WARNING: All labels are zero
2025-02-13 18:45:50,468 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 61096,  validation: loss=0.08223, DER=0.1929, ACC=0.9616, MI=0.1159, FA=0.04349, CF=0.03342, over 0.00 frames. 
2025-02-13 18:45:50,468 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 18:45:50,642 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 61096,  validation: loss=0.0839, DER=0.1924, ACC=0.9608, MI=0.1155, FA=0.04108, CF=0.03584, over 0.00 frames. 
2025-02-13 18:45:50,643 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 18:54:56,055 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-61500.pt
2025-02-13 18:55:22,473 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-13 18:57:33,449 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 61596, num_updates: 56000, {'loss': 0.11051198095083237, 'DER': 0.2422458062307429, 'ACC': np.float64(0.9512611607142857), 'MI': 0.13413214652516262, 'FA': 0.05135227661759671, 'CF': 0.05676138308798357}, batch size: 64, grad_norm: 0.1807042509317398, grad_scale: , lr: 1.78e-04, 
2025-02-13 18:57:33,450 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 18:57:33,452 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 61596, num_updates: 56000, {'loss': 0.12622275948524475, 'DER': 0.3041575492341357, 'ACC': np.float64(0.941997767857143), 'MI': 0.15200583515681984, 'FA': 0.07724288840262582, 'CF': 0.07490882567469001}, batch size: 64, grad_norm: 0.1807042509317398, grad_scale: , lr: 1.78e-04, 
2025-02-13 18:57:33,452 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 18:58:17,889 (model:925) WARNING: All labels are zero
2025-02-13 18:58:18,419 (model:925) WARNING: All labels are zero
2025-02-13 18:58:19,148 (model:925) WARNING: All labels are zero
2025-02-13 18:59:42,529 (model:925) WARNING: All labels are zero
2025-02-13 18:59:51,400 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 61596,  validation: loss=0.08256, DER=0.1912, ACC=0.9612, MI=0.1124, FA=0.04419, CF=0.03463, over 0.00 frames. 
2025-02-13 18:59:51,401 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 18:59:53,550 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 61596,  validation: loss=0.08122, DER=0.1899, ACC=0.9621, MI=0.1095, FA=0.04685, CF=0.03354, over 0.00 frames. 
2025-02-13 18:59:53,550 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 19:02:25,762 (train_accelerate_ddp:713) INFO: end of epoch 14, batch_idx: 4113 batch_idx_train: 61709, {'loss': 0.11015763878822327, 'DER': 0.24903368304803974, 'ACC': np.float64(0.9489397321428571), 'MI': 0.12210104914411928, 'FA': 0.06018774157923799, 'CF': 0.06674489232468249}, batch size: 64, grad_norm: 0.19970522820949554, grad_scale: , lr: 1.77e-04, 
2025-02-13 19:02:25,766 (train_accelerate_ddp:713) INFO: end of epoch 14, batch_idx: 4113 batch_idx_train: 61709, {'loss': 0.10364299267530441, 'DER': 0.25360532018232085, 'ACC': np.float64(0.952857142857143), 'MI': 0.10221923335574983, 'FA': 0.08936710752447134, 'CF': 0.06201897930209968}, batch size: 64, grad_norm: 0.19970522820949554, grad_scale: , lr: 1.77e-04, 
2025-02-13 19:02:25,768 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-14.pt
2025-02-13 19:02:37,127 (train_accelerate_ddp:561) INFO:  end of epoch 14, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-14.pt 
2025-02-13 19:02:39,385 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 61710, num_updates: 56000, {'loss': 0.08149393647909164, 'DER': 0.1956029011786038, 'ACC': np.float64(0.9638839285714286), 'MI': 0.08915080084617709, 'FA': 0.05757026291931097, 'CF': 0.04888183741311575}, batch size: 64, grad_norm: 0.21954213082790375, grad_scale: , lr: 1.77e-04, 
2025-02-13 19:02:39,385 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 61710, num_updates: 56000, {'loss': 0.10748088359832764, 'DER': 0.24881706340540147, 'ACC': np.float64(0.9543144925581185), 'MI': 0.12717478343160807, 'FA': 0.07461600058236878, 'CF': 0.04702627939142462}, batch size: 64, grad_norm: 0.21954213082790375, grad_scale: , lr: 1.77e-04, 
2025-02-13 19:13:56,996 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 62210, num_updates: 56500, {'loss': 0.08856251090765, 'DER': 0.20869498425378294, 'ACC': np.float64(0.9643973214285714), 'MI': 0.09355557262462555, 'FA': 0.07880789615177818, 'CF': 0.036331515477379214}, batch size: 64, grad_norm: 0.1918327510356903, grad_scale: , lr: 1.71e-04, 
2025-02-13 19:13:56,996 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 62210, num_updates: 56500, {'loss': 0.10048790276050568, 'DER': 0.27432590855803046, 'ACC': np.float64(0.9528794642857144), 'MI': 0.10957405236420477, 'FA': 0.10910511918718249, 'CF': 0.05564673700664322}, batch size: 64, grad_norm: 0.1918327510356903, grad_scale: , lr: 1.71e-04, 
2025-02-13 19:13:56,997 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 19:13:56,997 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 19:14:41,630 (model:925) WARNING: All labels are zero
2025-02-13 19:14:42,164 (model:925) WARNING: All labels are zero
2025-02-13 19:14:42,166 (model:925) WARNING: All labels are zero
2025-02-13 19:16:04,806 (model:925) WARNING: All labels are zero
2025-02-13 19:16:15,594 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 62210,  validation: loss=0.08261, DER=0.1879, ACC=0.961, MI=0.09661, FA=0.05442, CF=0.03684, over 0.00 frames. 
2025-02-13 19:16:15,594 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 19:16:15,727 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 62210,  validation: loss=0.08126, DER=0.187, ACC=0.9618, MI=0.09361, FA=0.05699, CF=0.03641, over 0.00 frames. 
2025-02-13 19:16:15,727 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 19:27:39,808 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 62710, num_updates: 57000, {'loss': 0.1256498545408249, 'DER': 0.30105017502917153, 'ACC': np.float64(0.94265625), 'MI': 0.13783547257876314, 'FA': 0.08955659276546091, 'CF': 0.07365810968494749}, batch size: 64, grad_norm: 0.23127716779708862, grad_scale: , lr: 1.65e-04, 
2025-02-13 19:27:39,808 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 19:27:39,809 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 62710, num_updates: 57000, {'loss': 0.10689502954483032, 'DER': 0.252393018018018, 'ACC': np.float64(0.9513504464285714), 'MI': 0.13288288288288289, 'FA': 0.06510416666666667, 'CF': 0.05440596846846847}, batch size: 64, grad_norm: 0.23127716779708862, grad_scale: , lr: 1.65e-04, 
2025-02-13 19:27:39,809 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 19:28:24,942 (model:925) WARNING: All labels are zero
2025-02-13 19:28:25,453 (model:925) WARNING: All labels are zero
2025-02-13 19:28:25,487 (model:925) WARNING: All labels are zero
2025-02-13 19:29:49,500 (model:925) WARNING: All labels are zero
2025-02-13 19:29:59,701 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 62710,  validation: loss=0.08114, DER=0.1831, ACC=0.9623, MI=0.08627, FA=0.06128, CF=0.0355, over 0.00 frames. 
2025-02-13 19:29:59,702 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 19:30:00,499 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 62710,  validation: loss=0.07918, DER=0.1826, ACC=0.9632, MI=0.08348, FA=0.06504, CF=0.03412, over 0.00 frames. 
2025-02-13 19:30:00,500 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 19:36:28,484 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-63000.pt
2025-02-13 19:36:41,092 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-13 19:41:27,302 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 63210, num_updates: 57500, {'loss': 0.09621111303567886, 'DER': 0.21695212999560826, 'ACC': np.float64(0.9595089285714287), 'MI': 0.09076269945835164, 'FA': 0.07758746889181672, 'CF': 0.04860196164543991}, batch size: 64, grad_norm: 0.19588756561279297, grad_scale: , lr: 1.60e-04, 
2025-02-13 19:41:27,302 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 63210, num_updates: 57500, {'loss': 0.13915659487247467, 'DER': 0.29605493658468224, 'ACC': np.float64(0.941875), 'MI': 0.15261719571158294, 'FA': 0.07455679349730222, 'CF': 0.06888094737579707}, batch size: 64, grad_norm: 0.19588756561279297, grad_scale: , lr: 1.60e-04, 
2025-02-13 19:41:27,302 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 19:41:27,302 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 19:42:12,413 (model:925) WARNING: All labels are zero
2025-02-13 19:42:12,528 (model:925) WARNING: All labels are zero
2025-02-13 19:42:13,067 (model:925) WARNING: All labels are zero
2025-02-13 19:43:34,583 (model:925) WARNING: All labels are zero
2025-02-13 19:43:45,440 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 63210,  validation: loss=0.07835, DER=0.1807, ACC=0.9637, MI=0.09298, FA=0.0529, CF=0.03484, over 0.00 frames. 
2025-02-13 19:43:45,440 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 19:43:47,508 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 63210,  validation: loss=0.08049, DER=0.1817, ACC=0.9622, MI=0.09629, FA=0.05083, CF=0.0346, over 0.00 frames. 
2025-02-13 19:43:47,508 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 19:54:57,733 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 63710, num_updates: 58000, {'loss': 0.13136954605579376, 'DER': 0.2738126135478848, 'ACC': np.float64(0.9432589285714286), 'MI': 0.15831819361536464, 'FA': 0.059434207111341814, 'CF': 0.056060212821178304}, batch size: 64, grad_norm: 0.25660404562950134, grad_scale: , lr: 1.54e-04, 
2025-02-13 19:54:57,734 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 19:54:57,734 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 63710, num_updates: 58000, {'loss': 0.10950983315706253, 'DER': 0.24288467239845835, 'ACC': np.float64(0.954810267857143), 'MI': 0.10413578416839608, 'FA': 0.08152979543433146, 'CF': 0.05721909279573081}, batch size: 64, grad_norm: 0.25660404562950134, grad_scale: , lr: 1.54e-04, 
2025-02-13 19:54:57,734 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 19:55:42,742 (model:925) WARNING: All labels are zero
2025-02-13 19:55:42,900 (model:925) WARNING: All labels are zero
2025-02-13 19:55:43,283 (model:925) WARNING: All labels are zero
2025-02-13 19:57:05,429 (model:925) WARNING: All labels are zero
2025-02-13 19:57:16,337 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 63710,  validation: loss=0.08278, DER=0.194, ACC=0.9619, MI=0.12, FA=0.04176, CF=0.03228, over 0.00 frames. 
2025-02-13 19:57:16,337 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 19:57:17,624 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 63710,  validation: loss=0.08507, DER=0.1932, ACC=0.9609, MI=0.1211, FA=0.03907, CF=0.03303, over 0.00 frames. 
2025-02-13 19:57:17,624 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 20:08:45,867 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 64210, num_updates: 58500, {'loss': 0.12244889885187149, 'DER': 0.2917101535708961, 'ACC': np.float64(0.94703125), 'MI': 0.1432831370210228, 'FA': 0.08632771731027285, 'CF': 0.06209929923960042}, batch size: 64, grad_norm: 0.16050854325294495, grad_scale: , lr: 1.49e-04, 
2025-02-13 20:08:45,867 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 20:08:45,868 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 64210, num_updates: 58500, {'loss': 0.09978475421667099, 'DER': 0.23491891158309017, 'ACC': np.float64(0.956015625), 'MI': 0.16170183890886883, 'FA': 0.040713849494469705, 'CF': 0.03250322317975165}, batch size: 64, grad_norm: 0.16050854325294495, grad_scale: , lr: 1.49e-04, 
2025-02-13 20:08:45,869 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 20:09:33,701 (model:925) WARNING: All labels are zero
2025-02-13 20:09:33,729 (model:925) WARNING: All labels are zero
2025-02-13 20:09:34,262 (model:925) WARNING: All labels are zero
2025-02-13 20:11:02,538 (model:925) WARNING: All labels are zero
2025-02-13 20:11:14,262 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 64210,  validation: loss=0.0786, DER=0.1802, ACC=0.9636, MI=0.08902, FA=0.06054, CF=0.03064, over 0.00 frames. 
2025-02-13 20:11:14,262 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 20:11:14,824 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 64210,  validation: loss=0.08094, DER=0.1819, ACC=0.9623, MI=0.09166, FA=0.05754, CF=0.03272, over 0.00 frames. 
2025-02-13 20:11:14,824 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 20:17:48,246 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-64500.pt
2025-02-13 20:18:00,544 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-13 20:22:50,710 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 64710, num_updates: 59000, {'loss': 0.10991211235523224, 'DER': 0.27461698913903476, 'ACC': np.float64(0.9512946428571429), 'MI': 0.16953175573617205, 'FA': 0.0658131338560023, 'CF': 0.03927209954686039}, batch size: 64, grad_norm: 0.19551073014736176, grad_scale: , lr: 1.43e-04, 
2025-02-13 20:22:50,711 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 20:22:50,712 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 64710, num_updates: 59000, {'loss': 0.1543666571378708, 'DER': 0.36549323017408125, 'ACC': np.float64(0.9338392857142856), 'MI': 0.1772533849129594, 'FA': 0.09508704061895551, 'CF': 0.09315280464216634}, batch size: 64, grad_norm: 0.19551073014736176, grad_scale: , lr: 1.43e-04, 
2025-02-13 20:22:50,713 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 20:23:38,908 (model:925) WARNING: All labels are zero
2025-02-13 20:23:39,482 (model:925) WARNING: All labels are zero
2025-02-13 20:23:39,504 (model:925) WARNING: All labels are zero
2025-02-13 20:25:07,292 (model:925) WARNING: All labels are zero
2025-02-13 20:25:18,618 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 64710,  validation: loss=0.07895, DER=0.1802, ACC=0.963, MI=0.09415, FA=0.05318, CF=0.03288, over 0.00 frames. 
2025-02-13 20:25:18,618 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 20:25:18,779 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 64710,  validation: loss=0.07558, DER=0.1746, ACC=0.965, MI=0.09092, FA=0.05418, CF=0.02946, over 0.00 frames. 
2025-02-13 20:25:18,779 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 20:36:51,254 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 65210, num_updates: 59500, {'loss': 0.1158524826169014, 'DER': 0.26869941389896734, 'ACC': np.float64(0.9475375701611444), 'MI': 0.1680854032933296, 'FA': 0.04584147362545353, 'CF': 0.0547725369801842}, batch size: 64, grad_norm: 0.16066023707389832, grad_scale: , lr: 1.38e-04, 
2025-02-13 20:36:51,255 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 20:36:51,255 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 65210, num_updates: 59500, {'loss': 0.11554422974586487, 'DER': 0.26664646617680476, 'ACC': np.float64(0.9517753403763767), 'MI': 0.11870312855086736, 'FA': 0.08885690477994092, 'CF': 0.05908643284599652}, batch size: 64, grad_norm: 0.16066023707389832, grad_scale: , lr: 1.38e-04, 
2025-02-13 20:36:51,255 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 20:37:36,475 (model:925) WARNING: All labels are zero
2025-02-13 20:37:36,539 (model:925) WARNING: All labels are zero
2025-02-13 20:37:37,008 (model:925) WARNING: All labels are zero
2025-02-13 20:38:59,272 (model:925) WARNING: All labels are zero
2025-02-13 20:39:10,208 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 65210,  validation: loss=0.07814, DER=0.1809, ACC=0.964, MI=0.1022, FA=0.04974, CF=0.02894, over 0.00 frames. 
2025-02-13 20:39:10,208 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 20:39:10,271 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 65210,  validation: loss=0.08035, DER=0.1836, ACC=0.9626, MI=0.1055, FA=0.04758, CF=0.03052, over 0.00 frames. 
2025-02-13 20:39:10,271 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 20:50:50,834 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 65710, num_updates: 60000, {'loss': 0.11929680407047272, 'DER': 0.28464119019836637, 'ACC': np.float64(0.9456584821428571), 'MI': 0.13579346557759628, 'FA': 0.07839848308051342, 'CF': 0.07044924154025671}, batch size: 64, grad_norm: 0.11547990888357162, grad_scale: , lr: 1.32e-04, 
2025-02-13 20:50:50,835 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 20:50:50,836 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 65710, num_updates: 60000, {'loss': 0.09690898656845093, 'DER': 0.21194928906633045, 'ACC': np.float64(0.9571428571428571), 'MI': 0.09112558660783078, 'FA': 0.06380892344330041, 'CF': 0.057014779015199274}, batch size: 64, grad_norm: 0.11547990888357162, grad_scale: , lr: 1.32e-04, 
2025-02-13 20:50:50,837 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 20:51:38,212 (model:925) WARNING: All labels are zero
2025-02-13 20:51:38,295 (model:925) WARNING: All labels are zero
2025-02-13 20:51:38,774 (model:925) WARNING: All labels are zero
2025-02-13 20:53:04,756 (model:925) WARNING: All labels are zero
2025-02-13 20:53:16,146 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 65710,  validation: loss=0.08114, DER=0.1815, ACC=0.9642, MI=0.09567, FA=0.05916, CF=0.02668, over 0.00 frames. 
2025-02-13 20:53:16,146 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 20:53:17,858 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 65710,  validation: loss=0.08286, DER=0.186, ACC=0.9629, MI=0.09804, FA=0.05923, CF=0.02869, over 0.00 frames. 
2025-02-13 20:53:17,859 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 20:55:51,683 (train_accelerate_ddp:713) INFO: end of epoch 15, batch_idx: 4113 batch_idx_train: 65823, {'loss': 0.10137586295604706, 'DER': 0.23313067627411244, 'ACC': np.float64(0.9562723214285714), 'MI': 0.09494858515349396, 'FA': 0.07723485701418599, 'CF': 0.060947234106432484}, batch size: 64, grad_norm: 0.16948753595352173, grad_scale: , lr: 1.31e-04, 
2025-02-13 20:55:51,684 (train_accelerate_ddp:713) INFO: end of epoch 15, batch_idx: 4113 batch_idx_train: 65823, {'loss': 0.1083892211318016, 'DER': 0.24409562211981567, 'ACC': np.float64(0.9543369755834346), 'MI': 0.13184043778801843, 'FA': 0.06386808755760369, 'CF': 0.04838709677419355}, batch size: 64, grad_norm: 0.16948753595352173, grad_scale: , lr: 1.31e-04, 
2025-02-13 20:55:51,686 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-15.pt
2025-02-13 20:55:56,388 (train_accelerate_ddp:561) INFO:  end of epoch 15, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-15.pt 
2025-02-13 20:55:58,710 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 65824, num_updates: 60000, {'loss': 0.10513284057378769, 'DER': 0.22676733013040495, 'ACC': np.float64(0.9561272321428571), 'MI': 0.1126286890871654, 'FA': 0.07110501029512697, 'CF': 0.04303363074811256}, batch size: 64, grad_norm: 0.16407528519630432, grad_scale: , lr: 1.31e-04, 
2025-02-13 20:55:58,710 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 65824, num_updates: 60000, {'loss': 0.10577230900526047, 'DER': 0.25007088176920894, 'ACC': np.float64(0.951875), 'MI': 0.11901049050184292, 'FA': 0.07548908420754182, 'CF': 0.055571307059824215}, batch size: 64, grad_norm: 0.16407528519630432, grad_scale: , lr: 1.31e-04, 
2025-02-13 20:59:55,265 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-66000.pt
2025-02-13 20:59:55,752 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-13 20:59:55,773 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-13 21:07:17,151 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 66324, num_updates: 60500, {'loss': 0.09553597122430801, 'DER': 0.22264403751674855, 'ACC': np.float64(0.9605548719096095), 'MI': 0.1286288521661456, 'FA': 0.05419085901444097, 'CF': 0.03982432633616198}, batch size: 64, grad_norm: 0.17847242951393127, grad_scale: , lr: 1.25e-04, 
2025-02-13 21:07:17,152 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 21:07:17,152 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 66324, num_updates: 60500, {'loss': 0.11319778859615326, 'DER': 0.270198304253381, 'ACC': np.float64(0.9471875), 'MI': 0.1447691121855511, 'FA': 0.06404596734636676, 'CF': 0.061383224721463105}, batch size: 64, grad_norm: 0.17847242951393127, grad_scale: , lr: 1.25e-04, 
2025-02-13 21:07:17,152 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 21:08:02,172 (model:925) WARNING: All labels are zero
2025-02-13 21:08:02,712 (model:925) WARNING: All labels are zero
2025-02-13 21:08:02,819 (model:925) WARNING: All labels are zero
2025-02-13 21:09:26,554 (model:925) WARNING: All labels are zero
2025-02-13 21:09:36,894 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 66324,  validation: loss=0.0823, DER=0.1864, ACC=0.9615, MI=0.07594, FA=0.07445, CF=0.03603, over 0.00 frames. 
2025-02-13 21:09:36,894 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 21:09:37,431 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 66324,  validation: loss=0.08108, DER=0.1869, ACC=0.9622, MI=0.07556, FA=0.07624, CF=0.03514, over 0.00 frames. 
2025-02-13 21:09:37,431 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 21:20:59,012 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 66824, num_updates: 61000, {'loss': 0.11875629425048828, 'DER': 0.2423369808664491, 'ACC': np.float64(0.9518526785714286), 'MI': 0.1611953669930249, 'FA': 0.04741793050489537, 'CF': 0.03372368336852883}, batch size: 64, grad_norm: 0.18562009930610657, grad_scale: , lr: 1.20e-04, 
2025-02-13 21:20:59,012 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 66824, num_updates: 61000, {'loss': 0.09608083963394165, 'DER': 0.2342200180342651, 'ACC': np.float64(0.9569786792052448), 'MI': 0.09881274421400661, 'FA': 0.08017733694018635, 'CF': 0.05522993688007214}, batch size: 64, grad_norm: 0.18562009930610657, grad_scale: , lr: 1.20e-04, 
2025-02-13 21:20:59,013 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 21:20:59,013 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 21:21:43,841 (model:925) WARNING: All labels are zero
2025-02-13 21:21:43,952 (model:925) WARNING: All labels are zero
2025-02-13 21:21:44,379 (model:925) WARNING: All labels are zero
2025-02-13 21:23:06,120 (model:925) WARNING: All labels are zero
2025-02-13 21:23:16,994 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 66824,  validation: loss=0.07813, DER=0.1787, ACC=0.9641, MI=0.08691, FA=0.06145, CF=0.03037, over 0.00 frames. 
2025-02-13 21:23:16,995 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 21:23:18,308 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 66824,  validation: loss=0.07931, DER=0.1825, ACC=0.9629, MI=0.08833, FA=0.06202, CF=0.03212, over 0.00 frames. 
2025-02-13 21:23:18,308 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 21:34:27,551 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 67324, num_updates: 61500, {'loss': 0.0877738744020462, 'DER': 0.21734678952757058, 'ACC': np.float64(0.961439732142857), 'MI': 0.1025303495685242, 'FA': 0.07949393008629516, 'CF': 0.03532250987275121}, batch size: 64, grad_norm: 0.18989470601081848, grad_scale: , lr: 1.14e-04, 
2025-02-13 21:34:27,552 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 67324, num_updates: 61500, {'loss': 0.11769917607307434, 'DER': 0.29237320355866475, 'ACC': np.float64(0.9467857142857143), 'MI': 0.10653182267508174, 'FA': 0.11565660406052772, 'CF': 0.07018477682305528}, batch size: 64, grad_norm: 0.18989470601081848, grad_scale: , lr: 1.14e-04, 
2025-02-13 21:34:27,552 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 21:34:27,552 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 21:35:12,413 (model:925) WARNING: All labels are zero
2025-02-13 21:35:12,670 (model:925) WARNING: All labels are zero
2025-02-13 21:35:12,949 (model:925) WARNING: All labels are zero
2025-02-13 21:36:35,114 (model:925) WARNING: All labels are zero
2025-02-13 21:36:45,984 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 67324,  validation: loss=0.07775, DER=0.1773, ACC=0.964, MI=0.08234, FA=0.06412, CF=0.03087, over 0.00 frames. 
2025-02-13 21:36:45,985 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 21:36:46,847 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 67324,  validation: loss=0.07794, DER=0.1763, ACC=0.9634, MI=0.0836, FA=0.06108, CF=0.03159, over 0.00 frames. 
2025-02-13 21:36:46,848 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 21:40:39,197 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-67500.pt
2025-02-13 21:40:39,630 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-13 21:48:00,055 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 67824, num_updates: 62000, {'loss': 0.10538162291049957, 'DER': 0.25063254536253887, 'ACC': np.float64(0.9525446428571429), 'MI': 0.14609990602183184, 'FA': 0.04778428395864961, 'CF': 0.0567483553820574}, batch size: 64, grad_norm: 0.18427778780460358, grad_scale: , lr: 1.09e-04, 
2025-02-13 21:48:00,055 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 21:48:00,057 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 67824, num_updates: 62000, {'loss': 0.1437370628118515, 'DER': 0.3343089663049686, 'ACC': np.float64(0.9375111607142856), 'MI': 0.1722587093089663, 'FA': 0.09665905197030268, 'CF': 0.0653912050256996}, batch size: 64, grad_norm: 0.18427778780460358, grad_scale: , lr: 1.09e-04, 
2025-02-13 21:48:00,057 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 21:48:45,110 (model:925) WARNING: All labels are zero
2025-02-13 21:48:45,208 (model:925) WARNING: All labels are zero
2025-02-13 21:48:45,650 (model:925) WARNING: All labels are zero
2025-02-13 21:50:08,337 (model:925) WARNING: All labels are zero
2025-02-13 21:50:19,222 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 67824,  validation: loss=0.07553, DER=0.1712, ACC=0.9653, MI=0.08182, FA=0.06026, CF=0.02911, over 0.00 frames. 
2025-02-13 21:50:19,223 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 21:50:19,932 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 67824,  validation: loss=0.07598, DER=0.1715, ACC=0.9647, MI=0.08363, FA=0.05873, CF=0.02916, over 0.00 frames. 
2025-02-13 21:50:19,933 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 22:01:35,765 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 68324, num_updates: 62500, {'loss': 0.10086388885974884, 'DER': 0.24716895666616337, 'ACC': np.float64(0.9537388392857143), 'MI': 0.11052393175298203, 'FA': 0.07088932507926922, 'CF': 0.06575569983391212}, batch size: 64, grad_norm: 0.15777897834777832, grad_scale: , lr: 1.03e-04, 
2025-02-13 22:01:35,766 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 22:01:35,766 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 68324, num_updates: 62500, {'loss': 0.09852512180805206, 'DER': 0.2230357645733596, 'ACC': np.float64(0.957578125), 'MI': 0.1299633905941988, 'FA': 0.048507462686567165, 'CF': 0.044564911292593636}, batch size: 64, grad_norm: 0.15777897834777832, grad_scale: , lr: 1.03e-04, 
2025-02-13 22:01:35,767 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 22:02:20,709 (model:925) WARNING: All labels are zero
2025-02-13 22:02:21,246 (model:925) WARNING: All labels are zero
2025-02-13 22:02:21,421 (model:925) WARNING: All labels are zero
2025-02-13 22:03:44,799 (model:925) WARNING: All labels are zero
2025-02-13 22:03:55,277 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 68324,  validation: loss=0.08052, DER=0.1803, ACC=0.9626, MI=0.08071, FA=0.06527, CF=0.03431, over 0.00 frames. 
2025-02-13 22:03:55,277 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 22:03:55,817 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 68324,  validation: loss=0.07956, DER=0.1785, ACC=0.9634, MI=0.07694, FA=0.06691, CF=0.03462, over 0.00 frames. 
2025-02-13 22:03:55,818 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 22:15:17,726 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 68824, num_updates: 63000, {'loss': 0.10261301696300507, 'DER': 0.2267037552155772, 'ACC': np.float64(0.9566183035714286), 'MI': 0.14755944102258428, 'FA': 0.048413802238558845, 'CF': 0.03073051195443407}, batch size: 64, grad_norm: 0.22438307106494904, grad_scale: , lr: 9.75e-05, 
2025-02-13 22:15:17,727 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 22:15:17,728 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 68824, num_updates: 63000, {'loss': 0.11045420914888382, 'DER': 0.24732341740317598, 'ACC': np.float64(0.952109375), 'MI': 0.12279945390529567, 'FA': 0.06351943666019975, 'CF': 0.06100452683768053}, batch size: 64, grad_norm: 0.22438307106494904, grad_scale: , lr: 9.75e-05, 
2025-02-13 22:15:17,728 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 22:16:02,728 (model:925) WARNING: All labels are zero
2025-02-13 22:16:03,125 (model:925) WARNING: All labels are zero
2025-02-13 22:16:03,264 (model:925) WARNING: All labels are zero
2025-02-13 22:17:25,897 (model:925) WARNING: All labels are zero
2025-02-13 22:17:36,832 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 68824,  validation: loss=0.07098, DER=0.1655, ACC=0.9666, MI=0.09537, FA=0.04604, CF=0.02409, over 0.00 frames. 
2025-02-13 22:17:36,832 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 22:17:37,387 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 68824,  validation: loss=0.07288, DER=0.167, ACC=0.9654, MI=0.09651, FA=0.04342, CF=0.02707, over 0.00 frames. 
2025-02-13 22:17:37,387 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 22:21:37,827 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-69000.pt
2025-02-13 22:21:38,257 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-13 22:28:54,038 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 69324, num_updates: 63500, {'loss': 0.08380652219057083, 'DER': 0.20395367706719775, 'ACC': np.float64(0.9629671281249649), 'MI': 0.11470089252784539, 'FA': 0.05030611492218042, 'CF': 0.03894666961717194}, batch size: 64, grad_norm: 0.12297366559505463, grad_scale: , lr: 9.19e-05, 
2025-02-13 22:28:54,038 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 22:28:54,039 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 69324, num_updates: 63500, {'loss': 0.10178668051958084, 'DER': 0.23362637362637362, 'ACC': np.float64(0.9539620535714286), 'MI': 0.1019047619047619, 'FA': 0.06315018315018316, 'CF': 0.06857142857142857}, batch size: 64, grad_norm: 0.12297366559505463, grad_scale: , lr: 9.19e-05, 
2025-02-13 22:28:54,040 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 22:29:38,970 (model:925) WARNING: All labels are zero
2025-02-13 22:29:39,118 (model:925) WARNING: All labels are zero
2025-02-13 22:29:39,657 (model:925) WARNING: All labels are zero
2025-02-13 22:31:01,057 (model:925) WARNING: All labels are zero
2025-02-13 22:31:11,894 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 69324,  validation: loss=0.07423, DER=0.1663, ACC=0.9662, MI=0.07886, FA=0.06092, CF=0.02656, over 0.00 frames. 
2025-02-13 22:31:11,894 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 22:31:13,872 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 69324,  validation: loss=0.07672, DER=0.1719, ACC=0.9644, MI=0.08131, FA=0.06098, CF=0.02957, over 0.00 frames. 
2025-02-13 22:31:13,873 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 22:43:10,021 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 69824, num_updates: 64000, {'loss': 0.1234152764081955, 'DER': 0.2952625017315418, 'ACC': np.float64(0.94359375), 'MI': 0.1713533730433578, 'FA': 0.06912314725031168, 'CF': 0.054785981437872285}, batch size: 64, grad_norm: 0.1741403490304947, grad_scale: , lr: 8.63e-05, 
2025-02-13 22:43:10,021 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 69824, num_updates: 64000, {'loss': 0.0972793847322464, 'DER': 0.2366611866686594, 'ACC': np.float64(0.957734375), 'MI': 0.11530413988940368, 'FA': 0.0750261545359438, 'CF': 0.04633089224331191}, batch size: 64, grad_norm: 0.1741403490304947, grad_scale: , lr: 8.63e-05, 
2025-02-13 22:43:10,021 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 22:43:10,021 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 22:43:57,568 (model:925) WARNING: All labels are zero
2025-02-13 22:43:57,842 (model:925) WARNING: All labels are zero
2025-02-13 22:43:58,139 (model:925) WARNING: All labels are zero
2025-02-13 22:45:25,260 (model:925) WARNING: All labels are zero
2025-02-13 22:45:36,787 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 69824,  validation: loss=0.0782, DER=0.1771, ACC=0.9636, MI=0.09215, FA=0.05193, CF=0.033, over 0.00 frames. 
2025-02-13 22:45:36,788 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 22:45:37,265 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 69824,  validation: loss=0.07899, DER=0.1782, ACC=0.9628, MI=0.09372, FA=0.05071, CF=0.03378, over 0.00 frames. 
2025-02-13 22:45:37,265 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 22:48:18,737 (train_accelerate_ddp:713) INFO: end of epoch 16, batch_idx: 4113 batch_idx_train: 69937, {'loss': 0.10269292443990707, 'DER': 0.21299374916877245, 'ACC': np.float64(0.9585267857142857), 'MI': 0.11477590105067163, 'FA': 0.06410426918473201, 'CF': 0.0341135789333688}, batch size: 64, grad_norm: 0.1279314160346985, grad_scale: , lr: 8.51e-05, 
2025-02-13 22:48:18,737 (train_accelerate_ddp:713) INFO: end of epoch 16, batch_idx: 4113 batch_idx_train: 69937, {'loss': 0.0902247205376625, 'DER': 0.20295763941676456, 'ACC': np.float64(0.9629910714285714), 'MI': 0.1224518001520282, 'FA': 0.054315527606938016, 'CF': 0.026190311657798355}, batch size: 64, grad_norm: 0.1279314160346985, grad_scale: , lr: 8.51e-05, 
2025-02-13 22:48:18,739 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-16.pt
2025-02-13 22:48:19,061 (train_accelerate_ddp:561) INFO:  end of epoch 16, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-16.pt 
2025-02-13 22:48:21,671 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 69938, num_updates: 64000, {'loss': 0.11090832948684692, 'DER': 0.2609149780655943, 'ACC': np.float64(0.9501450892857143), 'MI': 0.13919643478866375, 'FA': 0.07158275886080356, 'CF': 0.05013578441612701}, batch size: 64, grad_norm: 0.13059411942958832, grad_scale: , lr: 8.51e-05, 
2025-02-13 22:48:21,672 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 69938, num_updates: 64000, {'loss': 0.08207398653030396, 'DER': 0.18965386078356788, 'ACC': np.float64(0.9669084821428571), 'MI': 0.0890833016356029, 'FA': 0.06466337010270065, 'CF': 0.03590718904526436}, batch size: 64, grad_norm: 0.13059411942958832, grad_scale: , lr: 8.51e-05, 
2025-02-13 22:59:46,010 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 70438, num_updates: 64500, {'loss': 0.10207244008779526, 'DER': 0.24634825735443985, 'ACC': np.float64(0.9524776785714286), 'MI': 0.15272776683198586, 'FA': 0.05068279095047218, 'CF': 0.04293769957198179}, batch size: 64, grad_norm: 0.11431843042373657, grad_scale: , lr: 7.95e-05, 
2025-02-13 22:59:46,011 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 22:59:46,013 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 70438, num_updates: 64500, {'loss': 0.08705053478479385, 'DER': 0.19522666084552134, 'ACC': np.float64(0.9633482142857143), 'MI': 0.09670377646802009, 'FA': 0.05479153023357346, 'CF': 0.04373135414392782}, batch size: 64, grad_norm: 0.11431843042373657, grad_scale: , lr: 7.95e-05, 
2025-02-13 22:59:46,013 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 23:00:30,450 (model:925) WARNING: All labels are zero
2025-02-13 23:00:30,979 (model:925) WARNING: All labels are zero
2025-02-13 23:00:31,586 (model:925) WARNING: All labels are zero
2025-02-13 23:01:54,788 (model:925) WARNING: All labels are zero
2025-02-13 23:02:03,885 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 70438,  validation: loss=0.07831, DER=0.1772, ACC=0.9633, MI=0.08582, FA=0.05861, CF=0.03277, over 0.00 frames. 
2025-02-13 23:02:03,885 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 23:02:05,784 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 70438,  validation: loss=0.0766, DER=0.1735, ACC=0.9647, MI=0.08471, FA=0.05913, CF=0.02969, over 0.00 frames. 
2025-02-13 23:02:05,784 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 23:03:30,914 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-70500.pt
2025-02-13 23:03:31,307 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-13 23:03:31,317 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-13 23:13:28,143 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 70938, num_updates: 65000, {'loss': 0.09583771973848343, 'DER': 0.2306800898095169, 'ACC': np.float64(0.9574783184301758), 'MI': 0.12645759397407114, 'FA': 0.0604041428261027, 'CF': 0.043818353009343086}, batch size: 64, grad_norm: 0.156911700963974, grad_scale: , lr: 7.40e-05, 
2025-02-13 23:13:28,144 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 23:13:28,146 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 70938, num_updates: 65000, {'loss': 0.09504874050617218, 'DER': 0.2268196486195769, 'ACC': np.float64(0.95953125), 'MI': 0.11660093223377554, 'FA': 0.07701685191825026, 'CF': 0.03320186446755109}, batch size: 64, grad_norm: 0.156911700963974, grad_scale: , lr: 7.40e-05, 
2025-02-13 23:13:28,146 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 23:14:13,056 (model:925) WARNING: All labels are zero
2025-02-13 23:14:13,595 (model:925) WARNING: All labels are zero
2025-02-13 23:14:13,827 (model:925) WARNING: All labels are zero
2025-02-13 23:15:37,325 (model:925) WARNING: All labels are zero
2025-02-13 23:15:47,541 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 70938,  validation: loss=0.07993, DER=0.1802, ACC=0.963, MI=0.09271, FA=0.05545, CF=0.03203, over 0.00 frames. 
2025-02-13 23:15:47,541 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 23:15:48,345 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 70938,  validation: loss=0.07781, DER=0.1758, ACC=0.9643, MI=0.09197, FA=0.054, CF=0.02988, over 0.00 frames. 
2025-02-13 23:15:48,345 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 23:27:09,179 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 71438, num_updates: 65500, {'loss': 0.09090805053710938, 'DER': 0.23571161748225625, 'ACC': np.float64(0.9598217792891374), 'MI': 0.12379529323870003, 'FA': 0.08016436309301457, 'CF': 0.03175196115054165}, batch size: 64, grad_norm: 0.15249815583229065, grad_scale: , lr: 6.84e-05, 
2025-02-13 23:27:09,179 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 23:27:09,181 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 71438, num_updates: 65500, {'loss': 0.09388107806444168, 'DER': 0.2162883845126836, 'ACC': np.float64(0.9596316964285714), 'MI': 0.1233223245028459, 'FA': 0.055090998524348254, 'CF': 0.03787506148548942}, batch size: 64, grad_norm: 0.15249815583229065, grad_scale: , lr: 6.84e-05, 
2025-02-13 23:27:09,182 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 23:27:53,996 (model:925) WARNING: All labels are zero
2025-02-13 23:27:54,534 (model:925) WARNING: All labels are zero
2025-02-13 23:27:54,743 (model:925) WARNING: All labels are zero
2025-02-13 23:29:18,067 (model:925) WARNING: All labels are zero
2025-02-13 23:29:28,400 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 71438,  validation: loss=0.07641, DER=0.1717, ACC=0.9644, MI=0.0882, FA=0.05349, CF=0.03002, over 0.00 frames. 
2025-02-13 23:29:28,401 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 23:29:29,055 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 71438,  validation: loss=0.07511, DER=0.1701, ACC=0.9653, MI=0.08759, FA=0.05449, CF=0.02803, over 0.00 frames. 
2025-02-13 23:29:29,056 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 23:41:42,173 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 71938, num_updates: 66000, {'loss': 0.09605974704027176, 'DER': 0.22334161050017737, 'ACC': np.float64(0.9579575892857143), 'MI': 0.1354380986165307, 'FA': 0.04398722951401206, 'CF': 0.04391628236963462}, batch size: 64, grad_norm: 0.12136394530534744, grad_scale: , lr: 6.29e-05, 
2025-02-13 23:41:42,174 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 23:41:42,176 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 71938, num_updates: 66000, {'loss': 0.08788097649812698, 'DER': 0.20957613814756673, 'ACC': np.float64(0.9625558035714286), 'MI': 0.12822891394319966, 'FA': 0.051519908662765804, 'CF': 0.029827315541601257}, batch size: 64, grad_norm: 0.12136394530534744, grad_scale: , lr: 6.29e-05, 
2025-02-13 23:41:42,176 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 23:42:30,596 (model:925) WARNING: All labels are zero
2025-02-13 23:42:31,095 (model:925) WARNING: All labels are zero
2025-02-13 23:42:31,168 (model:925) WARNING: All labels are zero
2025-02-13 23:43:58,916 (model:925) WARNING: All labels are zero
2025-02-13 23:44:09,627 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 71938,  validation: loss=0.0808, DER=0.1781, ACC=0.9625, MI=0.09592, FA=0.04574, CF=0.03644, over 0.00 frames. 
2025-02-13 23:44:09,627 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 23:44:09,965 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 71938,  validation: loss=0.0808, DER=0.1812, ACC=0.9626, MI=0.09711, FA=0.04718, CF=0.03689, over 0.00 frames. 
2025-02-13 23:44:09,965 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 23:45:33,663 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-72000.pt
2025-02-13 23:45:34,064 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-13 23:55:42,596 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 72438, num_updates: 66500, {'loss': 0.09473790228366852, 'DER': 0.22489423291026497, 'ACC': np.float64(0.9582183681513599), 'MI': 0.10658353744526089, 'FA': 0.06783938246864099, 'CF': 0.050471312996363094}, batch size: 64, grad_norm: 0.1936444193124771, grad_scale: , lr: 5.73e-05, 
2025-02-13 23:55:42,596 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 23:55:42,597 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 72438, num_updates: 66500, {'loss': 0.11083348840475082, 'DER': 0.2421365826013035, 'ACC': np.float64(0.953984375), 'MI': 0.14189572116746954, 'FA': 0.05029753471238311, 'CF': 0.04994332672145083}, batch size: 64, grad_norm: 0.1936444193124771, grad_scale: , lr: 5.73e-05, 
2025-02-13 23:55:42,597 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-13 23:56:27,641 (model:925) WARNING: All labels are zero
2025-02-13 23:56:28,178 (model:925) WARNING: All labels are zero
2025-02-13 23:56:28,188 (model:925) WARNING: All labels are zero
2025-02-13 23:57:51,441 (model:925) WARNING: All labels are zero
2025-02-13 23:58:02,382 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 72438,  validation: loss=0.07563, DER=0.1698, ACC=0.9647, MI=0.08586, FA=0.05395, CF=0.02998, over 0.00 frames. 
2025-02-13 23:58:02,382 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-13 23:58:02,438 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 72438,  validation: loss=0.07376, DER=0.1672, ACC=0.9659, MI=0.0848, FA=0.05463, CF=0.02774, over 0.00 frames. 
2025-02-13 23:58:02,439 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 00:09:24,173 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 72938, num_updates: 67000, {'loss': 0.08908675611019135, 'DER': 0.21697161792248956, 'ACC': np.float64(0.9608370535714286), 'MI': 0.1297363492292177, 'FA': 0.05143351102146665, 'CF': 0.03580175767180521}, batch size: 64, grad_norm: 0.13161349296569824, grad_scale: , lr: 5.17e-05, 
2025-02-14 00:09:24,173 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 00:09:24,174 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 72938, num_updates: 67000, {'loss': 0.09090346097946167, 'DER': 0.20535219079312259, 'ACC': np.float64(0.9620870535714287), 'MI': 0.1269412090959512, 'FA': 0.048252911813643926, 'CF': 0.030158069883527455}, batch size: 64, grad_norm: 0.13161349296569824, grad_scale: , lr: 5.17e-05, 
2025-02-14 00:09:24,174 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 00:10:08,512 (model:925) WARNING: All labels are zero
2025-02-14 00:10:09,041 (model:925) WARNING: All labels are zero
2025-02-14 00:10:09,873 (model:925) WARNING: All labels are zero
2025-02-14 00:11:33,396 (model:925) WARNING: All labels are zero
2025-02-14 00:11:41,693 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 72938,  validation: loss=0.07601, DER=0.1689, ACC=0.9646, MI=0.08756, FA=0.05053, CF=0.03082, over 0.00 frames. 
2025-02-14 00:11:41,693 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 00:11:44,416 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 72938,  validation: loss=0.07369, DER=0.1669, ACC=0.9657, MI=0.08552, FA=0.05201, CF=0.02935, over 0.00 frames. 
2025-02-14 00:11:44,417 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 00:23:22,918 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 73438, num_updates: 67500, {'loss': 0.08226516842842102, 'DER': 0.21738792634604925, 'ACC': np.float64(0.9660714285714286), 'MI': 0.12648589853158262, 'FA': 0.07210006992463679, 'CF': 0.01880195788982985}, batch size: 64, grad_norm: 0.14016883075237274, grad_scale: , lr: 4.62e-05, 
2025-02-14 00:23:22,918 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 00:23:22,921 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 73438, num_updates: 67500, {'loss': 0.08785049617290497, 'DER': 0.20466681296174383, 'ACC': np.float64(0.9649553571428571), 'MI': 0.10635652110306489, 'FA': 0.07329383366249725, 'CF': 0.025016458196181698}, batch size: 64, grad_norm: 0.14016883075237274, grad_scale: , lr: 4.62e-05, 
2025-02-14 00:23:22,921 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 00:24:14,515 (model:925) WARNING: All labels are zero
2025-02-14 00:24:15,073 (model:925) WARNING: All labels are zero
2025-02-14 00:24:15,117 (model:925) WARNING: All labels are zero
2025-02-14 00:25:45,324 (model:925) WARNING: All labels are zero
2025-02-14 00:25:57,121 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 73438,  validation: loss=0.07589, DER=0.1715, ACC=0.965, MI=0.08343, FA=0.05863, CF=0.02948, over 0.00 frames. 
2025-02-14 00:25:57,121 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 00:25:57,219 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 73438,  validation: loss=0.07823, DER=0.174, ACC=0.9636, MI=0.0841, FA=0.05679, CF=0.0331, over 0.00 frames. 
2025-02-14 00:25:57,219 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 00:27:54,774 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-73500.pt
2025-02-14 00:27:55,217 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-14 00:38:33,153 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 73938, num_updates: 68000, {'loss': 0.09621266275644302, 'DER': 0.2216712308489379, 'ACC': np.float64(0.958515625), 'MI': 0.11716379246539857, 'FA': 0.051069498926800384, 'CF': 0.053437939456738956}, batch size: 64, grad_norm: 0.16275233030319214, grad_scale: , lr: 4.06e-05, 
2025-02-14 00:38:33,154 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 00:38:33,154 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 73938, num_updates: 68000, {'loss': 0.10875929892063141, 'DER': 0.2255001010305112, 'ACC': np.float64(0.953359375), 'MI': 0.1303293594665589, 'FA': 0.039199838351182056, 'CF': 0.055970903212770255}, batch size: 64, grad_norm: 0.16275233030319214, grad_scale: , lr: 4.06e-05, 
2025-02-14 00:38:33,154 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 00:39:17,962 (model:925) WARNING: All labels are zero
2025-02-14 00:39:18,498 (model:925) WARNING: All labels are zero
2025-02-14 00:39:19,498 (model:925) WARNING: All labels are zero
2025-02-14 00:40:44,534 (model:925) WARNING: All labels are zero
2025-02-14 00:40:52,035 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 73938,  validation: loss=0.0749, DER=0.1687, ACC=0.9648, MI=0.08887, FA=0.04955, CF=0.03027, over 0.00 frames. 
2025-02-14 00:40:52,036 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 00:40:55,698 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 73938,  validation: loss=0.07267, DER=0.1646, ACC=0.9663, MI=0.08723, FA=0.05054, CF=0.02681, over 0.00 frames. 
2025-02-14 00:40:55,698 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 00:43:32,319 (train_accelerate_ddp:713) INFO: end of epoch 17, batch_idx: 4113 batch_idx_train: 74051, {'loss': 0.10178971290588379, 'DER': 0.24714773635636944, 'ACC': np.float64(0.952734375), 'MI': 0.11910471622701839, 'FA': 0.06743695952329046, 'CF': 0.06060606060606061}, batch size: 64, grad_norm: 0.14771726727485657, grad_scale: , lr: 3.94e-05, 
2025-02-14 00:43:32,322 (train_accelerate_ddp:713) INFO: end of epoch 17, batch_idx: 4113 batch_idx_train: 74051, {'loss': 0.1002531498670578, 'DER': 0.25341753343239226, 'ACC': np.float64(0.954453125), 'MI': 0.16032689450222884, 'FA': 0.043313521545319464, 'CF': 0.04977711738484398}, batch size: 64, grad_norm: 0.14771726727485657, grad_scale: , lr: 3.94e-05, 
2025-02-14 00:43:32,325 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-17.pt
2025-02-14 00:43:32,638 (train_accelerate_ddp:561) INFO:  end of epoch 17, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-17.pt 
2025-02-14 00:43:35,280 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 74052, num_updates: 68000, {'loss': 0.08359299600124359, 'DER': 0.20464335255895452, 'ACC': np.float64(0.9649553571428571), 'MI': 0.11681390085420165, 'FA': 0.06322552383733664, 'CF': 0.024603927867416223}, batch size: 64, grad_norm: 0.11312195658683777, grad_scale: , lr: 3.94e-05, 
2025-02-14 00:43:35,282 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 74052, num_updates: 68000, {'loss': 0.0966818705201149, 'DER': 0.22244326554671381, 'ACC': np.float64(0.9599553571428571), 'MI': 0.11921603300913645, 'FA': 0.06130268199233716, 'CF': 0.0419245505452402}, batch size: 64, grad_norm: 0.11312195658683777, grad_scale: , lr: 3.94e-05, 
2025-02-14 00:55:00,804 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 74552, num_updates: 68500, {'loss': 0.11575010418891907, 'DER': 0.2679324894514768, 'ACC': np.float64(0.949216075777471), 'MI': 0.14669479606188468, 'FA': 0.0709563994374121, 'CF': 0.05028129395218003}, batch size: 64, grad_norm: 0.18626263737678528, grad_scale: , lr: 3.38e-05, 
2025-02-14 00:55:00,805 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 00:55:00,805 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 74552, num_updates: 68500, {'loss': 0.09266266226768494, 'DER': 0.23247346812301495, 'ACC': np.float64(0.9581138392857143), 'MI': 0.10814160663103262, 'FA': 0.06607793012626849, 'CF': 0.05825393136571384}, batch size: 64, grad_norm: 0.18626263737678528, grad_scale: , lr: 3.38e-05, 
2025-02-14 00:55:00,805 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 00:55:45,978 (model:925) WARNING: All labels are zero
2025-02-14 00:55:46,517 (model:925) WARNING: All labels are zero
2025-02-14 00:55:46,713 (model:925) WARNING: All labels are zero
2025-02-14 00:57:11,021 (model:925) WARNING: All labels are zero
2025-02-14 00:57:21,408 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 74552,  validation: loss=0.07358, DER=0.1667, ACC=0.9654, MI=0.08271, FA=0.05527, CF=0.02874, over 0.00 frames. 
2025-02-14 00:57:21,408 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 00:57:22,148 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 74552,  validation: loss=0.07143, DER=0.1619, ACC=0.967, MI=0.08113, FA=0.05616, CF=0.02457, over 0.00 frames. 
2025-02-14 00:57:22,148 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 01:07:33,701 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-75000.pt
2025-02-14 01:07:34,159 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-14 01:07:34,178 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-14 01:08:47,442 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 75052, num_updates: 69000, {'loss': 0.0740048810839653, 'DER': 0.17543222432079036, 'ACC': np.float64(0.9693861607142857), 'MI': 0.0905855005084992, 'FA': 0.06101990411157925, 'CF': 0.023826819700711897}, batch size: 64, grad_norm: 0.13402925431728363, grad_scale: , lr: 2.83e-05, 
2025-02-14 01:08:47,442 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 01:08:47,443 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 75052, num_updates: 69000, {'loss': 0.10058093816041946, 'DER': 0.2405572111719454, 'ACC': np.float64(0.9551339285714286), 'MI': 0.1409661099175272, 'FA': 0.06154272645366969, 'CF': 0.03804837480074849}, batch size: 64, grad_norm: 0.13402925431728363, grad_scale: , lr: 2.83e-05, 
2025-02-14 01:08:47,443 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 01:09:32,513 (model:925) WARNING: All labels are zero
2025-02-14 01:09:33,058 (model:925) WARNING: All labels are zero
2025-02-14 01:09:33,190 (model:925) WARNING: All labels are zero
2025-02-14 01:10:57,151 (model:925) WARNING: All labels are zero
2025-02-14 01:11:07,764 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 75052,  validation: loss=0.07609, DER=0.1706, ACC=0.9642, MI=0.08744, FA=0.05183, CF=0.03133, over 0.00 frames. 
2025-02-14 01:11:07,764 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 01:11:08,240 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 75052,  validation: loss=0.0739, DER=0.1687, ACC=0.9655, MI=0.08705, FA=0.05348, CF=0.02819, over 0.00 frames. 
2025-02-14 01:11:08,240 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 01:23:12,055 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 75552, num_updates: 69500, {'loss': 0.10221358388662338, 'DER': 0.23817712811693895, 'ACC': np.float64(0.9538169642857143), 'MI': 0.1467028242608638, 'FA': 0.05595608175143859, 'CF': 0.03551822210463655}, batch size: 64, grad_norm: 0.14852282404899597, grad_scale: , lr: 2.27e-05, 
2025-02-14 01:23:12,056 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 01:23:12,058 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 75552, num_updates: 69500, {'loss': 0.105816550552845, 'DER': 0.23595734564966378, 'ACC': np.float64(0.9530691964285714), 'MI': 0.1289139441689873, 'FA': 0.057393194321809414, 'CF': 0.04965020715886708}, batch size: 64, grad_norm: 0.14852282404899597, grad_scale: , lr: 2.27e-05, 
2025-02-14 01:23:12,058 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 01:23:57,077 (model:925) WARNING: All labels are zero
2025-02-14 01:23:57,592 (model:925) WARNING: All labels are zero
2025-02-14 01:23:57,630 (model:925) WARNING: All labels are zero
2025-02-14 01:25:21,200 (model:925) WARNING: All labels are zero
2025-02-14 01:25:32,043 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 75552,  validation: loss=0.0746, DER=0.1679, ACC=0.965, MI=0.07965, FA=0.05884, CF=0.0294, over 0.00 frames. 
2025-02-14 01:25:32,043 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 01:25:32,140 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 75552,  validation: loss=0.07282, DER=0.1642, ACC=0.9665, MI=0.07774, FA=0.06, CF=0.02648, over 0.00 frames. 
2025-02-14 01:25:32,141 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 01:37:29,465 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 76052, num_updates: 70000, {'loss': 0.10610063374042511, 'DER': 0.22211336599020293, 'ACC': np.float64(0.9580803571428571), 'MI': 0.12295311406578027, 'FA': 0.05843247025892232, 'CF': 0.04072778166550035}, batch size: 64, grad_norm: 0.18165959417819977, grad_scale: , lr: 1.71e-05, 
2025-02-14 01:37:29,466 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 01:37:29,468 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 76052, num_updates: 70000, {'loss': 0.0914822369813919, 'DER': 0.22010850419220743, 'ACC': np.float64(0.9612276785714287), 'MI': 0.14697386035369547, 'FA': 0.04847460015500599, 'CF': 0.024660043683505953}, batch size: 64, grad_norm: 0.18165959417819977, grad_scale: , lr: 1.71e-05, 
2025-02-14 01:37:29,469 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 01:38:17,139 (model:925) WARNING: All labels are zero
2025-02-14 01:38:17,620 (model:925) WARNING: All labels are zero
2025-02-14 01:38:17,698 (model:925) WARNING: All labels are zero
2025-02-14 01:39:45,484 (model:925) WARNING: All labels are zero
2025-02-14 01:39:56,782 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 76052,  validation: loss=0.07501, DER=0.1673, ACC=0.9648, MI=0.08155, FA=0.05509, CF=0.0307, over 0.00 frames. 
2025-02-14 01:39:56,783 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 01:39:56,924 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 76052,  validation: loss=0.0729, DER=0.1646, ACC=0.9662, MI=0.08118, FA=0.0563, CF=0.02715, over 0.00 frames. 
2025-02-14 01:39:56,924 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 01:50:24,140 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-76500.pt
2025-02-14 01:50:24,559 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-14 01:51:36,162 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 76552, num_updates: 70500, {'loss': 0.10941311717033386, 'DER': 0.25128955806496583, 'ACC': np.float64(0.9526785714285714), 'MI': 0.14596403178586365, 'FA': 0.06106231702216646, 'CF': 0.044263209256935734}, batch size: 64, grad_norm: 0.255129873752594, grad_scale: , lr: 1.16e-05, 
2025-02-14 01:51:36,163 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 01:51:36,165 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 76552, num_updates: 70500, {'loss': 0.10442831367254257, 'DER': 0.24669538095945343, 'ACC': np.float64(0.9538704475204947), 'MI': 0.12008020199019753, 'FA': 0.06742908064755682, 'CF': 0.0591860983216991}, batch size: 64, grad_norm: 0.255129873752594, grad_scale: , lr: 1.16e-05, 
2025-02-14 01:51:36,165 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 01:52:22,928 (model:925) WARNING: All labels are zero
2025-02-14 01:52:23,492 (model:925) WARNING: All labels are zero
2025-02-14 01:52:24,058 (model:925) WARNING: All labels are zero
2025-02-14 01:53:51,432 (model:925) WARNING: All labels are zero
2025-02-14 01:54:00,967 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 76552,  validation: loss=0.0741, DER=0.1661, ACC=0.9651, MI=0.08575, FA=0.05009, CF=0.03029, over 0.00 frames. 
2025-02-14 01:54:00,967 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 01:54:02,938 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 76552,  validation: loss=0.07204, DER=0.1632, ACC=0.9665, MI=0.08516, FA=0.05121, CF=0.02682, over 0.00 frames. 
2025-02-14 01:54:02,938 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 02:05:30,376 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 77052, num_updates: 71000, {'loss': 0.09850212931632996, 'DER': 0.2232732072151342, 'ACC': np.float64(0.9581134269612667), 'MI': 0.11042674879014518, 'FA': 0.061445959818155156, 'CF': 0.05140049860683385}, batch size: 64, grad_norm: 0.15423472225666046, grad_scale: , lr: 6.03e-06, 
2025-02-14 02:05:30,377 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 02:05:30,377 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 77052, num_updates: 71000, {'loss': 0.08075445145368576, 'DER': 0.2144428430554502, 'ACC': np.float64(0.9624332377579131), 'MI': 0.1094591519381021, 'FA': 0.06599408328908443, 'CF': 0.038989607828263675}, batch size: 64, grad_norm: 0.15423472225666046, grad_scale: , lr: 6.03e-06, 
2025-02-14 02:05:30,377 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 02:06:14,804 (model:925) WARNING: All labels are zero
2025-02-14 02:06:15,333 (model:925) WARNING: All labels are zero
2025-02-14 02:06:15,891 (model:925) WARNING: All labels are zero
2025-02-14 02:07:39,103 (model:925) WARNING: All labels are zero
2025-02-14 02:07:48,086 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 77052,  validation: loss=0.07396, DER=0.1661, ACC=0.9653, MI=0.08436, FA=0.05236, CF=0.02939, over 0.00 frames. 
2025-02-14 02:07:48,086 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 02:07:50,083 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 77052,  validation: loss=0.07197, DER=0.1629, ACC=0.9666, MI=0.08323, FA=0.05333, CF=0.02635, over 0.00 frames. 
2025-02-14 02:07:50,083 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 02:19:49,121 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 77552, num_updates: 71500, {'loss': 0.08495894819498062, 'DER': 0.18986604542807223, 'ACC': np.float64(0.9643191964285713), 'MI': 0.09435061153174142, 'FA': 0.05263541059988352, 'CF': 0.042880023296447294}, batch size: 64, grad_norm: 0.13784915208816528, grad_scale: , lr: 4.78e-07, 
2025-02-14 02:19:49,121 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 77552, num_updates: 71500, {'loss': 0.09213569760322571, 'DER': 0.22145953757225434, 'ACC': np.float64(0.9590959821428571), 'MI': 0.11466763005780346, 'FA': 0.0634393063583815, 'CF': 0.04335260115606936}, batch size: 64, grad_norm: 0.13784915208816528, grad_scale: , lr: 4.78e-07, 
2025-02-14 02:19:49,121 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 02:19:49,121 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 02:20:34,073 (model:925) WARNING: All labels are zero
2025-02-14 02:20:34,621 (model:925) WARNING: All labels are zero
2025-02-14 02:20:35,003 (model:925) WARNING: All labels are zero
2025-02-14 02:21:58,853 (model:925) WARNING: All labels are zero
2025-02-14 02:22:08,725 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 77552,  validation: loss=0.07379, DER=0.166, ACC=0.9654, MI=0.08598, FA=0.05104, CF=0.02893, over 0.00 frames. 
2025-02-14 02:22:08,725 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 02:22:09,911 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 77552,  validation: loss=0.07168, DER=0.1628, ACC=0.9668, MI=0.08524, FA=0.05194, CF=0.0256, over 0.00 frames. 
2025-02-14 02:22:09,912 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 02:32:25,299 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-78000.pt
2025-02-14 02:32:25,742 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-14 02:33:38,656 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 78052, num_updates: 72000, {'loss': 0.09622538089752197, 'DER': 0.21981880750052674, 'ACC': np.float64(0.9578236607142857), 'MI': 0.10056886017276494, 'FA': 0.07367090385560784, 'CF': 0.04557904347215394}, batch size: 64, grad_norm: 0.1449209451675415, grad_scale: , lr: 0.00e+00, 
2025-02-14 02:33:38,656 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 02:33:38,657 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 78052, num_updates: 72000, {'loss': 0.09697983413934708, 'DER': 0.22079642931864146, 'ACC': np.float64(0.957993772692018), 'MI': 0.12497384754864356, 'FA': 0.05600111583792454, 'CF': 0.03982146593207336}, batch size: 64, grad_norm: 0.1449209451675415, grad_scale: , lr: 0.00e+00, 
2025-02-14 02:33:38,657 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 02:34:23,259 (model:925) WARNING: All labels are zero
2025-02-14 02:34:23,792 (model:925) WARNING: All labels are zero
2025-02-14 02:34:24,242 (model:925) WARNING: All labels are zero
2025-02-14 02:35:48,114 (model:925) WARNING: All labels are zero
2025-02-14 02:35:56,877 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 78052,  validation: loss=0.07388, DER=0.1658, ACC=0.9653, MI=0.08742, FA=0.04961, CF=0.02882, over 0.00 frames. 
2025-02-14 02:35:56,877 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 02:35:59,094 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 78052,  validation: loss=0.07187, DER=0.1634, ACC=0.9666, MI=0.08717, FA=0.0507, CF=0.02558, over 0.00 frames. 
2025-02-14 02:35:59,095 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 02:38:30,260 (train_accelerate_ddp:713) INFO: end of epoch 18, batch_idx: 4113 batch_idx_train: 78165, {'loss': 0.09520548582077026, 'DER': 0.20051413881748073, 'ACC': np.float64(0.9636160714285714), 'MI': 0.09834741094381197, 'FA': 0.06323907455012853, 'CF': 0.038927653323540215}, batch size: 64, grad_norm: 0.12740813195705414, grad_scale: , lr: 0.00e+00, 
2025-02-14 02:38:30,261 (train_accelerate_ddp:713) INFO: end of epoch 18, batch_idx: 4113 batch_idx_train: 78165, {'loss': 0.09000172466039658, 'DER': 0.20887955384949664, 'ACC': np.float64(0.961953125), 'MI': 0.11385529079452451, 'FA': 0.057000072427029765, 'CF': 0.03802419062794235}, batch size: 64, grad_norm: 0.12740813195705414, grad_scale: , lr: 0.00e+00, 
2025-02-14 02:38:30,263 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-18.pt
2025-02-14 02:38:30,581 (train_accelerate_ddp:561) INFO:  end of epoch 18, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-18.pt 
2025-02-14 02:38:33,067 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 78166, num_updates: 72000, {'loss': 0.07146849483251572, 'DER': 0.17390002993115833, 'ACC': np.float64(0.969765625), 'MI': 0.08492966177791081, 'FA': 0.06016162825501347, 'CF': 0.028808739898234063}, batch size: 64, grad_norm: 0.10070965439081192, grad_scale: , lr: 0.00e+00, 
2025-02-14 02:38:33,068 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 78166, num_updates: 72000, {'loss': 0.07886742055416107, 'DER': 0.1844220070059757, 'ACC': np.float64(0.9661160714285714), 'MI': 0.11340064564873961, 'FA': 0.04691256267600797, 'CF': 0.024108798681228106}, batch size: 64, grad_norm: 0.10070965439081192, grad_scale: , lr: 0.00e+00, 
2025-02-14 02:49:57,490 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 78666, num_updates: 72500, {'loss': 0.0742228552699089, 'DER': 0.15359432546719412, 'ACC': np.float64(0.9725111607142857), 'MI': 0.10121402264356841, 'FA': 0.03798936025098895, 'CF': 0.014390942572636747}, batch size: 64, grad_norm: 0.11862320452928543, grad_scale: , lr: 0.00e+00, 
2025-02-14 02:49:57,491 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 02:49:57,493 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 78666, num_updates: 72500, {'loss': 0.08198018372058868, 'DER': 0.20336700336700336, 'ACC': np.float64(0.9625111607142857), 'MI': 0.10160867938645717, 'FA': 0.053797231575009354, 'CF': 0.04796109240553685}, batch size: 64, grad_norm: 0.11862320452928543, grad_scale: , lr: 0.00e+00, 
2025-02-14 02:49:57,493 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 02:50:42,464 (model:925) WARNING: All labels are zero
2025-02-14 02:50:42,901 (model:925) WARNING: All labels are zero
2025-02-14 02:50:43,003 (model:925) WARNING: All labels are zero
2025-02-14 02:52:05,648 (model:925) WARNING: All labels are zero
2025-02-14 02:52:16,575 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 78666,  validation: loss=0.07191, DER=0.1633, ACC=0.9667, MI=0.08672, FA=0.05102, CF=0.02553, over 0.00 frames. 
2025-02-14 02:52:16,575 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 02:52:17,158 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 78666,  validation: loss=0.07397, DER=0.1662, ACC=0.9653, MI=0.08741, FA=0.04981, CF=0.02895, over 0.00 frames. 
2025-02-14 02:52:17,159 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 03:03:38,814 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 79166, num_updates: 73000, {'loss': 0.09006993472576141, 'DER': 0.2087517456939549, 'ACC': np.float64(0.9608258928571429), 'MI': 0.1310766775287624, 'FA': 0.053002593602447294, 'CF': 0.02467247456274523}, batch size: 64, grad_norm: 0.11485752463340759, grad_scale: , lr: 0.00e+00, 
2025-02-14 03:03:38,814 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 03:03:38,816 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 79166, num_updates: 73000, {'loss': 0.07137396931648254, 'DER': 0.1887121377206363, 'ACC': np.float64(0.9673549107142857), 'MI': 0.10517905135468875, 'FA': 0.059780634851456384, 'CF': 0.023752451514491176}, batch size: 64, grad_norm: 0.11485752463340759, grad_scale: , lr: 0.00e+00, 
2025-02-14 03:03:38,817 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 03:04:23,469 (model:925) WARNING: All labels are zero
2025-02-14 03:04:23,959 (model:925) WARNING: All labels are zero
2025-02-14 03:04:24,008 (model:925) WARNING: All labels are zero
2025-02-14 03:05:46,576 (model:925) WARNING: All labels are zero
2025-02-14 03:06:00,267 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 79166,  validation: loss=0.07374, DER=0.1657, ACC=0.9654, MI=0.08675, FA=0.05005, CF=0.02893, over 0.00 frames. 
2025-02-14 03:06:00,267 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 03:06:00,394 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 79166,  validation: loss=0.0718, DER=0.1626, ACC=0.9668, MI=0.08567, FA=0.0511, CF=0.02579, over 0.00 frames. 
2025-02-14 03:06:00,395 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 03:14:36,007 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-79500.pt
2025-02-14 03:14:36,391 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-14 03:14:36,393 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-14 03:18:32,180 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 79666, num_updates: 73500, {'loss': 0.10716141760349274, 'DER': 0.254509443304803, 'ACC': np.float64(0.9527455357142857), 'MI': 0.15229539506260167, 'FA': 0.05722571974251963, 'CF': 0.044988328499681686}, batch size: 64, grad_norm: 0.14674216508865356, grad_scale: , lr: 0.00e+00, 
2025-02-14 03:18:32,180 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 03:18:32,181 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 79666, num_updates: 73500, {'loss': 0.10405047982931137, 'DER': 0.24719887955182074, 'ACC': np.float64(0.9511272321428571), 'MI': 0.12023809523809524, 'FA': 0.06750700280112044, 'CF': 0.05945378151260504}, batch size: 64, grad_norm: 0.14674216508865356, grad_scale: , lr: 0.00e+00, 
2025-02-14 03:18:32,181 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 03:19:17,009 (model:925) WARNING: All labels are zero
2025-02-14 03:19:17,559 (model:925) WARNING: All labels are zero
2025-02-14 03:19:17,668 (model:925) WARNING: All labels are zero
2025-02-14 03:20:40,853 (model:925) WARNING: All labels are zero
2025-02-14 03:20:51,785 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 79666,  validation: loss=0.07221, DER=0.1634, ACC=0.9666, MI=0.08592, FA=0.05124, CF=0.0262, over 0.00 frames. 
2025-02-14 03:20:51,785 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 03:20:51,996 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 79666,  validation: loss=0.0741, DER=0.1666, ACC=0.9652, MI=0.08653, FA=0.05054, CF=0.0295, over 0.00 frames. 
2025-02-14 03:20:51,996 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 03:32:09,333 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 80166, num_updates: 74000, {'loss': 0.07460397481918335, 'DER': 0.1712123482691443, 'ACC': np.float64(0.9710267857142857), 'MI': 0.08594335381387681, 'FA': 0.06196613217443429, 'CF': 0.023302862280833208}, batch size: 64, grad_norm: 0.10297729820013046, grad_scale: , lr: 0.00e+00, 
2025-02-14 03:32:09,333 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 03:32:09,336 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 80166, num_updates: 74000, {'loss': 0.09031231701374054, 'DER': 0.20756382400869092, 'ACC': np.float64(0.96171875), 'MI': 0.14007332971211298, 'FA': 0.04216458446496469, 'CF': 0.025325909831613255}, batch size: 64, grad_norm: 0.10297729820013046, grad_scale: , lr: 0.00e+00, 
2025-02-14 03:32:09,336 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 03:32:53,851 (model:925) WARNING: All labels are zero
2025-02-14 03:32:54,386 (model:925) WARNING: All labels are zero
2025-02-14 03:32:54,622 (model:925) WARNING: All labels are zero
2025-02-14 03:34:17,392 (model:925) WARNING: All labels are zero
2025-02-14 03:34:27,405 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 80166,  validation: loss=0.07387, DER=0.1654, ACC=0.9653, MI=0.08705, FA=0.04874, CF=0.02965, over 0.00 frames. 
2025-02-14 03:34:27,406 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 03:34:28,331 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 80166,  validation: loss=0.07188, DER=0.1625, ACC=0.9667, MI=0.08652, FA=0.05013, CF=0.02584, over 0.00 frames. 
2025-02-14 03:34:28,331 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 03:45:48,047 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 80666, num_updates: 74500, {'loss': 0.08364634215831757, 'DER': 0.19353110560503584, 'ACC': np.float64(0.9637388392857144), 'MI': 0.13239134802116118, 'FA': 0.037099042389339046, 'CF': 0.024040715194535593}, batch size: 64, grad_norm: 0.10499193519353867, grad_scale: , lr: 0.00e+00, 
2025-02-14 03:45:48,047 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 03:45:48,047 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 80666, num_updates: 74500, {'loss': 0.08757959306240082, 'DER': 0.19666444296197466, 'ACC': np.float64(0.9633482142857143), 'MI': 0.11507671781187458, 'FA': 0.059172781854569714, 'CF': 0.022414943295530353}, batch size: 64, grad_norm: 0.10499193519353867, grad_scale: , lr: 0.00e+00, 
2025-02-14 03:45:48,048 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 03:46:32,982 (model:925) WARNING: All labels are zero
2025-02-14 03:46:33,515 (model:925) WARNING: All labels are zero
2025-02-14 03:46:33,839 (model:925) WARNING: All labels are zero
2025-02-14 03:47:57,422 (model:925) WARNING: All labels are zero
2025-02-14 03:48:08,189 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 80666,  validation: loss=0.07448, DER=0.1671, ACC=0.965, MI=0.08697, FA=0.05022, CF=0.02996, over 0.00 frames. 
2025-02-14 03:48:08,189 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 03:48:08,459 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 80666,  validation: loss=0.07242, DER=0.1641, ACC=0.9664, MI=0.08655, FA=0.05107, CF=0.02646, over 0.00 frames. 
2025-02-14 03:48:08,459 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 03:55:41,510 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-81000.pt
2025-02-14 03:55:41,932 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-14 03:59:32,624 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 81166, num_updates: 75000, {'loss': 0.09328914433717728, 'DER': 0.2162463424829316, 'ACC': np.float64(0.960345982142857), 'MI': 0.12944127072593006, 'FA': 0.05552459244809809, 'CF': 0.031280479308903444}, batch size: 64, grad_norm: 0.11672805994749069, grad_scale: , lr: 0.00e+00, 
2025-02-14 03:59:32,624 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 03:59:32,626 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 81166, num_updates: 75000, {'loss': 0.07646000385284424, 'DER': 0.17441129201313674, 'ACC': np.float64(0.9678125), 'MI': 0.10439522045978618, 'FA': 0.042904059814128995, 'CF': 0.027112011739221578}, batch size: 64, grad_norm: 0.11672805994749069, grad_scale: , lr: 0.00e+00, 
2025-02-14 03:59:32,627 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 04:00:17,086 (model:925) WARNING: All labels are zero
2025-02-14 04:00:17,618 (model:925) WARNING: All labels are zero
2025-02-14 04:00:17,685 (model:925) WARNING: All labels are zero
2025-02-14 04:01:39,949 (model:925) WARNING: All labels are zero
2025-02-14 04:01:50,452 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 81166,  validation: loss=0.07434, DER=0.1667, ACC=0.9651, MI=0.08591, FA=0.051, CF=0.02975, over 0.00 frames. 
2025-02-14 04:01:50,452 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 04:01:50,818 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 81166,  validation: loss=0.07229, DER=0.1639, ACC=0.9665, MI=0.08558, FA=0.0521, CF=0.02618, over 0.00 frames. 
2025-02-14 04:01:50,818 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 04:14:04,053 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 81666, num_updates: 75500, {'loss': 0.09019237756729126, 'DER': 0.22326325411334552, 'ACC': np.float64(0.9609151785714286), 'MI': 0.07091712370505789, 'FA': 0.1088513101767215, 'CF': 0.04349482023156612}, batch size: 64, grad_norm: 0.12391091883182526, grad_scale: , lr: 0.00e+00, 
2025-02-14 04:14:04,054 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 04:14:04,054 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 81666, num_updates: 75500, {'loss': 0.06520754843950272, 'DER': 0.13991097922848664, 'ACC': np.float64(0.9775334821428571), 'MI': 0.08286350148367952, 'FA': 0.047626112759643915, 'CF': 0.009421364985163204}, batch size: 64, grad_norm: 0.12391091883182526, grad_scale: , lr: 0.00e+00, 
2025-02-14 04:14:04,054 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 04:14:49,447 (model:925) WARNING: All labels are zero
2025-02-14 04:14:49,709 (model:925) WARNING: All labels are zero
2025-02-14 04:14:49,987 (model:925) WARNING: All labels are zero
2025-02-14 04:16:12,736 (model:925) WARNING: All labels are zero
2025-02-14 04:16:23,671 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 81666,  validation: loss=0.07199, DER=0.1627, ACC=0.9667, MI=0.08389, FA=0.05271, CF=0.0261, over 0.00 frames. 
2025-02-14 04:16:23,671 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 04:16:24,615 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 81666,  validation: loss=0.07395, DER=0.1655, ACC=0.9653, MI=0.08473, FA=0.05152, CF=0.02926, over 0.00 frames. 
2025-02-14 04:16:24,615 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 04:27:42,046 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 82166, num_updates: 76000, {'loss': 0.11902506649494171, 'DER': 0.2673142777273045, 'ACC': np.float64(0.9469308035714286), 'MI': 0.1366971835907471, 'FA': 0.06562303445384024, 'CF': 0.06499405968271717}, batch size: 64, grad_norm: 0.15295004844665527, grad_scale: , lr: 0.00e+00, 
2025-02-14 04:27:42,046 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 82166, num_updates: 76000, {'loss': 0.09706984460353851, 'DER': 0.22706228956228955, 'ACC': np.float64(0.9572879464285714), 'MI': 0.1307519640852974, 'FA': 0.054924242424242424, 'CF': 0.04138608305274972}, batch size: 64, grad_norm: 0.15295004844665527, grad_scale: , lr: 0.00e+00, 
2025-02-14 04:27:42,046 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 04:27:42,046 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 04:28:26,888 (model:925) WARNING: All labels are zero
2025-02-14 04:28:27,422 (model:925) WARNING: All labels are zero
2025-02-14 04:28:27,581 (model:925) WARNING: All labels are zero
2025-02-14 04:29:50,872 (model:925) WARNING: All labels are zero
2025-02-14 04:30:01,248 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 82166,  validation: loss=0.07386, DER=0.1657, ACC=0.9653, MI=0.08473, FA=0.05144, CF=0.02956, over 0.00 frames. 
2025-02-14 04:30:01,248 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 04:30:01,854 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 82166,  validation: loss=0.07165, DER=0.1624, ACC=0.9667, MI=0.08374, FA=0.05264, CF=0.02604, over 0.00 frames. 
2025-02-14 04:30:01,854 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 04:32:33,770 (train_accelerate_ddp:713) INFO: end of epoch 19, batch_idx: 4113 batch_idx_train: 82279, {'loss': 0.07206133008003235, 'DER': 0.17514206615182865, 'ACC': np.float64(0.9693080357142857), 'MI': 0.09995628733789888, 'FA': 0.04997814366894944, 'CF': 0.02520763514498033}, batch size: 64, grad_norm: 0.11009679734706879, grad_scale: , lr: 0.00e+00, 
2025-02-14 04:32:33,770 (train_accelerate_ddp:713) INFO: end of epoch 19, batch_idx: 4113 batch_idx_train: 82279, {'loss': 0.07263000309467316, 'DER': 0.17573544899248753, 'ACC': np.float64(0.9677232142857143), 'MI': 0.08649863090641016, 'FA': 0.0619251562170891, 'CF': 0.027311661868988275}, batch size: 64, grad_norm: 0.11009679734706879, grad_scale: , lr: 0.00e+00, 
2025-02-14 04:32:33,772 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-19.pt
2025-02-14 04:32:34,066 (train_accelerate_ddp:561) INFO:  end of epoch 19, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-19.pt 
2025-02-14 04:32:36,406 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 82280, num_updates: 76000, {'loss': 0.09543643146753311, 'DER': 0.2216771424191323, 'ACC': np.float64(0.963203125), 'MI': 0.12532577035106546, 'FA': 0.06530737390771117, 'CF': 0.031043998160355666}, batch size: 64, grad_norm: 0.16391336917877197, grad_scale: , lr: 0.00e+00, 
2025-02-14 04:32:36,408 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 82280, num_updates: 76000, {'loss': 0.08202356100082397, 'DER': 0.1653440066248016, 'ACC': np.float64(0.9689397321428571), 'MI': 0.09495548961424333, 'FA': 0.04368228555655234, 'CF': 0.026706231454005934}, batch size: 64, grad_norm: 0.16391336917877197, grad_scale: , lr: 0.00e+00, 
2025-02-14 04:37:32,293 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-82500.pt
2025-02-14 04:37:32,707 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-14 04:37:32,709 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-02-14 04:43:56,468 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 82780, num_updates: 76500, {'loss': 0.0844823569059372, 'DER': 0.18490319773765498, 'ACC': np.float64(0.9689620535714286), 'MI': 0.11456747153940976, 'FA': 0.05358567181495178, 'CF': 0.016750054383293453}, batch size: 64, grad_norm: 0.1520683467388153, grad_scale: , lr: 0.00e+00, 
2025-02-14 04:43:56,468 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 04:43:56,470 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 82780, num_updates: 76500, {'loss': 0.0968095064163208, 'DER': 0.22953205734662688, 'ACC': np.float64(0.9554910714285714), 'MI': 0.11039953424059384, 'FA': 0.05843825049123062, 'CF': 0.06069427261480242}, batch size: 64, grad_norm: 0.1520683467388153, grad_scale: , lr: 0.00e+00, 
2025-02-14 04:43:56,470 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 04:44:40,940 (model:925) WARNING: All labels are zero
2025-02-14 04:44:41,471 (model:925) WARNING: All labels are zero
2025-02-14 04:44:42,214 (model:925) WARNING: All labels are zero
2025-02-14 04:46:05,652 (model:925) WARNING: All labels are zero
2025-02-14 04:46:14,415 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 82780,  validation: loss=0.07409, DER=0.1661, ACC=0.9653, MI=0.08618, FA=0.05037, CF=0.02953, over 0.00 frames. 
2025-02-14 04:46:14,415 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 04:46:16,678 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 82780,  validation: loss=0.07205, DER=0.163, ACC=0.9666, MI=0.08569, FA=0.05148, CF=0.02586, over 0.00 frames. 
2025-02-14 04:46:16,679 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 04:57:59,254 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 83280, num_updates: 77000, {'loss': 0.09037383645772934, 'DER': 0.22786069651741295, 'ACC': np.float64(0.9597767857142857), 'MI': 0.13191186922530207, 'FA': 0.06766169154228856, 'CF': 0.028287135749822317}, batch size: 64, grad_norm: 0.14897894859313965, grad_scale: , lr: 0.00e+00, 
2025-02-14 04:57:59,254 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 83280, num_updates: 77000, {'loss': 0.11537890136241913, 'DER': 0.2683592110784725, 'ACC': np.float64(0.9491629464285714), 'MI': 0.14792278640369283, 'FA': 0.07021961113442439, 'CF': 0.050216813540355294}, batch size: 64, grad_norm: 0.14897894859313965, grad_scale: , lr: 0.00e+00, 
2025-02-14 04:57:59,255 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 04:57:59,255 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 04:58:44,728 (model:925) WARNING: All labels are zero
2025-02-14 04:58:45,035 (model:925) WARNING: All labels are zero
2025-02-14 04:58:45,270 (model:925) WARNING: All labels are zero
2025-02-14 05:00:08,452 (model:925) WARNING: All labels are zero
2025-02-14 05:00:19,443 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 83280,  validation: loss=0.07185, DER=0.163, ACC=0.9667, MI=0.0845, FA=0.05284, CF=0.02567, over 0.00 frames. 
2025-02-14 05:00:19,443 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 05:00:20,195 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 83280,  validation: loss=0.07393, DER=0.1658, ACC=0.9653, MI=0.08517, FA=0.0516, CF=0.02902, over 0.00 frames. 
2025-02-14 05:00:20,195 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 05:12:00,876 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 83780, num_updates: 77500, {'loss': 0.08898457884788513, 'DER': 0.18246035920943865, 'ACC': np.float64(0.9668973214285714), 'MI': 0.09446156158412865, 'FA': 0.04756894867363042, 'CF': 0.040429848951679566}, batch size: 64, grad_norm: 0.29428064823150635, grad_scale: , lr: 0.00e+00, 
2025-02-14 05:12:00,876 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 83780, num_updates: 77500, {'loss': 0.08779729902744293, 'DER': 0.21191338522000464, 'ACC': np.float64(0.962064732142857), 'MI': 0.09632426600909301, 'FA': 0.06557756029899052, 'CF': 0.05001155891192109}, batch size: 64, grad_norm: 0.29428064823150635, grad_scale: , lr: 0.00e+00, 
2025-02-14 05:12:00,877 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 05:12:00,877 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 05:12:45,975 (model:925) WARNING: All labels are zero
2025-02-14 05:12:46,042 (model:925) WARNING: All labels are zero
2025-02-14 05:12:46,511 (model:925) WARNING: All labels are zero
2025-02-14 05:14:08,422 (model:925) WARNING: All labels are zero
2025-02-14 05:14:19,283 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 83780,  validation: loss=0.07233, DER=0.1638, ACC=0.9665, MI=0.08623, FA=0.05119, CF=0.02634, over 0.00 frames. 
2025-02-14 05:14:19,284 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 05:14:20,755 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 83780,  validation: loss=0.07431, DER=0.1666, ACC=0.9652, MI=0.08677, FA=0.05022, CF=0.02961, over 0.00 frames. 
2025-02-14 05:14:20,756 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 05:19:20,714 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-84000.pt
2025-02-14 05:19:21,124 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-14 05:25:43,212 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 84280, num_updates: 78000, {'loss': 0.08925250917673111, 'DER': 0.21867737164589054, 'ACC': np.float64(0.960859375), 'MI': 0.13747447003310093, 'FA': 0.052891048665398975, 'CF': 0.02831185294739066}, batch size: 64, grad_norm: 0.16965873539447784, grad_scale: , lr: 0.00e+00, 
2025-02-14 05:25:43,213 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 05:25:43,214 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 84280, num_updates: 78000, {'loss': 0.11061176657676697, 'DER': 0.2903902969989115, 'ACC': np.float64(0.95046875), 'MI': 0.16404913699269166, 'FA': 0.07168403047737522, 'CF': 0.05465712952884466}, batch size: 64, grad_norm: 0.16965873539447784, grad_scale: , lr: 0.00e+00, 
2025-02-14 05:25:43,214 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 05:26:27,965 (model:925) WARNING: All labels are zero
2025-02-14 05:26:28,485 (model:925) WARNING: All labels are zero
2025-02-14 05:26:28,499 (model:925) WARNING: All labels are zero
2025-02-14 05:27:51,113 (model:925) WARNING: All labels are zero
2025-02-14 05:28:01,974 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 84280,  validation: loss=0.0743, DER=0.1669, ACC=0.9652, MI=0.08664, FA=0.05107, CF=0.02921, over 0.00 frames. 
2025-02-14 05:28:01,975 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 05:28:01,983 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 84280,  validation: loss=0.07237, DER=0.1643, ACC=0.9665, MI=0.08629, FA=0.05207, CF=0.02591, over 0.00 frames. 
2025-02-14 05:28:01,984 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 05:39:22,112 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 84780, num_updates: 78500, {'loss': 0.08319519460201263, 'DER': 0.2067120978969737, 'ACC': np.float64(0.9630915178571429), 'MI': 0.11584963728291932, 'FA': 0.05525023814757822, 'CF': 0.03561222246647615}, batch size: 64, grad_norm: 0.1311267465353012, grad_scale: , lr: 0.00e+00, 
2025-02-14 05:39:22,112 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 84780, num_updates: 78500, {'loss': 0.08714453876018524, 'DER': 0.21106349824698092, 'ACC': np.float64(0.9622879464285714), 'MI': 0.09637709388391118, 'FA': 0.06248539150759642, 'CF': 0.052201012855473315}, batch size: 64, grad_norm: 0.1311267465353012, grad_scale: , lr: 0.00e+00, 
2025-02-14 05:39:22,113 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 05:39:22,113 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 05:40:07,356 (model:925) WARNING: All labels are zero
2025-02-14 05:40:07,434 (model:925) WARNING: All labels are zero
2025-02-14 05:40:07,892 (model:925) WARNING: All labels are zero
2025-02-14 05:41:30,273 (model:925) WARNING: All labels are zero
2025-02-14 05:41:41,206 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 84780,  validation: loss=0.07239, DER=0.164, ACC=0.9664, MI=0.08437, FA=0.05312, CF=0.02647, over 0.00 frames. 
2025-02-14 05:41:41,206 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 05:41:42,636 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 84780,  validation: loss=0.07435, DER=0.1666, ACC=0.9651, MI=0.08481, FA=0.05193, CF=0.02985, over 0.00 frames. 
2025-02-14 05:41:42,636 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 05:53:34,817 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 85280, num_updates: 79000, {'loss': 0.10418961942195892, 'DER': 0.22493112947658403, 'ACC': np.float64(0.9553794642857143), 'MI': 0.12121212121212122, 'FA': 0.05330578512396694, 'CF': 0.050413223140495865}, batch size: 64, grad_norm: 0.1452258974313736, grad_scale: , lr: 0.00e+00, 
2025-02-14 05:53:34,818 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 05:53:34,818 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 85280, num_updates: 79000, {'loss': 0.07823161035776138, 'DER': 0.1925888398349859, 'ACC': np.float64(0.9652232142857143), 'MI': 0.08873127306940726, 'FA': 0.07092711876673663, 'CF': 0.032930447998842004}, batch size: 64, grad_norm: 0.1452258974313736, grad_scale: , lr: 0.00e+00, 
2025-02-14 05:53:34,818 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 05:54:19,473 (model:925) WARNING: All labels are zero
2025-02-14 05:54:20,020 (model:925) WARNING: All labels are zero
2025-02-14 05:54:20,785 (model:925) WARNING: All labels are zero
2025-02-14 05:55:44,626 (model:925) WARNING: All labels are zero
2025-02-14 05:55:53,506 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 85280,  validation: loss=0.07358, DER=0.1654, ACC=0.9654, MI=0.0851, FA=0.05148, CF=0.02887, over 0.00 frames. 
2025-02-14 05:55:53,506 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 05:55:55,596 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 85280,  validation: loss=0.07159, DER=0.1622, ACC=0.9669, MI=0.08448, FA=0.05259, CF=0.02517, over 0.00 frames. 
2025-02-14 05:55:55,596 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 06:01:00,245 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/checkpoint-85500.pt
2025-02-14 06:01:01,213 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-02-14 06:07:25,152 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 85780, num_updates: 79500, {'loss': 0.09044944494962692, 'DER': 0.23351063829787233, 'ACC': np.float64(0.9573138699185174), 'MI': 0.12028875379939209, 'FA': 0.056534954407294835, 'CF': 0.05668693009118541}, batch size: 64, grad_norm: 0.1480274200439453, grad_scale: , lr: 0.00e+00, 
2025-02-14 06:07:25,152 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 85780, num_updates: 79500, {'loss': 0.10369931161403656, 'DER': 0.23531786074672048, 'ACC': np.float64(0.95265625), 'MI': 0.12559704002690886, 'FA': 0.05967036663303061, 'CF': 0.05005045408678103}, batch size: 64, grad_norm: 0.1480274200439453, grad_scale: , lr: 0.00e+00, 
2025-02-14 06:07:25,153 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 06:07:25,153 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 06:08:09,759 (model:925) WARNING: All labels are zero
2025-02-14 06:08:10,296 (model:925) WARNING: All labels are zero
2025-02-14 06:08:10,297 (model:925) WARNING: All labels are zero
2025-02-14 06:09:32,680 (model:925) WARNING: All labels are zero
2025-02-14 06:09:43,478 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 85780,  validation: loss=0.07412, DER=0.1672, ACC=0.9652, MI=0.08684, FA=0.05137, CF=0.02895, over 0.00 frames. 
2025-02-14 06:09:43,478 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 06:09:43,571 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 85780,  validation: loss=0.07213, DER=0.1636, ACC=0.9666, MI=0.08605, FA=0.0521, CF=0.02548, over 0.00 frames. 
2025-02-14 06:09:43,571 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 06:21:03,162 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 86280, num_updates: 80000, {'loss': 0.09230951219797134, 'DER': 0.22994210090984285, 'ACC': np.float64(0.9571540178571429), 'MI': 0.11286562899466125, 'FA': 0.058350251898638995, 'CF': 0.058726220016542596}, batch size: 64, grad_norm: 0.13359889388084412, grad_scale: , lr: 0.00e+00, 
2025-02-14 06:21:03,163 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 06:21:03,164 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 86280, num_updates: 80000, {'loss': 0.08282248675823212, 'DER': 0.20653604894292574, 'ACC': np.float64(0.9649107142857143), 'MI': 0.09904747154030821, 'FA': 0.07054905908774103, 'CF': 0.036939518314876484}, batch size: 64, grad_norm: 0.13359889388084412, grad_scale: , lr: 0.00e+00, 
2025-02-14 06:21:03,164 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-02-14 06:21:47,807 (model:925) WARNING: All labels are zero
2025-02-14 06:21:48,344 (model:925) WARNING: All labels are zero
2025-02-14 06:21:48,374 (model:925) WARNING: All labels are zero
2025-02-14 06:23:10,814 (model:925) WARNING: All labels are zero
2025-02-14 06:23:21,485 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 86280,  validation: loss=0.07429, DER=0.1666, ACC=0.9652, MI=0.08497, FA=0.05215, CF=0.02946, over 0.00 frames. 
2025-02-14 06:23:21,485 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 06:23:21,729 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 86280,  validation: loss=0.07243, DER=0.1639, ACC=0.9665, MI=0.08465, FA=0.05288, CF=0.0264, over 0.00 frames. 
2025-02-14 06:23:21,729 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 12490MB
2025-02-14 06:25:53,556 (train_accelerate_ddp:713) INFO: end of epoch 20, batch_idx: 4113 batch_idx_train: 86393, {'loss': 0.09930641949176788, 'DER': 0.2226587613400957, 'ACC': np.float64(0.95828125), 'MI': 0.11157939852846632, 'FA': 0.0667190513608115, 'CF': 0.04436031145081792}, batch size: 64, grad_norm: 0.216508686542511, grad_scale: , lr: 0.00e+00, 
2025-02-14 06:25:53,558 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-20.pt
2025-02-14 06:25:53,558 (train_accelerate_ddp:713) INFO: end of epoch 20, batch_idx: 4113 batch_idx_train: 86393, {'loss': 0.13430416584014893, 'DER': 0.3102806414662085, 'ACC': np.float64(0.9416294642857143), 'MI': 0.19358533791523483, 'FA': 0.05254868270332188, 'CF': 0.06414662084765177}, batch size: 64, grad_norm: 0.216508686542511, grad_scale: , lr: 0.00e+00, 
2025-02-14 06:25:53,561 (train_accelerate_ddp:1066) INFO: Done!
2025-02-14 06:25:53,851 (train_accelerate_ddp:561) INFO:  end of epoch 20, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr2e4_single_backend_2layer_conformer_multi_backend_transformer_rs_len8/epoch-20.pt 
2025-02-14 06:25:53,852 (train_accelerate_ddp:1066) INFO: Done!
pgpu25:3760651:3760995 [1] NCCL INFO [Service thread] Connection closed by localRank 1
[rank0]:[W214 06:25:54.941180564 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
pgpu25:3760650:3760994 [0] NCCL INFO [Service thread] Connection closed by localRank 0
pgpu25:3760651:4085750 [1] NCCL INFO comm 0x5555670c59e0 rank 1 nranks 2 cudaDev 1 busId 2b000 - Abort COMPLETE
pgpu25:3760650:4085751 [0] NCCL INFO comm 0x555563820580 rank 0 nranks 2 cudaDev 0 busId 25000 - Abort COMPLETE
