2025-01-24 11:05:20,888 (train_accelerate_ddp:857) INFO: params: {'best_train_loss': inf, 'best_valid_loss': inf, 'best_train_der': inf, 'best_valid_der': inf, 'best_train_epoch': -1, 'best_valid_epoch': -1, 'batch_idx_train': 0, 'log_interval': 500, 'reset_interval': 200, 'valid_interval': 500, 'batch_size': 64, 'verbose': 1, 'world_size': 2, 'tensorboard': True, 'num_epochs': 20, 'max_updates': 40000, 'warmup_updates': 4000, 'freeze_updates': 4000, 'start_batch': 0, 'start_epoch': 1, 'seed': 1337, 'exp_dir': PosixPath('/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10'), 'save_every_n': 1500, 'keep_last_k': 1, 'keep_last_epoch': 1, 'grad_clip': True, 'feature_grad_mult': 0.1, 'lr': 0.0001, 'average_period': 200, 'train_on_average': False, 'musan_path': '/mntcephfs/lee_dataset/asr/musan', 'rir_path': '/mntcephfs/lee_dataset/asr/RIRS_NOISES', 'spk_path': '/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/data/alimeeting_ami_aishell_4', 'speaker_embedding_name_dir': 'cam++_zh-cn_200k_feature_dir', 'data_dir': '/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/data/alimeeting_ami_aishell_4', 'dataset_name': 'alimeeting_ami_aishell_4', 'max_num_speaker': 7, 'speech_encoder_path': '/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/zh/modelscope/speech_campplus_sv_zh-cn_16k-common/campplus_cn_common.bin', 'select_encoder_layer_nums': 6, 'wavlm_fuse_feat_post_norm': False, 'speech_encoder_config': '/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/wav-bert2.0/config.json', 'num_transformer_layer': 2, 'd_state': 256, 'expand': 4, 'speech_encoder_type': 'CAM++', 'speaker_embed_dim': 192, 'rs_len': 10, 'segment_shift': 2, 'single_backend_type': 'mamba2', 'multi_backend_type': 'transformer', 'do_finetune': False, 'init_modules': None, 'finetune_ckpt': None}
2025-01-24 11:05:20,888 (train_accelerate_ddp:857) INFO: params: {'best_train_loss': inf, 'best_valid_loss': inf, 'best_train_der': inf, 'best_valid_der': inf, 'best_train_epoch': -1, 'best_valid_epoch': -1, 'batch_idx_train': 0, 'log_interval': 500, 'reset_interval': 200, 'valid_interval': 500, 'batch_size': 64, 'verbose': 1, 'world_size': 2, 'tensorboard': True, 'num_epochs': 20, 'max_updates': 40000, 'warmup_updates': 4000, 'freeze_updates': 4000, 'start_batch': 0, 'start_epoch': 1, 'seed': 1337, 'exp_dir': PosixPath('/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10'), 'save_every_n': 1500, 'keep_last_k': 1, 'keep_last_epoch': 1, 'grad_clip': True, 'feature_grad_mult': 0.1, 'lr': 0.0001, 'average_period': 200, 'train_on_average': False, 'musan_path': '/mntcephfs/lee_dataset/asr/musan', 'rir_path': '/mntcephfs/lee_dataset/asr/RIRS_NOISES', 'spk_path': '/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/data/alimeeting_ami_aishell_4', 'speaker_embedding_name_dir': 'cam++_zh-cn_200k_feature_dir', 'data_dir': '/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/data/alimeeting_ami_aishell_4', 'dataset_name': 'alimeeting_ami_aishell_4', 'max_num_speaker': 7, 'speech_encoder_path': '/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/zh/modelscope/speech_campplus_sv_zh-cn_16k-common/campplus_cn_common.bin', 'select_encoder_layer_nums': 6, 'wavlm_fuse_feat_post_norm': False, 'speech_encoder_config': '/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/wav-bert2.0/config.json', 'num_transformer_layer': 2, 'd_state': 256, 'expand': 4, 'speech_encoder_type': 'CAM++', 'speaker_embed_dim': 192, 'rs_len': 10, 'segment_shift': 2, 'single_backend_type': 'mamba2', 'multi_backend_type': 'transformer', 'do_finetune': False, 'init_modules': None, 'finetune_ckpt': None}
2025-01-24 11:05:20,892 (train_accelerate_ddp:873) INFO: data_cfg: TSVADDataConfig(data_dir='/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/data/alimeeting_ami_aishell_4', ts_len=6000, rs_len=10, segment_shift=2, spk_path='/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/data/alimeeting_ami_aishell_4', speech_encoder_type='CAM++', speaker_embedding_name_dir='cam++_zh-cn_200k_feature_dir', speaker_embed_dim=192, noise_ratio=0.8, zero_ratio=0.3, sample_rate=16000, max_num_speaker=7, dataset_name='alimeeting', embed_input=False, embed_len=1, embed_shift=0.4, label_rate=25, random_channel=False, random_mask_speaker_prob=0.0, random_mask_speaker_step=0, musan_path='/mntcephfs/lee_dataset/asr/musan', rir_path='/mntcephfs/lee_dataset/asr/RIRS_NOISES')
2025-01-24 11:05:20,892 (train_accelerate_ddp:873) INFO: data_cfg: TSVADDataConfig(data_dir='/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/data/alimeeting_ami_aishell_4', ts_len=6000, rs_len=10, segment_shift=2, spk_path='/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/data/alimeeting_ami_aishell_4', speech_encoder_type='CAM++', speaker_embedding_name_dir='cam++_zh-cn_200k_feature_dir', speaker_embed_dim=192, noise_ratio=0.8, zero_ratio=0.3, sample_rate=16000, max_num_speaker=7, dataset_name='alimeeting', embed_input=False, embed_len=1, embed_shift=0.4, label_rate=25, random_channel=False, random_mask_speaker_prob=0.0, random_mask_speaker_step=0, musan_path='/mntcephfs/lee_dataset/asr/musan', rir_path='/mntcephfs/lee_dataset/asr/RIRS_NOISES')
  0%|          | 0/145 [00:00<?, ?it/s]  0%|          | 0/145 [00:00<?, ?it/s]  3%|▎         | 4/145 [00:00<00:07, 18.14it/s]  3%|▎         | 4/145 [00:00<00:05, 27.76it/s] 21%|██        | 30/145 [00:00<00:00, 140.78it/s] 21%|██        | 30/145 [00:00<00:01, 111.57it/s] 41%|████▏     | 60/145 [00:00<00:00, 205.43it/s] 41%|████▏     | 60/145 [00:00<00:00, 178.05it/s] 57%|█████▋    | 82/145 [00:00<00:00, 170.04it/s] 57%|█████▋    | 83/145 [00:00<00:00, 186.58it/s] 86%|████████▌ | 124/145 [00:00<00:00, 243.25it/s] 86%|████████▌ | 125/145 [00:00<00:00, 258.79it/s]100%|██████████| 145/145 [00:00<00:00, 227.16it/s]
2025-01-24 11:05:21,660 (ts_vad_dataset:152) INFO: model expect fbank as input , fbank_input should be True !!!
100%|██████████| 145/145 [00:00<00:00, 202.61it/s]
2025-01-24 11:05:21,660 (ts_vad_dataset:152) INFO: model expect fbank as input , fbank_input should be True !!!
2025-01-24 11:05:21,660 (ts_vad_dataset:160) INFO: loaded sentence=35332, shortest sent=640.0, longest sent=160000.0, rs_len=10, segment_shift=2,  rir=False, musan=False, noise_ratio=0.8, zero_ratio=0.3
2025-01-24 11:05:21,661 (ts_vad_dataset:160) INFO: loaded sentence=35332, shortest sent=640.0, longest sent=160000.0, rs_len=10, segment_shift=2,  rir=False, musan=False, noise_ratio=0.8, zero_ratio=0.3
  0%|          | 0/2080 [00:00<?, ?it/s]  0%|          | 0/2080 [00:00<?, ?it/s]  1%|          | 17/2080 [00:00<00:12, 164.62it/s]  1%|▏         | 28/2080 [00:00<00:16, 121.97it/s]  2%|▏         | 34/2080 [00:00<00:20, 99.73it/s]   3%|▎         | 53/2080 [00:00<00:11, 169.41it/s]  3%|▎         | 55/2080 [00:00<00:14, 135.74it/s]  4%|▎         | 75/2080 [00:00<00:10, 185.78it/s]  4%|▎         | 76/2080 [00:00<00:12, 157.32it/s]  5%|▍         | 96/2080 [00:00<00:10, 191.46it/s]  5%|▍         | 97/2080 [00:00<00:11, 173.40it/s]  6%|▌         | 122/2080 [00:00<00:09, 211.69it/s]  6%|▌         | 123/2080 [00:00<00:09, 199.50it/s]  7%|▋         | 145/2080 [00:01<00:14, 134.52it/s]  7%|▋         | 145/2080 [00:00<00:13, 139.63it/s]  8%|▊         | 168/2080 [00:01<00:12, 158.78it/s]  8%|▊         | 168/2080 [00:01<00:12, 154.73it/s]  9%|▉         | 192/2080 [00:01<00:10, 177.17it/s]  9%|▉         | 192/2080 [00:01<00:10, 174.05it/s] 10%|█         | 215/2080 [00:01<00:09, 189.63it/s] 10%|█         | 215/2080 [00:01<00:09, 187.29it/s] 12%|█▏        | 240/2080 [00:01<00:09, 203.43it/s] 12%|█▏        | 240/2080 [00:01<00:09, 201.69it/s] 13%|█▎        | 262/2080 [00:01<00:08, 207.47it/s] 13%|█▎        | 262/2080 [00:01<00:08, 206.21it/s] 14%|█▍        | 286/2080 [00:01<00:08, 208.75it/s] 14%|█▍        | 286/2080 [00:01<00:08, 207.87it/s] 15%|█▍        | 308/2080 [00:01<00:13, 134.82it/s] 15%|█▍        | 308/2080 [00:01<00:13, 135.19it/s] 16%|█▌        | 332/2080 [00:02<00:11, 156.06it/s] 16%|█▌        | 332/2080 [00:01<00:11, 156.36it/s] 17%|█▋        | 359/2080 [00:02<00:09, 181.33it/s] 17%|█▋        | 359/2080 [00:02<00:09, 181.09it/s] 18%|█▊        | 384/2080 [00:02<00:08, 197.28it/s] 18%|█▊        | 384/2080 [00:02<00:08, 197.46it/s] 20%|█▉        | 408/2080 [00:02<00:08, 207.58it/s] 20%|█▉        | 408/2080 [00:02<00:08, 207.72it/s] 21%|██        | 437/2080 [00:02<00:07, 228.07it/s] 21%|██        | 437/2080 [00:02<00:07, 227.97it/s] 22%|██▏       | 465/2080 [00:02<00:06, 239.89it/s] 22%|██▏       | 465/2080 [00:02<00:06, 239.79it/s] 24%|██▍       | 494/2080 [00:02<00:06, 252.06it/s] 24%|██▍       | 494/2080 [00:02<00:06, 252.10it/s] 25%|██▌       | 521/2080 [00:02<00:06, 255.35it/s] 25%|██▌       | 521/2080 [00:02<00:06, 255.31it/s] 26%|██▋       | 548/2080 [00:02<00:05, 259.23it/s] 26%|██▋       | 548/2080 [00:02<00:05, 259.24it/s] 28%|██▊       | 575/2080 [00:02<00:06, 244.79it/s] 28%|██▊       | 575/2080 [00:02<00:06, 244.76it/s] 29%|██▉       | 600/2080 [00:03<00:10, 146.88it/s] 29%|██▉       | 600/2080 [00:03<00:10, 146.87it/s] 30%|███       | 632/2080 [00:03<00:08, 179.09it/s] 30%|███       | 632/2080 [00:03<00:08, 179.08it/s] 32%|███▏      | 660/2080 [00:03<00:07, 199.83it/s] 32%|███▏      | 660/2080 [00:03<00:07, 199.82it/s] 33%|███▎      | 693/2080 [00:03<00:06, 228.08it/s] 33%|███▎      | 693/2080 [00:03<00:06, 228.07it/s] 35%|███▍      | 727/2080 [00:03<00:05, 254.37it/s] 35%|███▍      | 727/2080 [00:03<00:05, 254.36it/s] 36%|███▋      | 756/2080 [00:03<00:05, 259.09it/s] 36%|███▋      | 756/2080 [00:03<00:05, 259.08it/s] 38%|███▊      | 792/2080 [00:03<00:04, 286.04it/s] 38%|███▊      | 793/2080 [00:03<00:04, 286.94it/s] 40%|███▉      | 826/2080 [00:03<00:04, 298.67it/s] 40%|███▉      | 826/2080 [00:04<00:04, 298.42it/s] 41%|████▏     | 858/2080 [00:04<00:04, 295.79it/s] 41%|████▏     | 858/2080 [00:04<00:04, 295.95it/s] 43%|████▎     | 890/2080 [00:04<00:03, 300.43it/s] 43%|████▎     | 890/2080 [00:04<00:03, 300.55it/s] 44%|████▍     | 924/2080 [00:04<00:03, 307.81it/s] 44%|████▍     | 924/2080 [00:04<00:03, 307.89it/s] 46%|████▌     | 959/2080 [00:04<00:03, 317.80it/s] 46%|████▌     | 959/2080 [00:04<00:03, 317.74it/s] 48%|████▊     | 995/2080 [00:04<00:03, 329.05it/s] 48%|████▊     | 995/2080 [00:04<00:03, 329.08it/s] 49%|████▉     | 1029/2080 [00:04<00:03, 328.10it/s] 49%|████▉     | 1029/2080 [00:04<00:03, 328.11it/s] 51%|█████     | 1063/2080 [00:04<00:03, 330.47it/s] 51%|█████     | 1063/2080 [00:04<00:03, 330.47it/s] 53%|█████▎    | 1099/2080 [00:04<00:02, 338.45it/s] 53%|█████▎    | 1099/2080 [00:04<00:02, 338.35it/s] 54%|█████▍    | 1133/2080 [00:04<00:02, 328.12it/s] 54%|█████▍    | 1133/2080 [00:04<00:02, 328.11it/s] 56%|█████▌    | 1166/2080 [00:04<00:02, 328.05it/s] 56%|█████▌    | 1166/2080 [00:05<00:02, 328.05it/s] 58%|█████▊    | 1204/2080 [00:05<00:02, 342.33it/s] 58%|█████▊    | 1204/2080 [00:05<00:02, 342.33it/s] 60%|█████▉    | 1243/2080 [00:05<00:02, 354.14it/s] 60%|█████▉    | 1243/2080 [00:05<00:02, 354.14it/s] 61%|██████▏   | 1279/2080 [00:05<00:02, 348.03it/s] 61%|██████▏   | 1279/2080 [00:05<00:02, 348.00it/s] 63%|██████▎   | 1319/2080 [00:05<00:02, 359.85it/s] 63%|██████▎   | 1319/2080 [00:05<00:02, 359.83it/s] 65%|██████▌   | 1361/2080 [00:05<00:01, 376.39it/s] 65%|██████▌   | 1359/2080 [00:05<00:01, 370.42it/s] 67%|██████▋   | 1399/2080 [00:05<00:01, 373.53it/s] 67%|██████▋   | 1398/2080 [00:05<00:01, 372.27it/s] 69%|██████▉   | 1436/2080 [00:05<00:01, 373.19it/s] 69%|██████▉   | 1437/2080 [00:05<00:01, 373.02it/s] 71%|███████   | 1474/2080 [00:05<00:01, 345.36it/s] 71%|███████   | 1475/2080 [00:05<00:01, 342.16it/s] 73%|███████▎  | 1509/2080 [00:06<00:01, 338.94it/s] 73%|███████▎  | 1510/2080 [00:05<00:01, 338.71it/s] 75%|███████▍  | 1553/2080 [00:06<00:01, 367.11it/s] 75%|███████▍  | 1555/2080 [00:06<00:01, 368.35it/s] 76%|███████▋  | 1591/2080 [00:06<00:01, 368.23it/s] 77%|███████▋  | 1593/2080 [00:06<00:01, 364.83it/s] 78%|███████▊  | 1632/2080 [00:06<00:01, 379.65it/s] 79%|███████▊  | 1635/2080 [00:06<00:01, 380.07it/s] 81%|████████  | 1675/2080 [00:06<00:01, 391.30it/s] 81%|████████  | 1677/2080 [00:06<00:01, 390.63it/s] 82%|████████▏ | 1715/2080 [00:06<00:01, 351.73it/s] 83%|████████▎ | 1717/2080 [00:06<00:01, 352.28it/s] 85%|████████▍ | 1760/2080 [00:06<00:00, 375.75it/s] 85%|████████▍ | 1761/2080 [00:06<00:00, 376.02it/s] 86%|████████▋ | 1799/2080 [00:06<00:00, 376.19it/s] 87%|████████▋ | 1800/2080 [00:06<00:00, 376.78it/s] 89%|████████▊ | 1844/2080 [00:06<00:00, 396.10it/s] 89%|████████▊ | 1845/2080 [00:06<00:00, 396.63it/s] 91%|█████████ | 1885/2080 [00:06<00:00, 394.96it/s] 91%|█████████ | 1886/2080 [00:06<00:00, 395.29it/s] 93%|█████████▎| 1925/2080 [00:07<00:00, 388.60it/s] 93%|█████████▎| 1926/2080 [00:07<00:00, 390.54it/s] 95%|█████████▍| 1967/2080 [00:07<00:00, 395.83it/s] 95%|█████████▍| 1968/2080 [00:07<00:00, 399.71it/s] 97%|█████████▋| 2010/2080 [00:07<00:00, 404.07it/s] 97%|█████████▋| 2012/2080 [00:07<00:00, 408.77it/s] 99%|█████████▊| 2052/2080 [00:07<00:00, 408.11it/s] 99%|█████████▉| 2054/2080 [00:07<00:00, 412.02it/s]100%|██████████| 2080/2080 [00:07<00:00, 278.86it/s]
100%|██████████| 2080/2080 [00:07<00:00, 281.77it/s]
2025-01-24 11:05:29,731 (ts_vad_dataset:152) INFO: model expect fbank as input , fbank_input should be True !!!
2025-01-24 11:05:29,731 (ts_vad_dataset:152) INFO: model expect fbank as input , fbank_input should be True !!!
2025-01-24 11:05:29,748 (ts_vad_dataset:160) INFO: loaded sentence=526485, shortest sent=48640.0, longest sent=160000.0, rs_len=10, segment_shift=2,  rir=True, musan=True, noise_ratio=0.8, zero_ratio=0.3
2025-01-24 11:05:29,748 (ts_vad_dataset:160) INFO: loaded sentence=526485, shortest sent=48640.0, longest sent=160000.0, rs_len=10, segment_shift=2,  rir=True, musan=True, noise_ratio=0.8, zero_ratio=0.3
2025-01-24 11:05:29,748 (train_accelerate_ddp:908) INFO: The scale window is set to 8192.
2025-01-24 11:05:29,748 (train_accelerate_ddp:908) INFO: The scale window is set to 8192.
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/accelerate/accelerator.py:494: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  self.scaler = torch.cuda.amp.GradScaler(**kwargs)
2025-01-24 11:05:30,428 (other:349) WARNING: Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
2025-01-24 11:05:30,428 (train_accelerate_ddp:946) INFO: model_cfg: TSVADConfig(speech_encoder_path='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/zh/modelscope/speech_campplus_sv_zh-cn_16k-common/campplus_cn_common.bin', speech_encoder_type='CAM++', freeze_speech_encoder_updates=4000, num_attention_head=4, num_transformer_layer=2, transformer_embed_dim=384, transformer_ffn_embed_dim=1536, speaker_embed_dim=192, dropout=0.1, use_spk_embed=True, feature_grad_mult=0.1, whisper_n_mels=80, select_encoder_layer_nums=6, wavlm_fuse_feat_post_norm=False, speech_encoder_config='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/wav-bert2.0/config.json', single_backend_type='mamba2', multi_backend_type='transformer', d_state=256, expand=4)
self.wavlm_fuse_feat_post_norm: False
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/accelerate/accelerator.py:494: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  self.scaler = torch.cuda.amp.GradScaler(**kwargs)
2025-01-24 11:05:30,454 (train_accelerate_ddp:946) INFO: model_cfg: TSVADConfig(speech_encoder_path='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/zh/modelscope/speech_campplus_sv_zh-cn_16k-common/campplus_cn_common.bin', speech_encoder_type='CAM++', freeze_speech_encoder_updates=4000, num_attention_head=4, num_transformer_layer=2, transformer_embed_dim=384, transformer_ffn_embed_dim=1536, speaker_embed_dim=192, dropout=0.1, use_spk_embed=True, feature_grad_mult=0.1, whisper_n_mels=80, select_encoder_layer_nums=6, wavlm_fuse_feat_post_norm=False, speech_encoder_config='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/wav-bert2.0/config.json', single_backend_type='mamba2', multi_backend_type='transformer', d_state=256, expand=4)
self.wavlm_fuse_feat_post_norm: False
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/model.py:898: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loadedState = torch.load(model_path, map_location=device)
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/model.py:898: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loadedState = torch.load(model_path, map_location=device)
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
2025-01-24 11:05:31,010 (train_accelerate_ddp:949) INFO: model: TSVADModel(
  (rs_dropout): Dropout(p=0.1, inplace=False)
  (speech_encoder): CAMPPlus(
    (head): FCM(
      (conv1): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (layer1): Sequential(
        (0): BasicResBlock(
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(2, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (shortcut): Sequential(
            (0): Conv2d(32, 32, kernel_size=(1, 1), stride=(2, 1), bias=False)
            (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicResBlock(
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (shortcut): Sequential()
        )
      )
      (layer2): Sequential(
        (0): BasicResBlock(
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(2, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (shortcut): Sequential(
            (0): Conv2d(32, 32, kernel_size=(1, 1), stride=(2, 1), bias=False)
            (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicResBlock(
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (shortcut): Sequential()
        )
      )
      (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(2, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (xvector): Sequential(
      (tdnn): TDNNLayer(
        (linear): Conv1d(320, 128, kernel_size=(5,), stride=(2,), padding=(2,), bias=False)
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
      )
      (block1): CAMDenseTDNNBlock(
        (0): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (1): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(160, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (2): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(192, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (3): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(224, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (4): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(256, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (5): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(288, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (6): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(320, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (7): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(352, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(352, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (8): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(384, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (9): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(416, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(416, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (10): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(448, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (11): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(480, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(480, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
      )
      (transit1): TransitLayer(
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
        (linear): Conv1d(512, 256, kernel_size=(1,), stride=(1,), bias=False)
      )
      (block2): CAMDenseTDNNBlock(
        (0): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(256, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (1): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(288, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (2): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(320, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (3): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(352, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(352, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (4): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(384, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (5): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(416, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(416, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (6): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(448, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (7): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(480, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(480, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (8): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(512, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (9): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(544, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(544, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (10): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(576, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (11): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(608, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(608, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (12): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(640, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (13): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(672, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(672, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (14): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(704, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(704, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (15): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(736, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(736, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (16): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(768, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (17): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(800, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(800, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (18): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(832, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(832, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (19): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(864, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(864, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (20): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(896, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(896, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (21): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(928, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(928, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (22): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(960, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(960, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (23): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(992, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(992, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
      )
      (transit2): TransitLayer(
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
        (linear): Conv1d(1024, 512, kernel_size=(1,), stride=(1,), bias=False)
      )
      (block3): CAMDenseTDNNBlock(
        (0): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(512, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (1): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(544, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(544, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (2): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(576, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (3): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(608, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(608, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (4): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(640, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (5): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(672, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(672, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (6): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(704, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(704, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (7): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(736, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(736, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (8): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(768, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (9): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(800, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(800, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (10): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(832, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(832, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (11): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(864, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(864, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (12): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(896, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(896, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (13): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(928, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(928, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (14): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(960, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(960, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (15): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(992, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(992, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
      )
      (transit3): TransitLayer(
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
        (linear): Conv1d(1024, 512, kernel_size=(1,), stride=(1,), bias=False)
      )
      (out_nonlinear): Sequential(
        (batchnorm): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (stats): StatsPool()
      (dense): DenseLayer(
        (linear): Conv1d(1024, 192, kernel_size=(1,), stride=(1,), bias=False)
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(192, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
        )
      )
    )
  )
  (speech_down_or_up): Sequential(
    (0): Conv1d(512, 192, kernel_size=(5,), stride=(2,), padding=(2,))
    (1): BatchNorm1D(
      (bn): BatchNorm1d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (2): ReLU()
  )
  (pos_encoder): PositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (single_backend): Mamba2BlockV2(
    (forward_blocks): ModuleList(
      (0-1): 2 x Block(
        (norm): RMSNorm()
        (mixer): Mamba2(
          (in_proj): Linear(in_features=384, out_features=3608, bias=False)
          (conv1d): Conv1d(2048, 2048, kernel_size=(4,), stride=(1,), padding=(3,), groups=2048)
          (act): SiLU()
          (norm): RMSNorm()
          (out_proj): Linear(in_features=1536, out_features=384, bias=False)
        )
      )
    )
    (backward_blocks): ModuleList(
      (0-1): 2 x Block(
        (norm): RMSNorm()
        (mixer): Mamba2(
          (in_proj): Linear(in_features=384, out_features=3608, bias=False)
          (conv1d): Conv1d(2048, 2048, kernel_size=(4,), stride=(1,), padding=(3,), groups=2048)
          (act): SiLU()
          (norm): RMSNorm()
          (out_proj): Linear(in_features=1536, out_features=384, bias=False)
        )
      )
    )
  )
  (backend_down): Sequential(
    (0): Conv1d(5376, 384, kernel_size=(5,), stride=(1,), padding=(2,))
    (1): BatchNorm1D(
      (bn): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (2): ReLU()
  )
  (multi_backend): TransformerEncoder(
    (layers): ModuleList(
      (0-1): 2 x TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=384, out_features=384, bias=True)
        )
        (linear1): Linear(in_features=384, out_features=1536, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=1536, out_features=384, bias=True)
        (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc): Linear(in_features=384, out_features=7, bias=True)
)
2025-01-24 11:05:31,011 (train_accelerate_ddp:949) INFO: model: TSVADModel(
  (rs_dropout): Dropout(p=0.1, inplace=False)
  (speech_encoder): CAMPPlus(
    (head): FCM(
      (conv1): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (layer1): Sequential(
        (0): BasicResBlock(
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(2, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (shortcut): Sequential(
            (0): Conv2d(32, 32, kernel_size=(1, 1), stride=(2, 1), bias=False)
            (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicResBlock(
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (shortcut): Sequential()
        )
      )
      (layer2): Sequential(
        (0): BasicResBlock(
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(2, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (shortcut): Sequential(
            (0): Conv2d(32, 32, kernel_size=(1, 1), stride=(2, 1), bias=False)
            (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicResBlock(
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (shortcut): Sequential()
        )
      )
      (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(2, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (xvector): Sequential(
      (tdnn): TDNNLayer(
        (linear): Conv1d(320, 128, kernel_size=(5,), stride=(2,), padding=(2,), bias=False)
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
      )
      (block1): CAMDenseTDNNBlock(
        (0): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (1): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(160, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (2): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(192, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (3): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(224, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (4): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(256, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (5): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(288, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (6): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(320, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (7): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(352, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(352, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (8): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(384, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (9): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(416, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(416, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (10): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(448, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (11): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(480, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(480, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
      )
      (transit1): TransitLayer(
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
        (linear): Conv1d(512, 256, kernel_size=(1,), stride=(1,), bias=False)
      )
      (block2): CAMDenseTDNNBlock(
        (0): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(256, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (1): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(288, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (2): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(320, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (3): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(352, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(352, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (4): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(384, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (5): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(416, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(416, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (6): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(448, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (7): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(480, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(480, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (8): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(512, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (9): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(544, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(544, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (10): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(576, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (11): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(608, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(608, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (12): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(640, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (13): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(672, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(672, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (14): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(704, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(704, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (15): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(736, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(736, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (16): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(768, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (17): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(800, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(800, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (18): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(832, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(832, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (19): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(864, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(864, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (20): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(896, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(896, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (21): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(928, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(928, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (22): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(960, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(960, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (23): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(992, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(992, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
      )
      (transit2): TransitLayer(
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
        (linear): Conv1d(1024, 512, kernel_size=(1,), stride=(1,), bias=False)
      )
      (block3): CAMDenseTDNNBlock(
        (0): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(512, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (1): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(544, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(544, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (2): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(576, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (3): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(608, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(608, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (4): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(640, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (5): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(672, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(672, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (6): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(704, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(704, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (7): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(736, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(736, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (8): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(768, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (9): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(800, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(800, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (10): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(832, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(832, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (11): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(864, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(864, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (12): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(896, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(896, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (13): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(928, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(928, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (14): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(960, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(960, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
        (15): CAMDenseTDNNLayer(
          (nonlinear1): Sequential(
            (batchnorm): BatchNorm1d(992, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (linear1): Conv1d(992, 128, kernel_size=(1,), stride=(1,), bias=False)
          (nonlinear2): Sequential(
            (batchnorm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (relu): ReLU(inplace=True)
          )
          (cam_layer): CAMLayer(
            (linear_local): Conv1d(128, 32, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,), bias=False)
            (linear1): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
            (relu): ReLU(inplace=True)
            (linear2): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
            (sigmoid): Sigmoid()
          )
        )
      )
      (transit3): TransitLayer(
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
        )
        (linear): Conv1d(1024, 512, kernel_size=(1,), stride=(1,), bias=False)
      )
      (out_nonlinear): Sequential(
        (batchnorm): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (stats): StatsPool()
      (dense): DenseLayer(
        (linear): Conv1d(1024, 192, kernel_size=(1,), stride=(1,), bias=False)
        (nonlinear): Sequential(
          (batchnorm): BatchNorm1d(192, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
        )
      )
    )
  )
  (speech_down_or_up): Sequential(
    (0): Conv1d(512, 192, kernel_size=(5,), stride=(2,), padding=(2,))
    (1): BatchNorm1D(
      (bn): BatchNorm1d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (2): ReLU()
  )
  (pos_encoder): PositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (single_backend): Mamba2BlockV2(
    (forward_blocks): ModuleList(
      (0-1): 2 x Block(
        (norm): RMSNorm()
        (mixer): Mamba2(
          (in_proj): Linear(in_features=384, out_features=3608, bias=False)
          (conv1d): Conv1d(2048, 2048, kernel_size=(4,), stride=(1,), padding=(3,), groups=2048)
          (act): SiLU()
          (norm): RMSNorm()
          (out_proj): Linear(in_features=1536, out_features=384, bias=False)
        )
      )
    )
    (backward_blocks): ModuleList(
      (0-1): 2 x Block(
        (norm): RMSNorm()
        (mixer): Mamba2(
          (in_proj): Linear(in_features=384, out_features=3608, bias=False)
          (conv1d): Conv1d(2048, 2048, kernel_size=(4,), stride=(1,), padding=(3,), groups=2048)
          (act): SiLU()
          (norm): RMSNorm()
          (out_proj): Linear(in_features=1536, out_features=384, bias=False)
        )
      )
    )
  )
  (backend_down): Sequential(
    (0): Conv1d(5376, 384, kernel_size=(5,), stride=(1,), padding=(2,))
    (1): BatchNorm1D(
      (bn): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (2): ReLU()
  )
  (multi_backend): TransformerEncoder(
    (layers): ModuleList(
      (0-1): 2 x TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=384, out_features=384, bias=True)
        )
        (linear1): Linear(in_features=384, out_features=1536, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=1536, out_features=384, bias=True)
        (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc): Linear(in_features=384, out_features=7, bias=True)
)
2025-01-24 11:05:31,012 (train_accelerate_ddp:951) INFO: Number of model parameters: 29165447
2025-01-24 11:05:31,012 (train_accelerate_ddp:951) INFO: Number of model parameters: 29165447
pgpu17:609267:609267 [0] NCCL INFO Bootstrap : Using ib1:20.20.20.17<0>
pgpu17:609267:609267 [0] NCCL INFO NET/Plugin : dlerror=libnccl-net.so: cannot open shared object file: No such file or directory No plugin found (libnccl-net.so), using internal implementation
pgpu17:609267:609267 [0] NCCL INFO cudaDriverVersion 12040
NCCL version 2.20.5+cuda11.0
pgpu17:609268:609268 [1] NCCL INFO cudaDriverVersion 12040
pgpu17:609268:609268 [1] NCCL INFO Bootstrap : Using ib1:20.20.20.17<0>
pgpu17:609268:609268 [1] NCCL INFO NET/Plugin : dlerror=libnccl-net.so: cannot open shared object file: No such file or directory No plugin found (libnccl-net.so), using internal implementation
pgpu17:609267:609352 [0] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [1]mlx5_1:1/RoCE [2]mlx5_3:1/IB [RO]; OOB ib1:20.20.20.17<0>
pgpu17:609267:609352 [0] NCCL INFO Using non-device net plugin version 0
pgpu17:609267:609352 [0] NCCL INFO Using network IB
pgpu17:609268:609353 [1] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [1]mlx5_1:1/RoCE [2]mlx5_3:1/IB [RO]; OOB ib1:20.20.20.17<0>
pgpu17:609268:609353 [1] NCCL INFO Using non-device net plugin version 0
pgpu17:609268:609353 [1] NCCL INFO Using network IB
pgpu17:609267:609352 [0] NCCL INFO comm 0x555568d53c70 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 9b000 commId 0xb82a12ba4b6328c4 - Init START
pgpu17:609268:609353 [1] NCCL INFO comm 0x555565c0fad0 rank 1 nranks 2 cudaDev 1 nvmlDev 1 busId cb000 commId 0xb82a12ba4b6328c4 - Init START
pgpu17:609267:609352 [0] NCCL INFO comm 0x555568d53c70 rank 0 nRanks 2 nNodes 1 localRanks 2 localRank 0 MNNVL 0
pgpu17:609268:609353 [1] NCCL INFO comm 0x555565c0fad0 rank 1 nRanks 2 nNodes 1 localRanks 2 localRank 1 MNNVL 0
pgpu17:609267:609352 [0] NCCL INFO Channel 00/24 :    0   1
pgpu17:609267:609352 [0] NCCL INFO Channel 01/24 :    0   1
pgpu17:609267:609352 [0] NCCL INFO Channel 02/24 :    0   1
pgpu17:609267:609352 [0] NCCL INFO Channel 03/24 :    0   1
pgpu17:609267:609352 [0] NCCL INFO Channel 04/24 :    0   1
pgpu17:609267:609352 [0] NCCL INFO Channel 05/24 :    0   1
pgpu17:609267:609352 [0] NCCL INFO Channel 06/24 :    0   1
pgpu17:609267:609352 [0] NCCL INFO Channel 07/24 :    0   1
pgpu17:609267:609352 [0] NCCL INFO Channel 08/24 :    0   1
pgpu17:609267:609352 [0] NCCL INFO Channel 09/24 :    0   1
pgpu17:609267:609352 [0] NCCL INFO Channel 10/24 :    0   1
pgpu17:609267:609352 [0] NCCL INFO Channel 11/24 :    0   1
pgpu17:609267:609352 [0] NCCL INFO Channel 12/24 :    0   1
pgpu17:609268:609353 [1] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] -1/-1/-1->1->0 [2] -1/-1/-1->1->0 [3] -1/-1/-1->1->0 [4] -1/-1/-1->1->0 [5] -1/-1/-1->1->0 [6] 0/-1/-1->1->-1 [7] 0/-1/-1->1->-1 [8] 0/-1/-1->1->-1 [9] 0/-1/-1->1->-1 [10] 0/-1/-1->1->-1 [11] 0/-1/-1->1->-1 [12] -1/-1/-1->1->0 [13] -1/-1/-1->1->0 [14] -1/-1/-1->1->0 [15] -1/-1/-1->1->0 [16] -1/-1/-1->1->0 [17] -1/-1/-1->1->0 [18] 0/-1/-1->1->-1 [19] 0/-1/-1->1->-1 [20] 0/-1/-1->1->-1 [21] 0/-1/-1->1->-1 [22] 0/-1/-1->1->-1 [23] 0/-1/-1->1->-1
pgpu17:609267:609352 [0] NCCL INFO Channel 13/24 :    0   1
pgpu17:609268:609353 [1] NCCL INFO P2P Chunksize set to 524288
pgpu17:609267:609352 [0] NCCL INFO Channel 14/24 :    0   1
pgpu17:609267:609352 [0] NCCL INFO Channel 15/24 :    0   1
pgpu17:609267:609352 [0] NCCL INFO Channel 16/24 :    0   1
pgpu17:609267:609352 [0] NCCL INFO Channel 17/24 :    0   1
pgpu17:609267:609352 [0] NCCL INFO Channel 18/24 :    0   1
pgpu17:609267:609352 [0] NCCL INFO Channel 19/24 :    0   1
pgpu17:609267:609352 [0] NCCL INFO Channel 20/24 :    0   1
pgpu17:609267:609352 [0] NCCL INFO Channel 21/24 :    0   1
pgpu17:609267:609352 [0] NCCL INFO Channel 22/24 :    0   1
pgpu17:609267:609352 [0] NCCL INFO Channel 23/24 :    0   1
pgpu17:609267:609352 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1 [2] 1/-1/-1->0->-1 [3] 1/-1/-1->0->-1 [4] 1/-1/-1->0->-1 [5] 1/-1/-1->0->-1 [6] -1/-1/-1->0->1 [7] -1/-1/-1->0->1 [8] -1/-1/-1->0->1 [9] -1/-1/-1->0->1 [10] -1/-1/-1->0->1 [11] -1/-1/-1->0->1 [12] 1/-1/-1->0->-1 [13] 1/-1/-1->0->-1 [14] 1/-1/-1->0->-1 [15] 1/-1/-1->0->-1 [16] 1/-1/-1->0->-1 [17] 1/-1/-1->0->-1 [18] -1/-1/-1->0->1 [19] -1/-1/-1->0->1 [20] -1/-1/-1->0->1 [21] -1/-1/-1->0->1 [22] -1/-1/-1->0->1 [23] -1/-1/-1->0->1
pgpu17:609267:609352 [0] NCCL INFO P2P Chunksize set to 524288
pgpu17:609268:609353 [1] NCCL INFO Channel 00/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu17:609267:609352 [0] NCCL INFO Channel 00/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu17:609268:609353 [1] NCCL INFO Channel 01/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu17:609267:609352 [0] NCCL INFO Channel 01/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu17:609268:609353 [1] NCCL INFO Channel 02/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu17:609267:609352 [0] NCCL INFO Channel 02/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu17:609268:609353 [1] NCCL INFO Channel 03/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu17:609267:609352 [0] NCCL INFO Channel 03/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu17:609268:609353 [1] NCCL INFO Channel 04/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu17:609267:609352 [0] NCCL INFO Channel 04/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu17:609268:609353 [1] NCCL INFO Channel 05/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu17:609267:609352 [0] NCCL INFO Channel 05/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu17:609268:609353 [1] NCCL INFO Channel 06/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu17:609267:609352 [0] NCCL INFO Channel 06/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu17:609268:609353 [1] NCCL INFO Channel 07/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu17:609267:609352 [0] NCCL INFO Channel 07/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu17:609268:609353 [1] NCCL INFO Channel 08/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu17:609267:609352 [0] NCCL INFO Channel 08/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu17:609268:609353 [1] NCCL INFO Channel 09/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu17:609267:609352 [0] NCCL INFO Channel 09/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu17:609268:609353 [1] NCCL INFO Channel 10/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu17:609267:609352 [0] NCCL INFO Channel 10/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu17:609268:609353 [1] NCCL INFO Channel 11/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu17:609267:609352 [0] NCCL INFO Channel 11/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu17:609268:609353 [1] NCCL INFO Channel 12/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu17:609267:609352 [0] NCCL INFO Channel 12/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu17:609268:609353 [1] NCCL INFO Channel 13/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu17:609267:609352 [0] NCCL INFO Channel 13/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu17:609268:609353 [1] NCCL INFO Channel 14/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu17:609267:609352 [0] NCCL INFO Channel 14/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu17:609268:609353 [1] NCCL INFO Channel 15/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu17:609267:609352 [0] NCCL INFO Channel 15/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu17:609268:609353 [1] NCCL INFO Channel 16/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu17:609267:609352 [0] NCCL INFO Channel 16/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu17:609268:609353 [1] NCCL INFO Channel 17/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu17:609267:609352 [0] NCCL INFO Channel 17/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu17:609268:609353 [1] NCCL INFO Channel 18/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu17:609267:609352 [0] NCCL INFO Channel 18/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu17:609268:609353 [1] NCCL INFO Channel 19/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu17:609267:609352 [0] NCCL INFO Channel 19/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu17:609268:609353 [1] NCCL INFO Channel 20/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu17:609267:609352 [0] NCCL INFO Channel 20/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu17:609268:609353 [1] NCCL INFO Channel 21/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu17:609267:609352 [0] NCCL INFO Channel 21/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu17:609268:609353 [1] NCCL INFO Channel 22/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu17:609267:609352 [0] NCCL INFO Channel 22/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu17:609268:609353 [1] NCCL INFO Channel 23/0 : 1[1] -> 0[0] via P2P/IPC/read
pgpu17:609267:609352 [0] NCCL INFO Channel 23/0 : 0[0] -> 1[1] via P2P/IPC/read
pgpu17:609268:609353 [1] NCCL INFO Connected all rings
pgpu17:609267:609352 [0] NCCL INFO Connected all rings
pgpu17:609268:609353 [1] NCCL INFO Connected all trees
pgpu17:609267:609352 [0] NCCL INFO Connected all trees
pgpu17:609268:609353 [1] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
pgpu17:609268:609353 [1] NCCL INFO 24 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
pgpu17:609267:609352 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
pgpu17:609267:609352 [0] NCCL INFO 24 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
pgpu17:609268:609353 [1] NCCL INFO comm 0x555565c0fad0 rank 1 nranks 2 cudaDev 1 nvmlDev 1 busId cb000 commId 0xb82a12ba4b6328c4 - Init COMPLETE
pgpu17:609267:609352 [0] NCCL INFO comm 0x555568d53c70 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 9b000 commId 0xb82a12ba4b6328c4 - Init COMPLETE
2025-01-24 11:05:33,170 (train_accelerate_ddp:1032) INFO: start training from epoch 1
2025-01-24 11:05:33,170 (train_accelerate_ddp:1033) INFO: Train set grouped total_num_itrs = 4114
2025-01-24 11:05:33,171 (train_accelerate_ddp:1032) INFO: start training from epoch 1
2025-01-24 11:05:33,171 (train_accelerate_ddp:1033) INFO: Train set grouped total_num_itrs = 4114
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/ts_vad_dataset.py:398: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  feature = torch.load(path, map_location="cpu")
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/ts_vad_dataset.py:398: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  feature = torch.load(path, map_location="cpu")
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/ts_vad_dataset.py:392: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  feature = torch.load(path, map_location="cpu")
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/ts_vad_dataset.py:392: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  feature = torch.load(path, map_location="cpu")
2025-01-24 11:06:06,241 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 0, num_updates: 0, {'loss': 0.7356405258178711, 'DER': 2.8153479873761142, 'ACC': np.float64(0.4690446428571428), 'MI': 0.009135706771496594, 'FA': 2.328996179613532, 'CF': 0.47721610099108575}, batch size: 64, grad_norm: 2.325930118560791, grad_scale: , lr: 5.00e-08,
2025-01-24 11:06:06,241 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 0, num_updates: 0, {'loss': 0.7409105896949768, 'DER': 2.910406264185202, 'ACC': np.float64(0.46386607142857145), 'MI': 0.008681343622333183, 'FA': 2.405015887426237, 'CF': 0.49670903313663184}, batch size: 64, grad_norm: 2.325930118560791, grad_scale: , lr: 5.00e-08,
2025-01-24 11:23:29,936 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 500, num_updates: 500, {'loss': 0.33404117822647095, 'DER': 0.8418504572350726, 'ACC': np.float64(0.8609553571428571), 'MI': 0.7240451855836472, 'FA': 0.02886856733010579, 'CF': 0.08893670432131971}, batch size: 64, grad_norm: 0.33746251463890076, grad_scale: , lr: 2.51e-05,
2025-01-24 11:23:29,936 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 500, num_updates: 500, {'loss': 0.356087327003479, 'DER': 0.8952726485081497, 'ACC': np.float64(0.8400714285714286), 'MI': 0.8015920290247468, 'FA': 0.01900687713218173, 'CF': 0.0746737423512211}, batch size: 64, grad_norm: 0.33746251463890076, grad_scale: , lr: 2.51e-05,
2025-01-24 11:23:29,936 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 11:23:29,936 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 11:24:39,490 (model:870) WARNING: All labels are zero
2025-01-24 11:24:40,306 (model:870) WARNING: All labels are zero
2025-01-24 11:24:42,055 (model:870) WARNING: All labels are zero
2025-01-24 11:26:52,524 (model:870) WARNING: All labels are zero
2025-01-24 11:27:06,169 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 500,  validation: loss=0.3343, DER=0.9889, ACC=0.8474, MI=0.9806, FA=4.571e-05, CF=0.008203, over 0.00 frames.
2025-01-24 11:27:06,170 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 8810MB
2025-01-24 11:27:09,763 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 500,  validation: loss=0.3323, DER=0.9887, ACC=0.8492, MI=0.981, FA=4.915e-05, CF=0.007636, over 0.00 frames.
2025-01-24 11:27:09,764 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 8810MB
2025-01-24 11:43:08,906 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 1000, num_updates: 1000, {'loss': 0.26808273792266846, 'DER': 0.6710853355426678, 'ACC': np.float64(0.8817678571428571), 'MI': 0.4915374600544443, 'FA': 0.06699017635223103, 'CF': 0.11255769913599242}, batch size: 64, grad_norm: 0.3317505121231079, grad_scale: , lr: 5.00e-05,
2025-01-24 11:43:08,906 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 1000, num_updates: 1000, {'loss': 0.2853517234325409, 'DER': 0.7757125154894672, 'ACC': np.float64(0.8639642857142856), 'MI': 0.5828760252552074, 'FA': 0.06951082787514014, 'CF': 0.12332566235911961}, batch size: 64, grad_norm: 0.3317505121231079, grad_scale: , lr: 5.00e-05,
2025-01-24 11:43:08,907 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 11:43:08,907 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 11:44:17,833 (model:870) WARNING: All labels are zero
2025-01-24 11:44:18,635 (model:870) WARNING: All labels are zero
2025-01-24 11:44:19,057 (model:870) WARNING: All labels are zero
2025-01-24 11:46:26,272 (model:870) WARNING: All labels are zero
2025-01-24 11:46:41,761 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 1000,  validation: loss=0.2826, DER=0.7632, ACC=0.8602, MI=0.5614, FA=0.0549, CF=0.1469, over 0.00 frames.
2025-01-24 11:46:41,761 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 8810MB
2025-01-24 11:46:43,058 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 1000,  validation: loss=0.2818, DER=0.7653, ACC=0.861, MI=0.5627, FA=0.05397, CF=0.1486, over 0.00 frames.
2025-01-24 11:46:43,058 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 8810MB
2025-01-24 12:02:48,651 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-1500.pt
2025-01-24 12:02:49,115 (checkpoint:355) WARNING: No checkpoints found in /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10
2025-01-24 12:02:51,048 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 1500, num_updates: 1500, {'loss': 0.2224816232919693, 'DER': 0.5422122985939292, 'ACC': np.float64(0.9004642857142857), 'MI': 0.3104821676422666, 'FA': 0.10120089312654637, 'CF': 0.13052923782511616}, batch size: 64, grad_norm: 0.3743862509727478, grad_scale: , lr: 7.50e-05,
2025-01-24 12:02:51,049 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 12:02:51,049 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 1500, num_updates: 1500, {'loss': 0.2097395658493042, 'DER': 0.47923583519294616, 'ACC': np.float64(0.90625), 'MI': 0.31687802754041255, 'FA': 0.0701028683394111, 'CF': 0.09225493931312252}, batch size: 64, grad_norm: 0.3743862509727478, grad_scale: , lr: 7.50e-05,
2025-01-24 12:02:51,049 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 12:04:01,010 (model:870) WARNING: All labels are zero
2025-01-24 12:04:01,812 (model:870) WARNING: All labels are zero
2025-01-24 12:04:03,543 (model:870) WARNING: All labels are zero
2025-01-24 12:06:14,362 (model:870) WARNING: All labels are zero
2025-01-24 12:06:25,159 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 1500,  validation: loss=0.2177, DER=0.5864, ACC=0.8915, MI=0.3881, FA=0.07454, CF=0.1237, over 0.00 frames.
2025-01-24 12:06:25,160 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 8810MB
2025-01-24 12:06:31,650 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 1500,  validation: loss=0.2132, DER=0.5841, ACC=0.8934, MI=0.3903, FA=0.07153, CF=0.1223, over 0.00 frames.
2025-01-24 12:06:31,650 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 8810MB
2025-01-24 12:22:34,559 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 2000, num_updates: 2000, {'loss': 0.22469665110111237, 'DER': 0.5346810735447891, 'ACC': np.float64(0.9029642857142857), 'MI': 0.37033809689787384, 'FA': 0.06767747182525852, 'CF': 0.0966655048216568}, batch size: 64, grad_norm: 0.407492995262146, grad_scale: , lr: 1.00e-04,
2025-01-24 12:22:34,559 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 2000, num_updates: 2000, {'loss': 0.19907762110233307, 'DER': 0.5017711764340315, 'ACC': np.float64(0.9108125), 'MI': 0.27288546392393265, 'FA': 0.10987508545149463, 'CF': 0.11901062705860418}, batch size: 64, grad_norm: 0.407492995262146, grad_scale: , lr: 1.00e-04,
2025-01-24 12:22:34,560 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 12:22:34,560 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 12:23:43,921 (model:870) WARNING: All labels are zero
2025-01-24 12:23:44,720 (model:870) WARNING: All labels are zero
2025-01-24 12:23:46,772 (model:870) WARNING: All labels are zero
2025-01-24 12:25:57,565 (model:870) WARNING: All labels are zero
2025-01-24 12:26:10,457 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 2000,  validation: loss=0.1951, DER=0.4607, ACC=0.9076, MI=0.2228, FA=0.09194, CF=0.146, over 0.00 frames.
2025-01-24 12:26:10,458 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 8810MB
2025-01-24 12:26:14,943 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 2000,  validation: loss=0.1916, DER=0.4567, ACC=0.9088, MI=0.2229, FA=0.08582, CF=0.1479, over 0.00 frames.
2025-01-24 12:26:14,944 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 8810MB
2025-01-24 12:42:23,808 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 2500, num_updates: 2500, {'loss': 0.20014965534210205, 'DER': 0.4660271782573941, 'ACC': np.float64(0.9107829107829108), 'MI': 0.31654676258992803, 'FA': 0.049503254539225765, 'CF': 0.09997716112824026}, batch size: 64, grad_norm: 0.3106970489025116, grad_scale: , lr: 9.72e-05,
2025-01-24 12:42:23,808 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 2500, num_updates: 2500, {'loss': 0.193563312292099, 'DER': 0.4429281831849196, 'ACC': np.float64(0.9193303571428572), 'MI': 0.29224008326587253, 'FA': 0.07118075633167573, 'CF': 0.07950734358737134}, batch size: 64, grad_norm: 0.3106970489025116, grad_scale: , lr: 9.72e-05,
2025-01-24 12:42:23,809 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 12:42:23,809 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 12:43:33,799 (model:870) WARNING: All labels are zero
2025-01-24 12:43:34,610 (model:870) WARNING: All labels are zero
2025-01-24 12:43:36,176 (model:870) WARNING: All labels are zero
2025-01-24 12:45:47,084 (model:870) WARNING: All labels are zero
2025-01-24 12:45:59,949 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 2500,  validation: loss=0.1522, DER=0.3617, ACC=0.9308, MI=0.2047, FA=0.07878, CF=0.07823, over 0.00 frames.
2025-01-24 12:45:59,950 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 8810MB
2025-01-24 12:46:04,374 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 2500,  validation: loss=0.148, DER=0.3507, ACC=0.9338, MI=0.2011, FA=0.07649, CF=0.07314, over 0.00 frames.
2025-01-24 12:46:04,375 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 8810MB
2025-01-24 13:02:00,381 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-3000.pt
2025-01-24 13:02:00,790 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-24 13:02:00,817 (checkpoint:355) WARNING: No checkpoints found in /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10
2025-01-24 13:02:02,584 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 3000, num_updates: 3000, {'loss': 0.1783754527568817, 'DER': 0.4199897895513075, 'ACC': np.float64(0.9194312369425834), 'MI': 0.26938567133700153, 'FA': 0.06307788303363776, 'CF': 0.08752623518066821}, batch size: 64, grad_norm: 0.2888868451118469, grad_scale: , lr: 9.44e-05,
2025-01-24 13:02:02,584 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 13:02:02,584 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 3000, num_updates: 3000, {'loss': 0.1583426147699356, 'DER': 0.3473064264680409, 'ACC': np.float64(0.9313125), 'MI': 0.19550782377735434, 'FA': 0.05491079161614412, 'CF': 0.0968878110745424}, batch size: 64, grad_norm: 0.2888868451118469, grad_scale: , lr: 9.44e-05,
2025-01-24 13:02:02,585 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 13:03:15,084 (model:870) WARNING: All labels are zero
2025-01-24 13:03:15,966 (model:870) WARNING: All labels are zero
2025-01-24 13:03:16,511 (model:870) WARNING: All labels are zero
2025-01-24 13:05:27,309 (model:870) WARNING: All labels are zero
2025-01-24 13:05:42,839 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 3000,  validation: loss=0.1271, DER=0.2949, ACC=0.9434, MI=0.1789, FA=0.05965, CF=0.05634, over 0.00 frames.
2025-01-24 13:05:42,839 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 8810MB
2025-01-24 13:05:44,587 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 3000,  validation: loss=0.1252, DER=0.2898, ACC=0.9444, MI=0.1765, FA=0.0571, CF=0.05622, over 0.00 frames.
2025-01-24 13:05:44,587 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 8810MB
2025-01-24 13:21:58,437 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 3500, num_updates: 3500, {'loss': 0.19811056554317474, 'DER': 0.4321581196581197, 'ACC': np.float64(0.9115714285714286), 'MI': 0.28354700854700854, 'FA': 0.051709401709401706, 'CF': 0.0969017094017094}, batch size: 64, grad_norm: 0.28943488001823425, grad_scale: , lr: 9.17e-05,
2025-01-24 13:21:58,438 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 3500, num_updates: 3500, {'loss': 0.15904611349105835, 'DER': 0.37194345003337176, 'ACC': np.float64(0.9327292177962369), 'MI': 0.2305685334627753, 'FA': 0.0592803834718767, 'CF': 0.08209453309871974}, batch size: 64, grad_norm: 0.28943488001823425, grad_scale: , lr: 9.17e-05,
2025-01-24 13:21:58,438 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 13:21:58,438 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 13:23:09,999 (model:870) WARNING: All labels are zero
2025-01-24 13:23:10,814 (model:870) WARNING: All labels are zero
2025-01-24 13:23:11,244 (model:870) WARNING: All labels are zero
2025-01-24 13:25:22,932 (model:870) WARNING: All labels are zero
2025-01-24 13:25:40,418 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 3500,  validation: loss=0.1232, DER=0.2809, ACC=0.9462, MI=0.1293, FA=0.09422, CF=0.05739, over 0.00 frames.
2025-01-24 13:25:40,419 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 8810MB
2025-01-24 13:25:40,990 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 3500,  validation: loss=0.1262, DER=0.2865, ACC=0.9441, MI=0.1312, FA=0.0936, CF=0.06174, over 0.00 frames.
2025-01-24 13:25:40,990 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 8810MB
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
2025-01-24 13:41:41,803 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 4000, num_updates: 4000, {'loss': 0.18281495571136475, 'DER': 0.3981016801221907, 'ACC': np.float64(0.9226785714285715), 'MI': 0.26860135282566006, 'FA': 0.05520401483744272, 'CF': 0.07429631245908794}, batch size: 64, grad_norm: 0.28376561403274536, grad_scale: , lr: 8.89e-05,
2025-01-24 13:41:41,804 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 13:41:41,806 (train_accelerate_ddp:702) INFO: [Train] - Epoch 1, batch_idx_train: 4000, num_updates: 4000, {'loss': 0.15377318859100342, 'DER': 0.3436130966105603, 'ACC': np.float64(0.9348035714285714), 'MI': 0.19495042656213973, 'FA': 0.07136269310583353, 'CF': 0.07729997694258704}, batch size: 64, grad_norm: 0.28376561403274536, grad_scale: , lr: 8.89e-05,
2025-01-24 13:41:41,806 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 13:42:51,341 (model:870) WARNING: All labels are zero
2025-01-24 13:42:52,151 (model:870) WARNING: All labels are zero
2025-01-24 13:42:54,267 (model:870) WARNING: All labels are zero
2025-01-24 13:45:05,398 (model:870) WARNING: All labels are zero
2025-01-24 13:45:16,812 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 4000,  validation: loss=0.1193, DER=0.2679, ACC=0.9478, MI=0.1397, FA=0.07455, CF=0.05372, over 0.00 frames.
2025-01-24 13:45:16,813 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15787MB
2025-01-24 13:45:22,905 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 1, batch_idx_train: 4000,  validation: loss=0.1186, DER=0.2692, ACC=0.948, MI=0.1391, FA=0.07511, CF=0.05499, over 0.00 frames.
2025-01-24 13:45:22,905 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15787MB
2025-01-24 13:49:20,307 (train_accelerate_ddp:713) INFO: end of epoch 1, batch_idx: 4113 batch_idx_train: 4113, {'loss': 0.14326542615890503, 'DER': 0.34468937875751504, 'ACC': np.float64(0.9374732142857143), 'MI': 0.20073480293921175, 'FA': 0.0988087285682476, 'CF': 0.045145847250055667}, batch size: 64, grad_norm: 0.290147989988327, grad_scale: , lr: 8.83e-05,
2025-01-24 13:49:20,307 (train_accelerate_ddp:713) INFO: end of epoch 1, batch_idx: 4113 batch_idx_train: 4113, {'loss': 0.15693944692611694, 'DER': 0.3370162446249403, 'ACC': np.float64(0.9344107142857143), 'MI': 0.14106545628284758, 'FA': 0.0942427138079312, 'CF': 0.10170807453416149}, batch size: 64, grad_norm: 0.290147989988327, grad_scale: , lr: 8.83e-05,
2025-01-24 13:49:20,312 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-1.pt
2025-01-24 13:49:20,740 (train_accelerate_ddp:561) INFO:  end of epoch 1, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-1.pt
2025-01-24 13:49:25,382 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 4114, num_updates: 4000, {'loss': 0.15328583121299744, 'DER': 0.3296684016609158, 'ACC': np.float64(0.9393095868691783), 'MI': 0.17808058950815836, 'FA': 0.08725656471138662, 'CF': 0.06433124744137084}, batch size: 64, grad_norm: 0.3071036636829376, grad_scale: , lr: 8.83e-05,
2025-01-24 13:49:25,383 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 4114, num_updates: 4000, {'loss': 0.13999339938163757, 'DER': 0.33649630652813645, 'ACC': np.float64(0.9394732142857143), 'MI': 0.17704642363821993, 'FA': 0.08882349408443937, 'CF': 0.07062638880547714}, batch size: 64, grad_norm: 0.3071036636829376, grad_scale: , lr: 8.83e-05,
2025-01-24 14:02:54,014 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-4500.pt
2025-01-24 14:02:54,584 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-24 14:06:58,125 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 4614, num_updates: 4500, {'loss': 0.12794363498687744, 'DER': 0.2839906356924185, 'ACC': np.float64(0.9483928571428571), 'MI': 0.1405246413350141, 'FA': 0.08049702863317126, 'CF': 0.06296896572423315}, batch size: 64, grad_norm: 0.23991471529006958, grad_scale: , lr: 8.55e-05,
2025-01-24 14:06:58,125 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 4614, num_updates: 4500, {'loss': 0.12433189153671265, 'DER': 0.29479407537028934, 'ACC': np.float64(0.9490178571428571), 'MI': 0.1675520279982501, 'FA': 0.06518342603587275, 'CF': 0.06205862133616649}, batch size: 64, grad_norm: 0.23991471529006958, grad_scale: , lr: 8.55e-05,
2025-01-24 14:06:58,125 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 14:06:58,125 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 14:08:08,401 (model:870) WARNING: All labels are zero
2025-01-24 14:08:09,206 (model:870) WARNING: All labels are zero
2025-01-24 14:08:10,310 (model:870) WARNING: All labels are zero
2025-01-24 14:10:21,514 (model:870) WARNING: All labels are zero
2025-01-24 14:10:36,774 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 4614,  validation: loss=0.1002, DER=0.2305, ACC=0.9549, MI=0.1346, FA=0.05505, CF=0.04086, over 0.00 frames.
2025-01-24 14:10:36,775 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 14:10:38,847 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 4614,  validation: loss=0.09898, DER=0.2275, ACC=0.9557, MI=0.1341, FA=0.05401, CF=0.03934, over 0.00 frames.
2025-01-24 14:10:38,847 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 14:28:12,317 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 5114, num_updates: 5000, {'loss': 0.1353350281715393, 'DER': 0.32172527597587347, 'ACC': np.float64(0.9391071428571429), 'MI': 0.17360874018436326, 'FA': 0.08176852167975418, 'CF': 0.066348014111756}, batch size: 64, grad_norm: 0.20859788358211517, grad_scale: , lr: 8.27e-05,
2025-01-24 14:28:12,318 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 14:28:12,318 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 5114, num_updates: 5000, {'loss': 0.11770696192979813, 'DER': 0.2547803917023989, 'ACC': np.float64(0.9538214285714286), 'MI': 0.15337814346969522, 'FA': 0.05649553830107776, 'CF': 0.04490670993162591}, batch size: 64, grad_norm: 0.20859788358211517, grad_scale: , lr: 8.27e-05,
2025-01-24 14:28:12,318 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 14:29:21,378 (model:870) WARNING: All labels are zero
2025-01-24 14:29:22,175 (model:870) WARNING: All labels are zero
2025-01-24 14:29:24,326 (model:870) WARNING: All labels are zero
2025-01-24 14:31:34,311 (model:870) WARNING: All labels are zero
2025-01-24 14:31:44,944 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 5114,  validation: loss=0.09804, DER=0.2242, ACC=0.9555, MI=0.1, FA=0.08131, CF=0.04291, over 0.00 frames.
2025-01-24 14:31:44,944 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 14:31:51,456 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 5114,  validation: loss=0.09772, DER=0.2262, ACC=0.9557, MI=0.09874, FA=0.08207, CF=0.0454, over 0.00 frames.
2025-01-24 14:31:51,456 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 14:49:13,547 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 5614, num_updates: 5500, {'loss': 0.1333276927471161, 'DER': 0.32125361506226763, 'ACC': np.float64(0.9403660714285714), 'MI': 0.16508292510181197, 'FA': 0.08322020893584371, 'CF': 0.07295048102461194}, batch size: 64, grad_norm: 0.25654906034469604, grad_scale: , lr: 7.99e-05,
2025-01-24 14:49:13,548 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 14:49:13,548 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 5614, num_updates: 5500, {'loss': 0.14623220264911652, 'DER': 0.3363962348722546, 'ACC': np.float64(0.9365), 'MI': 0.16982294935006723, 'FA': 0.10449350067234424, 'CF': 0.06207978484984312}, batch size: 64, grad_norm: 0.25654906034469604, grad_scale: , lr: 7.99e-05,
2025-01-24 14:49:13,548 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 14:50:24,989 (model:870) WARNING: All labels are zero
2025-01-24 14:50:25,830 (model:870) WARNING: All labels are zero
2025-01-24 14:50:25,924 (model:870) WARNING: All labels are zero
2025-01-24 14:52:37,782 (model:870) WARNING: All labels are zero
2025-01-24 14:52:55,269 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 5614,  validation: loss=0.09142, DER=0.2135, ACC=0.9581, MI=0.09506, FA=0.07895, CF=0.03948, over 0.00 frames.
2025-01-24 14:52:55,269 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 14:52:55,343 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 5614,  validation: loss=0.09229, DER=0.2131, ACC=0.9575, MI=0.09626, FA=0.07745, CF=0.03934, over 0.00 frames.
2025-01-24 14:52:55,343 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 15:06:21,943 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-6000.pt
2025-01-24 15:06:22,477 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-24 15:10:27,206 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 6114, num_updates: 6000, {'loss': 0.17031562328338623, 'DER': 0.35523304203079487, 'ACC': np.float64(0.928), 'MI': 0.24412193091968373, 'FA': 0.04686849771119434, 'CF': 0.06424261339991677}, batch size: 64, grad_norm: 0.30718904733657837, grad_scale: , lr: 7.71e-05,
2025-01-24 15:10:27,207 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 6114, num_updates: 6000, {'loss': 0.1299252063035965, 'DER': 0.3078729525039629, 'ACC': np.float64(0.9436071428571429), 'MI': 0.16497387424411436, 'FA': 0.07996242587917572, 'CF': 0.06293665238067281}, batch size: 64, grad_norm: 0.30718904733657837, grad_scale: , lr: 7.71e-05,
2025-01-24 15:10:27,207 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 15:10:27,207 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 15:11:36,892 (model:870) WARNING: All labels are zero
2025-01-24 15:11:37,693 (model:870) WARNING: All labels are zero
2025-01-24 15:11:38,667 (model:870) WARNING: All labels are zero
2025-01-24 15:13:47,367 (model:870) WARNING: All labels are zero
2025-01-24 15:14:01,217 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 6114,  validation: loss=0.09261, DER=0.2134, ACC=0.9576, MI=0.1177, FA=0.05863, CF=0.03707, over 0.00 frames.
2025-01-24 15:14:01,218 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 15:14:04,407 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 6114,  validation: loss=0.09165, DER=0.2152, ACC=0.9581, MI=0.1159, FA=0.06101, CF=0.03831, over 0.00 frames.
2025-01-24 15:14:04,407 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 15:31:30,278 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 6614, num_updates: 6500, {'loss': 0.1326170712709427, 'DER': 0.3119103773584906, 'ACC': np.float64(0.9420803571428571), 'MI': 0.1636202830188679, 'FA': 0.0777122641509434, 'CF': 0.07057783018867925}, batch size: 64, grad_norm: 0.22577428817749023, grad_scale: , lr: 7.44e-05,
2025-01-24 15:31:30,279 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 6614, num_updates: 6500, {'loss': 0.13507519662380219, 'DER': 0.30692187847763186, 'ACC': np.float64(0.9429821428571429), 'MI': 0.20570888048074784, 'FA': 0.05280436234141999, 'CF': 0.048408635655464057}, batch size: 64, grad_norm: 0.22577428817749023, grad_scale: , lr: 7.44e-05,
2025-01-24 15:31:30,279 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 15:31:30,279 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 15:32:40,080 (model:870) WARNING: All labels are zero
2025-01-24 15:32:40,886 (model:870) WARNING: All labels are zero
2025-01-24 15:32:41,434 (model:870) WARNING: All labels are zero
2025-01-24 15:34:50,853 (model:870) WARNING: All labels are zero
2025-01-24 15:35:06,452 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 6614,  validation: loss=0.09057, DER=0.206, ACC=0.9588, MI=0.1117, FA=0.05935, CF=0.03502, over 0.00 frames.
2025-01-24 15:35:06,452 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 15:35:07,980 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 6614,  validation: loss=0.08875, DER=0.2068, ACC=0.9594, MI=0.1094, FA=0.06166, CF=0.03573, over 0.00 frames.
2025-01-24 15:35:07,981 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 15:52:35,845 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 7114, num_updates: 7000, {'loss': 0.15575726330280304, 'DER': 0.3646664354260608, 'ACC': np.float64(0.9295982142857143), 'MI': 0.21089143253555323, 'FA': 0.06260839403399236, 'CF': 0.0911666088565152}, batch size: 64, grad_norm: 0.2653684616088867, grad_scale: , lr: 7.16e-05,
2025-01-24 15:52:35,845 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 15:52:35,845 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 7114, num_updates: 7000, {'loss': 0.13230492174625397, 'DER': 0.3013399813025865, 'ACC': np.float64(0.9442053571428571), 'MI': 0.14029292614521657, 'FA': 0.07291991274540355, 'CF': 0.08812714241196634}, batch size: 64, grad_norm: 0.2653684616088867, grad_scale: , lr: 7.16e-05,
2025-01-24 15:52:35,845 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 15:53:47,170 (model:870) WARNING: All labels are zero
2025-01-24 15:53:47,365 (model:870) WARNING: All labels are zero
2025-01-24 15:53:48,198 (model:870) WARNING: All labels are zero
2025-01-24 15:55:56,484 (model:870) WARNING: All labels are zero
2025-01-24 15:56:13,600 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 7114,  validation: loss=0.09029, DER=0.2103, ACC=0.9589, MI=0.1353, FA=0.04008, CF=0.03488, over 0.00 frames.
2025-01-24 15:56:13,601 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 15:56:16,258 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 7114,  validation: loss=0.09128, DER=0.2115, ACC=0.9582, MI=0.1354, FA=0.04038, CF=0.0357, over 0.00 frames.
2025-01-24 15:56:16,258 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 16:09:52,712 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-7500.pt
2025-01-24 16:09:53,502 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-24 16:13:52,678 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 7614, num_updates: 7500, {'loss': 0.12409613281488419, 'DER': 0.31236947311892116, 'ACC': np.float64(0.9418698748381528), 'MI': 0.1691031684468047, 'FA': 0.06987290411122382, 'CF': 0.07339340056089265}, batch size: 64, grad_norm: 0.21893292665481567, grad_scale: , lr: 6.88e-05,
2025-01-24 16:13:52,678 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 7614, num_updates: 7500, {'loss': 0.1335681676864624, 'DER': 0.2861398381294964, 'ACC': np.float64(0.9433622851328269), 'MI': 0.1591726618705036, 'FA': 0.06272482014388489, 'CF': 0.06424235611510791}, batch size: 64, grad_norm: 0.21893292665481567, grad_scale: , lr: 6.88e-05,
2025-01-24 16:13:52,678 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 16:13:52,678 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 16:15:02,057 (model:870) WARNING: All labels are zero
2025-01-24 16:15:02,863 (model:870) WARNING: All labels are zero
2025-01-24 16:15:04,645 (model:870) WARNING: All labels are zero
2025-01-24 16:17:15,160 (model:870) WARNING: All labels are zero
2025-01-24 16:17:26,978 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 7614,  validation: loss=0.08674, DER=0.2, ACC=0.96, MI=0.1213, FA=0.04409, CF=0.03467, over 0.00 frames.
2025-01-24 16:17:26,978 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 16:17:32,463 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 7614,  validation: loss=0.08592, DER=0.2004, ACC=0.9606, MI=0.1205, FA=0.04532, CF=0.03459, over 0.00 frames.
2025-01-24 16:17:32,464 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 16:35:00,408 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 8114, num_updates: 8000, {'loss': 0.13796916604042053, 'DER': 0.3317355468521658, 'ACC': np.float64(0.9367053571428571), 'MI': 0.16560472321271993, 'FA': 0.08347460104050973, 'CF': 0.08265622259893611}, batch size: 64, grad_norm: 0.21616312861442566, grad_scale: , lr: 6.60e-05,
2025-01-24 16:35:00,408 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 16:35:00,410 (train_accelerate_ddp:702) INFO: [Train] - Epoch 2, batch_idx_train: 8114, num_updates: 8000, {'loss': 0.12639717757701874, 'DER': 0.28298458149779737, 'ACC': np.float64(0.9451964285714286), 'MI': 0.15743392070484583, 'FA': 0.07053964757709251, 'CF': 0.05501101321585903}, batch size: 64, grad_norm: 0.21616312861442566, grad_scale: , lr: 6.60e-05,
2025-01-24 16:35:00,410 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 16:36:09,661 (model:870) WARNING: All labels are zero
2025-01-24 16:36:10,466 (model:870) WARNING: All labels are zero
2025-01-24 16:36:12,137 (model:870) WARNING: All labels are zero
2025-01-24 16:38:22,049 (model:870) WARNING: All labels are zero
2025-01-24 16:38:34,264 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 8114,  validation: loss=0.08765, DER=0.2009, ACC=0.9597, MI=0.1132, FA=0.05537, CF=0.03232, over 0.00 frames.
2025-01-24 16:38:34,265 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 16:38:39,290 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 2, batch_idx_train: 8114,  validation: loss=0.08644, DER=0.2014, ACC=0.9602, MI=0.111, FA=0.05765, CF=0.03276, over 0.00 frames.
2025-01-24 16:38:39,290 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 16:42:36,974 (train_accelerate_ddp:713) INFO: end of epoch 2, batch_idx: 4113 batch_idx_train: 8227, {'loss': 0.12211766839027405, 'DER': 0.2961860038941702, 'ACC': np.float64(0.9458047312757869), 'MI': 0.16916733478410262, 'FA': 0.07868514488603826, 'CF': 0.04833352422402932}, batch size: 64, grad_norm: 0.20034129917621613, grad_scale: , lr: 6.54e-05,
2025-01-24 16:42:36,975 (train_accelerate_ddp:713) INFO: end of epoch 2, batch_idx: 4113 batch_idx_train: 8227, {'loss': 0.10988304764032364, 'DER': 0.24389950715230196, 'ACC': np.float64(0.9572053571428571), 'MI': 0.1285611251352326, 'FA': 0.07116239932684217, 'CF': 0.04417598269022719}, batch size: 64, grad_norm: 0.20034129917621613, grad_scale: , lr: 6.54e-05,
2025-01-24 16:42:36,976 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-2.pt
2025-01-24 16:42:37,410 (train_accelerate_ddp:561) INFO:  end of epoch 2, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-2.pt
2025-01-24 16:42:41,475 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 8228, num_updates: 8000, {'loss': 0.13642694056034088, 'DER': 0.31843856607572285, 'ACC': np.float64(0.9388839285714285), 'MI': 0.1733124545607069, 'FA': 0.08075610983725742, 'CF': 0.06437000167775851}, batch size: 64, grad_norm: 0.21387359499931335, grad_scale: , lr: 6.54e-05,
2025-01-24 16:42:41,477 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 8228, num_updates: 8000, {'loss': 0.133866086602211, 'DER': 0.29197660553063426, 'ACC': np.float64(0.9464285714285714), 'MI': 0.1830106183635228, 'FA': 0.06024643688603713, 'CF': 0.04871955028107433}, batch size: 64, grad_norm: 0.21387359499931335, grad_scale: , lr: 6.54e-05,
2025-01-24 17:00:05,229 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 8728, num_updates: 8500, {'loss': 0.10339395701885223, 'DER': 0.24565574234448406, 'ACC': np.float64(0.9565714285714285), 'MI': 0.15044999150959415, 'FA': 0.06554593309560197, 'CF': 0.029659817739287938}, batch size: 64, grad_norm: 0.17878739535808563, grad_scale: , lr: 6.26e-05,
2025-01-24 17:00:05,230 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 8728, num_updates: 8500, {'loss': 0.11644206941127777, 'DER': 0.2849716163728712, 'ACC': np.float64(0.9467067480258435), 'MI': 0.14299372572452942, 'FA': 0.07206453540484016, 'CF': 0.06991335524350165}, batch size: 64, grad_norm: 0.17878739535808563, grad_scale: , lr: 6.26e-05,
2025-01-24 17:00:05,230 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 17:00:05,230 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 17:01:16,974 (model:870) WARNING: All labels are zero
2025-01-24 17:01:17,399 (model:870) WARNING: All labels are zero
2025-01-24 17:01:17,819 (model:870) WARNING: All labels are zero
2025-01-24 17:03:27,114 (model:870) WARNING: All labels are zero
2025-01-24 17:03:44,319 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 8728,  validation: loss=0.08517, DER=0.1965, ACC=0.9611, MI=0.1075, FA=0.05443, CF=0.03458, over 0.00 frames.
2025-01-24 17:03:44,321 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 17:03:45,274 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 8728,  validation: loss=0.08698, DER=0.195, ACC=0.9604, MI=0.1081, FA=0.05177, CF=0.03508, over 0.00 frames.
2025-01-24 17:03:45,274 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 17:13:16,505 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-9000.pt
2025-01-24 17:13:17,764 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-24 17:13:17,799 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-01-24 17:21:14,162 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 9228, num_updates: 9000, {'loss': 0.11005456000566483, 'DER': 0.25424334464891907, 'ACC': np.float64(0.9551739898016793), 'MI': 0.12679411589542017, 'FA': 0.08379489011970699, 'CF': 0.043654338633791916}, batch size: 64, grad_norm: 0.23458637297153473, grad_scale: , lr: 5.98e-05,
2025-01-24 17:21:14,162 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 17:21:14,164 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 9228, num_updates: 9000, {'loss': 0.14831365644931793, 'DER': 0.3053615447822514, 'ACC': np.float64(0.9353839285714286), 'MI': 0.2043960558751027, 'FA': 0.03466516023007395, 'CF': 0.06630032867707478}, batch size: 64, grad_norm: 0.23458637297153473, grad_scale: , lr: 5.98e-05,
2025-01-24 17:21:14,164 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 17:22:22,549 (model:870) WARNING: All labels are zero
2025-01-24 17:22:23,334 (model:870) WARNING: All labels are zero
2025-01-24 17:22:24,140 (model:870) WARNING: All labels are zero
2025-01-24 17:24:31,075 (model:870) WARNING: All labels are zero
2025-01-24 17:24:45,516 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 9228,  validation: loss=0.08162, DER=0.1895, ACC=0.9622, MI=0.1001, FA=0.05891, CF=0.03051, over 0.00 frames.
2025-01-24 17:24:45,517 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 17:24:47,859 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 9228,  validation: loss=0.08011, DER=0.1858, ACC=0.9629, MI=0.09843, FA=0.05755, CF=0.02979, over 0.00 frames.
2025-01-24 17:24:47,859 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 17:42:05,586 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 9728, num_updates: 9500, {'loss': 0.12360547482967377, 'DER': 0.2807037986483337, 'ACC': np.float64(0.9434464285714286), 'MI': 0.12794220461430902, 'FA': 0.06443719412724307, 'CF': 0.08832439990678163}, batch size: 64, grad_norm: 0.26076164841651917, grad_scale: , lr: 5.71e-05,
2025-01-24 17:42:05,587 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 9728, num_updates: 9500, {'loss': 0.11428947001695633, 'DER': 0.281999386691199, 'ACC': np.float64(0.9520625), 'MI': 0.1378718184605949, 'FA': 0.09684145967494634, 'CF': 0.04728610855565778}, batch size: 64, grad_norm: 0.26076164841651917, grad_scale: , lr: 5.71e-05,
2025-01-24 17:42:05,588 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 17:42:05,588 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 17:43:14,350 (model:870) WARNING: All labels are zero
2025-01-24 17:43:15,143 (model:870) WARNING: All labels are zero
2025-01-24 17:43:17,052 (model:870) WARNING: All labels are zero
2025-01-24 17:45:26,597 (model:870) WARNING: All labels are zero
2025-01-24 17:45:37,424 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 9728,  validation: loss=0.0811, DER=0.1864, ACC=0.9625, MI=0.1117, FA=0.04622, CF=0.02847, over 0.00 frames.
2025-01-24 17:45:37,424 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 17:45:43,682 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 9728,  validation: loss=0.07978, DER=0.1858, ACC=0.9631, MI=0.1098, FA=0.04751, CF=0.02847, over 0.00 frames.
2025-01-24 17:45:43,682 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 18:03:04,757 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 10228, num_updates: 10000, {'loss': 0.11623815447092056, 'DER': 0.27297437973512234, 'ACC': np.float64(0.9525267857142856), 'MI': 0.14863223642357296, 'FA': 0.08981551095945868, 'CF': 0.034526632352090685}, batch size: 64, grad_norm: 0.17336982488632202, grad_scale: , lr: 5.43e-05,
2025-01-24 18:03:04,758 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 18:03:04,759 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 10228, num_updates: 10000, {'loss': 0.12248788774013519, 'DER': 0.2943567115652578, 'ACC': np.float64(0.9471785714285714), 'MI': 0.19078030654900138, 'FA': 0.05445889456572225, 'CF': 0.04911751045053414}, batch size: 64, grad_norm: 0.17336982488632202, grad_scale: , lr: 5.43e-05,
2025-01-24 18:03:04,759 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 18:04:13,440 (model:870) WARNING: All labels are zero
2025-01-24 18:04:14,236 (model:870) WARNING: All labels are zero
2025-01-24 18:04:16,259 (model:870) WARNING: All labels are zero
2025-01-24 18:06:25,359 (model:870) WARNING: All labels are zero
2025-01-24 18:06:36,517 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 10228,  validation: loss=0.08253, DER=0.19, ACC=0.9617, MI=0.1008, FA=0.05827, CF=0.03089, over 0.00 frames.
2025-01-24 18:06:36,517 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 18:06:42,464 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 10228,  validation: loss=0.08104, DER=0.189, ACC=0.9625, MI=0.0986, FA=0.06013, CF=0.03028, over 0.00 frames.
2025-01-24 18:06:42,464 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 18:16:04,371 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-10500.pt
2025-01-24 18:16:04,934 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-24 18:24:04,894 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 10728, num_updates: 10500, {'loss': 0.11763068288564682, 'DER': 0.25511555127587865, 'ACC': np.float64(0.9541701332045123), 'MI': 0.14901299951853636, 'FA': 0.05290081848820414, 'CF': 0.05320173326913818}, batch size: 64, grad_norm: 0.23158049583435059, grad_scale: , lr: 5.15e-05,
2025-01-24 18:24:04,895 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 18:24:04,896 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 10728, num_updates: 10500, {'loss': 0.12292614579200745, 'DER': 0.28680894539675333, 'ACC': np.float64(0.9451428571428571), 'MI': 0.16528550346236803, 'FA': 0.05959813826768078, 'CF': 0.061925303666704505}, batch size: 64, grad_norm: 0.23158049583435059, grad_scale: , lr: 5.15e-05,
2025-01-24 18:24:04,897 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 18:25:16,260 (model:870) WARNING: All labels are zero
2025-01-24 18:25:17,106 (model:870) WARNING: All labels are zero
2025-01-24 18:25:17,150 (model:870) WARNING: All labels are zero
2025-01-24 18:27:28,040 (model:870) WARNING: All labels are zero
2025-01-24 18:27:45,402 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 10728,  validation: loss=0.07885, DER=0.1839, ACC=0.9635, MI=0.09924, FA=0.05621, CF=0.02841, over 0.00 frames.
2025-01-24 18:27:45,403 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 18:27:45,840 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 10728,  validation: loss=0.08045, DER=0.1857, ACC=0.9625, MI=0.09995, FA=0.05639, CF=0.02932, over 0.00 frames.
2025-01-24 18:27:45,840 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 18:45:12,775 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 11228, num_updates: 11000, {'loss': 0.11060254275798798, 'DER': 0.23043175860039591, 'ACC': np.float64(0.9560446428571429), 'MI': 0.15991653737092718, 'FA': 0.03755818308276711, 'CF': 0.032957038146701624}, batch size: 64, grad_norm: 0.17868779599666595, grad_scale: , lr: 4.87e-05,
2025-01-24 18:45:12,775 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 18:45:12,777 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 11228, num_updates: 11000, {'loss': 0.10983008146286011, 'DER': 0.24275569808727523, 'ACC': np.float64(0.9541696428571429), 'MI': 0.13870117970450122, 'FA': 0.05285763371893254, 'CF': 0.05119688466384149}, batch size: 64, grad_norm: 0.17868779599666595, grad_scale: , lr: 4.87e-05,
2025-01-24 18:45:12,777 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 18:46:22,499 (model:870) WARNING: All labels are zero
2025-01-24 18:46:23,304 (model:870) WARNING: All labels are zero
2025-01-24 18:46:25,853 (model:870) WARNING: All labels are zero
2025-01-24 18:48:36,650 (model:870) WARNING: All labels are zero
2025-01-24 18:48:46,553 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 11228,  validation: loss=0.08276, DER=0.1915, ACC=0.9616, MI=0.1181, FA=0.04297, CF=0.03039, over 0.00 frames.
2025-01-24 18:48:46,553 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 18:48:53,971 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 11228,  validation: loss=0.08119, DER=0.1925, ACC=0.9624, MI=0.1182, FA=0.04497, CF=0.02935, over 0.00 frames.
2025-01-24 18:48:53,972 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 19:06:20,063 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 11728, num_updates: 11500, {'loss': 0.10300644487142563, 'DER': 0.25875726104559055, 'ACC': np.float64(0.9518793198222959), 'MI': 0.12574077333802736, 'FA': 0.07844862993604412, 'CF': 0.054567857771519096}, batch size: 64, grad_norm: 0.22160451114177704, grad_scale: , lr: 4.60e-05,
2025-01-24 19:06:20,063 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 11728, num_updates: 11500, {'loss': 0.1268756240606308, 'DER': 0.30711061609707485, 'ACC': np.float64(0.9432589285714286), 'MI': 0.17240166481036404, 'FA': 0.06928893839029251, 'CF': 0.06542001289641831}, batch size: 64, grad_norm: 0.22160451114177704, grad_scale: , lr: 4.60e-05,
2025-01-24 19:06:20,063 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 19:06:20,063 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 19:07:31,328 (model:870) WARNING: All labels are zero
2025-01-24 19:07:32,149 (model:870) WARNING: All labels are zero
2025-01-24 19:07:32,157 (model:870) WARNING: All labels are zero
2025-01-24 19:09:43,181 (model:870) WARNING: All labels are zero
2025-01-24 19:10:00,592 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 11728,  validation: loss=0.07959, DER=0.1844, ACC=0.9631, MI=0.09244, FA=0.06171, CF=0.03027, over 0.00 frames.
2025-01-24 19:10:00,593 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 19:10:00,884 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 11728,  validation: loss=0.08087, DER=0.187, ACC=0.9622, MI=0.09423, FA=0.06175, CF=0.03106, over 0.00 frames.
2025-01-24 19:10:00,885 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 19:19:27,695 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-12000.pt
2025-01-24 19:19:28,330 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-24 19:27:29,965 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 12228, num_updates: 12000, {'loss': 0.10183612257242203, 'DER': 0.24371889073240105, 'ACC': np.float64(0.9556160714285714), 'MI': 0.12052619104053093, 'FA': 0.07235126807300309, 'CF': 0.05084143161886703}, batch size: 64, grad_norm: 0.16770003736019135, grad_scale: , lr: 4.32e-05,
2025-01-24 19:27:29,966 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 19:27:29,968 (train_accelerate_ddp:702) INFO: [Train] - Epoch 3, batch_idx_train: 12228, num_updates: 12000, {'loss': 0.09746336936950684, 'DER': 0.22783264898457442, 'ACC': np.float64(0.9586785714285715), 'MI': 0.14987237820441682, 'FA': 0.048995671956497615, 'CF': 0.02896459882365997}, batch size: 64, grad_norm: 0.16770003736019135, grad_scale: , lr: 4.32e-05,
2025-01-24 19:27:29,968 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 19:28:40,417 (model:870) WARNING: All labels are zero
2025-01-24 19:28:41,234 (model:870) WARNING: All labels are zero
2025-01-24 19:28:42,375 (model:870) WARNING: All labels are zero
2025-01-24 19:30:53,895 (model:870) WARNING: All labels are zero
2025-01-24 19:31:07,610 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 12228,  validation: loss=0.07982, DER=0.1855, ACC=0.9629, MI=0.1037, FA=0.05306, CF=0.02873, over 0.00 frames.
2025-01-24 19:31:07,611 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 19:31:11,267 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 3, batch_idx_train: 12228,  validation: loss=0.0782, DER=0.1827, ACC=0.9638, MI=0.1024, FA=0.05278, CF=0.02752, over 0.00 frames.
2025-01-24 19:31:11,268 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 19:35:07,669 (train_accelerate_ddp:713) INFO: end of epoch 3, batch_idx: 4113 batch_idx_train: 12341, {'loss': 0.10246174782514572, 'DER': 0.21743780254418552, 'ACC': np.float64(0.9604196428571429), 'MI': 0.12687155240346729, 'FA': 0.05848249465270742, 'CF': 0.032083755488010804}, batch size: 64, grad_norm: 0.1677158921957016, grad_scale: , lr: 4.25e-05,
2025-01-24 19:35:07,670 (train_accelerate_ddp:713) INFO: end of epoch 3, batch_idx: 4113 batch_idx_train: 12341, {'loss': 0.12491784989833832, 'DER': 0.2792729626233752, 'ACC': np.float64(0.9439375), 'MI': 0.16530931449220646, 'FA': 0.0545817377703468, 'CF': 0.05938191036082196}, batch size: 64, grad_norm: 0.1677158921957016, grad_scale: , lr: 4.25e-05,
2025-01-24 19:35:07,672 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-3.pt
2025-01-24 19:35:08,127 (train_accelerate_ddp:561) INFO:  end of epoch 3, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-3.pt
2025-01-24 19:35:12,568 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 12342, num_updates: 12000, {'loss': 0.10210105776786804, 'DER': 0.2320556709130703, 'ACC': np.float64(0.9583035714285715), 'MI': 0.1364835288175543, 'FA': 0.06554801055053594, 'CF': 0.030024131544980077}, batch size: 64, grad_norm: 0.20999623835086823, grad_scale: , lr: 4.25e-05,
2025-01-24 19:35:12,569 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 12342, num_updates: 12000, {'loss': 0.12754064798355103, 'DER': 0.2878964480706705, 'ACC': np.float64(0.9462946428571429), 'MI': 0.11790687687871909, 'FA': 0.08889025213177106, 'CF': 0.08109931906018036}, batch size: 64, grad_norm: 0.20999623835086823, grad_scale: , lr: 4.25e-05,
2025-01-24 19:52:42,138 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 12842, num_updates: 12500, {'loss': 0.11786814779043198, 'DER': 0.28142698662929877, 'ACC': np.float64(0.9487946428571429), 'MI': 0.15624452618672272, 'FA': 0.07175804285630875, 'CF': 0.0534244175862673}, batch size: 64, grad_norm: 0.19095227122306824, grad_scale: , lr: 3.98e-05,
2025-01-24 19:52:42,138 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 19:52:42,138 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 12842, num_updates: 12500, {'loss': 0.12421438843011856, 'DER': 0.30255931458699475, 'ACC': np.float64(0.9404262925063676), 'MI': 0.17168277680140598, 'FA': 0.06733304042179263, 'CF': 0.06354349736379614}, batch size: 64, grad_norm: 0.19095227122306824, grad_scale: , lr: 3.98e-05,
2025-01-24 19:52:42,139 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 19:53:50,434 (model:870) WARNING: All labels are zero
2025-01-24 19:53:51,221 (model:870) WARNING: All labels are zero
2025-01-24 19:53:51,818 (model:870) WARNING: All labels are zero
2025-01-24 19:55:58,193 (model:870) WARNING: All labels are zero
2025-01-24 19:56:13,536 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 12842,  validation: loss=0.07885, DER=0.1816, ACC=0.9634, MI=0.1086, FA=0.04538, CF=0.02768, over 0.00 frames.
2025-01-24 19:56:13,537 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 19:56:15,029 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 12842,  validation: loss=0.07722, DER=0.1799, ACC=0.9641, MI=0.1068, FA=0.0462, CF=0.02688, over 0.00 frames.
2025-01-24 19:56:15,029 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 20:13:45,029 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 13342, num_updates: 13000, {'loss': 0.10116010904312134, 'DER': 0.23201656028980508, 'ACC': np.float64(0.9579464285714285), 'MI': 0.12391466850669887, 'FA': 0.06928871255246967, 'CF': 0.038813179230636534}, batch size: 64, grad_norm: 0.15841567516326904, grad_scale: , lr: 3.70e-05,
2025-01-24 20:13:45,030 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 20:13:45,032 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 13342, num_updates: 13000, {'loss': 0.11715847253799438, 'DER': 0.2818293467454237, 'ACC': np.float64(0.9497164461247637), 'MI': 0.1553892040470203, 'FA': 0.0815837183461021, 'CF': 0.044856424352301305}, batch size: 64, grad_norm: 0.15841567516326904, grad_scale: , lr: 3.70e-05,
2025-01-24 20:13:45,032 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 20:14:54,097 (model:870) WARNING: All labels are zero
2025-01-24 20:14:54,897 (model:870) WARNING: All labels are zero
2025-01-24 20:14:56,262 (model:870) WARNING: All labels are zero
2025-01-24 20:17:05,938 (model:870) WARNING: All labels are zero
2025-01-24 20:17:19,536 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 13342,  validation: loss=0.07839, DER=0.183, ACC=0.9634, MI=0.1114, FA=0.04433, CF=0.02731, over 0.00 frames.
2025-01-24 20:17:19,536 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 20:17:23,056 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 13342,  validation: loss=0.07712, DER=0.1826, ACC=0.9641, MI=0.1114, FA=0.0446, CF=0.0266, over 0.00 frames.
2025-01-24 20:17:23,056 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 20:22:59,831 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-13500.pt
2025-01-24 20:23:01,229 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-24 20:23:01,264 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-01-24 20:34:59,633 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 13842, num_updates: 13500, {'loss': 0.13014653325080872, 'DER': 0.30253000507127964, 'ACC': np.float64(0.9430625), 'MI': 0.18386206119344115, 'FA': 0.061869611765368794, 'CF': 0.056798332112469714}, batch size: 64, grad_norm: 0.20783518254756927, grad_scale: , lr: 3.42e-05,
2025-01-24 20:34:59,634 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 13842, num_updates: 13500, {'loss': 0.11555103212594986, 'DER': 0.26041289387902933, 'ACC': np.float64(0.9526328574127554), 'MI': 0.11746951587589038, 'FA': 0.08553664131353374, 'CF': 0.05740673668960521}, batch size: 64, grad_norm: 0.20783518254756927, grad_scale: , lr: 3.42e-05,
2025-01-24 20:34:59,634 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 20:34:59,634 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 20:36:09,792 (model:870) WARNING: All labels are zero
2025-01-24 20:36:10,643 (model:870) WARNING: All labels are zero
2025-01-24 20:36:10,985 (model:870) WARNING: All labels are zero
2025-01-24 20:38:20,492 (model:870) WARNING: All labels are zero
2025-01-24 20:38:36,058 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 13842,  validation: loss=0.07807, DER=0.1804, ACC=0.9635, MI=0.1046, FA=0.04863, CF=0.02714, over 0.00 frames.
2025-01-24 20:38:36,059 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 20:38:37,560 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 13842,  validation: loss=0.07693, DER=0.1818, ACC=0.9641, MI=0.1048, FA=0.05021, CF=0.02675, over 0.00 frames.
2025-01-24 20:38:37,561 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 20:56:37,752 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 14342, num_updates: 14000, {'loss': 0.10910395532846451, 'DER': 0.244071651976116, 'ACC': np.float64(0.9520803571428571), 'MI': 0.1203866932044356, 'FA': 0.06255331248222917, 'CF': 0.06113164628945124}, batch size: 64, grad_norm: 0.2135717272758484, grad_scale: , lr: 3.14e-05,
2025-01-24 20:56:37,752 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 20:56:37,753 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 14342, num_updates: 14000, {'loss': 0.1042170450091362, 'DER': 0.2490964535803027, 'ACC': np.float64(0.9549464285714285), 'MI': 0.1368308109329117, 'FA': 0.07640614411565394, 'CF': 0.03585949853173707}, batch size: 64, grad_norm: 0.2135717272758484, grad_scale: , lr: 3.14e-05,
2025-01-24 20:56:37,753 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 20:57:49,339 (model:870) WARNING: All labels are zero
2025-01-24 20:57:50,221 (model:870) WARNING: All labels are zero
2025-01-24 20:57:51,532 (model:870) WARNING: All labels are zero
2025-01-24 21:00:04,469 (model:870) WARNING: All labels are zero
2025-01-24 21:00:17,012 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 14342,  validation: loss=0.07618, DER=0.1766, ACC=0.9645, MI=0.1076, FA=0.04391, CF=0.02507, over 0.00 frames.
2025-01-24 21:00:17,013 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 21:00:21,907 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 14342,  validation: loss=0.07497, DER=0.1765, ACC=0.965, MI=0.1069, FA=0.04505, CF=0.02456, over 0.00 frames.
2025-01-24 21:00:21,908 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 21:18:05,121 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 14842, num_updates: 14500, {'loss': 0.10210521519184113, 'DER': 0.23834136709448864, 'ACC': np.float64(0.9569940006315125), 'MI': 0.14036819792090133, 'FA': 0.05946919100993089, 'CF': 0.03850397816365642}, batch size: 64, grad_norm: 0.16457369923591614, grad_scale: , lr: 2.86e-05,
2025-01-24 21:18:05,121 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 14842, num_updates: 14500, {'loss': 0.11235406994819641, 'DER': 0.2656047728935667, 'ACC': np.float64(0.9495089285714285), 'MI': 0.1598469071874824, 'FA': 0.05307592728091405, 'CF': 0.05268193842517026}, batch size: 64, grad_norm: 0.16457369923591614, grad_scale: , lr: 2.86e-05,
2025-01-24 21:18:05,121 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 21:18:05,121 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 21:19:16,544 (model:870) WARNING: All labels are zero
2025-01-24 21:19:17,369 (model:870) WARNING: All labels are zero
2025-01-24 21:19:19,489 (model:870) WARNING: All labels are zero
2025-01-24 21:21:31,623 (model:870) WARNING: All labels are zero
2025-01-24 21:21:42,528 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 14842,  validation: loss=0.07814, DER=0.1802, ACC=0.9637, MI=0.1101, FA=0.0439, CF=0.0262, over 0.00 frames.
2025-01-24 21:21:42,528 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 21:21:49,092 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 14842,  validation: loss=0.07653, DER=0.1807, ACC=0.9643, MI=0.1093, FA=0.04577, CF=0.02563, over 0.00 frames.
2025-01-24 21:21:49,093 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 21:27:27,630 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-15000.pt
2025-01-24 21:27:28,923 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-24 21:39:35,757 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 15342, num_updates: 15000, {'loss': 0.09405524283647537, 'DER': 0.20860648848545973, 'ACC': np.float64(0.9615803571428571), 'MI': 0.13217907771614276, 'FA': 0.043928951644534094, 'CF': 0.03249845912478288}, batch size: 64, grad_norm: 0.14748996496200562, grad_scale: , lr: 2.59e-05,
2025-01-24 21:39:35,758 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 15342, num_updates: 15000, {'loss': 0.10306601971387863, 'DER': 0.2359654712936678, 'ACC': np.float64(0.9586696976748349), 'MI': 0.15126585945194368, 'FA': 0.05312554313191588, 'CF': 0.03157406870980824}, batch size: 64, grad_norm: 0.14748996496200562, grad_scale: , lr: 2.59e-05,
2025-01-24 21:39:35,758 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 21:39:35,758 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 21:40:46,883 (model:870) WARNING: All labels are zero
2025-01-24 21:40:47,712 (model:870) WARNING: All labels are zero
2025-01-24 21:40:49,768 (model:870) WARNING: All labels are zero
2025-01-24 21:43:01,862 (model:870) WARNING: All labels are zero
2025-01-24 21:43:12,980 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 15342,  validation: loss=0.07701, DER=0.1778, ACC=0.9642, MI=0.1092, FA=0.04378, CF=0.02482, over 0.00 frames.
2025-01-24 21:43:12,980 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 21:43:19,426 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 15342,  validation: loss=0.07537, DER=0.1777, ACC=0.9649, MI=0.1085, FA=0.04504, CF=0.02416, over 0.00 frames.
2025-01-24 21:43:19,426 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 22:00:54,812 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 15842, num_updates: 15500, {'loss': 0.11532630771398544, 'DER': 0.2750945501891004, 'ACC': np.float64(0.9511071428571429), 'MI': 0.1409262818525637, 'FA': 0.069750139500279, 'CF': 0.06441812883625768}, batch size: 64, grad_norm: 0.21327845752239227, grad_scale: , lr: 2.31e-05,
2025-01-24 22:00:54,812 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 15842, num_updates: 15500, {'loss': 0.11871087551116943, 'DER': 0.2775384257102934, 'ACC': np.float64(0.9481517857142857), 'MI': 0.12756171401956218, 'FA': 0.08942710759198882, 'CF': 0.06054960409874243}, batch size: 64, grad_norm: 0.21327845752239227, grad_scale: , lr: 2.31e-05,
2025-01-24 22:00:54,812 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 22:00:54,812 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 22:02:07,138 (model:870) WARNING: All labels are zero
2025-01-24 22:02:07,977 (model:870) WARNING: All labels are zero
2025-01-24 22:02:08,581 (model:870) WARNING: All labels are zero
2025-01-24 22:04:21,548 (model:870) WARNING: All labels are zero
2025-01-24 22:04:36,738 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 15842,  validation: loss=0.07707, DER=0.1774, ACC=0.9641, MI=0.101, FA=0.05012, CF=0.02621, over 0.00 frames.
2025-01-24 22:04:36,739 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 22:04:39,112 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 15842,  validation: loss=0.07575, DER=0.1768, ACC=0.9646, MI=0.1, FA=0.05095, CF=0.02585, over 0.00 frames.
2025-01-24 22:04:39,113 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 22:22:17,064 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 16342, num_updates: 16000, {'loss': 0.08827894181013107, 'DER': 0.20759675107501194, 'ACC': np.float64(0.9639821428571429), 'MI': 0.11675824175824176, 'FA': 0.05751313903487817, 'CF': 0.033325370281892024}, batch size: 64, grad_norm: 0.1780458241701126, grad_scale: , lr: 2.03e-05,
2025-01-24 22:22:17,064 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 22:22:17,068 (train_accelerate_ddp:702) INFO: [Train] - Epoch 4, batch_idx_train: 16342, num_updates: 16000, {'loss': 0.12311051040887833, 'DER': 0.26503932736642255, 'ACC': np.float64(0.9469196428571429), 'MI': 0.14640629237862762, 'FA': 0.061187957689178195, 'CF': 0.05744507729861676}, batch size: 64, grad_norm: 0.1780458241701126, grad_scale: , lr: 2.03e-05,
2025-01-24 22:22:17,068 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 22:23:28,614 (model:870) WARNING: All labels are zero
2025-01-24 22:23:29,386 (model:870) WARNING: All labels are zero
2025-01-24 22:23:29,439 (model:870) WARNING: All labels are zero
2025-01-24 22:25:38,191 (model:870) WARNING: All labels are zero
2025-01-24 22:25:53,915 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 16342,  validation: loss=0.0766, DER=0.1783, ACC=0.9642, MI=0.1081, FA=0.04556, CF=0.02461, over 0.00 frames.
2025-01-24 22:25:53,916 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 22:25:55,308 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 4, batch_idx_train: 16342,  validation: loss=0.07523, DER=0.1778, ACC=0.9648, MI=0.1075, FA=0.04627, CF=0.02407, over 0.00 frames.
2025-01-24 22:25:55,308 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 22:29:52,223 (train_accelerate_ddp:713) INFO: end of epoch 4, batch_idx: 4113 batch_idx_train: 16455, {'loss': 0.10634244233369827, 'DER': 0.26392732523162077, 'ACC': np.float64(0.9517767857142857), 'MI': 0.12718084466369872, 'FA': 0.07574299121646011, 'CF': 0.061003489351461916}, batch size: 64, grad_norm: 0.15462183952331543, grad_scale: , lr: 1.97e-05,
2025-01-24 22:29:52,223 (train_accelerate_ddp:713) INFO: end of epoch 4, batch_idx: 4113 batch_idx_train: 16455, {'loss': 0.10997740924358368, 'DER': 0.25875509016870274, 'ACC': np.float64(0.954375), 'MI': 0.1489237929028505, 'FA': 0.07132053519488074, 'CF': 0.038510762070971497}, batch size: 64, grad_norm: 0.15462183952331543, grad_scale: , lr: 1.97e-05,
2025-01-24 22:29:52,226 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-4.pt
2025-01-24 22:29:52,741 (train_accelerate_ddp:561) INFO:  end of epoch 4, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-4.pt
2025-01-24 22:29:56,495 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 16456, num_updates: 16000, {'loss': 0.12837927043437958, 'DER': 0.3136101499423299, 'ACC': np.float64(0.9376785714285715), 'MI': 0.14728950403690888, 'FA': 0.07739331026528258, 'CF': 0.08892733564013841}, batch size: 64, grad_norm: 0.23125946521759033, grad_scale: , lr: 1.97e-05,
2025-01-24 22:29:56,496 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 16456, num_updates: 16000, {'loss': 0.106119804084301, 'DER': 0.2548950014788524, 'ACC': np.float64(0.9517321428571429), 'MI': 0.1199645075421473, 'FA': 0.07003845016267377, 'CF': 0.06489204377403135}, batch size: 64, grad_norm: 0.23125946521759033, grad_scale: , lr: 1.97e-05,
2025-01-24 22:31:27,611 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-16500.pt
2025-01-24 22:31:28,225 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-24 22:31:28,261 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-01-24 22:47:36,360 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 16956, num_updates: 16500, {'loss': 0.10658173263072968, 'DER': 0.2448465157965494, 'ACC': np.float64(0.9531006810432466), 'MI': 0.13438270221823886, 'FA': 0.06329822989020838, 'CF': 0.047165583688102176}, batch size: 64, grad_norm: 0.19823673367500305, grad_scale: , lr: 1.69e-05,
2025-01-24 22:47:36,360 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 16956, num_updates: 16500, {'loss': 0.11332108825445175, 'DER': 0.3000557379079705, 'ACC': np.float64(0.9471160714285715), 'MI': 0.1534650399455007, 'FA': 0.07982907041555706, 'CF': 0.06676162754691274}, batch size: 64, grad_norm: 0.19823673367500305, grad_scale: , lr: 1.69e-05,
2025-01-24 22:47:36,360 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 22:47:36,361 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 22:48:47,441 (model:870) WARNING: All labels are zero
2025-01-24 22:48:48,489 (model:870) WARNING: All labels are zero
2025-01-24 22:48:49,607 (model:870) WARNING: All labels are zero
2025-01-24 22:51:00,233 (model:870) WARNING: All labels are zero
2025-01-24 22:51:12,741 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 16956,  validation: loss=0.0761, DER=0.1765, ACC=0.9645, MI=0.1092, FA=0.04241, CF=0.02487, over 0.00 frames.
2025-01-24 22:51:12,742 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 22:51:17,579 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 16956,  validation: loss=0.0746, DER=0.1764, ACC=0.9652, MI=0.1082, FA=0.0442, CF=0.02399, over 0.00 frames.
2025-01-24 22:51:17,579 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 23:08:47,347 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 17456, num_updates: 17000, {'loss': 0.1028151661157608, 'DER': 0.24082608949302842, 'ACC': np.float64(0.9557410714285715), 'MI': 0.134764599498279, 'FA': 0.05769791727437139, 'CF': 0.04836357272037804}, batch size: 64, grad_norm: 0.25226664543151855, grad_scale: , lr: 1.41e-05,
2025-01-24 23:08:47,348 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 23:08:47,349 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 17456, num_updates: 17000, {'loss': 0.1303432434797287, 'DER': 0.29814084507042254, 'ACC': np.float64(0.9431071428571429), 'MI': 0.1664788732394366, 'FA': 0.0708169014084507, 'CF': 0.06084507042253521}, batch size: 64, grad_norm: 0.25226664543151855, grad_scale: , lr: 1.41e-05,
2025-01-24 23:08:47,349 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 23:09:57,777 (model:870) WARNING: All labels are zero
2025-01-24 23:09:58,605 (model:870) WARNING: All labels are zero
2025-01-24 23:09:58,633 (model:870) WARNING: All labels are zero
2025-01-24 23:12:06,177 (model:870) WARNING: All labels are zero
2025-01-24 23:12:22,427 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 17456,  validation: loss=0.07623, DER=0.1768, ACC=0.9643, MI=0.1017, FA=0.04961, CF=0.02548, over 0.00 frames.
2025-01-24 23:12:22,428 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 23:12:23,032 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 17456,  validation: loss=0.07477, DER=0.1763, ACC=0.9651, MI=0.1009, FA=0.05051, CF=0.02487, over 0.00 frames.
2025-01-24 23:12:23,032 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 23:29:57,119 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 17956, num_updates: 17500, {'loss': 0.12448373436927795, 'DER': 0.27426447492409173, 'ACC': np.float64(0.9443571428571429), 'MI': 0.1762642655219349, 'FA': 0.04601612396607685, 'CF': 0.05198408543607999}, batch size: 64, grad_norm: 0.21953518688678741, grad_scale: , lr: 1.14e-05,
2025-01-24 23:29:57,120 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 23:29:57,120 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 17956, num_updates: 17500, {'loss': 0.1270061582326889, 'DER': 0.26674191121143714, 'ACC': np.float64(0.9449107142857144), 'MI': 0.14656562399226056, 'FA': 0.055304740406320545, 'CF': 0.06487154681285606}, batch size: 64, grad_norm: 0.21953518688678741, grad_scale: , lr: 1.14e-05,
2025-01-24 23:29:57,120 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 23:31:06,734 (model:870) WARNING: All labels are zero
2025-01-24 23:31:07,541 (model:870) WARNING: All labels are zero
2025-01-24 23:31:10,016 (model:870) WARNING: All labels are zero
2025-01-24 23:33:19,457 (model:870) WARNING: All labels are zero
2025-01-24 23:33:30,075 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 17956,  validation: loss=0.07659, DER=0.1772, ACC=0.9643, MI=0.1037, FA=0.04798, CF=0.02556, over 0.00 frames.
2025-01-24 23:33:30,075 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 23:33:36,513 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 17956,  validation: loss=0.07493, DER=0.177, ACC=0.965, MI=0.1022, FA=0.04978, CF=0.02502, over 0.00 frames.
2025-01-24 23:33:36,514 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 23:35:05,050 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-18000.pt
2025-01-24 23:35:05,659 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-24 23:50:58,317 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 18456, num_updates: 18000, {'loss': 0.10999956727027893, 'DER': 0.2480764878931885, 'ACC': np.float64(0.9503392857142857), 'MI': 0.13328807422493777, 'FA': 0.048200950441276307, 'CF': 0.06658746322697442}, batch size: 64, grad_norm: 0.21062517166137695, grad_scale: , lr: 8.57e-06,
2025-01-24 23:50:58,318 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 18456, num_updates: 18000, {'loss': 0.12183055281639099, 'DER': 0.2958097395243488, 'ACC': np.float64(0.9458134238378064), 'MI': 0.18006795016987542, 'FA': 0.06800679501698755, 'CF': 0.04773499433748584}, batch size: 64, grad_norm: 0.21062517166137695, grad_scale: , lr: 8.57e-06,
2025-01-24 23:50:58,318 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 23:50:58,318 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-24 23:52:08,768 (model:870) WARNING: All labels are zero
2025-01-24 23:52:09,587 (model:870) WARNING: All labels are zero
2025-01-24 23:52:11,361 (model:870) WARNING: All labels are zero
2025-01-24 23:54:21,955 (model:870) WARNING: All labels are zero
2025-01-24 23:54:33,425 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 18456,  validation: loss=0.07584, DER=0.1747, ACC=0.9646, MI=0.09782, FA=0.05082, CF=0.02605, over 0.00 frames.
2025-01-24 23:54:33,425 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-24 23:54:39,385 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 18456,  validation: loss=0.0741, DER=0.1744, ACC=0.9654, MI=0.09707, FA=0.05228, CF=0.02507, over 0.00 frames.
2025-01-24 23:54:39,385 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 00:12:09,897 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 18956, num_updates: 18500, {'loss': 0.11121509224176407, 'DER': 0.2562229589256616, 'ACC': np.float64(0.9505357142857144), 'MI': 0.14715963364612014, 'FA': 0.05399786480867562, 'CF': 0.05506546047086588}, batch size: 64, grad_norm: 0.18615330755710602, grad_scale: , lr: 5.79e-06,
2025-01-25 00:12:09,897 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 18956, num_updates: 18500, {'loss': 0.10989322513341904, 'DER': 0.27205406993828973, 'ACC': np.float64(0.9517971654901115), 'MI': 0.16038789303555687, 'FA': 0.06829268292682927, 'CF': 0.043373493975903614}, batch size: 64, grad_norm: 0.18615330755710602, grad_scale: , lr: 5.79e-06,
2025-01-25 00:12:09,898 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 00:12:09,898 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 00:13:19,556 (model:870) WARNING: All labels are zero
2025-01-25 00:13:20,364 (model:870) WARNING: All labels are zero
2025-01-25 00:13:22,231 (model:870) WARNING: All labels are zero
2025-01-25 00:15:31,057 (model:870) WARNING: All labels are zero
2025-01-25 00:15:43,044 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 18956,  validation: loss=0.07487, DER=0.1736, ACC=0.965, MI=0.09944, FA=0.04955, CF=0.02461, over 0.00 frames.
2025-01-25 00:15:43,045 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 00:15:48,094 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 18956,  validation: loss=0.07333, DER=0.1722, ACC=0.9658, MI=0.09821, FA=0.05024, CF=0.02378, over 0.00 frames.
2025-01-25 00:15:48,094 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 00:33:20,328 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 19456, num_updates: 19000, {'loss': 0.10316923260688782, 'DER': 0.23469994058229351, 'ACC': np.float64(0.9564275829843826), 'MI': 0.11931075460487225, 'FA': 0.0619726678550208, 'CF': 0.053416518122400475}, batch size: 64, grad_norm: 0.20999227464199066, grad_scale: , lr: 3.02e-06,
2025-01-25 00:33:20,329 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 00:33:20,329 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 19456, num_updates: 19000, {'loss': 0.11309702694416046, 'DER': 0.2827545265657465, 'ACC': np.float64(0.9471550209487768), 'MI': 0.1408726625111309, 'FA': 0.07646185811813594, 'CF': 0.06542000593647966}, batch size: 64, grad_norm: 0.20999227464199066, grad_scale: , lr: 3.02e-06,
2025-01-25 00:33:20,330 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 00:34:31,475 (model:870) WARNING: All labels are zero
2025-01-25 00:34:31,852 (model:870) WARNING: All labels are zero
2025-01-25 00:34:32,308 (model:870) WARNING: All labels are zero
2025-01-25 00:36:40,461 (model:870) WARNING: All labels are zero
2025-01-25 00:36:57,445 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 19456,  validation: loss=0.07375, DER=0.1731, ACC=0.9656, MI=0.0936, FA=0.05498, CF=0.02452, over 0.00 frames.
2025-01-25 00:36:57,446 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 00:36:59,246 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 19456,  validation: loss=0.07525, DER=0.1741, ACC=0.9648, MI=0.09459, FA=0.05417, CF=0.0253, over 0.00 frames.
2025-01-25 00:36:59,247 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 00:38:29,567 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-19500.pt
2025-01-25 00:38:30,117 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-25 00:54:27,198 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 19956, num_updates: 19500, {'loss': 0.10957520455121994, 'DER': 0.2552152943227381, 'ACC': np.float64(0.9540015192814693), 'MI': 0.13684699866349004, 'FA': 0.07449590330640944, 'CF': 0.04387239235283863}, batch size: 64, grad_norm: 0.2040053755044937, grad_scale: , lr: 2.39e-07,
2025-01-25 00:54:27,199 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 00:54:27,199 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 19956, num_updates: 19500, {'loss': 0.10777127742767334, 'DER': 0.26079526033952377, 'ACC': np.float64(0.952625), 'MI': 0.14327218867494587, 'FA': 0.07605104249743648, 'CF': 0.04147202916714139}, batch size: 64, grad_norm: 0.2040053755044937, grad_scale: , lr: 2.39e-07,
2025-01-25 00:54:27,199 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 00:55:38,548 (model:870) WARNING: All labels are zero
2025-01-25 00:55:39,365 (model:870) WARNING: All labels are zero
2025-01-25 00:55:41,495 (model:870) WARNING: All labels are zero
2025-01-25 00:57:52,727 (model:870) WARNING: All labels are zero
2025-01-25 00:58:03,428 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 19956,  validation: loss=0.07484, DER=0.1733, ACC=0.965, MI=0.09883, FA=0.0498, CF=0.02464, over 0.00 frames.
2025-01-25 00:58:03,429 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 00:58:10,127 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 19956,  validation: loss=0.07332, DER=0.1728, ACC=0.9657, MI=0.09802, FA=0.051, CF=0.02377, over 0.00 frames.
2025-01-25 00:58:10,127 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 01:15:39,747 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 20456, num_updates: 20000, {'loss': 0.14508262276649475, 'DER': 0.3124651577656372, 'ACC': np.float64(0.9368035714285714), 'MI': 0.17331921061433828, 'FA': 0.057029769205039584, 'CF': 0.08211617794625933}, batch size: 64, grad_norm: 0.2305651307106018, grad_scale: , lr: 0.00e+00,
2025-01-25 01:15:39,747 (train_accelerate_ddp:702) INFO: [Train] - Epoch 5, batch_idx_train: 20456, num_updates: 20000, {'loss': 0.11413463950157166, 'DER': 0.25144817501827793, 'ACC': np.float64(0.9544107446875592), 'MI': 0.16810078173331083, 'FA': 0.05016590742927844, 'CF': 0.033181485855688655}, batch size: 64, grad_norm: 0.2305651307106018, grad_scale: , lr: 0.00e+00,
2025-01-25 01:15:39,748 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 01:15:39,748 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 01:16:51,476 (model:870) WARNING: All labels are zero
2025-01-25 01:16:52,309 (model:870) WARNING: All labels are zero
2025-01-25 01:16:53,217 (model:870) WARNING: All labels are zero
2025-01-25 01:19:07,266 (model:870) WARNING: All labels are zero
2025-01-25 01:19:21,702 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 20456,  validation: loss=0.07516, DER=0.1739, ACC=0.9649, MI=0.09873, FA=0.05052, CF=0.02468, over 0.00 frames.
2025-01-25 01:19:21,702 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 01:19:24,773 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 5, batch_idx_train: 20456,  validation: loss=0.07368, DER=0.1733, ACC=0.9656, MI=0.09776, FA=0.05164, CF=0.02386, over 0.00 frames.
2025-01-25 01:19:24,773 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 01:23:22,337 (train_accelerate_ddp:713) INFO: end of epoch 5, batch_idx: 4113 batch_idx_train: 20569, {'loss': 0.1163857951760292, 'DER': 0.24922136347906332, 'ACC': np.float64(0.9533660714285714), 'MI': 0.13646325989156766, 'FA': 0.06073364863306033, 'CF': 0.05202445495443534}, batch size: 64, grad_norm: 0.1685750037431717, grad_scale: , lr: 0.00e+00,
2025-01-25 01:23:22,337 (train_accelerate_ddp:713) INFO: end of epoch 5, batch_idx: 4113 batch_idx_train: 20569, {'loss': 0.11011513322591782, 'DER': 0.2631701090740311, 'ACC': np.float64(0.9527767857142857), 'MI': 0.15879554420979344, 'FA': 0.06068693432350893, 'CF': 0.04368763054072871}, batch size: 64, grad_norm: 0.1685750037431717, grad_scale: , lr: 0.00e+00,
2025-01-25 01:23:22,340 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-5.pt
2025-01-25 01:23:22,772 (train_accelerate_ddp:561) INFO:  end of epoch 5, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-5.pt
2025-01-25 01:23:26,545 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 20570, num_updates: 20000, {'loss': 0.08670978248119354, 'DER': 0.22026061370323666, 'ACC': np.float64(0.9622589285714286), 'MI': 0.10430553053503873, 'FA': 0.08238755779739386, 'CF': 0.03356752537080406}, batch size: 64, grad_norm: 0.19821389019489288, grad_scale: , lr: 0.00e+00,
2025-01-25 01:23:26,545 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 20570, num_updates: 20000, {'loss': 0.0975576713681221, 'DER': 0.21939275220372184, 'ACC': np.float64(0.9564375), 'MI': 0.12678202198280553, 'FA': 0.0465230166503428, 'CF': 0.046087713570573514}, batch size: 64, grad_norm: 0.19821389019489288, grad_scale: , lr: 0.00e+00,
2025-01-25 01:38:41,386 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-21000.pt
2025-01-25 01:38:41,947 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-25 01:38:41,986 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-01-25 01:41:08,827 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 21070, num_updates: 20500, {'loss': 0.10806763917207718, 'DER': 0.25726366656599214, 'ACC': np.float64(0.9530714285714286), 'MI': 0.13107822410147993, 'FA': 0.06596194503171247, 'CF': 0.060223497432799755}, batch size: 64, grad_norm: 0.16132919490337372, grad_scale: , lr: 0.00e+00,
2025-01-25 01:41:08,827 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 21070, num_updates: 20500, {'loss': 0.09865256398916245, 'DER': 0.2175834970530452, 'ACC': np.float64(0.9603839285714285), 'MI': 0.1552608600742196, 'FA': 0.037764680200829515, 'CF': 0.02455795677799607}, batch size: 64, grad_norm: 0.16132919490337372, grad_scale: , lr: 0.00e+00,
2025-01-25 01:41:08,828 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 01:41:08,828 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 01:42:18,641 (model:870) WARNING: All labels are zero
2025-01-25 01:42:19,457 (model:870) WARNING: All labels are zero
2025-01-25 01:42:22,349 (model:870) WARNING: All labels are zero
2025-01-25 01:44:34,535 (model:870) WARNING: All labels are zero
2025-01-25 01:44:43,880 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 21070,  validation: loss=0.07486, DER=0.1734, ACC=0.9649, MI=0.09919, FA=0.04951, CF=0.02474, over 0.00 frames.
2025-01-25 01:44:43,880 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 01:44:52,078 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 21070,  validation: loss=0.07343, DER=0.173, ACC=0.9656, MI=0.0984, FA=0.05051, CF=0.02412, over 0.00 frames.
2025-01-25 01:44:52,079 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 02:02:34,898 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 21570, num_updates: 21000, {'loss': 0.15015023946762085, 'DER': 0.32921635434412266, 'ACC': np.float64(0.9316160714285714), 'MI': 0.1979344122657581, 'FA': 0.0527576660988075, 'CF': 0.07852427597955706}, batch size: 64, grad_norm: 0.27021360397338867, grad_scale: , lr: 0.00e+00,
2025-01-25 02:02:34,898 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 21570, num_updates: 21000, {'loss': 0.10568784922361374, 'DER': 0.25638460633164645, 'ACC': np.float64(0.9524553571428571), 'MI': 0.13640108273508297, 'FA': 0.06302224314463928, 'CF': 0.05696128045192421}, batch size: 64, grad_norm: 0.27021360397338867, grad_scale: , lr: 0.00e+00,
2025-01-25 02:02:34,898 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 02:02:34,898 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 02:03:48,717 (model:870) WARNING: All labels are zero
2025-01-25 02:03:49,534 (model:870) WARNING: All labels are zero
2025-01-25 02:03:50,093 (model:870) WARNING: All labels are zero
2025-01-25 02:06:00,338 (model:870) WARNING: All labels are zero
2025-01-25 02:06:13,976 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 21570,  validation: loss=0.07492, DER=0.1735, ACC=0.9649, MI=0.1, FA=0.049, CF=0.02454, over 0.00 frames.
2025-01-25 02:06:13,977 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 02:06:17,608 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 21570,  validation: loss=0.07346, DER=0.1726, ACC=0.9657, MI=0.09873, FA=0.04984, CF=0.02402, over 0.00 frames.
2025-01-25 02:06:17,609 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 02:23:51,054 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 22070, num_updates: 21500, {'loss': 0.12203086912631989, 'DER': 0.2989363479423066, 'ACC': np.float64(0.9443303571428571), 'MI': 0.1773681572645765, 'FA': 0.07328618366096787, 'CF': 0.04828200701676227}, batch size: 64, grad_norm: 0.21093837916851044, grad_scale: , lr: 0.00e+00,
2025-01-25 02:23:51,054 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 02:23:51,056 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 22070, num_updates: 21500, {'loss': 0.11209726333618164, 'DER': 0.2519800859923059, 'ACC': np.float64(0.9525892857142857), 'MI': 0.14420683412536772, 'FA': 0.05934600588368409, 'CF': 0.04842724598325413}, batch size: 64, grad_norm: 0.21093837916851044, grad_scale: , lr: 0.00e+00,
2025-01-25 02:23:51,056 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 02:25:01,928 (model:870) WARNING: All labels are zero
2025-01-25 02:25:02,752 (model:870) WARNING: All labels are zero
2025-01-25 02:25:04,795 (model:870) WARNING: All labels are zero
2025-01-25 02:27:16,091 (model:870) WARNING: All labels are zero
2025-01-25 02:27:28,069 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 22070,  validation: loss=0.07507, DER=0.174, ACC=0.9649, MI=0.09988, FA=0.0494, CF=0.02474, over 0.00 frames.
2025-01-25 02:27:28,069 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 02:27:33,530 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 22070,  validation: loss=0.07358, DER=0.1729, ACC=0.9657, MI=0.09876, FA=0.05018, CF=0.02397, over 0.00 frames.
2025-01-25 02:27:33,530 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 02:42:34,730 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-22500.pt
2025-01-25 02:42:35,364 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-25 02:45:05,873 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 22570, num_updates: 22000, {'loss': 0.07269488275051117, 'DER': 0.15999049090692974, 'ACC': np.float64(0.9704732142857143), 'MI': 0.07238797099726614, 'FA': 0.05105194342089623, 'CF': 0.03655057648876738}, batch size: 64, grad_norm: 0.1903964877128601, grad_scale: , lr: 0.00e+00,
2025-01-25 02:45:05,874 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 02:45:05,875 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 22570, num_updates: 22000, {'loss': 0.11986815929412842, 'DER': 0.2782542196973835, 'ACC': np.float64(0.9470803571428571), 'MI': 0.18692303490468126, 'FA': 0.04582946413940023, 'CF': 0.04550172065330201}, batch size: 64, grad_norm: 0.1903964877128601, grad_scale: , lr: 0.00e+00,
2025-01-25 02:45:05,875 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 02:46:17,677 (model:870) WARNING: All labels are zero
2025-01-25 02:46:17,877 (model:870) WARNING: All labels are zero
2025-01-25 02:46:18,510 (model:870) WARNING: All labels are zero
2025-01-25 02:48:26,585 (model:870) WARNING: All labels are zero
2025-01-25 02:48:43,427 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 22570,  validation: loss=0.07359, DER=0.173, ACC=0.9656, MI=0.09768, FA=0.05102, CF=0.02425, over 0.00 frames.
2025-01-25 02:48:43,428 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 02:48:44,358 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 22570,  validation: loss=0.07498, DER=0.1737, ACC=0.9649, MI=0.09884, FA=0.05002, CF=0.02486, over 0.00 frames.
2025-01-25 02:48:44,358 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 03:06:13,264 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 23070, num_updates: 22500, {'loss': 0.10250414907932281, 'DER': 0.2178561736770692, 'ACC': np.float64(0.9585892857142857), 'MI': 0.1405156037991859, 'FA': 0.043473541383989144, 'CF': 0.03386702849389416}, batch size: 64, grad_norm: 0.22324487566947937, grad_scale: , lr: 0.00e+00,
2025-01-25 03:06:13,264 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 03:06:13,266 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 23070, num_updates: 22500, {'loss': 0.12192507833242416, 'DER': 0.27250201992997575, 'ACC': np.float64(0.9450535714285715), 'MI': 0.15136008618367897, 'FA': 0.06215997845408026, 'CF': 0.05898195529221654}, batch size: 64, grad_norm: 0.22324487566947937, grad_scale: , lr: 0.00e+00,
2025-01-25 03:06:13,266 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 03:07:23,502 (model:870) WARNING: All labels are zero
2025-01-25 03:07:24,315 (model:870) WARNING: All labels are zero
2025-01-25 03:07:26,860 (model:870) WARNING: All labels are zero
2025-01-25 03:09:38,658 (model:870) WARNING: All labels are zero
2025-01-25 03:09:47,956 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 23070,  validation: loss=0.07533, DER=0.1745, ACC=0.9648, MI=0.1019, FA=0.04799, CF=0.02456, over 0.00 frames.
2025-01-25 03:09:47,956 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 03:09:55,963 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 23070,  validation: loss=0.07387, DER=0.1738, ACC=0.9655, MI=0.1009, FA=0.049, CF=0.02389, over 0.00 frames.
2025-01-25 03:09:55,964 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 03:28:21,928 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 23570, num_updates: 23000, {'loss': 0.12593603134155273, 'DER': 0.2671486213853396, 'ACC': np.float64(0.9476785714285715), 'MI': 0.15954942837928715, 'FA': 0.046346110737502805, 'CF': 0.061253082268549655}, batch size: 64, grad_norm: 0.27293920516967773, grad_scale: , lr: 0.00e+00,
2025-01-25 03:28:21,928 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 23570, num_updates: 23000, {'loss': 0.11208798736333847, 'DER': 0.24973402766112324, 'ACC': np.float64(0.9547321428571429), 'MI': 0.1670866229912089, 'FA': 0.04849095694047819, 'CF': 0.034156447729436136}, batch size: 64, grad_norm: 0.27293920516967773, grad_scale: , lr: 0.00e+00,
2025-01-25 03:28:21,929 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 03:28:21,929 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 03:29:32,535 (model:870) WARNING: All labels are zero
2025-01-25 03:29:33,773 (model:870) WARNING: All labels are zero
2025-01-25 03:29:35,345 (model:870) WARNING: All labels are zero
2025-01-25 03:31:48,126 (model:870) WARNING: All labels are zero
2025-01-25 03:32:02,703 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 23570,  validation: loss=0.07501, DER=0.1738, ACC=0.9649, MI=0.1007, FA=0.04867, CF=0.02443, over 0.00 frames.
2025-01-25 03:32:02,704 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 03:32:05,982 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 23570,  validation: loss=0.07352, DER=0.1728, ACC=0.9657, MI=0.0996, FA=0.04944, CF=0.02375, over 0.00 frames.
2025-01-25 03:32:05,982 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 03:47:25,271 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-24000.pt
2025-01-25 03:47:25,904 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-25 03:49:54,550 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 24070, num_updates: 23500, {'loss': 0.10118991136550903, 'DER': 0.24243146603098928, 'ACC': np.float64(0.9580982142857143), 'MI': 0.12747318235995234, 'FA': 0.07771156138259833, 'CF': 0.037246722288438616}, batch size: 64, grad_norm: 0.14473628997802734, grad_scale: , lr: 0.00e+00,
2025-01-25 03:49:54,550 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 03:49:54,550 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 24070, num_updates: 23500, {'loss': 0.08309269696474075, 'DER': 0.1876874228258952, 'ACC': np.float64(0.9683571428571429), 'MI': 0.09366731345916388, 'FA': 0.07332274945610631, 'CF': 0.020697359910625036}, batch size: 64, grad_norm: 0.14473628997802734, grad_scale: , lr: 0.00e+00,
2025-01-25 03:49:54,550 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 03:51:03,788 (model:870) WARNING: All labels are zero
2025-01-25 03:51:04,589 (model:870) WARNING: All labels are zero
2025-01-25 03:51:05,918 (model:870) WARNING: All labels are zero
2025-01-25 03:53:15,879 (model:870) WARNING: All labels are zero
2025-01-25 03:53:29,936 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 24070,  validation: loss=0.07503, DER=0.174, ACC=0.9649, MI=0.09962, FA=0.04963, CF=0.02479, over 0.00 frames.
2025-01-25 03:53:29,937 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 03:53:33,040 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 24070,  validation: loss=0.07362, DER=0.1734, ACC=0.9656, MI=0.09863, FA=0.05066, CF=0.02413, over 0.00 frames.
2025-01-25 03:53:33,040 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 04:11:07,389 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 24570, num_updates: 24000, {'loss': 0.10740748792886734, 'DER': 0.22861706229002587, 'ACC': np.float64(0.956125), 'MI': 0.13091369719667345, 'FA': 0.05568100457123974, 'CF': 0.04202236052211268}, batch size: 64, grad_norm: 0.20946770906448364, grad_scale: , lr: 0.00e+00,
2025-01-25 04:11:07,390 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 04:11:07,391 (train_accelerate_ddp:702) INFO: [Train] - Epoch 6, batch_idx_train: 24570, num_updates: 24000, {'loss': 0.1196482926607132, 'DER': 0.26782026234998607, 'ACC': np.float64(0.9474642857142856), 'MI': 0.16154060842869103, 'FA': 0.04566006140106056, 'CF': 0.06061959252023444}, batch size: 64, grad_norm: 0.20946770906448364, grad_scale: , lr: 0.00e+00,
2025-01-25 04:11:07,391 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 04:12:18,297 (model:870) WARNING: All labels are zero
2025-01-25 04:12:19,115 (model:870) WARNING: All labels are zero
2025-01-25 04:12:19,119 (model:870) WARNING: All labels are zero
2025-01-25 04:14:29,399 (model:870) WARNING: All labels are zero
2025-01-25 04:14:46,837 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 24570,  validation: loss=0.07343, DER=0.1728, ACC=0.9657, MI=0.09835, FA=0.05063, CF=0.02378, over 0.00 frames.
2025-01-25 04:14:46,838 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 04:14:47,672 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 6, batch_idx_train: 24570,  validation: loss=0.07502, DER=0.1736, ACC=0.9649, MI=0.09927, FA=0.04964, CF=0.02465, over 0.00 frames.
2025-01-25 04:14:47,672 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 04:18:42,729 (train_accelerate_ddp:713) INFO: end of epoch 6, batch_idx: 4113 batch_idx_train: 24683, {'loss': 0.0936686247587204, 'DER': 0.21781354051054383, 'ACC': np.float64(0.9588839285714286), 'MI': 0.1232519422863485, 'FA': 0.05682574916759157, 'CF': 0.03773584905660377}, batch size: 64, grad_norm: 0.16757304966449738, grad_scale: , lr: 0.00e+00,
2025-01-25 04:18:42,729 (train_accelerate_ddp:713) INFO: end of epoch 6, batch_idx: 4113 batch_idx_train: 24683, {'loss': 0.09338632225990295, 'DER': 0.2220666316587899, 'ACC': np.float64(0.9586517857142857), 'MI': 0.12264426162553241, 'FA': 0.05128653947138106, 'CF': 0.048135830561876425}, batch size: 64, grad_norm: 0.16757304966449738, grad_scale: , lr: 0.00e+00,
2025-01-25 04:18:42,732 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-6.pt
2025-01-25 04:18:43,182 (train_accelerate_ddp:561) INFO:  end of epoch 6, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-6.pt
2025-01-25 04:18:46,557 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 24684, num_updates: 24000, {'loss': 0.11036297678947449, 'DER': 0.2591203339584972, 'ACC': np.float64(0.9566339285714286), 'MI': 0.15282231229959464, 'FA': 0.07157117792969932, 'CF': 0.03472684372920322}, batch size: 64, grad_norm: 0.19067656993865967, grad_scale: , lr: 0.00e+00,
2025-01-25 04:18:46,558 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 24684, num_updates: 24000, {'loss': 0.11740954965353012, 'DER': 0.25549100968188104, 'ACC': np.float64(0.9506517857142857), 'MI': 0.1567911479944675, 'FA': 0.048409405255878286, 'CF': 0.05029045643153527}, batch size: 64, grad_norm: 0.19067656993865967, grad_scale: , lr: 0.00e+00,
2025-01-25 04:36:20,900 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 25184, num_updates: 24500, {'loss': 0.08935989439487457, 'DER': 0.21664250507393448, 'ACC': np.float64(0.9627678571428571), 'MI': 0.11087271672948681, 'FA': 0.08060307335459553, 'CF': 0.02516671498985213}, batch size: 64, grad_norm: 0.2059321403503418, grad_scale: , lr: 0.00e+00,
2025-01-25 04:36:20,900 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 04:36:20,902 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 25184, num_updates: 24500, {'loss': 0.10049144923686981, 'DER': 0.24244016345592528, 'ACC': np.float64(0.9548214285714286), 'MI': 0.1299474605954466, 'FA': 0.0595446584938704, 'CF': 0.05294804436660829}, batch size: 64, grad_norm: 0.2059321403503418, grad_scale: , lr: 0.00e+00,
2025-01-25 04:36:20,902 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 04:37:29,728 (model:870) WARNING: All labels are zero
2025-01-25 04:37:30,522 (model:870) WARNING: All labels are zero
2025-01-25 04:37:32,104 (model:870) WARNING: All labels are zero
2025-01-25 04:39:41,583 (model:870) WARNING: All labels are zero
2025-01-25 04:39:54,179 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 25184,  validation: loss=0.07481, DER=0.1733, ACC=0.965, MI=0.09823, FA=0.05032, CF=0.02476, over 0.00 frames.
2025-01-25 04:39:54,179 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 04:39:58,754 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 25184,  validation: loss=0.07329, DER=0.172, ACC=0.9658, MI=0.09681, FA=0.05123, CF=0.024, over 0.00 frames.
2025-01-25 04:39:58,754 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 04:50:57,291 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-25500.pt
2025-01-25 04:50:57,958 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-25 04:50:58,043 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-01-25 04:57:23,747 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 25684, num_updates: 25000, {'loss': 0.1254139095544815, 'DER': 0.27327361378841136, 'ACC': np.float64(0.950375), 'MI': 0.16044903050232454, 'FA': 0.07098310466039233, 'CF': 0.041841478625694525}, batch size: 64, grad_norm: 0.2615582346916199, grad_scale: , lr: 0.00e+00,
2025-01-25 04:57:23,747 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 04:57:23,748 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 25684, num_updates: 25000, {'loss': 0.12368670850992203, 'DER': 0.26378041878890773, 'ACC': np.float64(0.9496071428571429), 'MI': 0.1494057724957555, 'FA': 0.05874363327674024, 'CF': 0.055631013016412}, batch size: 64, grad_norm: 0.2615582346916199, grad_scale: , lr: 0.00e+00,
2025-01-25 04:57:23,748 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 04:58:33,735 (model:870) WARNING: All labels are zero
2025-01-25 04:58:34,543 (model:870) WARNING: All labels are zero
2025-01-25 04:58:35,961 (model:870) WARNING: All labels are zero
2025-01-25 05:00:46,568 (model:870) WARNING: All labels are zero
2025-01-25 05:00:59,622 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 25684,  validation: loss=0.0751, DER=0.1739, ACC=0.9648, MI=0.0991, FA=0.05013, CF=0.02467, over 0.00 frames.
2025-01-25 05:00:59,622 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 05:01:04,118 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 25684,  validation: loss=0.07357, DER=0.173, ACC=0.9656, MI=0.09797, FA=0.0511, CF=0.02392, over 0.00 frames.
2025-01-25 05:01:04,119 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 05:18:23,846 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 26184, num_updates: 25500, {'loss': 0.09529653936624527, 'DER': 0.2284757949544412, 'ACC': np.float64(0.9601071428571429), 'MI': 0.1077914832951094, 'FA': 0.07221223578999567, 'CF': 0.04847207586933614}, batch size: 64, grad_norm: 0.1702103316783905, grad_scale: , lr: 0.00e+00,
2025-01-25 05:18:23,846 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 05:18:24,516 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 26184, num_updates: 25500, {'loss': 0.09162604808807373, 'DER': 0.20203377944012624, 'ACC': np.float64(0.9629285714285715), 'MI': 0.10747472386184326, 'FA': 0.05394190871369295, 'CF': 0.04061714686459003}, batch size: 64, grad_norm: 0.1702103316783905, grad_scale: , lr: 0.00e+00,
2025-01-25 05:18:24,516 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 05:19:32,147 (model:870) WARNING: All labels are zero
2025-01-25 05:19:32,932 (model:870) WARNING: All labels are zero
2025-01-25 05:19:35,068 (model:870) WARNING: All labels are zero
2025-01-25 05:21:42,623 (model:870) WARNING: All labels are zero
2025-01-25 05:21:53,498 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 26184,  validation: loss=0.07505, DER=0.1738, ACC=0.9649, MI=0.09856, FA=0.05049, CF=0.0248, over 0.00 frames.
2025-01-25 05:21:53,498 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 05:21:59,609 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 26184,  validation: loss=0.07362, DER=0.173, ACC=0.9656, MI=0.0975, FA=0.05132, CF=0.02415, over 0.00 frames.
2025-01-25 05:21:59,609 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 05:39:12,326 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 26684, num_updates: 26000, {'loss': 0.1356734335422516, 'DER': 0.31689078798542164, 'ACC': np.float64(0.9415892857142857), 'MI': 0.1258640191026769, 'FA': 0.09683297725273345, 'CF': 0.0941937916300113}, batch size: 64, grad_norm: 0.23693622648715973, grad_scale: , lr: 0.00e+00,
2025-01-25 05:39:12,327 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 26684, num_updates: 26000, {'loss': 0.10748320817947388, 'DER': 0.23785803237858033, 'ACC': np.float64(0.9555), 'MI': 0.13370315860975887, 'FA': 0.05988905241707234, 'CF': 0.04426582135174912}, batch size: 64, grad_norm: 0.23693622648715973, grad_scale: , lr: 0.00e+00,
2025-01-25 05:39:12,327 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 05:39:12,327 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 05:40:20,874 (model:870) WARNING: All labels are zero
2025-01-25 05:40:21,672 (model:870) WARNING: All labels are zero
2025-01-25 05:40:22,358 (model:870) WARNING: All labels are zero
2025-01-25 05:42:28,695 (model:870) WARNING: All labels are zero
2025-01-25 05:42:43,553 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 26684,  validation: loss=0.07509, DER=0.1742, ACC=0.9649, MI=0.09958, FA=0.05009, CF=0.02457, over 0.00 frames.
2025-01-25 05:42:43,553 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 05:42:45,475 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 26684,  validation: loss=0.07364, DER=0.1733, ACC=0.9656, MI=0.09858, FA=0.05079, CF=0.02391, over 0.00 frames.
2025-01-25 05:42:45,475 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 05:53:34,021 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-27000.pt
2025-01-25 05:53:34,611 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-25 05:59:58,367 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 27184, num_updates: 26500, {'loss': 0.09169099479913712, 'DER': 0.19871495327102803, 'ACC': np.float64(0.9648214285714286), 'MI': 0.10432242990654206, 'FA': 0.06296728971962617, 'CF': 0.031425233644859815}, batch size: 64, grad_norm: 0.1387174427509308, grad_scale: , lr: 0.00e+00,
2025-01-25 05:59:58,368 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 05:59:58,368 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 27184, num_updates: 26500, {'loss': 0.0921972319483757, 'DER': 0.23445300462249616, 'ACC': np.float64(0.96), 'MI': 0.12073959938366718, 'FA': 0.0720493066255778, 'CF': 0.041664098613251155}, batch size: 64, grad_norm: 0.1387174427509308, grad_scale: , lr: 0.00e+00,
2025-01-25 05:59:58,368 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 06:01:06,227 (model:870) WARNING: All labels are zero
2025-01-25 06:01:07,011 (model:870) WARNING: All labels are zero
2025-01-25 06:01:09,157 (model:870) WARNING: All labels are zero
2025-01-25 06:03:17,532 (model:870) WARNING: All labels are zero
2025-01-25 06:03:27,865 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 27184,  validation: loss=0.07501, DER=0.1738, ACC=0.9648, MI=0.09796, FA=0.05086, CF=0.02495, over 0.00 frames.
2025-01-25 06:03:27,865 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 06:03:34,585 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 27184,  validation: loss=0.07361, DER=0.1729, ACC=0.9656, MI=0.09696, FA=0.05157, CF=0.02436, over 0.00 frames.
2025-01-25 06:03:34,585 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 06:20:49,253 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 27684, num_updates: 27000, {'loss': 0.14215339720249176, 'DER': 0.3405785169328723, 'ACC': np.float64(0.9305535714285714), 'MI': 0.18897853888797408, 'FA': 0.06526154015039244, 'CF': 0.08633843789450574}, batch size: 64, grad_norm: 0.19277507066726685, grad_scale: , lr: 0.00e+00,
2025-01-25 06:20:49,254 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 06:20:49,256 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 27684, num_updates: 27000, {'loss': 0.0887032225728035, 'DER': 0.20847770847770847, 'ACC': np.float64(0.963), 'MI': 0.11798336798336799, 'FA': 0.059655809655809654, 'CF': 0.030838530838530838}, batch size: 64, grad_norm: 0.19277507066726685, grad_scale: , lr: 0.00e+00,
2025-01-25 06:20:49,256 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 06:21:57,806 (model:870) WARNING: All labels are zero
2025-01-25 06:21:58,594 (model:870) WARNING: All labels are zero
2025-01-25 06:21:59,311 (model:870) WARNING: All labels are zero
2025-01-25 06:24:06,736 (model:870) WARNING: All labels are zero
2025-01-25 06:24:21,532 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 27684,  validation: loss=0.07495, DER=0.1738, ACC=0.9649, MI=0.09959, FA=0.04955, CF=0.02463, over 0.00 frames.
2025-01-25 06:24:21,533 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 06:24:23,681 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 27684,  validation: loss=0.07351, DER=0.1728, ACC=0.9657, MI=0.09829, FA=0.05047, CF=0.02399, over 0.00 frames.
2025-01-25 06:24:23,681 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 06:41:37,748 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 28184, num_updates: 27500, {'loss': 0.1158282533288002, 'DER': 0.2614344284116927, 'ACC': np.float64(0.948875), 'MI': 0.16042809222086152, 'FA': 0.057558170491454126, 'CF': 0.04344816569937703}, batch size: 64, grad_norm: 0.20661358535289764, grad_scale: , lr: 0.00e+00,
2025-01-25 06:41:37,749 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 06:41:37,751 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 28184, num_updates: 27500, {'loss': 0.0978526622056961, 'DER': 0.23803733203623761, 'ACC': np.float64(0.9569482679770797), 'MI': 0.12512920289414484, 'FA': 0.059038122453942965, 'CF': 0.05387000668814981}, batch size: 64, grad_norm: 0.20661358535289764, grad_scale: , lr: 0.00e+00,
2025-01-25 06:41:37,751 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 06:42:45,421 (model:870) WARNING: All labels are zero
2025-01-25 06:42:46,208 (model:870) WARNING: All labels are zero
2025-01-25 06:42:49,344 (model:870) WARNING: All labels are zero
2025-01-25 06:44:57,496 (model:870) WARNING: All labels are zero
2025-01-25 06:45:06,633 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 28184,  validation: loss=0.07506, DER=0.1739, ACC=0.9649, MI=0.09737, FA=0.05176, CF=0.02477, over 0.00 frames.
2025-01-25 06:45:06,634 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 06:45:14,560 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 28184,  validation: loss=0.07356, DER=0.1726, ACC=0.9657, MI=0.09648, FA=0.05211, CF=0.02401, over 0.00 frames.
2025-01-25 06:45:14,560 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 06:56:01,732 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-28500.pt
2025-01-25 06:56:02,405 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-25 07:02:22,859 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 28684, num_updates: 28000, {'loss': 0.11000005900859833, 'DER': 0.2617125382262997, 'ACC': np.float64(0.9534196428571429), 'MI': 0.1273394495412844, 'FA': 0.07700305810397554, 'CF': 0.05737003058103975}, batch size: 64, grad_norm: 0.2290244996547699, grad_scale: , lr: 0.00e+00,
2025-01-25 07:02:22,860 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 07:02:22,862 (train_accelerate_ddp:702) INFO: [Train] - Epoch 7, batch_idx_train: 28684, num_updates: 28000, {'loss': 0.09746138006448746, 'DER': 0.22807958065284728, 'ACC': np.float64(0.9588683662618734), 'MI': 0.11913271384322136, 'FA': 0.06284250655229927, 'CF': 0.046104360257326664}, batch size: 64, grad_norm: 0.2290244996547699, grad_scale: , lr: 0.00e+00,
2025-01-25 07:02:22,862 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 07:03:30,643 (model:870) WARNING: All labels are zero
2025-01-25 07:03:31,428 (model:870) WARNING: All labels are zero
2025-01-25 07:03:34,233 (model:870) WARNING: All labels are zero
2025-01-25 07:05:43,361 (model:870) WARNING: All labels are zero
2025-01-25 07:05:51,965 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 28684,  validation: loss=0.07505, DER=0.1737, ACC=0.9649, MI=0.09818, FA=0.05072, CF=0.02482, over 0.00 frames.
2025-01-25 07:05:51,965 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 07:06:00,529 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 7, batch_idx_train: 28684,  validation: loss=0.07356, DER=0.1728, ACC=0.9657, MI=0.09731, FA=0.05148, CF=0.02405, over 0.00 frames.
2025-01-25 07:06:00,529 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 07:09:51,573 (train_accelerate_ddp:713) INFO: end of epoch 7, batch_idx: 4113 batch_idx_train: 28797, {'loss': 0.12296142429113388, 'DER': 0.26762884254787206, 'ACC': np.float64(0.9499553571428571), 'MI': 0.16642991079038583, 'FA': 0.05034376953235979, 'CF': 0.05085516222512643}, batch size: 64, grad_norm: 0.22684961557388306, grad_scale: , lr: 0.00e+00,
2025-01-25 07:09:51,575 (train_accelerate_ddp:713) INFO: end of epoch 7, batch_idx: 4113 batch_idx_train: 28797, {'loss': 0.09519234299659729, 'DER': 0.21912902853182395, 'ACC': np.float64(0.9587410714285715), 'MI': 0.11106618921104308, 'FA': 0.06029802471987986, 'CF': 0.047764814600901005}, batch size: 64, grad_norm: 0.22684961557388306, grad_scale: , lr: 0.00e+00,
2025-01-25 07:09:51,578 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-7.pt
2025-01-25 07:09:52,015 (train_accelerate_ddp:561) INFO:  end of epoch 7, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-7.pt
2025-01-25 07:09:55,734 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 28798, num_updates: 28000, {'loss': 0.1268385797739029, 'DER': 0.26479315761913075, 'ACC': np.float64(0.9498035714285714), 'MI': 0.1373712689823704, 'FA': 0.06510734857741315, 'CF': 0.06231454005934718}, batch size: 64, grad_norm: 0.2112298160791397, grad_scale: , lr: 0.00e+00,
2025-01-25 07:09:55,735 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 28798, num_updates: 28000, {'loss': 0.09125121682882309, 'DER': 0.2486722306525038, 'ACC': np.float64(0.9604537478064678), 'MI': 0.11538947900859889, 'FA': 0.10268082953970663, 'CF': 0.03060192210419828}, batch size: 64, grad_norm: 0.2112298160791397, grad_scale: , lr: 0.00e+00,
2025-01-25 07:27:02,924 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 29298, num_updates: 28500, {'loss': 0.1124241054058075, 'DER': 0.26395714837925893, 'ACC': np.float64(0.9509642857142857), 'MI': 0.17041250207079353, 'FA': 0.05422717985532056, 'CF': 0.03931746645314484}, batch size: 64, grad_norm: 0.2006862610578537, grad_scale: , lr: 0.00e+00,
2025-01-25 07:27:02,925 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 07:27:02,927 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 29298, num_updates: 28500, {'loss': 0.11852570623159409, 'DER': 0.2730862526090145, 'ACC': np.float64(0.9468837953762735), 'MI': 0.15953065944604275, 'FA': 0.05342133468720032, 'CF': 0.060134258475771425}, batch size: 64, grad_norm: 0.2006862610578537, grad_scale: , lr: 0.00e+00,
2025-01-25 07:27:02,927 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 07:28:10,757 (model:870) WARNING: All labels are zero
2025-01-25 07:28:11,541 (model:870) WARNING: All labels are zero
2025-01-25 07:28:14,117 (model:870) WARNING: All labels are zero
2025-01-25 07:30:22,774 (model:870) WARNING: All labels are zero
2025-01-25 07:30:32,261 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 29298,  validation: loss=0.07499, DER=0.1738, ACC=0.9649, MI=0.09983, FA=0.04929, CF=0.02464, over 0.00 frames.
2025-01-25 07:30:32,261 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 07:30:39,868 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 29298,  validation: loss=0.07352, DER=0.1729, ACC=0.9657, MI=0.09872, FA=0.05016, CF=0.02406, over 0.00 frames.
2025-01-25 07:30:39,869 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 07:47:55,224 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 29798, num_updates: 29000, {'loss': 0.08228550106287003, 'DER': 0.1851615892505502, 'ACC': np.float64(0.9682589285714286), 'MI': 0.10871076103324452, 'FA': 0.05571643692806672, 'CF': 0.020734391289238967}, batch size: 64, grad_norm: 0.17709316313266754, grad_scale: , lr: 0.00e+00,
2025-01-25 07:47:55,224 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 07:47:55,224 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 29798, num_updates: 29000, {'loss': 0.12264940142631531, 'DER': 0.2732983159148752, 'ACC': np.float64(0.9474464285714286), 'MI': 0.18032165484377538, 'FA': 0.04754426815400444, 'CF': 0.04543239291709536}, batch size: 64, grad_norm: 0.17709316313266754, grad_scale: , lr: 0.00e+00,
2025-01-25 07:47:55,224 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 07:49:08,391 (model:870) WARNING: All labels are zero
2025-01-25 07:49:09,223 (model:870) WARNING: All labels are zero
2025-01-25 07:49:11,680 (model:870) WARNING: All labels are zero
2025-01-25 07:51:21,854 (model:870) WARNING: All labels are zero
2025-01-25 07:51:32,183 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 29798,  validation: loss=0.07495, DER=0.1736, ACC=0.9649, MI=0.09925, FA=0.04973, CF=0.02464, over 0.00 frames.
2025-01-25 07:51:32,183 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 07:51:39,231 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 29798,  validation: loss=0.07354, DER=0.1729, ACC=0.9657, MI=0.09816, FA=0.05068, CF=0.02404, over 0.00 frames.
2025-01-25 07:51:39,232 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 07:59:43,369 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-30000.pt
2025-01-25 07:59:43,921 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-25 07:59:43,925 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-01-25 08:10:20,225 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 30298, num_updates: 29500, {'loss': 0.09151490032672882, 'DER': 0.20648859617026466, 'ACC': np.float64(0.9655373884279691), 'MI': 0.12422246615440907, 'FA': 0.05494572508842542, 'CF': 0.027320404927430174}, batch size: 64, grad_norm: 0.19532375037670135, grad_scale: , lr: 0.00e+00,
2025-01-25 08:10:20,225 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 30298, num_updates: 29500, {'loss': 0.12506040930747986, 'DER': 0.29508196721311475, 'ACC': np.float64(0.9429196428571429), 'MI': 0.17103261788068277, 'FA': 0.05898259252999831, 'CF': 0.06506675680243366}, batch size: 64, grad_norm: 0.19532375037670135, grad_scale: , lr: 0.00e+00,
2025-01-25 08:10:20,225 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 08:10:20,225 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 08:11:28,902 (model:870) WARNING: All labels are zero
2025-01-25 08:11:29,702 (model:870) WARNING: All labels are zero
2025-01-25 08:11:30,768 (model:870) WARNING: All labels are zero
2025-01-25 08:13:39,341 (model:870) WARNING: All labels are zero
2025-01-25 08:13:53,240 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 30298,  validation: loss=0.07528, DER=0.1742, ACC=0.9648, MI=0.09926, FA=0.0503, CF=0.02463, over 0.00 frames.
2025-01-25 08:13:53,241 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 08:13:56,378 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 30298,  validation: loss=0.07391, DER=0.1732, ACC=0.9656, MI=0.09799, FA=0.05114, CF=0.02412, over 0.00 frames.
2025-01-25 08:13:56,378 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 08:31:06,497 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 30798, num_updates: 30000, {'loss': 0.10111073404550552, 'DER': 0.2570193030834796, 'ACC': np.float64(0.9570625), 'MI': 0.13048383053396842, 'FA': 0.08216344948608674, 'CF': 0.044372023063424415}, batch size: 64, grad_norm: 0.18593548238277435, grad_scale: , lr: 0.00e+00,
2025-01-25 08:31:06,497 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 30798, num_updates: 30000, {'loss': 0.10663577169179916, 'DER': 0.22382128665019868, 'ACC': np.float64(0.9580803571428571), 'MI': 0.14998389002255397, 'FA': 0.04553753624744925, 'CF': 0.02829986038019547}, batch size: 64, grad_norm: 0.18593548238277435, grad_scale: , lr: 0.00e+00,
2025-01-25 08:31:06,498 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 08:31:06,498 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 08:32:13,694 (model:870) WARNING: All labels are zero
2025-01-25 08:32:14,483 (model:870) WARNING: All labels are zero
2025-01-25 08:32:15,859 (model:870) WARNING: All labels are zero
2025-01-25 08:34:23,581 (model:870) WARNING: All labels are zero
2025-01-25 08:34:36,244 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 30798,  validation: loss=0.07517, DER=0.1748, ACC=0.9649, MI=0.103, FA=0.04742, CF=0.02441, over 0.00 frames.
2025-01-25 08:34:36,245 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 08:34:40,461 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 30798,  validation: loss=0.07361, DER=0.1735, ACC=0.9657, MI=0.1019, FA=0.0481, CF=0.02353, over 0.00 frames.
2025-01-25 08:34:40,462 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 08:52:08,243 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 31298, num_updates: 30500, {'loss': 0.12128502130508423, 'DER': 0.2722653573875314, 'ACC': np.float64(0.9488928571428571), 'MI': 0.16025348253025806, 'FA': 0.057490294587805434, 'CF': 0.05452158026946791}, batch size: 64, grad_norm: 0.206093892455101, grad_scale: , lr: 0.00e+00,
2025-01-25 08:52:08,244 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 08:52:08,246 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 31298, num_updates: 30500, {'loss': 0.0933930054306984, 'DER': 0.21324837839389243, 'ACC': np.float64(0.9587321428571429), 'MI': 0.11451696228689513, 'FA': 0.04666781470638884, 'CF': 0.052063601400608464}, batch size: 64, grad_norm: 0.206093892455101, grad_scale: , lr: 0.00e+00,
2025-01-25 08:52:08,246 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 08:53:17,347 (model:870) WARNING: All labels are zero
2025-01-25 08:53:18,161 (model:870) WARNING: All labels are zero
2025-01-25 08:53:19,419 (model:870) WARNING: All labels are zero
2025-01-25 08:55:29,089 (model:870) WARNING: All labels are zero
2025-01-25 08:55:42,372 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 31298,  validation: loss=0.07515, DER=0.1743, ACC=0.9648, MI=0.1014, FA=0.04834, CF=0.02455, over 0.00 frames.
2025-01-25 08:55:42,373 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 08:55:46,250 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 31298,  validation: loss=0.0736, DER=0.1734, ACC=0.9656, MI=0.1002, FA=0.04945, CF=0.02376, over 0.00 frames.
2025-01-25 08:55:46,250 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 09:03:15,292 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-31500.pt
2025-01-25 09:03:15,851 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-25 09:13:46,018 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 31798, num_updates: 31000, {'loss': 0.11228186637163162, 'DER': 0.2838644229621673, 'ACC': np.float64(0.950375), 'MI': 0.17901897601145722, 'FA': 0.05704738035565103, 'CF': 0.04779806659505908}, batch size: 64, grad_norm: 0.18713736534118652, grad_scale: , lr: 0.00e+00,
2025-01-25 09:13:46,018 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 09:13:46,020 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 31798, num_updates: 31000, {'loss': 0.12590524554252625, 'DER': 0.2746693260550073, 'ACC': np.float64(0.947125), 'MI': 0.1775141717404997, 'FA': 0.06099097207642242, 'CF': 0.03616418223808524}, batch size: 64, grad_norm: 0.18713736534118652, grad_scale: , lr: 0.00e+00,
2025-01-25 09:13:46,020 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 09:14:54,320 (model:870) WARNING: All labels are zero
2025-01-25 09:14:55,110 (model:870) WARNING: All labels are zero
2025-01-25 09:14:58,246 (model:870) WARNING: All labels are zero
2025-01-25 09:17:08,693 (model:870) WARNING: All labels are zero
2025-01-25 09:17:16,469 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 31798,  validation: loss=0.07516, DER=0.1742, ACC=0.9648, MI=0.1006, FA=0.04895, CF=0.02467, over 0.00 frames.
2025-01-25 09:17:16,470 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 09:17:25,948 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 31798,  validation: loss=0.07369, DER=0.1736, ACC=0.9656, MI=0.09974, FA=0.04993, CF=0.02393, over 0.00 frames.
2025-01-25 09:17:25,949 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 09:34:52,706 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 32298, num_updates: 31500, {'loss': 0.11137787997722626, 'DER': 0.22992383025027202, 'ACC': np.float64(0.9539285714285715), 'MI': 0.138411316648531, 'FA': 0.04069640914036997, 'CF': 0.05081610446137105}, batch size: 64, grad_norm: 0.16575987637043, grad_scale: , lr: 0.00e+00,
2025-01-25 09:34:52,706 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 09:34:52,709 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 32298, num_updates: 31500, {'loss': 0.1081848070025444, 'DER': 0.28024069753162223, 'ACC': np.float64(0.9533839285714285), 'MI': 0.1275942527324082, 'FA': 0.11230504727987228, 'CF': 0.040341397519341765}, batch size: 64, grad_norm: 0.16575987637043, grad_scale: , lr: 0.00e+00,
2025-01-25 09:34:52,709 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 09:36:02,507 (model:870) WARNING: All labels are zero
2025-01-25 09:36:03,319 (model:870) WARNING: All labels are zero
2025-01-25 09:36:04,177 (model:870) WARNING: All labels are zero
2025-01-25 09:38:13,958 (model:870) WARNING: All labels are zero
2025-01-25 09:38:28,727 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 32298,  validation: loss=0.07532, DER=0.1744, ACC=0.9648, MI=0.1007, FA=0.04912, CF=0.02464, over 0.00 frames.
2025-01-25 09:38:28,727 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 09:38:31,198 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 32298,  validation: loss=0.07372, DER=0.1732, ACC=0.9656, MI=0.09956, FA=0.04991, CF=0.02377, over 0.00 frames.
2025-01-25 09:38:31,199 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 09:56:36,638 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 32798, num_updates: 32000, {'loss': 0.1373017579317093, 'DER': 0.29381356408383436, 'ACC': np.float64(0.944125), 'MI': 0.17682755520593357, 'FA': 0.0591672753834916, 'CF': 0.05781873349440917}, batch size: 64, grad_norm: 0.19283655285835266, grad_scale: , lr: 0.00e+00,
2025-01-25 09:56:36,638 (train_accelerate_ddp:702) INFO: [Train] - Epoch 8, batch_idx_train: 32798, num_updates: 32000, {'loss': 0.12861855328083038, 'DER': 0.28286322511974454, 'ACC': np.float64(0.9418392857142857), 'MI': 0.15848855774348058, 'FA': 0.06056412985630655, 'CF': 0.06381053751995742}, batch size: 64, grad_norm: 0.19283655285835266, grad_scale: , lr: 0.00e+00,
2025-01-25 09:56:36,639 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 09:56:36,639 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 09:57:45,297 (model:870) WARNING: All labels are zero
2025-01-25 09:57:46,108 (model:870) WARNING: All labels are zero
2025-01-25 09:57:47,808 (model:870) WARNING: All labels are zero
2025-01-25 09:59:57,753 (model:870) WARNING: All labels are zero
2025-01-25 10:00:10,465 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 32798,  validation: loss=0.07525, DER=0.1749, ACC=0.9648, MI=0.1013, FA=0.04898, CF=0.02455, over 0.00 frames.
2025-01-25 10:00:10,466 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 10:00:15,090 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 8, batch_idx_train: 32798,  validation: loss=0.07388, DER=0.1737, ACC=0.9656, MI=0.1001, FA=0.04964, CF=0.02388, over 0.00 frames.
2025-01-25 10:00:15,091 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 10:04:23,779 (train_accelerate_ddp:713) INFO: end of epoch 8, batch_idx: 4113 batch_idx_train: 32911, {'loss': 0.10895402729511261, 'DER': 0.2352455633512175, 'ACC': np.float64(0.9568660714285715), 'MI': 0.11237544956075703, 'FA': 0.0732857732445021, 'CF': 0.04958434054595837}, batch size: 64, grad_norm: 0.2654264569282532, grad_scale: , lr: 0.00e+00,
2025-01-25 10:04:23,782 (train_accelerate_ddp:713) INFO: end of epoch 8, batch_idx: 4113 batch_idx_train: 32911, {'loss': 0.09575851261615753, 'DER': 0.2507206416844216, 'ACC': np.float64(0.9574723346345306), 'MI': 0.12495300162927685, 'FA': 0.07883193382629403, 'CF': 0.04693570622885073}, batch size: 64, grad_norm: 0.2654264569282532, grad_scale: , lr: 0.00e+00,
2025-01-25 10:04:23,783 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-8.pt
2025-01-25 10:04:24,217 (train_accelerate_ddp:561) INFO:  end of epoch 8, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-8.pt
2025-01-25 10:04:28,101 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 32912, num_updates: 32000, {'loss': 0.11188115924596786, 'DER': 0.24055722294580667, 'ACC': np.float64(0.9548928571428571), 'MI': 0.1437227476074523, 'FA': 0.0513052834248825, 'CF': 0.045529191913471885}, batch size: 64, grad_norm: 0.20514105260372162, grad_scale: , lr: 0.00e+00,
2025-01-25 10:04:28,105 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 32912, num_updates: 32000, {'loss': 0.11502504348754883, 'DER': 0.27636542561915695, 'ACC': np.float64(0.9467321428571429), 'MI': 0.17013831939205074, 'FA': 0.05642119074954896, 'CF': 0.04980591547755727}, batch size: 64, grad_norm: 0.20514105260372162, grad_scale: , lr: 0.00e+00,
2025-01-25 10:07:39,765 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-33000.pt
2025-01-25 10:07:40,325 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-25 10:07:40,328 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-01-25 10:22:10,332 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 33412, num_updates: 32500, {'loss': 0.11373021453619003, 'DER': 0.25859842704542785, 'ACC': np.float64(0.9516875), 'MI': 0.12419298039676019, 'FA': 0.0754196501936847, 'CF': 0.05898579645498298}, batch size: 64, grad_norm: 0.18269000947475433, grad_scale: , lr: 0.00e+00,
2025-01-25 10:22:10,333 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 10:22:10,333 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 33412, num_updates: 32500, {'loss': 0.09795702248811722, 'DER': 0.24755776542848787, 'ACC': np.float64(0.9575535714285714), 'MI': 0.15156478502486107, 'FA': 0.06545773618016965, 'CF': 0.03053524422345715}, batch size: 64, grad_norm: 0.18269000947475433, grad_scale: , lr: 0.00e+00,
2025-01-25 10:22:10,333 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 10:23:22,712 (model:870) WARNING: All labels are zero
2025-01-25 10:23:23,508 (model:870) WARNING: All labels are zero
2025-01-25 10:23:24,232 (model:870) WARNING: All labels are zero
2025-01-25 10:25:38,071 (model:870) WARNING: All labels are zero
2025-01-25 10:25:51,077 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 33412,  validation: loss=0.07501, DER=0.1737, ACC=0.9649, MI=0.09952, FA=0.04952, CF=0.0247, over 0.00 frames.
2025-01-25 10:25:51,077 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 10:25:55,484 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 33412,  validation: loss=0.07342, DER=0.1727, ACC=0.9657, MI=0.09824, FA=0.05069, CF=0.02381, over 0.00 frames.
2025-01-25 10:25:55,484 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 10:44:11,736 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 33912, num_updates: 33000, {'loss': 0.12715831398963928, 'DER': 0.30703395114209603, 'ACC': np.float64(0.9428125), 'MI': 0.17525364167091764, 'FA': 0.07578076290880235, 'CF': 0.05599954656237601}, batch size: 64, grad_norm: 0.1564394235610962, grad_scale: , lr: 0.00e+00,
2025-01-25 10:44:11,737 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 33912, num_updates: 33000, {'loss': 0.09875071048736572, 'DER': 0.2193007310024367, 'ACC': np.float64(0.9573571428571429), 'MI': 0.10778035926786422, 'FA': 0.06018020060066867, 'CF': 0.05134017113390378}, batch size: 64, grad_norm: 0.1564394235610962, grad_scale: , lr: 0.00e+00,
2025-01-25 10:44:11,737 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 10:44:11,737 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 10:45:20,925 (model:870) WARNING: All labels are zero
2025-01-25 10:45:21,741 (model:870) WARNING: All labels are zero
2025-01-25 10:45:24,430 (model:870) WARNING: All labels are zero
2025-01-25 10:47:38,569 (model:870) WARNING: All labels are zero
2025-01-25 10:47:50,531 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 33912,  validation: loss=0.07487, DER=0.1733, ACC=0.965, MI=0.1007, FA=0.04809, CF=0.02447, over 0.00 frames.
2025-01-25 10:47:50,532 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 10:47:56,179 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 33912,  validation: loss=0.07343, DER=0.1726, ACC=0.9657, MI=0.09954, FA=0.04927, CF=0.02381, over 0.00 frames.
2025-01-25 10:47:56,179 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 11:05:40,553 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 34412, num_updates: 33500, {'loss': 0.13371047377586365, 'DER': 0.29015288508959397, 'ACC': np.float64(0.9450803571428571), 'MI': 0.176886404734506, 'FA': 0.06635980053701572, 'CF': 0.04690667981807222}, batch size: 64, grad_norm: 0.21941648423671722, grad_scale: , lr: 0.00e+00,
2025-01-25 11:05:40,554 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 11:05:40,555 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 34412, num_updates: 33500, {'loss': 0.08884922415018082, 'DER': 0.2049469964664311, 'ACC': np.float64(0.9619107142857143), 'MI': 0.12025176678445229, 'FA': 0.05410777385159011, 'CF': 0.03058745583038869}, batch size: 64, grad_norm: 0.21941648423671722, grad_scale: , lr: 0.00e+00,
2025-01-25 11:05:40,556 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 11:06:52,126 (model:870) WARNING: All labels are zero
2025-01-25 11:06:52,960 (model:870) WARNING: All labels are zero
2025-01-25 11:06:52,978 (model:870) WARNING: All labels are zero
2025-01-25 11:09:06,524 (model:870) WARNING: All labels are zero
2025-01-25 11:09:24,321 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 34412,  validation: loss=0.07495, DER=0.1737, ACC=0.9649, MI=0.09931, FA=0.0496, CF=0.02478, over 0.00 frames.
2025-01-25 11:09:24,321 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 11:09:24,575 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 34412,  validation: loss=0.07346, DER=0.1727, ACC=0.9657, MI=0.09808, FA=0.05043, CF=0.02422, over 0.00 frames.
2025-01-25 11:09:24,575 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 11:12:36,905 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-34500.pt
2025-01-25 11:12:37,467 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-25 11:27:32,583 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 34912, num_updates: 34000, {'loss': 0.12279416620731354, 'DER': 0.28299379982285205, 'ACC': np.float64(0.9443035714285715), 'MI': 0.15483835252435785, 'FA': 0.0658215234720992, 'CF': 0.06233392382639504}, batch size: 64, grad_norm: 0.3627942204475403, grad_scale: , lr: 0.00e+00,
2025-01-25 11:27:32,584 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 11:27:32,584 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 34912, num_updates: 34000, {'loss': 0.11179624497890472, 'DER': 0.2585718589936728, 'ACC': np.float64(0.9539017857142856), 'MI': 0.13570352515818018, 'FA': 0.07032238626092197, 'CF': 0.05254594757457065}, batch size: 64, grad_norm: 0.3627942204475403, grad_scale: , lr: 0.00e+00,
2025-01-25 11:27:32,585 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 11:28:42,455 (model:870) WARNING: All labels are zero
2025-01-25 11:28:43,254 (model:870) WARNING: All labels are zero
2025-01-25 11:28:45,747 (model:870) WARNING: All labels are zero
2025-01-25 11:30:58,186 (model:870) WARNING: All labels are zero
2025-01-25 11:31:07,922 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 34912,  validation: loss=0.07496, DER=0.1736, ACC=0.9649, MI=0.09943, FA=0.04956, CF=0.02457, over 0.00 frames.
2025-01-25 11:31:07,923 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 11:31:15,597 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 34912,  validation: loss=0.0735, DER=0.1727, ACC=0.9657, MI=0.09804, FA=0.05065, CF=0.02398, over 0.00 frames.
2025-01-25 11:31:15,598 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 11:48:43,405 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 35412, num_updates: 34500, {'loss': 0.1097177192568779, 'DER': 0.2584764666517957, 'ACC': np.float64(0.9501696428571429), 'MI': 0.160104840508588, 'FA': 0.04561677448137408, 'CF': 0.05275485166183359}, batch size: 64, grad_norm: 0.1938350349664688, grad_scale: , lr: 0.00e+00,
2025-01-25 11:48:43,406 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 35412, num_updates: 34500, {'loss': 0.08686038106679916, 'DER': 0.2061479576580348, 'ACC': np.float64(0.9642678571428571), 'MI': 0.109323605047545, 'FA': 0.06363255786137192, 'CF': 0.033191794749117876}, batch size: 64, grad_norm: 0.1938350349664688, grad_scale: , lr: 0.00e+00,
2025-01-25 11:48:43,406 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 11:48:43,406 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 11:49:55,053 (model:870) WARNING: All labels are zero
2025-01-25 11:49:55,875 (model:870) WARNING: All labels are zero
2025-01-25 11:49:56,619 (model:870) WARNING: All labels are zero
2025-01-25 11:52:09,026 (model:870) WARNING: All labels are zero
2025-01-25 11:52:23,676 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 35412,  validation: loss=0.0751, DER=0.1741, ACC=0.9649, MI=0.1007, FA=0.04887, CF=0.0246, over 0.00 frames.
2025-01-25 11:52:23,677 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 11:52:26,281 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 35412,  validation: loss=0.07371, DER=0.1735, ACC=0.9656, MI=0.09961, FA=0.04982, CF=0.02408, over 0.00 frames.
2025-01-25 11:52:26,281 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 12:10:23,335 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 35912, num_updates: 35000, {'loss': 0.10761524736881256, 'DER': 0.2496347204935332, 'ACC': np.float64(0.9495267857142856), 'MI': 0.12776665403972076, 'FA': 0.06558796471670544, 'CF': 0.056280101737106986}, batch size: 64, grad_norm: 0.2064884901046753, grad_scale: , lr: 0.00e+00,
2025-01-25 12:10:23,336 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 12:10:23,337 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 35912, num_updates: 35000, {'loss': 0.14246703684329987, 'DER': 0.28727920750563446, 'ACC': np.float64(0.9378392857142857), 'MI': 0.1566119817600503, 'FA': 0.053042612296241944, 'CF': 0.07762461344934221}, batch size: 64, grad_norm: 0.2064884901046753, grad_scale: , lr: 0.00e+00,
2025-01-25 12:10:23,337 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 12:11:32,657 (model:870) WARNING: All labels are zero
2025-01-25 12:11:33,456 (model:870) WARNING: All labels are zero
2025-01-25 12:11:34,570 (model:870) WARNING: All labels are zero
2025-01-25 12:13:43,822 (model:870) WARNING: All labels are zero
2025-01-25 12:13:57,924 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 35912,  validation: loss=0.07506, DER=0.1737, ACC=0.9649, MI=0.09988, FA=0.04922, CF=0.02464, over 0.00 frames.
2025-01-25 12:13:57,924 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 12:14:00,883 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 35912,  validation: loss=0.07358, DER=0.1731, ACC=0.9657, MI=0.09904, FA=0.05033, CF=0.02377, over 0.00 frames.
2025-01-25 12:14:00,884 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 12:17:07,136 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-36000.pt
2025-01-25 12:17:07,698 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-25 12:32:06,034 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 36412, num_updates: 35500, {'loss': 0.11537221074104309, 'DER': 0.2675849941383353, 'ACC': np.float64(0.9534910714285715), 'MI': 0.16494724501758498, 'FA': 0.06488862837045721, 'CF': 0.03774912075029308}, batch size: 64, grad_norm: 0.192462757229805, grad_scale: , lr: 0.00e+00,
2025-01-25 12:32:06,035 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 12:32:06,037 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 36412, num_updates: 35500, {'loss': 0.08043129742145538, 'DER': 0.18454813805631246, 'ACC': np.float64(0.9662678571428571), 'MI': 0.08497956403269755, 'FA': 0.0696525885558583, 'CF': 0.029915985467756586}, batch size: 64, grad_norm: 0.192462757229805, grad_scale: , lr: 0.00e+00,
2025-01-25 12:32:06,037 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 12:33:18,022 (model:870) WARNING: All labels are zero
2025-01-25 12:33:18,859 (model:870) WARNING: All labels are zero
2025-01-25 12:33:20,483 (model:870) WARNING: All labels are zero
2025-01-25 12:35:34,529 (model:870) WARNING: All labels are zero
2025-01-25 12:35:46,140 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 36412,  validation: loss=0.07484, DER=0.1732, ACC=0.9649, MI=0.09913, FA=0.04944, CF=0.02462, over 0.00 frames.
2025-01-25 12:35:46,141 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 12:35:52,069 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 36412,  validation: loss=0.07335, DER=0.1724, ACC=0.9657, MI=0.09793, FA=0.05046, CF=0.02403, over 0.00 frames.
2025-01-25 12:35:52,069 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 12:53:46,888 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 36912, num_updates: 36000, {'loss': 0.11299154162406921, 'DER': 0.25516454479942347, 'ACC': np.float64(0.9543482142857144), 'MI': 0.14160461205861158, 'FA': 0.06167427336055729, 'CF': 0.05188565938025463}, batch size: 64, grad_norm: 0.22342808544635773, grad_scale: , lr: 0.00e+00,
2025-01-25 12:53:46,889 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 12:53:46,890 (train_accelerate_ddp:702) INFO: [Train] - Epoch 9, batch_idx_train: 36912, num_updates: 36000, {'loss': 0.12841731309890747, 'DER': 0.306965410673957, 'ACC': np.float64(0.9440947202057272), 'MI': 0.17467015333412575, 'FA': 0.06715796980862951, 'CF': 0.06513728753120171}, batch size: 64, grad_norm: 0.22342808544635773, grad_scale: , lr: 0.00e+00,
2025-01-25 12:53:46,890 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 12:54:59,355 (model:870) WARNING: All labels are zero
2025-01-25 12:55:00,187 (model:870) WARNING: All labels are zero
2025-01-25 12:55:01,211 (model:870) WARNING: All labels are zero
2025-01-25 12:57:14,247 (model:870) WARNING: All labels are zero
2025-01-25 12:57:28,437 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 36912,  validation: loss=0.075, DER=0.1737, ACC=0.9649, MI=0.1003, FA=0.0488, CF=0.02464, over 0.00 frames.
2025-01-25 12:57:28,438 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 12:57:32,133 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 9, batch_idx_train: 36912,  validation: loss=0.07355, DER=0.1729, ACC=0.9657, MI=0.09921, FA=0.0498, CF=0.0239, over 0.00 frames.
2025-01-25 12:57:32,133 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 13:01:33,856 (train_accelerate_ddp:713) INFO: end of epoch 9, batch_idx: 4113 batch_idx_train: 37025, {'loss': 0.11469884216785431, 'DER': 0.25592391005552806, 'ACC': np.float64(0.9507321428571429), 'MI': 0.15558854252570234, 'FA': 0.0528891088020232, 'CF': 0.04744625872780252}, batch size: 64, grad_norm: 0.16820776462554932, grad_scale: , lr: 0.00e+00,
2025-01-25 13:01:33,856 (train_accelerate_ddp:713) INFO: end of epoch 9, batch_idx: 4113 batch_idx_train: 37025, {'loss': 0.11091528087854385, 'DER': 0.246162191483591, 'ACC': np.float64(0.9517232142857144), 'MI': 0.14401952807160293, 'FA': 0.05500406834825061, 'CF': 0.04713859506373746}, batch size: 64, grad_norm: 0.16820776462554932, grad_scale: , lr: 0.00e+00,
2025-01-25 13:01:33,858 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-9.pt
2025-01-25 13:01:34,267 (train_accelerate_ddp:561) INFO:  end of epoch 9, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-9.pt
2025-01-25 13:01:37,579 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 37026, num_updates: 36000, {'loss': 0.10737376660108566, 'DER': 0.23374714145704018, 'ACC': np.float64(0.9567142857142856), 'MI': 0.13987803550038114, 'FA': 0.06365022323859305, 'CF': 0.03021888271806599}, batch size: 64, grad_norm: 0.2504119277000427, grad_scale: , lr: 0.00e+00,
2025-01-25 13:01:37,579 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 37026, num_updates: 36000, {'loss': 0.10066460072994232, 'DER': 0.22833454369402081, 'ACC': np.float64(0.9613303571428571), 'MI': 0.1134713144517066, 'FA': 0.08109416606148633, 'CF': 0.03376906318082789}, batch size: 64, grad_norm: 0.2504119277000427, grad_scale: , lr: 0.00e+00,
2025-01-25 13:19:09,653 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-37500.pt
2025-01-25 13:19:10,183 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-25 13:19:10,186 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-01-25 13:20:08,060 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 37526, num_updates: 36500, {'loss': 0.11756058037281036, 'DER': 0.2754537838592572, 'ACC': np.float64(0.9470714285714286), 'MI': 0.15085171739737505, 'FA': 0.06897514660709299, 'CF': 0.05562691985478917}, batch size: 64, grad_norm: 0.19628871977329254, grad_scale: , lr: 0.00e+00,
2025-01-25 13:20:08,061 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 37526, num_updates: 36500, {'loss': 0.0894002914428711, 'DER': 0.20401845332038362, 'ACC': np.float64(0.9639180804131846), 'MI': 0.09669782687871797, 'FA': 0.06707539152604103, 'CF': 0.04024523491562462}, batch size: 64, grad_norm: 0.19628871977329254, grad_scale: , lr: 0.00e+00,
2025-01-25 13:20:08,061 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 13:20:08,061 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 13:21:16,355 (model:870) WARNING: All labels are zero
2025-01-25 13:21:17,165 (model:870) WARNING: All labels are zero
2025-01-25 13:21:19,389 (model:870) WARNING: All labels are zero
2025-01-25 13:23:28,426 (model:870) WARNING: All labels are zero
2025-01-25 13:23:38,555 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 37526,  validation: loss=0.07511, DER=0.1737, ACC=0.9649, MI=0.101, FA=0.048, CF=0.02465, over 0.00 frames.
2025-01-25 13:23:38,556 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 13:23:45,518 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 37526,  validation: loss=0.07353, DER=0.1732, ACC=0.9657, MI=0.1, FA=0.04937, CF=0.02382, over 0.00 frames.
2025-01-25 13:23:45,519 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 13:41:15,613 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 38026, num_updates: 37000, {'loss': 0.08700679987668991, 'DER': 0.22123893805309736, 'ACC': np.float64(0.962780068112565), 'MI': 0.11976401179941003, 'FA': 0.07769911504424779, 'CF': 0.02377581120943953}, batch size: 64, grad_norm: 0.18610814213752747, grad_scale: , lr: 0.00e+00,
2025-01-25 13:41:15,613 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 38026, num_updates: 37000, {'loss': 0.09947232902050018, 'DER': 0.24306543385490753, 'ACC': np.float64(0.9553035714285715), 'MI': 0.134009009009009, 'FA': 0.05541725936462778, 'CF': 0.05363916548127074}, batch size: 64, grad_norm: 0.18610814213752747, grad_scale: , lr: 0.00e+00,
2025-01-25 13:41:15,614 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 13:41:15,614 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 13:42:23,293 (model:870) WARNING: All labels are zero
2025-01-25 13:42:24,075 (model:870) WARNING: All labels are zero
2025-01-25 13:42:26,245 (model:870) WARNING: All labels are zero
2025-01-25 13:44:34,134 (model:870) WARNING: All labels are zero
2025-01-25 13:44:44,287 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 38026,  validation: loss=0.07502, DER=0.1739, ACC=0.9649, MI=0.09984, FA=0.04947, CF=0.02459, over 0.00 frames.
2025-01-25 13:44:44,287 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 13:44:51,088 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 38026,  validation: loss=0.07343, DER=0.1727, ACC=0.9657, MI=0.09891, FA=0.05026, CF=0.02354, over 0.00 frames.
2025-01-25 13:44:51,089 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 14:02:12,771 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 38526, num_updates: 37500, {'loss': 0.10627022385597229, 'DER': 0.23292123744848803, 'ACC': np.float64(0.9581973862100045), 'MI': 0.13483080852051774, 'FA': 0.06181438272679784, 'CF': 0.03627604620117244}, batch size: 64, grad_norm: 0.1367284655570984, grad_scale: , lr: 0.00e+00,
2025-01-25 14:02:12,772 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 38526, num_updates: 37500, {'loss': 0.09205690771341324, 'DER': 0.2120253164556962, 'ACC': np.float64(0.9616696428571428), 'MI': 0.11460216998191682, 'FA': 0.0668512658227848, 'CF': 0.030571880650994573}, batch size: 64, grad_norm: 0.1367284655570984, grad_scale: , lr: 0.00e+00,
2025-01-25 14:02:12,772 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 14:02:12,772 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 14:03:21,539 (model:870) WARNING: All labels are zero
2025-01-25 14:03:22,331 (model:870) WARNING: All labels are zero
2025-01-25 14:03:23,828 (model:870) WARNING: All labels are zero
2025-01-25 14:05:32,755 (model:870) WARNING: All labels are zero
2025-01-25 14:05:45,096 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 38526,  validation: loss=0.0751, DER=0.174, ACC=0.9648, MI=0.1004, FA=0.04899, CF=0.02466, over 0.00 frames.
2025-01-25 14:05:45,097 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 14:05:49,874 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 38526,  validation: loss=0.07362, DER=0.1732, ACC=0.9656, MI=0.09922, FA=0.05007, CF=0.02394, over 0.00 frames.
2025-01-25 14:05:49,874 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 14:22:11,084 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-39000.pt
2025-01-25 14:22:11,623 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-25 14:23:06,409 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 39026, num_updates: 38000, {'loss': 0.09310349076986313, 'DER': 0.23635421464762782, 'ACC': np.float64(0.959), 'MI': 0.1467065868263473, 'FA': 0.06160755412252418, 'CF': 0.028040073698756333}, batch size: 64, grad_norm: 0.1410382241010666, grad_scale: , lr: 0.00e+00,
2025-01-25 14:23:06,410 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 39026, num_updates: 38000, {'loss': 0.1043575331568718, 'DER': 0.24682375328818493, 'ACC': np.float64(0.9550922718397682), 'MI': 0.13337437734370627, 'FA': 0.08093132590809873, 'CF': 0.03251805003637992}, batch size: 64, grad_norm: 0.1410382241010666, grad_scale: , lr: 0.00e+00,
2025-01-25 14:23:06,410 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 14:23:06,410 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 14:24:14,591 (model:870) WARNING: All labels are zero
2025-01-25 14:24:15,378 (model:870) WARNING: All labels are zero
2025-01-25 14:24:17,450 (model:870) WARNING: All labels are zero
2025-01-25 14:26:26,205 (model:870) WARNING: All labels are zero
2025-01-25 14:26:37,153 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 39026,  validation: loss=0.07527, DER=0.1742, ACC=0.9648, MI=0.09952, FA=0.05012, CF=0.0246, over 0.00 frames.
2025-01-25 14:26:37,153 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 14:26:43,289 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 39026,  validation: loss=0.07378, DER=0.1732, ACC=0.9656, MI=0.09831, FA=0.05091, CF=0.02398, over 0.00 frames.
2025-01-25 14:26:43,289 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 14:44:58,831 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 39526, num_updates: 38500, {'loss': 0.14385205507278442, 'DER': 0.3035255534298989, 'ACC': np.float64(0.9367857142857143), 'MI': 0.1728887674227931, 'FA': 0.047171358294616016, 'CF': 0.08346542771248976}, batch size: 64, grad_norm: 0.26085132360458374, grad_scale: , lr: 0.00e+00,
2025-01-25 14:44:58,832 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 14:44:58,832 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 39526, num_updates: 38500, {'loss': 0.10206076502799988, 'DER': 0.22921899294342782, 'ACC': np.float64(0.9569107142857143), 'MI': 0.1161344336801818, 'FA': 0.05370171032173185, 'CF': 0.059382848941514174}, batch size: 64, grad_norm: 0.26085132360458374, grad_scale: , lr: 0.00e+00,
2025-01-25 14:44:58,832 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 14:46:07,478 (model:870) WARNING: All labels are zero
2025-01-25 14:46:08,281 (model:870) WARNING: All labels are zero
2025-01-25 14:46:10,105 (model:870) WARNING: All labels are zero
2025-01-25 14:48:18,479 (model:870) WARNING: All labels are zero
2025-01-25 14:48:29,542 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 39526,  validation: loss=0.07508, DER=0.1739, ACC=0.9649, MI=0.0983, FA=0.05072, CF=0.02488, over 0.00 frames.
2025-01-25 14:48:29,542 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 14:48:35,463 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 39526,  validation: loss=0.07367, DER=0.1732, ACC=0.9656, MI=0.09748, FA=0.05137, CF=0.0243, over 0.00 frames.
2025-01-25 14:48:35,463 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 15:05:55,648 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 40026, num_updates: 39000, {'loss': 0.10068829357624054, 'DER': 0.24976070830342187, 'ACC': np.float64(0.9547232142857144), 'MI': 0.1076214405360134, 'FA': 0.08853792773390763, 'CF': 0.05360134003350084}, batch size: 64, grad_norm: 0.19840115308761597, grad_scale: , lr: 0.00e+00,
2025-01-25 15:05:55,648 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 40026, num_updates: 39000, {'loss': 0.09567183256149292, 'DER': 0.20667771997027043, 'ACC': np.float64(0.9618789943461182), 'MI': 0.11611686009947973, 'FA': 0.054771025098622146, 'CF': 0.035789834772168544}, batch size: 64, grad_norm: 0.19840115308761597, grad_scale: , lr: 0.00e+00,
2025-01-25 15:05:55,649 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 15:05:55,649 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 15:07:03,526 (model:870) WARNING: All labels are zero
2025-01-25 15:07:04,309 (model:870) WARNING: All labels are zero
2025-01-25 15:07:05,890 (model:870) WARNING: All labels are zero
2025-01-25 15:09:12,823 (model:870) WARNING: All labels are zero
2025-01-25 15:09:24,778 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 40026,  validation: loss=0.07509, DER=0.1742, ACC=0.9649, MI=0.1, FA=0.04953, CF=0.02459, over 0.00 frames.
2025-01-25 15:09:24,779 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 15:09:29,712 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 40026,  validation: loss=0.07367, DER=0.173, ACC=0.9657, MI=0.09919, FA=0.05011, CF=0.02374, over 0.00 frames.
2025-01-25 15:09:29,712 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 15:25:52,247 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-40500.pt
2025-01-25 15:25:52,754 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-25 15:26:48,861 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 40526, num_updates: 39500, {'loss': 0.09893788397312164, 'DER': 0.23977272727272728, 'ACC': np.float64(0.96), 'MI': 0.11773989898989899, 'FA': 0.07897727272727273, 'CF': 0.043055555555555555}, batch size: 64, grad_norm: 0.18892943859100342, grad_scale: , lr: 0.00e+00,
2025-01-25 15:26:48,861 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 15:26:48,863 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 40526, num_updates: 39500, {'loss': 0.11955475807189941, 'DER': 0.26236030659411386, 'ACC': np.float64(0.9524553571428571), 'MI': 0.1542332221637119, 'FA': 0.05891989936223743, 'CF': 0.04920718506816453}, batch size: 64, grad_norm: 0.18892943859100342, grad_scale: , lr: 0.00e+00,
2025-01-25 15:26:48,863 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 15:27:56,540 (model:870) WARNING: All labels are zero
2025-01-25 15:27:57,330 (model:870) WARNING: All labels are zero
2025-01-25 15:27:59,598 (model:870) WARNING: All labels are zero
2025-01-25 15:30:07,418 (model:870) WARNING: All labels are zero
2025-01-25 15:30:17,721 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 40526,  validation: loss=0.07508, DER=0.1738, ACC=0.9649, MI=0.09714, FA=0.05166, CF=0.02498, over 0.00 frames.
2025-01-25 15:30:17,721 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 15:30:24,367 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 40526,  validation: loss=0.07363, DER=0.1729, ACC=0.9656, MI=0.09601, FA=0.0525, CF=0.02435, over 0.00 frames.
2025-01-25 15:30:24,367 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 15:47:48,503 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 41026, num_updates: 40000, {'loss': 0.11389411240816116, 'DER': 0.24612351468002344, 'ACC': np.float64(0.9515), 'MI': 0.15164917141791442, 'FA': 0.05115362071721639, 'CF': 0.04332072254489263}, batch size: 64, grad_norm: 0.26917657256126404, grad_scale: , lr: 0.00e+00,
2025-01-25 15:47:48,503 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 15:47:48,503 (train_accelerate_ddp:702) INFO: [Train] - Epoch 10, batch_idx_train: 41026, num_updates: 40000, {'loss': 0.10493181645870209, 'DER': 0.20371625437704732, 'ACC': np.float64(0.9611875), 'MI': 0.10962385631989156, 'FA': 0.0522986558228849, 'CF': 0.04179374223427087}, batch size: 64, grad_norm: 0.26917657256126404, grad_scale: , lr: 0.00e+00,
2025-01-25 15:47:48,503 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 15:48:57,014 (model:870) WARNING: All labels are zero
2025-01-25 15:48:57,797 (model:870) WARNING: All labels are zero
2025-01-25 15:48:58,645 (model:870) WARNING: All labels are zero
2025-01-25 15:51:05,315 (model:870) WARNING: All labels are zero
2025-01-25 15:51:19,940 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 41026,  validation: loss=0.07511, DER=0.1746, ACC=0.9648, MI=0.1021, FA=0.04791, CF=0.02463, over 0.00 frames.
2025-01-25 15:51:19,941 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 15:51:22,134 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 10, batch_idx_train: 41026,  validation: loss=0.07361, DER=0.1734, ACC=0.9656, MI=0.1007, FA=0.04879, CF=0.02393, over 0.00 frames.
2025-01-25 15:51:22,134 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 15:55:17,188 (train_accelerate_ddp:713) INFO: end of epoch 10, batch_idx: 4113 batch_idx_train: 41139, {'loss': 0.11708486080169678, 'DER': 0.24421153948986685, 'ACC': np.float64(0.9509821428571429), 'MI': 0.14148975990588739, 'FA': 0.05336613015346773, 'CF': 0.04935564943051174}, batch size: 64, grad_norm: 0.1896221935749054, grad_scale: , lr: 0.00e+00,
2025-01-25 15:55:17,189 (train_accelerate_ddp:713) INFO: end of epoch 10, batch_idx: 4113 batch_idx_train: 41139, {'loss': 0.10531459748744965, 'DER': 0.252910928541876, 'ACC': np.float64(0.9528303571428571), 'MI': 0.11318635853182812, 'FA': 0.08038300135941841, 'CF': 0.05934156865062947}, batch size: 64, grad_norm: 0.1896221935749054, grad_scale: , lr: 0.00e+00,
2025-01-25 15:55:17,191 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-10.pt
2025-01-25 15:55:17,583 (train_accelerate_ddp:561) INFO:  end of epoch 10, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-10.pt
2025-01-25 15:55:20,968 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 41140, num_updates: 40000, {'loss': 0.12625503540039062, 'DER': 0.28456950051214075, 'ACC': np.float64(0.9463035714285715), 'MI': 0.14996686148099053, 'FA': 0.05681749713803699, 'CF': 0.07778514189311321}, batch size: 64, grad_norm: 0.236982524394989, grad_scale: , lr: 0.00e+00,
2025-01-25 15:55:20,969 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 41140, num_updates: 40000, {'loss': 0.10167837888002396, 'DER': 0.2320213080793134, 'ACC': np.float64(0.9588392857142857), 'MI': 0.13802900266350993, 'FA': 0.05315182006510802, 'CF': 0.040840485350695475}, batch size: 64, grad_norm: 0.236982524394989, grad_scale: , lr: 0.00e+00,
2025-01-25 16:12:36,365 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 41640, num_updates: 40500, {'loss': 0.10450685024261475, 'DER': 0.24299165418360796, 'ACC': np.float64(0.9530089285714286), 'MI': 0.14530280333832657, 'FA': 0.05911619944361224, 'CF': 0.03857265140166916}, batch size: 64, grad_norm: 0.19934052228927612, grad_scale: , lr: 0.00e+00,
2025-01-25 16:12:36,365 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 41640, num_updates: 40500, {'loss': 0.11305388808250427, 'DER': 0.2872185220424992, 'ACC': np.float64(0.9505172460362478), 'MI': 0.13307960672375516, 'FA': 0.09273707580082462, 'CF': 0.06140183951791944}, batch size: 64, grad_norm: 0.19934052228927612, grad_scale: , lr: 0.00e+00,
2025-01-25 16:12:36,366 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 16:12:36,366 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 16:13:45,959 (model:870) WARNING: All labels are zero
2025-01-25 16:13:46,752 (model:870) WARNING: All labels are zero
2025-01-25 16:13:47,656 (model:870) WARNING: All labels are zero
2025-01-25 16:15:56,548 (model:870) WARNING: All labels are zero
2025-01-25 16:16:10,912 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 41640,  validation: loss=0.07505, DER=0.1743, ACC=0.9649, MI=0.1004, FA=0.04938, CF=0.02449, over 0.00 frames.
2025-01-25 16:16:10,913 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 16:16:13,639 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 41640,  validation: loss=0.07357, DER=0.1731, ACC=0.9656, MI=0.09911, FA=0.0502, CF=0.02383, over 0.00 frames.
2025-01-25 16:16:13,639 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 16:28:49,533 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-42000.pt
2025-01-25 16:28:50,077 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-25 16:28:50,111 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-01-25 16:33:49,180 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 42140, num_updates: 41000, {'loss': 0.09942321479320526, 'DER': 0.22459286160131647, 'ACC': np.float64(0.9584910714285715), 'MI': 0.12489360494807922, 'FA': 0.060489133518697155, 'CF': 0.03921012313454009}, batch size: 64, grad_norm: 0.29184362292289734, grad_scale: , lr: 0.00e+00,
2025-01-25 16:33:49,180 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 42140, num_updates: 41000, {'loss': 0.13713353872299194, 'DER': 0.2807606870022214, 'ACC': np.float64(0.9449464285714285), 'MI': 0.18421195210489244, 'FA': 0.04323562875873652, 'CF': 0.05331310613859241}, batch size: 64, grad_norm: 0.29184362292289734, grad_scale: , lr: 0.00e+00,
2025-01-25 16:33:49,181 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 16:33:49,181 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 16:34:57,649 (model:870) WARNING: All labels are zero
2025-01-25 16:34:58,444 (model:870) WARNING: All labels are zero
2025-01-25 16:35:01,271 (model:870) WARNING: All labels are zero
2025-01-25 16:37:11,224 (model:870) WARNING: All labels are zero
2025-01-25 16:37:20,053 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 42140,  validation: loss=0.07504, DER=0.1736, ACC=0.9649, MI=0.09958, FA=0.04933, CF=0.0247, over 0.00 frames.
2025-01-25 16:37:20,054 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 16:37:28,458 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 42140,  validation: loss=0.07354, DER=0.1731, ACC=0.9656, MI=0.09862, FA=0.05053, CF=0.02395, over 0.00 frames.
2025-01-25 16:37:28,459 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 16:54:58,758 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 42640, num_updates: 41500, {'loss': 0.1173635721206665, 'DER': 0.27430249632892806, 'ACC': np.float64(0.9476339285714286), 'MI': 0.13262848751835535, 'FA': 0.07148311306901615, 'CF': 0.07019089574155653}, batch size: 64, grad_norm: 0.20984956622123718, grad_scale: , lr: 0.00e+00,
2025-01-25 16:54:58,759 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 42640, num_updates: 41500, {'loss': 0.11992188543081284, 'DER': 0.3006087830250015, 'ACC': np.float64(0.9473401300818834), 'MI': 0.17625155151013652, 'FA': 0.0775459542526154, 'CF': 0.04681127726224954}, batch size: 64, grad_norm: 0.20984956622123718, grad_scale: , lr: 0.00e+00,
2025-01-25 16:54:58,759 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 16:54:58,759 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 16:56:07,536 (model:870) WARNING: All labels are zero
2025-01-25 16:56:08,344 (model:870) WARNING: All labels are zero
2025-01-25 16:56:10,662 (model:870) WARNING: All labels are zero
2025-01-25 16:58:20,797 (model:870) WARNING: All labels are zero
2025-01-25 16:58:30,851 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 42640,  validation: loss=0.0748, DER=0.1733, ACC=0.965, MI=0.09884, FA=0.04978, CF=0.02463, over 0.00 frames.
2025-01-25 16:58:30,851 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 16:58:38,033 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 42640,  validation: loss=0.07331, DER=0.1727, ACC=0.9657, MI=0.09796, FA=0.05073, CF=0.02397, over 0.00 frames.
2025-01-25 16:58:38,034 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 17:16:08,561 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 43140, num_updates: 42000, {'loss': 0.12532702088356018, 'DER': 0.2649400275979195, 'ACC': np.float64(0.9490803571428571), 'MI': 0.1804479354633266, 'FA': 0.04675724445387963, 'CF': 0.0377348476807133}, batch size: 64, grad_norm: 0.15805433690547943, grad_scale: , lr: 0.00e+00,
2025-01-25 17:16:08,561 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 17:16:08,561 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 43140, num_updates: 42000, {'loss': 0.10615456104278564, 'DER': 0.25188081274805996, 'ACC': np.float64(0.9560803571428571), 'MI': 0.1355369942538949, 'FA': 0.07683194123570879, 'CF': 0.03951187725845625}, batch size: 64, grad_norm: 0.15805433690547943, grad_scale: , lr: 0.00e+00,
2025-01-25 17:16:08,561 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 17:17:17,529 (model:870) WARNING: All labels are zero
2025-01-25 17:17:18,334 (model:870) WARNING: All labels are zero
2025-01-25 17:17:20,929 (model:870) WARNING: All labels are zero
2025-01-25 17:19:31,102 (model:870) WARNING: All labels are zero
2025-01-25 17:19:40,660 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 43140,  validation: loss=0.07501, DER=0.174, ACC=0.9649, MI=0.0991, FA=0.05007, CF=0.0248, over 0.00 frames.
2025-01-25 17:19:40,661 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 17:19:48,359 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 43140,  validation: loss=0.07358, DER=0.1729, ACC=0.9657, MI=0.09823, FA=0.05061, CF=0.02407, over 0.00 frames.
2025-01-25 17:19:48,359 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 17:32:24,748 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-43500.pt
2025-01-25 17:32:25,383 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-25 17:37:20,190 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 43640, num_updates: 42500, {'loss': 0.11200462281703949, 'DER': 0.2876027152554484, 'ACC': np.float64(0.9478749932724566), 'MI': 0.15410265571037277, 'FA': 0.07508634035965225, 'CF': 0.05841371918542337}, batch size: 64, grad_norm: 0.20380109548568726, grad_scale: , lr: 0.00e+00,
2025-01-25 17:37:20,191 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 17:37:20,194 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 43640, num_updates: 42500, {'loss': 0.11435152590274811, 'DER': 0.2743202062822316, 'ACC': np.float64(0.9509107142857144), 'MI': 0.14873417721518986, 'FA': 0.07770745428973277, 'CF': 0.04787857477730895}, batch size: 64, grad_norm: 0.20380109548568726, grad_scale: , lr: 0.00e+00,
2025-01-25 17:37:20,194 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 17:38:28,990 (model:870) WARNING: All labels are zero
2025-01-25 17:38:29,787 (model:870) WARNING: All labels are zero
2025-01-25 17:38:31,179 (model:870) WARNING: All labels are zero
2025-01-25 17:40:39,724 (model:870) WARNING: All labels are zero
2025-01-25 17:40:52,822 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 43640,  validation: loss=0.0751, DER=0.1741, ACC=0.9648, MI=0.09856, FA=0.05065, CF=0.0249, over 0.00 frames.
2025-01-25 17:40:52,823 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 17:40:56,778 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 43640,  validation: loss=0.07362, DER=0.1732, ACC=0.9656, MI=0.09745, FA=0.05143, CF=0.02428, over 0.00 frames.
2025-01-25 17:40:56,778 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 17:58:31,411 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 44140, num_updates: 43000, {'loss': 0.10351606458425522, 'DER': 0.2354414909868622, 'ACC': np.float64(0.9582254648152507), 'MI': 0.1235563703024748, 'FA': 0.06532233424992362, 'CF': 0.04656278643446379}, batch size: 64, grad_norm: 0.18671287596225739, grad_scale: , lr: 0.00e+00,
2025-01-25 17:58:31,412 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 17:58:31,413 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 44140, num_updates: 43000, {'loss': 0.1283455491065979, 'DER': 0.26881433676462746, 'ACC': np.float64(0.9460714285714286), 'MI': 0.15376820097071844, 'FA': 0.061709957864419435, 'CF': 0.053336177929489574}, batch size: 64, grad_norm: 0.18671287596225739, grad_scale: , lr: 0.00e+00,
2025-01-25 17:58:31,413 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 17:59:39,929 (model:870) WARNING: All labels are zero
2025-01-25 17:59:40,729 (model:870) WARNING: All labels are zero
2025-01-25 17:59:43,515 (model:870) WARNING: All labels are zero
2025-01-25 18:01:53,687 (model:870) WARNING: All labels are zero
2025-01-25 18:02:02,784 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 44140,  validation: loss=0.07511, DER=0.1739, ACC=0.9649, MI=0.1001, FA=0.04914, CF=0.02466, over 0.00 frames.
2025-01-25 18:02:02,784 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 18:02:11,069 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 44140,  validation: loss=0.07367, DER=0.1733, ACC=0.9656, MI=0.09908, FA=0.05016, CF=0.02404, over 0.00 frames.
2025-01-25 18:02:11,070 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 18:19:40,026 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 44640, num_updates: 43500, {'loss': 0.12531070411205292, 'DER': 0.2640557696667422, 'ACC': np.float64(0.9529285714285715), 'MI': 0.16079120380866016, 'FA': 0.06852187712536839, 'CF': 0.03474268873271367}, batch size: 64, grad_norm: 0.19148099422454834, grad_scale: , lr: 0.00e+00,
2025-01-25 18:19:40,027 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 18:19:40,028 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 44640, num_updates: 43500, {'loss': 0.11369018256664276, 'DER': 0.2456150374221562, 'ACC': np.float64(0.9544285714285714), 'MI': 0.1395189396103525, 'FA': 0.06010398217448437, 'CF': 0.045992115637319315}, batch size: 64, grad_norm: 0.19148099422454834, grad_scale: , lr: 0.00e+00,
2025-01-25 18:19:40,029 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 18:20:48,342 (model:870) WARNING: All labels are zero
2025-01-25 18:20:49,127 (model:870) WARNING: All labels are zero
2025-01-25 18:20:51,974 (model:870) WARNING: All labels are zero
2025-01-25 18:23:01,809 (model:870) WARNING: All labels are zero
2025-01-25 18:23:11,263 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 44640,  validation: loss=0.07494, DER=0.1736, ACC=0.9649, MI=0.09906, FA=0.04965, CF=0.02484, over 0.00 frames.
2025-01-25 18:23:11,263 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 18:23:19,048 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 44640,  validation: loss=0.07352, DER=0.1726, ACC=0.9657, MI=0.09783, FA=0.05053, CF=0.02424, over 0.00 frames.
2025-01-25 18:23:19,049 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 18:35:55,124 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-45000.pt
2025-01-25 18:35:55,663 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-25 18:40:48,491 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 45140, num_updates: 44000, {'loss': 0.10732173919677734, 'DER': 0.24774507476857346, 'ACC': np.float64(0.9554642857142857), 'MI': 0.137669119392357, 'FA': 0.061832423451222404, 'CF': 0.04824353192499407}, batch size: 64, grad_norm: 0.20144818723201752, grad_scale: , lr: 0.00e+00,
2025-01-25 18:40:48,492 (train_accelerate_ddp:702) INFO: [Train] - Epoch 11, batch_idx_train: 45140, num_updates: 44000, {'loss': 0.1376618891954422, 'DER': 0.29340745732255163, 'ACC': np.float64(0.9428928571428571), 'MI': 0.16863207547169812, 'FA': 0.05901841868823001, 'CF': 0.06575696316262354}, batch size: 64, grad_norm: 0.20144818723201752, grad_scale: , lr: 0.00e+00,
2025-01-25 18:40:48,492 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 18:40:48,492 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 18:41:58,143 (model:870) WARNING: All labels are zero
2025-01-25 18:41:58,946 (model:870) WARNING: All labels are zero
2025-01-25 18:41:59,320 (model:870) WARNING: All labels are zero
2025-01-25 18:44:07,729 (model:870) WARNING: All labels are zero
2025-01-25 18:44:23,811 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 45140,  validation: loss=0.07504, DER=0.1738, ACC=0.9649, MI=0.09729, FA=0.05147, CF=0.025, over 0.00 frames.
2025-01-25 18:44:23,812 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 18:44:24,848 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 11, batch_idx_train: 45140,  validation: loss=0.07364, DER=0.173, ACC=0.9656, MI=0.09628, FA=0.05235, CF=0.02441, over 0.00 frames.
2025-01-25 18:44:24,848 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 18:48:22,379 (train_accelerate_ddp:713) INFO: end of epoch 11, batch_idx: 4113 batch_idx_train: 45253, {'loss': 0.11246100813150406, 'DER': 0.2484076433121019, 'ACC': np.float64(0.9531785714285714), 'MI': 0.1500796178343949, 'FA': 0.04851000909918107, 'CF': 0.04981801637852593}, batch size: 64, grad_norm: 0.22224313020706177, grad_scale: , lr: 0.00e+00,
2025-01-25 18:48:22,379 (train_accelerate_ddp:713) INFO: end of epoch 11, batch_idx: 4113 batch_idx_train: 45253, {'loss': 0.11975624412298203, 'DER': 0.2887624466571835, 'ACC': np.float64(0.9441428571428571), 'MI': 0.13928402086296823, 'FA': 0.06744902797534376, 'CF': 0.0820293978188715}, batch size: 64, grad_norm: 0.22224313020706177, grad_scale: , lr: 0.00e+00,
2025-01-25 18:48:22,381 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-11.pt
2025-01-25 18:48:22,819 (train_accelerate_ddp:561) INFO:  end of epoch 11, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-11.pt
2025-01-25 18:48:26,122 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 45254, num_updates: 44000, {'loss': 0.11806078255176544, 'DER': 0.26018878400888396, 'ACC': np.float64(0.95125), 'MI': 0.1631871182676291, 'FA': 0.05402554136590783, 'CF': 0.04297612437534703}, batch size: 64, grad_norm: 0.19760312139987946, grad_scale: , lr: 0.00e+00,
2025-01-25 18:48:26,122 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 45254, num_updates: 44000, {'loss': 0.09684403240680695, 'DER': 0.24252452428790924, 'ACC': np.float64(0.9571607142857144), 'MI': 0.1370996336130481, 'FA': 0.06441318993026829, 'CF': 0.04101170074459284}, batch size: 64, grad_norm: 0.19760312139987946, grad_scale: , lr: 0.00e+00,
2025-01-25 19:06:02,162 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 45754, num_updates: 44500, {'loss': 0.09697605669498444, 'DER': 0.23625894259291572, 'ACC': np.float64(0.9608303571428571), 'MI': 0.1481416855697086, 'FA': 0.06921421508753563, 'CF': 0.018903041935671494}, batch size: 64, grad_norm: 0.17571835219860077, grad_scale: , lr: 0.00e+00,
2025-01-25 19:06:02,162 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 19:06:02,162 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 45754, num_updates: 44500, {'loss': 0.11699036508798599, 'DER': 0.2371413390010627, 'ACC': np.float64(0.9561607142857144), 'MI': 0.16014877789585547, 'FA': 0.05324123273113709, 'CF': 0.023751328374070138}, batch size: 64, grad_norm: 0.17571835219860077, grad_scale: , lr: 0.00e+00,
2025-01-25 19:06:02,163 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 19:07:10,467 (model:870) WARNING: All labels are zero
2025-01-25 19:07:11,261 (model:870) WARNING: All labels are zero
2025-01-25 19:07:14,135 (model:870) WARNING: All labels are zero
2025-01-25 19:09:24,324 (model:870) WARNING: All labels are zero
2025-01-25 19:09:32,964 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 45754,  validation: loss=0.07514, DER=0.1739, ACC=0.9649, MI=0.1019, FA=0.04761, CF=0.02438, over 0.00 frames.
2025-01-25 19:09:32,964 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 19:09:41,577 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 45754,  validation: loss=0.07362, DER=0.1733, ACC=0.9656, MI=0.1011, FA=0.04869, CF=0.02355, over 0.00 frames.
2025-01-25 19:09:41,578 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 19:27:15,760 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 46254, num_updates: 45000, {'loss': 0.11582618951797485, 'DER': 0.24390243902439024, 'ACC': np.float64(0.9531160714285715), 'MI': 0.16319480791374438, 'FA': 0.04977493980948393, 'CF': 0.030932691301161937}, batch size: 64, grad_norm: 0.1839485615491867, grad_scale: , lr: 0.00e+00,
2025-01-25 19:27:15,760 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 46254, num_updates: 45000, {'loss': 0.09862746298313141, 'DER': 0.22239160924446613, 'ACC': np.float64(0.9613035714285715), 'MI': 0.12232453198365754, 'FA': 0.05817427891944631, 'CF': 0.04189279834136228}, batch size: 64, grad_norm: 0.1839485615491867, grad_scale: , lr: 0.00e+00,
2025-01-25 19:27:15,760 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 19:27:15,760 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 19:28:24,580 (model:870) WARNING: All labels are zero
2025-01-25 19:28:25,377 (model:870) WARNING: All labels are zero
2025-01-25 19:28:27,736 (model:870) WARNING: All labels are zero
2025-01-25 19:30:37,987 (model:870) WARNING: All labels are zero
2025-01-25 19:30:48,006 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 46254,  validation: loss=0.07513, DER=0.1743, ACC=0.9648, MI=0.09988, FA=0.04967, CF=0.02472, over 0.00 frames.
2025-01-25 19:30:48,006 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 19:30:55,267 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 46254,  validation: loss=0.07364, DER=0.1731, ACC=0.9656, MI=0.09868, FA=0.05042, CF=0.02396, over 0.00 frames.
2025-01-25 19:30:55,268 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 19:39:29,067 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-46500.pt
2025-01-25 19:39:29,635 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-25 19:39:29,678 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-01-25 19:48:25,902 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 46754, num_updates: 45500, {'loss': 0.0947905108332634, 'DER': 0.19719921534437662, 'ACC': np.float64(0.9618928571428571), 'MI': 0.11758936355710549, 'FA': 0.04424585876198779, 'CF': 0.03536399302528335}, batch size: 64, grad_norm: 0.19026215374469757, grad_scale: , lr: 0.00e+00,
2025-01-25 19:48:25,902 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 46754, num_updates: 45500, {'loss': 0.11488622426986694, 'DER': 0.2663825547930042, 'ACC': np.float64(0.9471428571428571), 'MI': 0.14677883551029444, 'FA': 0.05833517821562984, 'CF': 0.06126854106707992}, batch size: 64, grad_norm: 0.19026215374469757, grad_scale: , lr: 0.00e+00,
2025-01-25 19:48:25,903 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 19:48:25,903 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 19:49:35,219 (model:870) WARNING: All labels are zero
2025-01-25 19:49:36,025 (model:870) WARNING: All labels are zero
2025-01-25 19:49:36,658 (model:870) WARNING: All labels are zero
2025-01-25 19:51:45,584 (model:870) WARNING: All labels are zero
2025-01-25 19:52:01,047 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 46754,  validation: loss=0.07492, DER=0.1733, ACC=0.9649, MI=0.09892, FA=0.04954, CF=0.02487, over 0.00 frames.
2025-01-25 19:52:01,048 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 19:52:02,668 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 46754,  validation: loss=0.07354, DER=0.1727, ACC=0.9657, MI=0.09788, FA=0.0506, CF=0.02427, over 0.00 frames.
2025-01-25 19:52:02,668 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 20:09:41,967 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 47254, num_updates: 46000, {'loss': 0.12120360136032104, 'DER': 0.2644808743169399, 'ACC': np.float64(0.9484285714285714), 'MI': 0.17325006505334375, 'FA': 0.05511319281811085, 'CF': 0.0361176164454853}, batch size: 64, grad_norm: 0.2033732384443283, grad_scale: , lr: 0.00e+00,
2025-01-25 20:09:41,967 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 47254, num_updates: 46000, {'loss': 0.12678863108158112, 'DER': 0.31344307270233196, 'ACC': np.float64(0.9412142857142857), 'MI': 0.1843278463648834, 'FA': 0.06624371284865112, 'CF': 0.06287151348879744}, batch size: 64, grad_norm: 0.2033732384443283, grad_scale: , lr: 0.00e+00,
2025-01-25 20:09:41,968 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 20:09:41,968 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 20:10:50,493 (model:870) WARNING: All labels are zero
2025-01-25 20:10:51,294 (model:870) WARNING: All labels are zero
2025-01-25 20:10:53,784 (model:870) WARNING: All labels are zero
2025-01-25 20:13:03,518 (model:870) WARNING: All labels are zero
2025-01-25 20:13:13,426 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 47254,  validation: loss=0.07516, DER=0.1742, ACC=0.9648, MI=0.1014, FA=0.04841, CF=0.02441, over 0.00 frames.
2025-01-25 20:13:13,426 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 20:13:20,755 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 47254,  validation: loss=0.07376, DER=0.1736, ACC=0.9656, MI=0.1004, FA=0.04939, CF=0.0238, over 0.00 frames.
2025-01-25 20:13:20,756 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 20:30:51,403 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 47754, num_updates: 46500, {'loss': 0.13876494765281677, 'DER': 0.2771184101573282, 'ACC': np.float64(0.9429642857142857), 'MI': 0.1350262213635109, 'FA': 0.06657466188241788, 'CF': 0.07551752691139939}, batch size: 64, grad_norm: 0.2800127863883972, grad_scale: , lr: 0.00e+00,
2025-01-25 20:30:51,404 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 20:30:51,406 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 47754, num_updates: 46500, {'loss': 0.11973714828491211, 'DER': 0.25590736007511344, 'ACC': np.float64(0.9474375), 'MI': 0.16123311251369254, 'FA': 0.04350320797037192, 'CF': 0.05117103959104898}, batch size: 64, grad_norm: 0.2800127863883972, grad_scale: , lr: 0.00e+00,
2025-01-25 20:30:51,407 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 20:32:00,030 (model:870) WARNING: All labels are zero
2025-01-25 20:32:00,821 (model:870) WARNING: All labels are zero
2025-01-25 20:32:03,176 (model:870) WARNING: All labels are zero
2025-01-25 20:34:12,993 (model:870) WARNING: All labels are zero
2025-01-25 20:34:23,209 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 47754,  validation: loss=0.07511, DER=0.1736, ACC=0.9649, MI=0.09995, FA=0.04917, CF=0.02447, over 0.00 frames.
2025-01-25 20:34:23,209 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 20:34:30,268 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 47754,  validation: loss=0.07366, DER=0.1731, ACC=0.9657, MI=0.09931, FA=0.05006, CF=0.02369, over 0.00 frames.
2025-01-25 20:34:30,269 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 20:43:11,410 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-48000.pt
2025-01-25 20:43:11,977 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-25 20:52:09,346 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 48254, num_updates: 47000, {'loss': 0.10481690615415573, 'DER': 0.24921731939275799, 'ACC': np.float64(0.9539553571428571), 'MI': 0.14182763305570323, 'FA': 0.05198180636777128, 'CF': 0.05540787996928348}, batch size: 64, grad_norm: 0.1665397733449936, grad_scale: , lr: 0.00e+00,
2025-01-25 20:52:09,347 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 20:52:09,349 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 48254, num_updates: 47000, {'loss': 0.10596384853124619, 'DER': 0.23980738362760834, 'ACC': np.float64(0.953375), 'MI': 0.16179775280898875, 'FA': 0.03841626538255752, 'CF': 0.03959336543606207}, batch size: 64, grad_norm: 0.1665397733449936, grad_scale: , lr: 0.00e+00,
2025-01-25 20:52:09,349 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 20:53:18,142 (model:870) WARNING: All labels are zero
2025-01-25 20:53:18,932 (model:870) WARNING: All labels are zero
2025-01-25 20:53:20,118 (model:870) WARNING: All labels are zero
2025-01-25 20:55:28,345 (model:870) WARNING: All labels are zero
2025-01-25 20:55:41,732 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 48254,  validation: loss=0.07511, DER=0.1737, ACC=0.9649, MI=0.1014, FA=0.04786, CF=0.02443, over 0.00 frames.
2025-01-25 20:55:41,733 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 20:55:45,384 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 48254,  validation: loss=0.07374, DER=0.1732, ACC=0.9656, MI=0.1004, FA=0.04906, CF=0.02379, over 0.00 frames.
2025-01-25 20:55:45,385 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 21:13:22,677 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 48754, num_updates: 47500, {'loss': 0.1177571713924408, 'DER': 0.2500317944804782, 'ACC': np.float64(0.9552232142857143), 'MI': 0.12215439399720208, 'FA': 0.059010555767518756, 'CF': 0.06886684471575734}, batch size: 64, grad_norm: 0.19061294198036194, grad_scale: , lr: 0.00e+00,
2025-01-25 21:13:22,677 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 48754, num_updates: 47500, {'loss': 0.09418688714504242, 'DER': 0.1987075928917609, 'ACC': np.float64(0.961), 'MI': 0.09498078101498524, 'FA': 0.059105342320762075, 'CF': 0.04462146955601359}, batch size: 64, grad_norm: 0.19061294198036194, grad_scale: , lr: 0.00e+00,
2025-01-25 21:13:22,678 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 21:13:22,678 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 21:14:31,509 (model:870) WARNING: All labels are zero
2025-01-25 21:14:32,309 (model:870) WARNING: All labels are zero
2025-01-25 21:14:33,728 (model:870) WARNING: All labels are zero
2025-01-25 21:16:42,257 (model:870) WARNING: All labels are zero
2025-01-25 21:16:55,008 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 48754,  validation: loss=0.07497, DER=0.1738, ACC=0.9649, MI=0.1004, FA=0.04888, CF=0.02448, over 0.00 frames.
2025-01-25 21:16:55,009 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 21:16:59,317 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 48754,  validation: loss=0.07346, DER=0.173, ACC=0.9657, MI=0.09936, FA=0.05003, CF=0.02358, over 0.00 frames.
2025-01-25 21:16:59,318 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 21:34:33,665 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 49254, num_updates: 48000, {'loss': 0.10658172518014908, 'DER': 0.23761217323449083, 'ACC': np.float64(0.9560892857142856), 'MI': 0.13850955911041749, 'FA': 0.0625940583022128, 'CF': 0.03650855582186054}, batch size: 64, grad_norm: 0.27700909972190857, grad_scale: , lr: 0.00e+00,
2025-01-25 21:34:33,665 (train_accelerate_ddp:702) INFO: [Train] - Epoch 12, batch_idx_train: 49254, num_updates: 48000, {'loss': 0.12500882148742676, 'DER': 0.3054201156593718, 'ACC': np.float64(0.9438188188188188), 'MI': 0.18913709037305818, 'FA': 0.06531352761084024, 'CF': 0.05096949767547341}, batch size: 64, grad_norm: 0.27700909972190857, grad_scale: , lr: 0.00e+00,
2025-01-25 21:34:33,666 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 21:34:33,666 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 21:35:42,583 (model:870) WARNING: All labels are zero
2025-01-25 21:35:43,389 (model:870) WARNING: All labels are zero
2025-01-25 21:35:44,342 (model:870) WARNING: All labels are zero
2025-01-25 21:37:52,401 (model:870) WARNING: All labels are zero
2025-01-25 21:38:06,616 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 49254,  validation: loss=0.07495, DER=0.1734, ACC=0.9649, MI=0.09868, FA=0.04978, CF=0.02494, over 0.00 frames.
2025-01-25 21:38:06,617 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 21:38:09,401 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 12, batch_idx_train: 49254,  validation: loss=0.07357, DER=0.1727, ACC=0.9656, MI=0.09767, FA=0.05075, CF=0.02432, over 0.00 frames.
2025-01-25 21:38:09,402 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 21:42:03,983 (train_accelerate_ddp:713) INFO: end of epoch 12, batch_idx: 4113 batch_idx_train: 49367, {'loss': 0.11965788900852203, 'DER': 0.28231076157983, 'ACC': np.float64(0.949), 'MI': 0.1758515006071821, 'FA': 0.058462961892095065, 'CF': 0.04799629908055283}, batch size: 64, grad_norm: 0.22284258902072906, grad_scale: , lr: 0.00e+00,
2025-01-25 21:42:03,983 (train_accelerate_ddp:713) INFO: end of epoch 12, batch_idx: 4113 batch_idx_train: 49367, {'loss': 0.1090107336640358, 'DER': 0.2621825669183253, 'ACC': np.float64(0.9530535714285715), 'MI': 0.15900251658659345, 'FA': 0.06463051933196065, 'CF': 0.03854953099977122}, batch size: 64, grad_norm: 0.22284258902072906, grad_scale: , lr: 0.00e+00,
2025-01-25 21:42:03,985 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-12.pt
2025-01-25 21:42:04,383 (train_accelerate_ddp:561) INFO:  end of epoch 12, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-12.pt
2025-01-25 21:42:07,740 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 49368, num_updates: 48000, {'loss': 0.09087258577346802, 'DER': 0.19364277927591944, 'ACC': np.float64(0.9646607142857143), 'MI': 0.10832520511790694, 'FA': 0.051867577026794426, 'CF': 0.03344999713121809}, batch size: 64, grad_norm: 0.2182149440050125, grad_scale: , lr: 0.00e+00,
2025-01-25 21:42:07,743 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 49368, num_updates: 48000, {'loss': 0.13728155195713043, 'DER': 0.32733731814593436, 'ACC': np.float64(0.9360535714285715), 'MI': 0.16544490808616216, 'FA': 0.08537273034848314, 'CF': 0.07651967971128905}, batch size: 64, grad_norm: 0.2182149440050125, grad_scale: , lr: 0.00e+00,
2025-01-25 21:46:43,963 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-49500.pt
2025-01-25 21:46:44,482 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-25 21:46:44,514 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-01-25 21:59:41,509 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 49868, num_updates: 48500, {'loss': 0.10000308603048325, 'DER': 0.24304999075386796, 'ACC': np.float64(0.9561071428571429), 'MI': 0.0991185354126857, 'FA': 0.08395487887567034, 'CF': 0.059976576465511924}, batch size: 64, grad_norm: 0.2456434965133667, grad_scale: , lr: 0.00e+00,
2025-01-25 21:59:41,509 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 49868, num_updates: 48500, {'loss': 0.11956462264060974, 'DER': 0.27462951985773565, 'ACC': np.float64(0.9503214285714285), 'MI': 0.14991108476585654, 'FA': 0.06953171310017783, 'CF': 0.05518672199170124}, batch size: 64, grad_norm: 0.2456434965133667, grad_scale: , lr: 0.00e+00,
2025-01-25 21:59:41,509 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 21:59:41,509 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 22:00:49,839 (model:870) WARNING: All labels are zero
2025-01-25 22:00:50,627 (model:870) WARNING: All labels are zero
2025-01-25 22:00:53,084 (model:870) WARNING: All labels are zero
2025-01-25 22:03:02,303 (model:870) WARNING: All labels are zero
2025-01-25 22:03:12,412 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 49868,  validation: loss=0.07501, DER=0.1736, ACC=0.9649, MI=0.09812, FA=0.05037, CF=0.02508, over 0.00 frames.
2025-01-25 22:03:12,413 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 22:03:19,440 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 49868,  validation: loss=0.07347, DER=0.1729, ACC=0.9657, MI=0.09724, FA=0.05158, CF=0.02405, over 0.00 frames.
2025-01-25 22:03:19,441 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 22:20:55,825 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 50368, num_updates: 49000, {'loss': 0.09677092730998993, 'DER': 0.20765561239151675, 'ACC': np.float64(0.9626964285714286), 'MI': 0.11253520317259613, 'FA': 0.0626472785792287, 'CF': 0.032473130639691934}, batch size: 64, grad_norm: 0.17658227682113647, grad_scale: , lr: 0.00e+00,
2025-01-25 22:20:55,826 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 22:20:55,827 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 50368, num_updates: 49000, {'loss': 0.11016843467950821, 'DER': 0.25754469878145997, 'ACC': np.float64(0.9512053571428571), 'MI': 0.1325589340621797, 'FA': 0.0713472269673158, 'CF': 0.05363853775196447}, batch size: 64, grad_norm: 0.17658227682113647, grad_scale: , lr: 0.00e+00,
2025-01-25 22:20:55,827 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 22:22:05,051 (model:870) WARNING: All labels are zero
2025-01-25 22:22:05,847 (model:870) WARNING: All labels are zero
2025-01-25 22:22:07,124 (model:870) WARNING: All labels are zero
2025-01-25 22:24:16,238 (model:870) WARNING: All labels are zero
2025-01-25 22:24:29,708 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 50368,  validation: loss=0.07509, DER=0.1737, ACC=0.9649, MI=0.1003, FA=0.04876, CF=0.02467, over 0.00 frames.
2025-01-25 22:24:29,709 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 22:24:33,368 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 50368,  validation: loss=0.07351, DER=0.1732, ACC=0.9657, MI=0.09947, FA=0.05, CF=0.02372, over 0.00 frames.
2025-01-25 22:24:33,369 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 22:42:01,059 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 50868, num_updates: 49500, {'loss': 0.11019515991210938, 'DER': 0.27819894325752353, 'ACC': np.float64(0.9488928571428571), 'MI': 0.16890650126349643, 'FA': 0.05875258442453481, 'CF': 0.0505398575694923}, batch size: 64, grad_norm: 0.21075838804244995, grad_scale: , lr: 0.00e+00,
2025-01-25 22:42:01,059 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 50868, num_updates: 49500, {'loss': 0.10935205966234207, 'DER': 0.25622046347434946, 'ACC': np.float64(0.9532142857142857), 'MI': 0.15042988099982918, 'FA': 0.06365655070318282, 'CF': 0.04213403177133747}, batch size: 64, grad_norm: 0.21075838804244995, grad_scale: , lr: 0.00e+00,
2025-01-25 22:42:01,060 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 22:42:01,060 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 22:43:11,121 (model:870) WARNING: All labels are zero
2025-01-25 22:43:11,913 (model:870) WARNING: All labels are zero
2025-01-25 22:43:12,835 (model:870) WARNING: All labels are zero
2025-01-25 22:45:22,442 (model:870) WARNING: All labels are zero
2025-01-25 22:45:35,561 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 50868,  validation: loss=0.07498, DER=0.1737, ACC=0.9649, MI=0.09855, FA=0.05044, CF=0.02468, over 0.00 frames.
2025-01-25 22:45:35,562 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 22:45:39,617 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 50868,  validation: loss=0.07359, DER=0.1728, ACC=0.9657, MI=0.09759, FA=0.05105, CF=0.02412, over 0.00 frames.
2025-01-25 22:45:39,617 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 22:50:17,019 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-51000.pt
2025-01-25 22:50:17,532 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-25 23:03:16,747 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 51368, num_updates: 50000, {'loss': 0.11551779508590698, 'DER': 0.26719834758161687, 'ACC': np.float64(0.951591339381051), 'MI': 0.1430374662918125, 'FA': 0.08181766022146997, 'CF': 0.04234322106833439}, batch size: 64, grad_norm: 0.16259995102882385, grad_scale: , lr: 0.00e+00,
2025-01-25 23:03:16,748 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 23:03:16,751 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 51368, num_updates: 50000, {'loss': 0.08620212972164154, 'DER': 0.21155133588947722, 'ACC': np.float64(0.9645), 'MI': 0.10693201874505508, 'FA': 0.07418903292556753, 'CF': 0.030430284218854603}, batch size: 64, grad_norm: 0.16259995102882385, grad_scale: , lr: 0.00e+00,
2025-01-25 23:03:16,752 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 23:04:26,537 (model:870) WARNING: All labels are zero
2025-01-25 23:04:27,349 (model:870) WARNING: All labels are zero
2025-01-25 23:04:28,868 (model:870) WARNING: All labels are zero
2025-01-25 23:06:39,218 (model:870) WARNING: All labels are zero
2025-01-25 23:06:52,001 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 51368,  validation: loss=0.07499, DER=0.1738, ACC=0.9649, MI=0.1001, FA=0.0493, CF=0.02444, over 0.00 frames.
2025-01-25 23:06:52,001 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 23:06:56,517 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 51368,  validation: loss=0.07347, DER=0.1725, ACC=0.9657, MI=0.09885, FA=0.05012, CF=0.02357, over 0.00 frames.
2025-01-25 23:06:56,517 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 23:24:30,054 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 51868, num_updates: 50500, {'loss': 0.09832748025655746, 'DER': 0.21721243120031133, 'ACC': np.float64(0.9591964285714285), 'MI': 0.12097626063267916, 'FA': 0.05937621615611275, 'CF': 0.03685995441151943}, batch size: 64, grad_norm: 0.177447110414505, grad_scale: , lr: 0.00e+00,
2025-01-25 23:24:30,055 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 23:24:30,056 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 51868, num_updates: 50500, {'loss': 0.10182423144578934, 'DER': 0.22885572139303484, 'ACC': np.float64(0.9590535714285714), 'MI': 0.1198032824383828, 'FA': 0.07565620174987134, 'CF': 0.033396237204780695}, batch size: 64, grad_norm: 0.177447110414505, grad_scale: , lr: 0.00e+00,
2025-01-25 23:24:30,056 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 23:25:38,900 (model:870) WARNING: All labels are zero
2025-01-25 23:25:39,692 (model:870) WARNING: All labels are zero
2025-01-25 23:25:42,409 (model:870) WARNING: All labels are zero
2025-01-25 23:27:52,530 (model:870) WARNING: All labels are zero
2025-01-25 23:28:02,014 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 51868,  validation: loss=0.07511, DER=0.174, ACC=0.9649, MI=0.09868, FA=0.05052, CF=0.02485, over 0.00 frames.
2025-01-25 23:28:02,015 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 23:28:09,799 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 51868,  validation: loss=0.0736, DER=0.1732, ACC=0.9656, MI=0.09741, FA=0.05153, CF=0.02423, over 0.00 frames.
2025-01-25 23:28:09,800 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 23:45:43,004 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 52368, num_updates: 51000, {'loss': 0.12053368985652924, 'DER': 0.2762618636755824, 'ACC': np.float64(0.9412410714285715), 'MI': 0.13783433994823124, 'FA': 0.0598037100949094, 'CF': 0.07862381363244177}, batch size: 64, grad_norm: 0.24036380648612976, grad_scale: , lr: 0.00e+00,
2025-01-25 23:45:43,005 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 52368, num_updates: 51000, {'loss': 0.13207785785198212, 'DER': 0.302598207743899, 'ACC': np.float64(0.9440446428571428), 'MI': 0.1719551372372203, 'FA': 0.08003156174265907, 'CF': 0.05061150876401961}, batch size: 64, grad_norm: 0.24036380648612976, grad_scale: , lr: 0.00e+00,
2025-01-25 23:45:43,005 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 23:45:43,005 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-25 23:46:51,804 (model:870) WARNING: All labels are zero
2025-01-25 23:46:52,592 (model:870) WARNING: All labels are zero
2025-01-25 23:46:54,161 (model:870) WARNING: All labels are zero
2025-01-25 23:49:02,939 (model:870) WARNING: All labels are zero
2025-01-25 23:49:15,651 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 52368,  validation: loss=0.0751, DER=0.174, ACC=0.9649, MI=0.09975, FA=0.04959, CF=0.02468, over 0.00 frames.
2025-01-25 23:49:15,652 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 23:49:20,102 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 52368,  validation: loss=0.07361, DER=0.1733, ACC=0.9656, MI=0.09865, FA=0.05054, CF=0.02407, over 0.00 frames.
2025-01-25 23:49:20,102 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-25 23:54:00,184 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-52500.pt
2025-01-25 23:54:00,740 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-26 00:07:15,969 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 52868, num_updates: 51500, {'loss': 0.11985138803720474, 'DER': 0.28654791154791154, 'ACC': np.float64(0.9487321428571429), 'MI': 0.1441031941031941, 'FA': 0.07628992628992629, 'CF': 0.06615479115479116}, batch size: 64, grad_norm: 0.22288161516189575, grad_scale: , lr: 0.00e+00,
2025-01-26 00:07:15,970 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 00:07:15,971 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 52868, num_updates: 51500, {'loss': 0.11131057888269424, 'DER': 0.23904052936311002, 'ACC': np.float64(0.9544910714285715), 'MI': 0.1488833746898263, 'FA': 0.04813895781637717, 'CF': 0.04201819685690653}, batch size: 64, grad_norm: 0.22288161516189575, grad_scale: , lr: 0.00e+00,
2025-01-26 00:07:15,971 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 00:08:25,695 (model:870) WARNING: All labels are zero
2025-01-26 00:08:26,539 (model:870) WARNING: All labels are zero
2025-01-26 00:08:27,924 (model:870) WARNING: All labels are zero
2025-01-26 00:10:38,471 (model:870) WARNING: All labels are zero
2025-01-26 00:10:51,698 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 52868,  validation: loss=0.07511, DER=0.1736, ACC=0.9649, MI=0.09796, FA=0.05068, CF=0.02497, over 0.00 frames.
2025-01-26 00:10:51,699 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 00:10:55,989 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 52868,  validation: loss=0.07363, DER=0.1732, ACC=0.9656, MI=0.09702, FA=0.05186, CF=0.02428, over 0.00 frames.
2025-01-26 00:10:55,989 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 00:28:28,217 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 53368, num_updates: 52000, {'loss': 0.16196858882904053, 'DER': 0.32614018106246084, 'ACC': np.float64(0.9377589285714285), 'MI': 0.17650743039344075, 'FA': 0.07885896486932756, 'CF': 0.07077378579969254}, batch size: 64, grad_norm: 0.23088738322257996, grad_scale: , lr: 0.00e+00,
2025-01-26 00:28:28,218 (train_accelerate_ddp:702) INFO: [Train] - Epoch 13, batch_idx_train: 53368, num_updates: 52000, {'loss': 0.11717824637889862, 'DER': 0.25715690559440557, 'ACC': np.float64(0.9496785714285715), 'MI': 0.1573972902097902, 'FA': 0.049005681818181816, 'CF': 0.05075393356643357}, batch size: 64, grad_norm: 0.23088738322257996, grad_scale: , lr: 0.00e+00,
2025-01-26 00:28:28,218 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 00:28:28,218 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 00:29:36,743 (model:870) WARNING: All labels are zero
2025-01-26 00:29:37,532 (model:870) WARNING: All labels are zero
2025-01-26 00:29:40,139 (model:870) WARNING: All labels are zero
2025-01-26 00:31:49,982 (model:870) WARNING: All labels are zero
2025-01-26 00:31:59,308 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 53368,  validation: loss=0.075, DER=0.1739, ACC=0.9649, MI=0.09806, FA=0.05089, CF=0.02494, over 0.00 frames.
2025-01-26 00:31:59,308 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 00:32:07,212 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 13, batch_idx_train: 53368,  validation: loss=0.07359, DER=0.1729, ACC=0.9656, MI=0.09684, FA=0.05175, CF=0.0243, over 0.00 frames.
2025-01-26 00:32:07,213 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 00:36:01,567 (train_accelerate_ddp:713) INFO: end of epoch 13, batch_idx: 4113 batch_idx_train: 53481, {'loss': 0.11197943240404129, 'DER': 0.264899868089699, 'ACC': np.float64(0.9539107142857144), 'MI': 0.12231682455929968, 'FA': 0.09797337810289003, 'CF': 0.04460966542750929}, batch size: 64, grad_norm: 0.1463644802570343, grad_scale: , lr: 0.00e+00,
2025-01-26 00:36:01,567 (train_accelerate_ddp:713) INFO: end of epoch 13, batch_idx: 4113 batch_idx_train: 53481, {'loss': 0.10516034811735153, 'DER': 0.22727272727272727, 'ACC': np.float64(0.9555535714285714), 'MI': 0.14992583174401355, 'FA': 0.04089849544394999, 'CF': 0.03644840008476372}, batch size: 64, grad_norm: 0.1463644802570343, grad_scale: , lr: 0.00e+00,
2025-01-26 00:36:01,569 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-13.pt
2025-01-26 00:36:01,998 (train_accelerate_ddp:561) INFO:  end of epoch 13, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-13.pt
2025-01-26 00:36:05,463 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 53482, num_updates: 52000, {'loss': 0.09992222487926483, 'DER': 0.2453131468448755, 'ACC': np.float64(0.9558571428571428), 'MI': 0.11768880477852031, 'FA': 0.08054882015494708, 'CF': 0.047075521911408125}, batch size: 64, grad_norm: 0.21542876958847046, grad_scale: , lr: 0.00e+00,
2025-01-26 00:36:05,463 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 53482, num_updates: 52000, {'loss': 0.09280017763376236, 'DER': 0.22601720680509735, 'ACC': np.float64(0.9635982142857143), 'MI': 0.09767772818422925, 'FA': 0.09062681932854648, 'CF': 0.03771265929232163}, batch size: 64, grad_norm: 0.21542876958847046, grad_scale: , lr: 0.00e+00,
2025-01-26 00:53:37,231 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 53982, num_updates: 52500, {'loss': 0.11637765914201736, 'DER': 0.25874502206436334, 'ACC': np.float64(0.9495012859920958), 'MI': 0.16752771499300398, 'FA': 0.046711871703799375, 'CF': 0.044505435367560006}, batch size: 64, grad_norm: 0.17189207673072815, grad_scale: , lr: 0.00e+00,
2025-01-26 00:53:37,231 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 53982, num_updates: 52500, {'loss': 0.11495637148618698, 'DER': 0.282735854520183, 'ACC': np.float64(0.9464732142857143), 'MI': 0.1616957201598425, 'FA': 0.0565819192679678, 'CF': 0.06445821509237273}, batch size: 64, grad_norm: 0.17189207673072815, grad_scale: , lr: 0.00e+00,
2025-01-26 00:53:37,232 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 00:53:37,232 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 00:54:48,153 (model:870) WARNING: All labels are zero
2025-01-26 00:54:48,975 (model:870) WARNING: All labels are zero
2025-01-26 00:54:49,108 (model:870) WARNING: All labels are zero
2025-01-26 00:56:59,542 (model:870) WARNING: All labels are zero
2025-01-26 00:57:16,183 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 53982,  validation: loss=0.07496, DER=0.1736, ACC=0.9649, MI=0.09864, FA=0.05012, CF=0.02483, over 0.00 frames.
2025-01-26 00:57:16,184 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 00:57:16,912 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 53982,  validation: loss=0.07354, DER=0.1728, ACC=0.9656, MI=0.09754, FA=0.05101, CF=0.02426, over 0.00 frames.
2025-01-26 00:57:16,912 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 00:57:53,412 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-54000.pt
2025-01-26 00:57:54,156 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-26 00:57:54,160 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-01-26 01:14:47,598 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 54482, num_updates: 53000, {'loss': 0.08296331018209457, 'DER': 0.20619842070889985, 'ACC': np.float64(0.9638928571428571), 'MI': 0.11767499851570386, 'FA': 0.05462209820103307, 'CF': 0.03390132399216292}, batch size: 64, grad_norm: 0.1703164130449295, grad_scale: , lr: 0.00e+00,
2025-01-26 01:14:47,599 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 54482, num_updates: 53000, {'loss': 0.09636210650205612, 'DER': 0.22408046661111772, 'ACC': np.float64(0.9586339285714286), 'MI': 0.1066539697655041, 'FA': 0.06576598024044757, 'CF': 0.05166051660516605}, batch size: 64, grad_norm: 0.1703164130449295, grad_scale: , lr: 0.00e+00,
2025-01-26 01:14:47,599 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 01:14:47,599 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 01:15:56,264 (model:870) WARNING: All labels are zero
2025-01-26 01:15:57,056 (model:870) WARNING: All labels are zero
2025-01-26 01:15:58,567 (model:870) WARNING: All labels are zero
2025-01-26 01:18:07,385 (model:870) WARNING: All labels are zero
2025-01-26 01:18:19,494 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 54482,  validation: loss=0.0751, DER=0.174, ACC=0.9649, MI=0.09969, FA=0.04975, CF=0.02452, over 0.00 frames.
2025-01-26 01:18:19,495 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 01:18:24,446 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 54482,  validation: loss=0.07359, DER=0.1729, ACC=0.9657, MI=0.09883, FA=0.05045, CF=0.02365, over 0.00 frames.
2025-01-26 01:18:24,447 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 01:35:57,695 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 54982, num_updates: 53500, {'loss': 0.1069362536072731, 'DER': 0.25209855009266324, 'ACC': np.float64(0.9512946428571429), 'MI': 0.14482721029107162, 'FA': 0.062029870271448816, 'CF': 0.04524146953014281}, batch size: 64, grad_norm: 0.19391757249832153, grad_scale: , lr: 0.00e+00,
2025-01-26 01:35:57,696 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 01:35:57,697 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 54982, num_updates: 53500, {'loss': 0.1054164320230484, 'DER': 0.22792812777284827, 'ACC': np.float64(0.9556964285714286), 'MI': 0.14274622892635316, 'FA': 0.03793256433007986, 'CF': 0.04724933451641526}, batch size: 64, grad_norm: 0.19391757249832153, grad_scale: , lr: 0.00e+00,
2025-01-26 01:35:57,698 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 01:37:06,423 (model:870) WARNING: All labels are zero
2025-01-26 01:37:07,223 (model:870) WARNING: All labels are zero
2025-01-26 01:37:09,802 (model:870) WARNING: All labels are zero
2025-01-26 01:39:20,084 (model:870) WARNING: All labels are zero
2025-01-26 01:39:29,810 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 54982,  validation: loss=0.07503, DER=0.1742, ACC=0.9648, MI=0.09974, FA=0.04971, CF=0.02478, over 0.00 frames.
2025-01-26 01:39:29,811 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 01:39:37,371 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 54982,  validation: loss=0.07358, DER=0.1732, ACC=0.9656, MI=0.09865, FA=0.05048, CF=0.02405, over 0.00 frames.
2025-01-26 01:39:37,372 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 01:57:11,117 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 55482, num_updates: 54000, {'loss': 0.12482424080371857, 'DER': 0.301667207967955, 'ACC': np.float64(0.9389017857142856), 'MI': 0.16807405001623904, 'FA': 0.06484789433798853, 'CF': 0.0687452636137274}, batch size: 64, grad_norm: 0.1935737580060959, grad_scale: , lr: 0.00e+00,
2025-01-26 01:57:11,117 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 55482, num_updates: 54000, {'loss': 0.1166427880525589, 'DER': 0.2562062380649268, 'ACC': np.float64(0.9517767857142857), 'MI': 0.164491831105453, 'FA': 0.06142584341183959, 'CF': 0.030288563547634203}, batch size: 64, grad_norm: 0.1935737580060959, grad_scale: , lr: 0.00e+00,
2025-01-26 01:57:11,118 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 01:57:11,118 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 01:58:19,889 (model:870) WARNING: All labels are zero
2025-01-26 01:58:20,689 (model:870) WARNING: All labels are zero
2025-01-26 01:58:22,675 (model:870) WARNING: All labels are zero
2025-01-26 02:00:32,125 (model:870) WARNING: All labels are zero
2025-01-26 02:00:43,341 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 55482,  validation: loss=0.07507, DER=0.1743, ACC=0.9648, MI=0.1014, FA=0.04828, CF=0.02457, over 0.00 frames.
2025-01-26 02:00:43,341 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 02:00:49,232 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 55482,  validation: loss=0.07351, DER=0.1734, ACC=0.9656, MI=0.1003, FA=0.04944, CF=0.02363, over 0.00 frames.
2025-01-26 02:00:49,232 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 02:01:25,191 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-55500.pt
2025-01-26 02:01:25,831 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-26 02:18:15,029 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 55982, num_updates: 54500, {'loss': 0.09985452890396118, 'DER': 0.23933959578707656, 'ACC': np.float64(0.9546517857142857), 'MI': 0.13617990321662396, 'FA': 0.05334471961286649, 'CF': 0.04981497295758611}, batch size: 64, grad_norm: 0.1756613850593567, grad_scale: , lr: 0.00e+00,
2025-01-26 02:18:15,029 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 02:18:15,030 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 55982, num_updates: 54500, {'loss': 0.09788452088832855, 'DER': 0.21874451529866026, 'ACC': np.float64(0.9617876289588683), 'MI': 0.12484642836248756, 'FA': 0.0645293394957, 'CF': 0.029368747440472708}, batch size: 64, grad_norm: 0.1756613850593567, grad_scale: , lr: 0.00e+00,
2025-01-26 02:18:15,030 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 02:19:23,719 (model:870) WARNING: All labels are zero
2025-01-26 02:19:24,520 (model:870) WARNING: All labels are zero
2025-01-26 02:19:25,981 (model:870) WARNING: All labels are zero
2025-01-26 02:21:34,736 (model:870) WARNING: All labels are zero
2025-01-26 02:21:47,193 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 55982,  validation: loss=0.07498, DER=0.1738, ACC=0.9649, MI=0.1007, FA=0.04864, CF=0.02443, over 0.00 frames.
2025-01-26 02:21:47,194 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 02:21:51,858 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 55982,  validation: loss=0.0735, DER=0.173, ACC=0.9657, MI=0.09987, FA=0.04949, CF=0.02359, over 0.00 frames.
2025-01-26 02:21:51,859 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 02:39:22,985 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 56482, num_updates: 55000, {'loss': 0.11885474622249603, 'DER': 0.2764991896272285, 'ACC': np.float64(0.9461428571428571), 'MI': 0.1813614262560778, 'FA': 0.0457590491626148, 'CF': 0.04937871420853593}, batch size: 64, grad_norm: 0.1639808565378189, grad_scale: , lr: 0.00e+00,
2025-01-26 02:39:22,986 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 56482, num_updates: 55000, {'loss': 0.09840583056211472, 'DER': 0.23544639474681148, 'ACC': np.float64(0.96225), 'MI': 0.09420381361282991, 'FA': 0.10973607778759945, 'CF': 0.031506503346382116}, batch size: 64, grad_norm: 0.1639808565378189, grad_scale: , lr: 0.00e+00,
2025-01-26 02:39:22,986 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 02:39:22,986 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 02:40:31,645 (model:870) WARNING: All labels are zero
2025-01-26 02:40:32,443 (model:870) WARNING: All labels are zero
2025-01-26 02:40:34,773 (model:870) WARNING: All labels are zero
2025-01-26 02:42:44,361 (model:870) WARNING: All labels are zero
2025-01-26 02:42:54,896 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 56482,  validation: loss=0.07538, DER=0.1751, ACC=0.9647, MI=0.1018, FA=0.04867, CF=0.02463, over 0.00 frames.
2025-01-26 02:42:54,896 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 02:43:01,536 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 56482,  validation: loss=0.07388, DER=0.1742, ACC=0.9655, MI=0.1006, FA=0.04969, CF=0.02391, over 0.00 frames.
2025-01-26 02:43:01,537 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 03:00:37,445 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 56982, num_updates: 55500, {'loss': 0.09521634876728058, 'DER': 0.22728860936408107, 'ACC': np.float64(0.9599017857142856), 'MI': 0.13032844164919635, 'FA': 0.0627183787561146, 'CF': 0.03424178895877009}, batch size: 64, grad_norm: 0.1946662962436676, grad_scale: , lr: 0.00e+00,
2025-01-26 03:00:37,445 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 03:00:37,445 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 56982, num_updates: 55500, {'loss': 0.11205276846885681, 'DER': 0.24906710892613873, 'ACC': np.float64(0.9528392857142857), 'MI': 0.11461233193152875, 'FA': 0.07066279689628621, 'CF': 0.06379198009832376}, batch size: 64, grad_norm: 0.1946662962436676, grad_scale: , lr: 0.00e+00,
2025-01-26 03:00:37,445 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 03:01:46,856 (model:870) WARNING: All labels are zero
2025-01-26 03:01:47,665 (model:870) WARNING: All labels are zero
2025-01-26 03:01:47,906 (model:870) WARNING: All labels are zero
2025-01-26 03:03:56,255 (model:870) WARNING: All labels are zero
2025-01-26 03:04:12,330 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 56982,  validation: loss=0.07526, DER=0.1742, ACC=0.9648, MI=0.1005, FA=0.04911, CF=0.0246, over 0.00 frames.
2025-01-26 03:04:12,330 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 03:04:13,298 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 56982,  validation: loss=0.07377, DER=0.1734, ACC=0.9656, MI=0.09977, FA=0.0499, CF=0.02377, over 0.00 frames.
2025-01-26 03:04:13,299 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 03:04:49,321 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-57000.pt
2025-01-26 03:04:50,005 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-26 03:21:48,509 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 57482, num_updates: 56000, {'loss': 0.10901175439357758, 'DER': 0.2635781809641242, 'ACC': np.float64(0.9526964285714286), 'MI': 0.1400974693206506, 'FA': 0.07597909694087253, 'CF': 0.04750161470260114}, batch size: 64, grad_norm: 0.1981077641248703, grad_scale: , lr: 0.00e+00,
2025-01-26 03:21:48,509 (train_accelerate_ddp:702) INFO: [Train] - Epoch 14, batch_idx_train: 57482, num_updates: 56000, {'loss': 0.10153556615114212, 'DER': 0.24096949827293485, 'ACC': np.float64(0.9587607659353731), 'MI': 0.15531877524735085, 'FA': 0.05667115508459692, 'CF': 0.02897956794098706}, batch size: 64, grad_norm: 0.1981077641248703, grad_scale: , lr: 0.00e+00,
2025-01-26 03:21:48,510 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 03:21:48,510 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 03:22:57,251 (model:870) WARNING: All labels are zero
2025-01-26 03:22:58,047 (model:870) WARNING: All labels are zero
2025-01-26 03:23:00,476 (model:870) WARNING: All labels are zero
2025-01-26 03:25:10,518 (model:870) WARNING: All labels are zero
2025-01-26 03:25:20,695 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 57482,  validation: loss=0.07492, DER=0.1735, ACC=0.9649, MI=0.09957, FA=0.0493, CF=0.02465, over 0.00 frames.
2025-01-26 03:25:20,696 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 03:25:27,770 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 14, batch_idx_train: 57482,  validation: loss=0.07341, DER=0.1725, ACC=0.9658, MI=0.09838, FA=0.05022, CF=0.02385, over 0.00 frames.
2025-01-26 03:25:27,771 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 03:29:25,695 (train_accelerate_ddp:713) INFO: end of epoch 14, batch_idx: 4113 batch_idx_train: 57595, {'loss': 0.10937661677598953, 'DER': 0.24306382978723404, 'ACC': np.float64(0.9529017857142856), 'MI': 0.13588652482269503, 'FA': 0.050950354609929076, 'CF': 0.05622695035460993}, batch size: 64, grad_norm: 0.17926253378391266, grad_scale: , lr: 0.00e+00,
2025-01-26 03:29:25,696 (train_accelerate_ddp:713) INFO: end of epoch 14, batch_idx: 4113 batch_idx_train: 57595, {'loss': 0.10293107479810715, 'DER': 0.25510650259229184, 'ACC': np.float64(0.9557589285714285), 'MI': 0.11874570554063339, 'FA': 0.08195390093072646, 'CF': 0.054406896120931976}, batch size: 64, grad_norm: 0.17926253378391266, grad_scale: , lr: 0.00e+00,
2025-01-26 03:29:25,698 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-14.pt
2025-01-26 03:29:26,122 (train_accelerate_ddp:561) INFO:  end of epoch 14, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-14.pt
2025-01-26 03:29:29,990 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 57596, num_updates: 56000, {'loss': 0.11490250378847122, 'DER': 0.2676929892568391, 'ACC': np.float64(0.9459285714285715), 'MI': 0.13091150736515672, 'FA': 0.0691106434821132, 'CF': 0.06767083840956917}, batch size: 64, grad_norm: 0.17378894984722137, grad_scale: , lr: 0.00e+00,
2025-01-26 03:29:29,990 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 57596, num_updates: 56000, {'loss': 0.10697442293167114, 'DER': 0.23521636687546693, 'ACC': np.float64(0.956125), 'MI': 0.12464800873513017, 'FA': 0.06338716165737601, 'CF': 0.04718119648296075}, batch size: 64, grad_norm: 0.17378894984722137, grad_scale: , lr: 0.00e+00,
2025-01-26 03:47:06,300 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 58096, num_updates: 56500, {'loss': 0.14653295278549194, 'DER': 0.34150411416076876, 'ACC': np.float64(0.936625), 'MI': 0.20916048104033605, 'FA': 0.06542378732953565, 'CF': 0.06691984579089706}, batch size: 64, grad_norm: 0.2175307422876358, grad_scale: , lr: 0.00e+00,
2025-01-26 03:47:06,300 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 58096, num_updates: 56500, {'loss': 0.11511188000440598, 'DER': 0.24784326821394778, 'ACC': np.float64(0.9526339285714286), 'MI': 0.14020148049201314, 'FA': 0.06022151722602549, 'CF': 0.04742027049590917}, batch size: 64, grad_norm: 0.2175307422876358, grad_scale: , lr: 0.00e+00,
2025-01-26 03:47:06,301 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 03:47:06,301 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 03:48:14,967 (model:870) WARNING: All labels are zero
2025-01-26 03:48:15,765 (model:870) WARNING: All labels are zero
2025-01-26 03:48:18,473 (model:870) WARNING: All labels are zero
2025-01-26 03:50:27,527 (model:870) WARNING: All labels are zero
2025-01-26 03:50:37,908 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 58096,  validation: loss=0.07517, DER=0.1741, ACC=0.9648, MI=0.09799, FA=0.05108, CF=0.02504, over 0.00 frames.
2025-01-26 03:50:37,909 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 03:50:44,675 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 58096,  validation: loss=0.07372, DER=0.1732, ACC=0.9656, MI=0.09691, FA=0.05186, CF=0.02439, over 0.00 frames.
2025-01-26 03:50:44,676 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 04:04:57,134 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-58500.pt
2025-01-26 04:04:57,731 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-26 04:04:57,765 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-01-26 04:08:22,479 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 58596, num_updates: 57000, {'loss': 0.10863872617483139, 'DER': 0.23720271800679502, 'ACC': np.float64(0.9542803554682268), 'MI': 0.1260475651189128, 'FA': 0.05849377123442809, 'CF': 0.05266138165345413}, batch size: 64, grad_norm: 0.17986160516738892, grad_scale: , lr: 0.00e+00,
2025-01-26 04:08:22,479 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 58596, num_updates: 57000, {'loss': 0.09287463873624802, 'DER': 0.20792912017047047, 'ACC': np.float64(0.9599732142857144), 'MI': 0.11725452812202097, 'FA': 0.04721583581001514, 'CF': 0.043458756238434364}, batch size: 64, grad_norm: 0.17986160516738892, grad_scale: , lr: 0.00e+00,
2025-01-26 04:08:22,479 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 04:08:22,479 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 04:09:31,944 (model:870) WARNING: All labels are zero
2025-01-26 04:09:32,743 (model:870) WARNING: All labels are zero
2025-01-26 04:09:33,707 (model:870) WARNING: All labels are zero
2025-01-26 04:11:42,920 (model:870) WARNING: All labels are zero
2025-01-26 04:11:57,022 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 58596,  validation: loss=0.07484, DER=0.1732, ACC=0.9649, MI=0.0979, FA=0.05029, CF=0.02502, over 0.00 frames.
2025-01-26 04:11:57,023 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 04:12:00,029 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 58596,  validation: loss=0.07341, DER=0.1726, ACC=0.9657, MI=0.09675, FA=0.0514, CF=0.02445, over 0.00 frames.
2025-01-26 04:12:00,029 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 04:29:42,618 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 59096, num_updates: 57500, {'loss': 0.1090812161564827, 'DER': 0.24246304271912467, 'ACC': np.float64(0.9586428571428571), 'MI': 0.15172855313700384, 'FA': 0.0636130834594343, 'CF': 0.027121406122686532}, batch size: 64, grad_norm: 0.15512876212596893, grad_scale: , lr: 0.00e+00,
2025-01-26 04:29:42,619 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 04:29:42,620 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 59096, num_updates: 57500, {'loss': 0.11014623939990997, 'DER': 0.2307176045431079, 'ACC': np.float64(0.9547946428571429), 'MI': 0.1542591636551368, 'FA': 0.04579246257098606, 'CF': 0.03066597831698503}, batch size: 64, grad_norm: 0.15512876212596893, grad_scale: , lr: 0.00e+00,
2025-01-26 04:29:42,621 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 04:30:52,751 (model:870) WARNING: All labels are zero
2025-01-26 04:30:53,569 (model:870) WARNING: All labels are zero
2025-01-26 04:30:53,629 (model:870) WARNING: All labels are zero
2025-01-26 04:33:03,604 (model:870) WARNING: All labels are zero
2025-01-26 04:33:20,753 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 59096,  validation: loss=0.07344, DER=0.1727, ACC=0.9657, MI=0.09891, FA=0.05005, CF=0.02374, over 0.00 frames.
2025-01-26 04:33:20,754 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 04:33:21,177 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 59096,  validation: loss=0.07496, DER=0.1739, ACC=0.9649, MI=0.1, FA=0.04942, CF=0.02442, over 0.00 frames.
2025-01-26 04:33:21,178 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 04:50:59,109 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 59596, num_updates: 58000, {'loss': 0.10016526281833649, 'DER': 0.23514836882779777, 'ACC': np.float64(0.9560892857142856), 'MI': 0.11167482744380862, 'FA': 0.06849153442274793, 'CF': 0.054982006961241225}, batch size: 64, grad_norm: 0.2039605975151062, grad_scale: , lr: 0.00e+00,
2025-01-26 04:50:59,110 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 59596, num_updates: 58000, {'loss': 0.09723426401615143, 'DER': 0.2222348141432457, 'ACC': np.float64(0.9594910714285715), 'MI': 0.1403558476881233, 'FA': 0.04703082502266546, 'CF': 0.03484814143245694}, batch size: 64, grad_norm: 0.2039605975151062, grad_scale: , lr: 0.00e+00,
2025-01-26 04:50:59,110 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 04:50:59,110 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 04:52:08,468 (model:870) WARNING: All labels are zero
2025-01-26 04:52:09,265 (model:870) WARNING: All labels are zero
2025-01-26 04:52:10,808 (model:870) WARNING: All labels are zero
2025-01-26 04:54:21,223 (model:870) WARNING: All labels are zero
2025-01-26 04:54:31,908 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 59596,  validation: loss=0.07538, DER=0.175, ACC=0.9648, MI=0.1002, FA=0.05001, CF=0.02474, over 0.00 frames.
2025-01-26 04:54:31,908 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 04:54:38,381 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 59596,  validation: loss=0.07391, DER=0.1737, ACC=0.9655, MI=0.09928, FA=0.05035, CF=0.02405, over 0.00 frames.
2025-01-26 04:54:38,381 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 05:08:47,540 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-60000.pt
2025-01-26 05:08:48,758 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-26 05:12:12,763 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 60096, num_updates: 58500, {'loss': 0.11609086394309998, 'DER': 0.27432152713891444, 'ACC': np.float64(0.9501517857142857), 'MI': 0.15961361545538177, 'FA': 0.06801977920883165, 'CF': 0.046688132474701015}, batch size: 64, grad_norm: 0.21668319404125214, grad_scale: , lr: 0.00e+00,
2025-01-26 05:12:12,763 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 05:12:12,764 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 60096, num_updates: 58500, {'loss': 0.11265535652637482, 'DER': 0.28569621854053373, 'ACC': np.float64(0.9499256187170356), 'MI': 0.13254078664474517, 'FA': 0.08764385987100037, 'CF': 0.06551157202478816}, batch size: 64, grad_norm: 0.21668319404125214, grad_scale: , lr: 0.00e+00,
2025-01-26 05:12:12,765 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 05:13:21,580 (model:870) WARNING: All labels are zero
2025-01-26 05:13:22,376 (model:870) WARNING: All labels are zero
2025-01-26 05:13:24,499 (model:870) WARNING: All labels are zero
2025-01-26 05:15:34,570 (model:870) WARNING: All labels are zero
2025-01-26 05:15:44,940 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 60096,  validation: loss=0.07508, DER=0.1737, ACC=0.9649, MI=0.1003, FA=0.0489, CF=0.02453, over 0.00 frames.
2025-01-26 05:15:44,941 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 05:15:51,731 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 60096,  validation: loss=0.07356, DER=0.1729, ACC=0.9656, MI=0.09897, FA=0.04996, CF=0.024, over 0.00 frames.
2025-01-26 05:15:51,731 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 05:33:31,681 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 60596, num_updates: 59000, {'loss': 0.12689778208732605, 'DER': 0.2819954253349308, 'ACC': np.float64(0.9450625), 'MI': 0.1811894129179828, 'FA': 0.04770722143557347, 'CF': 0.05309879098137458}, batch size: 64, grad_norm: 0.19290196895599365, grad_scale: , lr: 0.00e+00,
2025-01-26 05:33:31,681 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 60596, num_updates: 59000, {'loss': 0.10899841785430908, 'DER': 0.2481866186966866, 'ACC': np.float64(0.9550089285714286), 'MI': 0.14054430453200256, 'FA': 0.06342482446468983, 'CF': 0.0442174896999942}, batch size: 64, grad_norm: 0.19290196895599365, grad_scale: , lr: 0.00e+00,
2025-01-26 05:33:31,681 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 05:33:31,681 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 05:34:40,652 (model:870) WARNING: All labels are zero
2025-01-26 05:34:41,451 (model:870) WARNING: All labels are zero
2025-01-26 05:34:43,792 (model:870) WARNING: All labels are zero
2025-01-26 05:36:53,729 (model:870) WARNING: All labels are zero
2025-01-26 05:37:04,260 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 60596,  validation: loss=0.07502, DER=0.1737, ACC=0.9649, MI=0.09975, FA=0.04931, CF=0.02466, over 0.00 frames.
2025-01-26 05:37:04,260 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 05:37:10,981 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 60596,  validation: loss=0.07349, DER=0.1727, ACC=0.9657, MI=0.0985, FA=0.05032, CF=0.02389, over 0.00 frames.
2025-01-26 05:37:10,981 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 05:54:40,371 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 61096, num_updates: 59500, {'loss': 0.12556026875972748, 'DER': 0.2679019925210694, 'ACC': np.float64(0.9494642857142856), 'MI': 0.14142992688508121, 'FA': 0.0784729586426299, 'CF': 0.04799910699335826}, batch size: 64, grad_norm: 0.28425905108451843, grad_scale: , lr: 0.00e+00,
2025-01-26 05:54:40,371 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 61096, num_updates: 59500, {'loss': 0.1382783204317093, 'DER': 0.3331891190308799, 'ACC': np.float64(0.9339553571428572), 'MI': 0.20339624682277865, 'FA': 0.0629495430209291, 'CF': 0.06684332918717213}, batch size: 64, grad_norm: 0.28425905108451843, grad_scale: , lr: 0.00e+00,
2025-01-26 05:54:40,371 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 05:54:40,371 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 05:55:49,262 (model:870) WARNING: All labels are zero
2025-01-26 05:55:50,054 (model:870) WARNING: All labels are zero
2025-01-26 05:55:52,482 (model:870) WARNING: All labels are zero
2025-01-26 05:58:02,896 (model:870) WARNING: All labels are zero
2025-01-26 05:58:12,845 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 61096,  validation: loss=0.07511, DER=0.1745, ACC=0.9648, MI=0.1017, FA=0.04803, CF=0.02469, over 0.00 frames.
2025-01-26 05:58:12,845 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 05:58:20,191 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 61096,  validation: loss=0.07371, DER=0.1734, ACC=0.9656, MI=0.1004, FA=0.04897, CF=0.02406, over 0.00 frames.
2025-01-26 05:58:20,191 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 06:12:34,915 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-61500.pt
2025-01-26 06:12:35,469 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-26 06:15:56,753 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 61596, num_updates: 60000, {'loss': 0.10709632188081741, 'DER': 0.26684042861280044, 'ACC': np.float64(0.9486875), 'MI': 0.1408050970170866, 'FA': 0.060005792064871125, 'CF': 0.06602953953084274}, batch size: 64, grad_norm: 0.1548629254102707, grad_scale: , lr: 0.00e+00,
2025-01-26 06:15:56,754 (train_accelerate_ddp:702) INFO: [Train] - Epoch 15, batch_idx_train: 61596, num_updates: 60000, {'loss': 0.08997105807065964, 'DER': 0.20955177372962608, 'ACC': np.float64(0.9618981485656569), 'MI': 0.10031160115052733, 'FA': 0.06561601150527326, 'CF': 0.0436241610738255}, batch size: 64, grad_norm: 0.1548629254102707, grad_scale: , lr: 0.00e+00,
2025-01-26 06:15:56,754 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 06:15:56,754 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 06:17:06,228 (model:870) WARNING: All labels are zero
2025-01-26 06:17:07,029 (model:870) WARNING: All labels are zero
2025-01-26 06:17:08,922 (model:870) WARNING: All labels are zero
2025-01-26 06:19:20,026 (model:870) WARNING: All labels are zero
2025-01-26 06:19:29,700 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 61596,  validation: loss=0.07504, DER=0.1743, ACC=0.9649, MI=0.09883, FA=0.05051, CF=0.02491, over 0.00 frames.
2025-01-26 06:19:29,701 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 06:19:37,288 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 15, batch_idx_train: 61596,  validation: loss=0.07357, DER=0.1729, ACC=0.9656, MI=0.09794, FA=0.05095, CF=0.02402, over 0.00 frames.
2025-01-26 06:19:37,288 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 06:23:33,271 (train_accelerate_ddp:713) INFO: end of epoch 15, batch_idx: 4113 batch_idx_train: 61709, {'loss': 0.1055637076497078, 'DER': 0.2401843632639126, 'ACC': np.float64(0.9543928571428572), 'MI': 0.13315124615909868, 'FA': 0.05656082849664277, 'CF': 0.05047228860817116}, batch size: 64, grad_norm: 0.19036610424518585, grad_scale: , lr: 0.00e+00,
2025-01-26 06:23:33,272 (train_accelerate_ddp:713) INFO: end of epoch 15, batch_idx: 4113 batch_idx_train: 61709, {'loss': 0.12094643712043762, 'DER': 0.27272207940588405, 'ACC': np.float64(0.9499732142857144), 'MI': 0.16903741788060553, 'FA': 0.05632676378177664, 'CF': 0.04735789774350185}, batch size: 64, grad_norm: 0.19036610424518585, grad_scale: , lr: 0.00e+00,
2025-01-26 06:23:33,273 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-15.pt
2025-01-26 06:23:33,695 (train_accelerate_ddp:561) INFO:  end of epoch 15, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-15.pt
2025-01-26 06:23:37,620 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 61710, num_updates: 60000, {'loss': 0.12342622131109238, 'DER': 0.2918375157181127, 'ACC': np.float64(0.9455714285714285), 'MI': 0.1922256847629982, 'FA': 0.05817068503635668, 'CF': 0.04144114591875786}, batch size: 64, grad_norm: 0.2162862867116928, grad_scale: , lr: 0.00e+00,
2025-01-26 06:23:37,622 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 61710, num_updates: 60000, {'loss': 0.12255217880010605, 'DER': 0.27630887760462264, 'ACC': np.float64(0.9509107142857144), 'MI': 0.16646238253662524, 'FA': 0.06525418782466585, 'CF': 0.04459230724333158}, batch size: 64, grad_norm: 0.2162862867116928, grad_scale: , lr: 0.00e+00,
2025-01-26 06:41:15,603 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 62210, num_updates: 60500, {'loss': 0.11022531241178513, 'DER': 0.24600866845887967, 'ACC': np.float64(0.9550714285714286), 'MI': 0.1566357601360619, 'FA': 0.05930762056290119, 'CF': 0.03006528775991661}, batch size: 64, grad_norm: 0.20989848673343658, grad_scale: , lr: 0.00e+00,
2025-01-26 06:41:15,603 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 62210, num_updates: 60500, {'loss': 0.1372813731431961, 'DER': 0.3041664379425811, 'ACC': np.float64(0.9415803571428571), 'MI': 0.18153373222813854, 'FA': 0.0676291376187078, 'CF': 0.055003568095734756}, batch size: 64, grad_norm: 0.20989848673343658, grad_scale: , lr: 0.00e+00,
2025-01-26 06:41:15,603 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 06:41:15,604 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 06:42:24,949 (model:870) WARNING: All labels are zero
2025-01-26 06:42:25,754 (model:870) WARNING: All labels are zero
2025-01-26 06:42:27,800 (model:870) WARNING: All labels are zero
2025-01-26 06:44:38,166 (model:870) WARNING: All labels are zero
2025-01-26 06:44:49,783 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 62210,  validation: loss=0.0749, DER=0.1735, ACC=0.9649, MI=0.09901, FA=0.04978, CF=0.02469, over 0.00 frames.
2025-01-26 06:44:49,784 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 06:44:55,555 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 62210,  validation: loss=0.07347, DER=0.1729, ACC=0.9657, MI=0.09787, FA=0.05104, CF=0.02403, over 0.00 frames.
2025-01-26 06:44:55,556 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 07:02:33,349 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 62710, num_updates: 61000, {'loss': 0.10847106575965881, 'DER': 0.2541513161407443, 'ACC': np.float64(0.9495178571428571), 'MI': 0.150194884937797, 'FA': 0.056222969726093225, 'CF': 0.047733461476854075}, batch size: 64, grad_norm: 0.17358487844467163, grad_scale: , lr: 0.00e+00,
2025-01-26 07:02:33,350 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 07:02:33,353 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 62710, num_updates: 61000, {'loss': 0.09493211656808853, 'DER': 0.21174669145794597, 'ACC': np.float64(0.959875), 'MI': 0.11074045718035656, 'FA': 0.06699114076342558, 'CF': 0.03401509351416384}, batch size: 64, grad_norm: 0.17358487844467163, grad_scale: , lr: 0.00e+00,
2025-01-26 07:02:33,353 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 07:03:41,951 (model:870) WARNING: All labels are zero
2025-01-26 07:03:42,740 (model:870) WARNING: All labels are zero
2025-01-26 07:03:45,226 (model:870) WARNING: All labels are zero
2025-01-26 07:05:55,350 (model:870) WARNING: All labels are zero
2025-01-26 07:06:05,050 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 62710,  validation: loss=0.07502, DER=0.1741, ACC=0.9649, MI=0.1005, FA=0.04897, CF=0.02459, over 0.00 frames.
2025-01-26 07:06:05,050 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 07:06:12,635 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 62710,  validation: loss=0.07353, DER=0.1731, ACC=0.9657, MI=0.0995, FA=0.04989, CF=0.02374, over 0.00 frames.
2025-01-26 07:06:12,636 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 07:16:21,265 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-63000.pt
2025-01-26 07:16:21,823 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-26 07:16:21,860 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-01-26 07:23:46,837 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 63210, num_updates: 61500, {'loss': 0.12443433701992035, 'DER': 0.27717770034843203, 'ACC': np.float64(0.9491964285714286), 'MI': 0.16306620209059233, 'FA': 0.060859465737514516, 'CF': 0.053252032520325204}, batch size: 64, grad_norm: 0.20450563728809357, grad_scale: , lr: 0.00e+00,
2025-01-26 07:23:46,837 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 63210, num_updates: 61500, {'loss': 0.11177023500204086, 'DER': 0.24924957703432843, 'ACC': np.float64(0.9530714285714286), 'MI': 0.15101238880096055, 'FA': 0.060634175626262075, 'CF': 0.03760301260710582}, batch size: 64, grad_norm: 0.20450563728809357, grad_scale: , lr: 0.00e+00,
2025-01-26 07:23:46,838 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 07:23:46,838 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 07:24:56,086 (model:870) WARNING: All labels are zero
2025-01-26 07:24:56,884 (model:870) WARNING: All labels are zero
2025-01-26 07:24:58,317 (model:870) WARNING: All labels are zero
2025-01-26 07:27:08,176 (model:870) WARNING: All labels are zero
2025-01-26 07:27:20,440 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 63210,  validation: loss=0.07505, DER=0.1739, ACC=0.9649, MI=0.1003, FA=0.04912, CF=0.02458, over 0.00 frames.
2025-01-26 07:27:20,440 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 07:27:25,335 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 63210,  validation: loss=0.07352, DER=0.173, ACC=0.9657, MI=0.09933, FA=0.04999, CF=0.02369, over 0.00 frames.
2025-01-26 07:27:25,335 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 07:45:01,827 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 63710, num_updates: 62000, {'loss': 0.10275887697935104, 'DER': 0.23687150837988827, 'ACC': np.float64(0.9552335406853404), 'MI': 0.12558659217877094, 'FA': 0.06994413407821229, 'CF': 0.041340782122905026}, batch size: 64, grad_norm: 0.17294153571128845, grad_scale: , lr: 0.00e+00,
2025-01-26 07:45:01,827 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 63710, num_updates: 62000, {'loss': 0.1069454699754715, 'DER': 0.2595067988015672, 'ACC': np.float64(0.95325), 'MI': 0.1426019820235077, 'FA': 0.07472920027656142, 'CF': 0.042175616501498044}, batch size: 64, grad_norm: 0.17294153571128845, grad_scale: , lr: 0.00e+00,
2025-01-26 07:45:01,827 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 07:45:01,827 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 07:46:10,725 (model:870) WARNING: All labels are zero
2025-01-26 07:46:11,526 (model:870) WARNING: All labels are zero
2025-01-26 07:46:13,972 (model:870) WARNING: All labels are zero
2025-01-26 07:48:24,280 (model:870) WARNING: All labels are zero
2025-01-26 07:48:33,761 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 63710,  validation: loss=0.07531, DER=0.1743, ACC=0.9648, MI=0.1016, FA=0.04816, CF=0.02449, over 0.00 frames.
2025-01-26 07:48:33,762 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 07:48:41,665 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 63710,  validation: loss=0.07378, DER=0.1734, ACC=0.9656, MI=0.1004, FA=0.04926, CF=0.0237, over 0.00 frames.
2025-01-26 07:48:41,666 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 08:06:23,024 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 64210, num_updates: 62500, {'loss': 0.11524486541748047, 'DER': 0.25696578027333405, 'ACC': np.float64(0.9490267857142857), 'MI': 0.15234664689056043, 'FA': 0.05916940353851043, 'CF': 0.04544972984426316}, batch size: 64, grad_norm: 0.1626555472612381, grad_scale: , lr: 0.00e+00,
2025-01-26 08:06:23,024 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 64210, num_updates: 62500, {'loss': 0.09983190894126892, 'DER': 0.22192406508706822, 'ACC': np.float64(0.9582560878404399), 'MI': 0.1221809877248073, 'FA': 0.05555238367113902, 'CF': 0.0441906936911219}, batch size: 64, grad_norm: 0.1626555472612381, grad_scale: , lr: 0.00e+00,
2025-01-26 08:06:23,024 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 08:06:23,024 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 08:07:32,128 (model:870) WARNING: All labels are zero
2025-01-26 08:07:32,922 (model:870) WARNING: All labels are zero
2025-01-26 08:07:35,276 (model:870) WARNING: All labels are zero
2025-01-26 08:09:45,305 (model:870) WARNING: All labels are zero
2025-01-26 08:09:55,624 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 64210,  validation: loss=0.07498, DER=0.1737, ACC=0.9649, MI=0.09974, FA=0.04943, CF=0.02455, over 0.00 frames.
2025-01-26 08:09:55,624 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 08:10:02,584 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 64210,  validation: loss=0.07352, DER=0.1728, ACC=0.9657, MI=0.09855, FA=0.05031, CF=0.02392, over 0.00 frames.
2025-01-26 08:10:02,584 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 08:20:12,705 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-64500.pt
2025-01-26 08:20:13,249 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-26 08:27:41,040 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 64710, num_updates: 63000, {'loss': 0.10333936661481857, 'DER': 0.2577765140744953, 'ACC': np.float64(0.9546785714285715), 'MI': 0.15797554734148422, 'FA': 0.06892237702587432, 'CF': 0.030878589707136764}, batch size: 64, grad_norm: 0.17327629029750824, grad_scale: , lr: 0.00e+00,
2025-01-26 08:27:41,040 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 64710, num_updates: 63000, {'loss': 0.1130327358841896, 'DER': 0.27981384525887143, 'ACC': np.float64(0.9505357142857144), 'MI': 0.17108784176847003, 'FA': 0.06625945317044793, 'CF': 0.04246655031995346}, batch size: 64, grad_norm: 0.17327629029750824, grad_scale: , lr: 0.00e+00,
2025-01-26 08:27:41,040 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 08:27:41,040 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 08:28:50,272 (model:870) WARNING: All labels are zero
2025-01-26 08:28:51,080 (model:870) WARNING: All labels are zero
2025-01-26 08:28:53,505 (model:870) WARNING: All labels are zero
2025-01-26 08:31:04,433 (model:870) WARNING: All labels are zero
2025-01-26 08:31:14,571 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 64710,  validation: loss=0.07483, DER=0.1735, ACC=0.9649, MI=0.09823, FA=0.05052, CF=0.02471, over 0.00 frames.
2025-01-26 08:31:14,571 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 08:31:21,766 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 64710,  validation: loss=0.07339, DER=0.1726, ACC=0.9657, MI=0.09713, FA=0.05155, CF=0.02395, over 0.00 frames.
2025-01-26 08:31:21,767 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 08:49:02,468 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 65210, num_updates: 63500, {'loss': 0.08837320655584335, 'DER': 0.20905514122966704, 'ACC': np.float64(0.9640580912114955), 'MI': 0.10370544365494157, 'FA': 0.08027482529802102, 'CF': 0.025074872276704446}, batch size: 64, grad_norm: 0.13066798448562622, grad_scale: , lr: 0.00e+00,
2025-01-26 08:49:02,468 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 65210, num_updates: 63500, {'loss': 0.10866513103246689, 'DER': 0.25107237878047456, 'ACC': np.float64(0.9511517857142857), 'MI': 0.13769886517891078, 'FA': 0.06738339577564206, 'CF': 0.0459901178259217}, batch size: 64, grad_norm: 0.13066798448562622, grad_scale: , lr: 0.00e+00,
2025-01-26 08:49:02,469 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 08:49:02,469 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 08:50:12,437 (model:870) WARNING: All labels are zero
2025-01-26 08:50:13,267 (model:870) WARNING: All labels are zero
2025-01-26 08:50:15,456 (model:870) WARNING: All labels are zero
2025-01-26 08:52:24,065 (model:870) WARNING: All labels are zero
2025-01-26 08:52:33,927 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 65210,  validation: loss=0.07503, DER=0.1738, ACC=0.9649, MI=0.09936, FA=0.04979, CF=0.02469, over 0.00 frames.
2025-01-26 08:52:33,928 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 08:52:40,991 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 65210,  validation: loss=0.07359, DER=0.1731, ACC=0.9656, MI=0.09827, FA=0.05067, CF=0.02414, over 0.00 frames.
2025-01-26 08:52:40,993 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 09:10:03,407 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 65710, num_updates: 64000, {'loss': 0.12411709874868393, 'DER': 0.2858518835616438, 'ACC': np.float64(0.943375), 'MI': 0.1695740582191781, 'FA': 0.06276755136986302, 'CF': 0.05351027397260274}, batch size: 64, grad_norm: 0.18269748985767365, grad_scale: , lr: 0.00e+00,
2025-01-26 09:10:03,407 (train_accelerate_ddp:702) INFO: [Train] - Epoch 16, batch_idx_train: 65710, num_updates: 64000, {'loss': 0.10090609639883041, 'DER': 0.2349540078843627, 'ACC': np.float64(0.955375), 'MI': 0.17324572930354795, 'FA': 0.03395532194480946, 'CF': 0.027752956636005258}, batch size: 64, grad_norm: 0.18269748985767365, grad_scale: , lr: 0.00e+00,
2025-01-26 09:10:03,408 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 09:10:03,408 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 09:11:11,166 (model:870) WARNING: All labels are zero
2025-01-26 09:11:11,946 (model:870) WARNING: All labels are zero
2025-01-26 09:11:12,764 (model:870) WARNING: All labels are zero
2025-01-26 09:13:18,570 (model:870) WARNING: All labels are zero
2025-01-26 09:13:32,636 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 65710,  validation: loss=0.07495, DER=0.1735, ACC=0.9649, MI=0.09791, FA=0.05068, CF=0.02489, over 0.00 frames.
2025-01-26 09:13:32,637 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 09:13:35,274 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 16, batch_idx_train: 65710,  validation: loss=0.07339, DER=0.1725, ACC=0.9657, MI=0.09696, FA=0.05165, CF=0.02394, over 0.00 frames.
2025-01-26 09:13:35,274 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 09:17:29,054 (train_accelerate_ddp:713) INFO: end of epoch 16, batch_idx: 4113 batch_idx_train: 65823, {'loss': 0.138522669672966, 'DER': 0.30259595476986784, 'ACC': np.float64(0.9411339285714285), 'MI': 0.18378722726548813, 'FA': 0.07140202792376706, 'CF': 0.047406699580612624}, batch size: 64, grad_norm: 0.15229260921478271, grad_scale: , lr: 0.00e+00,
2025-01-26 09:17:29,057 (train_accelerate_ddp:713) INFO: end of epoch 16, batch_idx: 4113 batch_idx_train: 65823, {'loss': 0.08351520448923111, 'DER': 0.2067358735401675, 'ACC': np.float64(0.9642589285714286), 'MI': 0.11796626164916833, 'FA': 0.05939601274035626, 'CF': 0.029373599150642915}, batch size: 64, grad_norm: 0.15229260921478271, grad_scale: , lr: 0.00e+00,
2025-01-26 09:17:29,059 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-16.pt
2025-01-26 09:17:29,494 (train_accelerate_ddp:561) INFO:  end of epoch 16, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-16.pt
2025-01-26 09:17:32,782 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 65824, num_updates: 64000, {'loss': 0.10449500381946564, 'DER': 0.268912673315495, 'ACC': np.float64(0.9544642857142857), 'MI': 0.16090975431768426, 'FA': 0.06677207492094381, 'CF': 0.04123084407686694}, batch size: 64, grad_norm: 0.21538512408733368, grad_scale: , lr: 0.00e+00,
2025-01-26 09:17:32,784 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 65824, num_updates: 64000, {'loss': 0.11039556562900543, 'DER': 0.25027173913043477, 'ACC': np.float64(0.9513363477638), 'MI': 0.14771739130434783, 'FA': 0.057445652173913044, 'CF': 0.045108695652173916}, batch size: 64, grad_norm: 0.21538512408733368, grad_scale: , lr: 0.00e+00,
2025-01-26 09:23:38,812 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-66000.pt
2025-01-26 09:23:39,397 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-26 09:23:39,428 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-01-26 09:35:05,026 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 66324, num_updates: 64500, {'loss': 0.09939829260110855, 'DER': 0.2428580167614853, 'ACC': np.float64(0.9545), 'MI': 0.09206582247507188, 'FA': 0.08191105401602741, 'CF': 0.068881140270386}, batch size: 64, grad_norm: 0.20662596821784973, grad_scale: , lr: 0.00e+00,
2025-01-26 09:35:05,027 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 09:35:05,028 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 66324, num_updates: 64500, {'loss': 0.11482463032007217, 'DER': 0.25251215559157214, 'ACC': np.float64(0.9518928571428571), 'MI': 0.15013506212857913, 'FA': 0.06380334954078876, 'CF': 0.038573743922204216}, batch size: 64, grad_norm: 0.20662596821784973, grad_scale: , lr: 0.00e+00,
2025-01-26 09:35:05,028 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 09:36:14,359 (model:870) WARNING: All labels are zero
2025-01-26 09:36:15,168 (model:870) WARNING: All labels are zero
2025-01-26 09:36:17,003 (model:870) WARNING: All labels are zero
2025-01-26 09:38:27,411 (model:870) WARNING: All labels are zero
2025-01-26 09:38:39,124 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 66324,  validation: loss=0.07519, DER=0.1746, ACC=0.9648, MI=0.101, FA=0.04884, CF=0.0248, over 0.00 frames.
2025-01-26 09:38:39,124 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 09:38:44,803 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 66324,  validation: loss=0.07368, DER=0.1735, ACC=0.9656, MI=0.09975, FA=0.04963, CF=0.02407, over 0.00 frames.
2025-01-26 09:38:44,803 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 09:56:22,110 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 66824, num_updates: 65000, {'loss': 0.11623749881982803, 'DER': 0.2676734251850069, 'ACC': np.float64(0.9532678571428571), 'MI': 0.1512544371578124, 'FA': 0.06918957944768667, 'CF': 0.04722940857950785}, batch size: 64, grad_norm: 0.19722923636436462, grad_scale: , lr: 0.00e+00,
2025-01-26 09:56:22,111 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 09:56:22,112 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 66824, num_updates: 65000, {'loss': 0.11446045339107513, 'DER': 0.2510605045769145, 'ACC': np.float64(0.9525803571428572), 'MI': 0.14244250948872517, 'FA': 0.06323956240232195, 'CF': 0.04537843268586738}, batch size: 64, grad_norm: 0.19722923636436462, grad_scale: , lr: 0.00e+00,
2025-01-26 09:56:22,112 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 09:57:31,053 (model:870) WARNING: All labels are zero
2025-01-26 09:57:31,852 (model:870) WARNING: All labels are zero
2025-01-26 09:57:34,073 (model:870) WARNING: All labels are zero
2025-01-26 09:59:44,000 (model:870) WARNING: All labels are zero
2025-01-26 09:59:55,258 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 66824,  validation: loss=0.07501, DER=0.174, ACC=0.9649, MI=0.1009, FA=0.04864, CF=0.02447, over 0.00 frames.
2025-01-26 09:59:55,258 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 10:00:01,246 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 66824,  validation: loss=0.07356, DER=0.1734, ACC=0.9656, MI=0.09975, FA=0.04992, CF=0.02376, over 0.00 frames.
2025-01-26 10:00:01,246 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 10:17:34,541 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 67324, num_updates: 65500, {'loss': 0.1272803694009781, 'DER': 0.2694338765544262, 'ACC': np.float64(0.9462142857142857), 'MI': 0.1401396854238828, 'FA': 0.0566691272500142, 'CF': 0.07262506388052921}, batch size: 64, grad_norm: 0.1747700273990631, grad_scale: , lr: 0.00e+00,
2025-01-26 10:17:34,541 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 67324, num_updates: 65500, {'loss': 0.09979842603206635, 'DER': 0.21367751670618668, 'ACC': np.float64(0.9572857142857143), 'MI': 0.11564992455270533, 'FA': 0.053890924768269025, 'CF': 0.04413666738521233}, batch size: 64, grad_norm: 0.1747700273990631, grad_scale: , lr: 0.00e+00,
2025-01-26 10:17:34,541 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 10:17:34,542 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 10:18:45,433 (model:870) WARNING: All labels are zero
2025-01-26 10:18:46,250 (model:870) WARNING: All labels are zero
2025-01-26 10:18:46,685 (model:870) WARNING: All labels are zero
2025-01-26 10:20:57,418 (model:870) WARNING: All labels are zero
2025-01-26 10:21:12,533 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 67324,  validation: loss=0.07497, DER=0.1735, ACC=0.9649, MI=0.1004, FA=0.04848, CF=0.02463, over 0.00 frames.
2025-01-26 10:21:12,534 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 10:21:14,841 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 67324,  validation: loss=0.07341, DER=0.1725, ACC=0.9657, MI=0.0993, FA=0.04938, CF=0.02379, over 0.00 frames.
2025-01-26 10:21:14,842 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 10:27:30,501 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-67500.pt
2025-01-26 10:27:31,759 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-26 10:39:02,640 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 67824, num_updates: 66000, {'loss': 0.0861295759677887, 'DER': 0.19966473088666706, 'ACC': np.float64(0.9655625), 'MI': 0.11710471172843202, 'FA': 0.05130814823684368, 'CF': 0.03125187092139137}, batch size: 64, grad_norm: 0.16566890478134155, grad_scale: , lr: 0.00e+00,
2025-01-26 10:39:02,640 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 67824, num_updates: 66000, {'loss': 0.11730223149061203, 'DER': 0.27389553802879046, 'ACC': np.float64(0.9472906093086569), 'MI': 0.15399040317687937, 'FA': 0.0713143235342783, 'CF': 0.048590811317632786}, batch size: 64, grad_norm: 0.16566890478134155, grad_scale: , lr: 0.00e+00,
2025-01-26 10:39:02,641 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 10:39:02,641 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 10:40:13,848 (model:870) WARNING: All labels are zero
2025-01-26 10:40:14,679 (model:870) WARNING: All labels are zero
2025-01-26 10:40:14,910 (model:870) WARNING: All labels are zero
2025-01-26 10:42:25,133 (model:870) WARNING: All labels are zero
2025-01-26 10:42:42,063 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 67824,  validation: loss=0.0749, DER=0.1735, ACC=0.9649, MI=0.0998, FA=0.04914, CF=0.02454, over 0.00 frames.
2025-01-26 10:42:42,064 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 10:42:42,561 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 67824,  validation: loss=0.0734, DER=0.1726, ACC=0.9657, MI=0.09876, FA=0.05012, CF=0.0237, over 0.00 frames.
2025-01-26 10:42:42,562 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 11:00:25,502 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 68324, num_updates: 66500, {'loss': 0.11142536252737045, 'DER': 0.25806273470289376, 'ACC': np.float64(0.9502053571428571), 'MI': 0.16086812458581842, 'FA': 0.04727192401148664, 'CF': 0.04992268610558869}, batch size: 64, grad_norm: 0.15398362278938293, grad_scale: , lr: 0.00e+00,
2025-01-26 11:00:25,502 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 11:00:25,503 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 68324, num_updates: 66500, {'loss': 0.11717799305915833, 'DER': 0.2766575629031321, 'ACC': np.float64(0.9495357142857144), 'MI': 0.13504561566622117, 'FA': 0.08983671334766692, 'CF': 0.051775233889244}, batch size: 64, grad_norm: 0.15398362278938293, grad_scale: , lr: 0.00e+00,
2025-01-26 11:00:25,503 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 11:01:36,248 (model:870) WARNING: All labels are zero
2025-01-26 11:01:36,743 (model:870) WARNING: All labels are zero
2025-01-26 11:01:37,072 (model:870) WARNING: All labels are zero
2025-01-26 11:03:43,783 (model:870) WARNING: All labels are zero
2025-01-26 11:04:00,707 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 68324,  validation: loss=0.07359, DER=0.173, ACC=0.9656, MI=0.09927, FA=0.04976, CF=0.02401, over 0.00 frames.
2025-01-26 11:04:00,708 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 11:04:02,217 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 68324,  validation: loss=0.07499, DER=0.1738, ACC=0.9649, MI=0.1004, FA=0.04882, CF=0.02459, over 0.00 frames.
2025-01-26 11:04:02,217 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 11:21:38,784 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 68824, num_updates: 67000, {'loss': 0.10873604565858841, 'DER': 0.23622566809633785, 'ACC': np.float64(0.9539196428571429), 'MI': 0.135323875508633, 'FA': 0.053337732321566036, 'CF': 0.04756406026613879}, batch size: 64, grad_norm: 0.21690624952316284, grad_scale: , lr: 0.00e+00,
2025-01-26 11:21:38,784 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 68824, num_updates: 67000, {'loss': 0.12998470664024353, 'DER': 0.29628368794326243, 'ACC': np.float64(0.9436428571428571), 'MI': 0.15676595744680852, 'FA': 0.07767375886524823, 'CF': 0.061843971631205676}, batch size: 64, grad_norm: 0.21690624952316284, grad_scale: , lr: 0.00e+00,
2025-01-26 11:21:38,784 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 11:21:38,784 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 11:22:48,687 (model:870) WARNING: All labels are zero
2025-01-26 11:22:49,454 (model:870) WARNING: All labels are zero
2025-01-26 11:22:49,500 (model:870) WARNING: All labels are zero
2025-01-26 11:24:57,631 (model:870) WARNING: All labels are zero
2025-01-26 11:25:14,649 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 68824,  validation: loss=0.07363, DER=0.1734, ACC=0.9656, MI=0.09958, FA=0.04988, CF=0.02389, over 0.00 frames.
2025-01-26 11:25:14,650 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 11:25:15,100 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 68824,  validation: loss=0.07516, DER=0.1743, ACC=0.9648, MI=0.1007, FA=0.04878, CF=0.02473, over 0.00 frames.
2025-01-26 11:25:15,100 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 11:31:28,615 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-69000.pt
2025-01-26 11:31:29,144 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-26 11:43:00,536 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 69324, num_updates: 67500, {'loss': 0.09573007375001907, 'DER': 0.24681006197593874, 'ACC': np.float64(0.9557232142857144), 'MI': 0.12449872402479037, 'FA': 0.06780896828290194, 'CF': 0.054502369668246446}, batch size: 64, grad_norm: 0.18405024707317352, grad_scale: , lr: 0.00e+00,
2025-01-26 11:43:00,537 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 11:43:00,538 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 69324, num_updates: 67500, {'loss': 0.11313698440790176, 'DER': 0.24514478427724154, 'ACC': np.float64(0.9551071428571429), 'MI': 0.14931968833585302, 'FA': 0.04861030352366554, 'CF': 0.047214792417722994}, batch size: 64, grad_norm: 0.18405024707317352, grad_scale: , lr: 0.00e+00,
2025-01-26 11:43:00,538 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 11:44:09,722 (model:870) WARNING: All labels are zero
2025-01-26 11:44:10,515 (model:870) WARNING: All labels are zero
2025-01-26 11:44:12,837 (model:870) WARNING: All labels are zero
2025-01-26 11:46:23,288 (model:870) WARNING: All labels are zero
2025-01-26 11:46:33,541 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 69324,  validation: loss=0.07515, DER=0.1742, ACC=0.9648, MI=0.09695, FA=0.05211, CF=0.02519, over 0.00 frames.
2025-01-26 11:46:33,541 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 11:46:40,638 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 69324,  validation: loss=0.07374, DER=0.1734, ACC=0.9655, MI=0.09592, FA=0.05287, CF=0.0246, over 0.00 frames.
2025-01-26 11:46:40,638 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 12:04:19,696 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 69824, num_updates: 68000, {'loss': 0.08870122581720352, 'DER': 0.22244037650863313, 'ACC': np.float64(0.9586517857142857), 'MI': 0.09868914939077207, 'FA': 0.07876652999942253, 'CF': 0.04498469711843853}, batch size: 64, grad_norm: 0.20881852507591248, grad_scale: , lr: 0.00e+00,
2025-01-26 12:04:19,696 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 12:04:19,696 (train_accelerate_ddp:702) INFO: [Train] - Epoch 17, batch_idx_train: 69824, num_updates: 68000, {'loss': 0.1288435459136963, 'DER': 0.27191024099833994, 'ACC': np.float64(0.946125), 'MI': 0.12691052721964624, 'FA': 0.07149808231724769, 'CF': 0.07350163146144599}, batch size: 64, grad_norm: 0.20881852507591248, grad_scale: , lr: 0.00e+00,
2025-01-26 12:04:19,697 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 12:05:28,634 (model:870) WARNING: All labels are zero
2025-01-26 12:05:29,439 (model:870) WARNING: All labels are zero
2025-01-26 12:05:31,674 (model:870) WARNING: All labels are zero
2025-01-26 12:07:41,745 (model:870) WARNING: All labels are zero
2025-01-26 12:07:52,158 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 69824,  validation: loss=0.07478, DER=0.1734, ACC=0.965, MI=0.09939, FA=0.04945, CF=0.02452, over 0.00 frames.
2025-01-26 12:07:52,158 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 12:07:59,057 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 17, batch_idx_train: 69824,  validation: loss=0.07328, DER=0.1724, ACC=0.9658, MI=0.09832, FA=0.05026, CF=0.02383, over 0.00 frames.
2025-01-26 12:07:59,058 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 12:11:54,427 (train_accelerate_ddp:713) INFO: end of epoch 17, batch_idx: 4113 batch_idx_train: 69937, {'loss': 0.10429125279188156, 'DER': 0.2293462839681327, 'ACC': np.float64(0.9555950742614073), 'MI': 0.13101604278074866, 'FA': 0.05653170359052712, 'CF': 0.04179853759685692}, batch size: 64, grad_norm: 0.183954119682312, grad_scale: , lr: 0.00e+00,
2025-01-26 12:11:54,427 (train_accelerate_ddp:713) INFO: end of epoch 17, batch_idx: 4113 batch_idx_train: 69937, {'loss': 0.08704810589551926, 'DER': 0.19550762697658824, 'ACC': np.float64(0.9634328692304249), 'MI': 0.10934793540816896, 'FA': 0.05347264904732637, 'CF': 0.03268704252109292}, batch size: 64, grad_norm: 0.183954119682312, grad_scale: , lr: 0.00e+00,
2025-01-26 12:11:54,429 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-17.pt
2025-01-26 12:11:54,981 (train_accelerate_ddp:561) INFO:  end of epoch 17, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-17.pt
2025-01-26 12:11:58,982 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 69938, num_updates: 68000, {'loss': 0.11704324930906296, 'DER': 0.2624351029978228, 'ACC': np.float64(0.9479541910855422), 'MI': 0.13543236755429017, 'FA': 0.06520404175738291, 'CF': 0.06179869368614972}, batch size: 64, grad_norm: 0.1878572404384613, grad_scale: , lr: 0.00e+00,
2025-01-26 12:11:58,986 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 69938, num_updates: 68000, {'loss': 0.0823003426194191, 'DER': 0.1906148313067306, 'ACC': np.float64(0.9660535714285714), 'MI': 0.11006450876291603, 'FA': 0.054118855968487756, 'CF': 0.026431466575326825}, batch size: 64, grad_norm: 0.1878572404384613, grad_scale: , lr: 0.00e+00,
2025-01-26 12:29:42,682 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 70438, num_updates: 68500, {'loss': 0.0962214469909668, 'DER': 0.25426910500181665, 'ACC': np.float64(0.9576398448254286), 'MI': 0.142545718784062, 'FA': 0.07902385854426547, 'CF': 0.03269952767348916}, batch size: 64, grad_norm: 0.21924260258674622, grad_scale: , lr: 0.00e+00,
2025-01-26 12:29:42,683 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 12:29:42,683 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 70438, num_updates: 68500, {'loss': 0.12849242985248566, 'DER': 0.3085321927059883, 'ACC': np.float64(0.9410446428571428), 'MI': 0.2014295362449347, 'FA': 0.0440117064385412, 'CF': 0.06309095002251239}, batch size: 64, grad_norm: 0.21924260258674622, grad_scale: , lr: 0.00e+00,
2025-01-26 12:29:42,683 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 12:30:51,759 (model:870) WARNING: All labels are zero
2025-01-26 12:30:52,555 (model:870) WARNING: All labels are zero
2025-01-26 12:30:54,555 (model:870) WARNING: All labels are zero
2025-01-26 12:33:04,939 (model:870) WARNING: All labels are zero
2025-01-26 12:33:15,229 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 70438,  validation: loss=0.07514, DER=0.1743, ACC=0.9648, MI=0.1006, FA=0.04901, CF=0.02471, over 0.00 frames.
2025-01-26 12:33:15,229 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 12:33:22,191 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 70438,  validation: loss=0.07366, DER=0.1733, ACC=0.9656, MI=0.09935, FA=0.05, CF=0.02394, over 0.00 frames.
2025-01-26 12:33:22,192 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 12:35:30,919 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-70500.pt
2025-01-26 12:35:31,525 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-26 12:35:31,563 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-01-26 12:50:59,977 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 70938, num_updates: 69000, {'loss': 0.09637618809938431, 'DER': 0.20508396595353118, 'ACC': np.float64(0.9619553571428571), 'MI': 0.10156429721647113, 'FA': 0.06354957441913964, 'CF': 0.0399700943179204}, batch size: 64, grad_norm: 0.18748100101947784, grad_scale: , lr: 0.00e+00,
2025-01-26 12:50:59,978 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 70938, num_updates: 69000, {'loss': 0.11891773343086243, 'DER': 0.2630451087538841, 'ACC': np.float64(0.9467053571428571), 'MI': 0.14571948998178508, 'FA': 0.06059144969463195, 'CF': 0.056734169077467055}, batch size: 64, grad_norm: 0.18748100101947784, grad_scale: , lr: 0.00e+00,
2025-01-26 12:50:59,978 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 12:50:59,978 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 12:52:10,192 (model:870) WARNING: All labels are zero
2025-01-26 12:52:10,998 (model:870) WARNING: All labels are zero
2025-01-26 12:52:12,817 (model:870) WARNING: All labels are zero
2025-01-26 12:54:23,361 (model:870) WARNING: All labels are zero
2025-01-26 12:54:34,614 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 70938,  validation: loss=0.07505, DER=0.1739, ACC=0.9649, MI=0.09991, FA=0.04939, CF=0.02462, over 0.00 frames.
2025-01-26 12:54:34,614 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 12:54:40,636 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 70938,  validation: loss=0.07356, DER=0.1732, ACC=0.9657, MI=0.09888, FA=0.05043, CF=0.02384, over 0.00 frames.
2025-01-26 12:54:40,637 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 13:12:23,211 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 71438, num_updates: 69500, {'loss': 0.08908175677061081, 'DER': 0.19922969187675071, 'ACC': np.float64(0.9643392857142856), 'MI': 0.10795985060690944, 'FA': 0.05742296918767507, 'CF': 0.0338468720821662}, batch size: 64, grad_norm: 0.17601098120212555, grad_scale: , lr: 0.00e+00,
2025-01-26 13:12:23,211 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 71438, num_updates: 69500, {'loss': 0.12150803208351135, 'DER': 0.26244393392407833, 'ACC': np.float64(0.9495357142857144), 'MI': 0.16628377639207964, 'FA': 0.04944754403238158, 'CF': 0.04671261349961711}, batch size: 64, grad_norm: 0.17601098120212555, grad_scale: , lr: 0.00e+00,
2025-01-26 13:12:23,212 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 13:12:23,212 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 13:13:34,516 (model:870) WARNING: All labels are zero
2025-01-26 13:13:34,995 (model:870) WARNING: All labels are zero
2025-01-26 13:13:35,334 (model:870) WARNING: All labels are zero
2025-01-26 13:15:45,647 (model:870) WARNING: All labels are zero
2025-01-26 13:16:02,952 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 71438,  validation: loss=0.07371, DER=0.1733, ACC=0.9655, MI=0.09679, FA=0.05205, CF=0.02442, over 0.00 frames.
2025-01-26 13:16:02,952 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 13:16:03,691 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 71438,  validation: loss=0.07512, DER=0.174, ACC=0.9648, MI=0.09805, FA=0.05113, CF=0.02481, over 0.00 frames.
2025-01-26 13:16:03,692 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 13:33:42,734 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 71938, num_updates: 70000, {'loss': 0.08641722798347473, 'DER': 0.1917297545308557, 'ACC': np.float64(0.9662053571428572), 'MI': 0.11178022482220693, 'FA': 0.05459967882541868, 'CF': 0.0253498508832301}, batch size: 64, grad_norm: 0.18307004868984222, grad_scale: , lr: 0.00e+00,
2025-01-26 13:33:42,735 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 13:33:42,736 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 71938, num_updates: 70000, {'loss': 0.12574049830436707, 'DER': 0.26599130158056644, 'ACC': np.float64(0.9475089285714285), 'MI': 0.15630635408931792, 'FA': 0.06385912803649094, 'CF': 0.04582581945475761}, batch size: 64, grad_norm: 0.18307004868984222, grad_scale: , lr: 0.00e+00,
2025-01-26 13:33:42,736 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 13:34:51,535 (model:870) WARNING: All labels are zero
2025-01-26 13:34:52,333 (model:870) WARNING: All labels are zero
2025-01-26 13:34:54,236 (model:870) WARNING: All labels are zero
2025-01-26 13:37:04,161 (model:870) WARNING: All labels are zero
2025-01-26 13:37:15,425 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 71938,  validation: loss=0.07504, DER=0.1738, ACC=0.9649, MI=0.1001, FA=0.04907, CF=0.02465, over 0.00 frames.
2025-01-26 13:37:15,426 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 13:37:21,368 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 71938,  validation: loss=0.07355, DER=0.1729, ACC=0.9657, MI=0.09915, FA=0.04992, CF=0.0238, over 0.00 frames.
2025-01-26 13:37:21,368 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 13:39:30,898 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-72000.pt
2025-01-26 13:39:32,126 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-26 13:55:08,636 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 72438, num_updates: 70500, {'loss': 0.1040627732872963, 'DER': 0.227728285077951, 'ACC': np.float64(0.9566964285714286), 'MI': 0.13658129175946548, 'FA': 0.048830734966592425, 'CF': 0.042316258351893093}, batch size: 64, grad_norm: 0.22125694155693054, grad_scale: , lr: 0.00e+00,
2025-01-26 13:55:08,636 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 72438, num_updates: 70500, {'loss': 0.14124695956707, 'DER': 0.30175142435112895, 'ACC': np.float64(0.9408035714285714), 'MI': 0.20125553914327918, 'FA': 0.052489976788351975, 'CF': 0.048005908419497784}, batch size: 64, grad_norm: 0.22125694155693054, grad_scale: , lr: 0.00e+00,
2025-01-26 13:55:08,637 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 13:55:08,637 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 13:56:17,753 (model:870) WARNING: All labels are zero
2025-01-26 13:56:18,547 (model:870) WARNING: All labels are zero
2025-01-26 13:56:19,730 (model:870) WARNING: All labels are zero
2025-01-26 13:58:28,630 (model:870) WARNING: All labels are zero
2025-01-26 13:58:42,126 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 72438,  validation: loss=0.07502, DER=0.1735, ACC=0.9649, MI=0.0986, FA=0.0503, CF=0.02459, over 0.00 frames.
2025-01-26 13:58:42,126 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 13:58:45,781 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 72438,  validation: loss=0.07353, DER=0.1726, ACC=0.9657, MI=0.09737, FA=0.05124, CF=0.02403, over 0.00 frames.
2025-01-26 13:58:45,781 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 14:16:23,910 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 72938, num_updates: 71000, {'loss': 0.11946892738342285, 'DER': 0.2737466307277628, 'ACC': np.float64(0.94375), 'MI': 0.1597843665768194, 'FA': 0.04808625336927224, 'CF': 0.06587601078167116}, batch size: 64, grad_norm: 0.23976191878318787, grad_scale: , lr: 0.00e+00,
2025-01-26 14:16:23,910 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 72938, num_updates: 71000, {'loss': 0.1290566623210907, 'DER': 0.2706712198398925, 'ACC': np.float64(0.9485625), 'MI': 0.16038739293511728, 'FA': 0.0584448300957286, 'CF': 0.051838996809046634}, batch size: 64, grad_norm: 0.23976191878318787, grad_scale: , lr: 0.00e+00,
2025-01-26 14:16:23,911 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 14:16:23,911 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 14:17:33,068 (model:870) WARNING: All labels are zero
2025-01-26 14:17:33,854 (model:870) WARNING: All labels are zero
2025-01-26 14:17:35,675 (model:870) WARNING: All labels are zero
2025-01-26 14:19:45,526 (model:870) WARNING: All labels are zero
2025-01-26 14:19:57,535 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 72938,  validation: loss=0.07516, DER=0.1744, ACC=0.9648, MI=0.09995, FA=0.0497, CF=0.02478, over 0.00 frames.
2025-01-26 14:19:57,535 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 14:20:02,738 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 72938,  validation: loss=0.0737, DER=0.1732, ACC=0.9656, MI=0.09863, FA=0.05036, CF=0.02422, over 0.00 frames.
2025-01-26 14:20:02,738 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 14:37:48,763 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 73438, num_updates: 71500, {'loss': 0.12090715020895004, 'DER': 0.2779929097354786, 'ACC': np.float64(0.9437589285714285), 'MI': 0.15353149713662395, 'FA': 0.058903736023997816, 'CF': 0.06555767657485684}, batch size: 64, grad_norm: 0.16657379269599915, grad_scale: , lr: 0.00e+00,
2025-01-26 14:37:48,764 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 14:37:48,765 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 73438, num_updates: 71500, {'loss': 0.10524706542491913, 'DER': 0.24063726072999644, 'ACC': np.float64(0.9583125), 'MI': 0.12329092854595174, 'FA': 0.08043038877660207, 'CF': 0.036915943407442635}, batch size: 64, grad_norm: 0.16657379269599915, grad_scale: , lr: 0.00e+00,
2025-01-26 14:37:48,765 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 14:38:58,680 (model:870) WARNING: All labels are zero
2025-01-26 14:38:59,484 (model:870) WARNING: All labels are zero
2025-01-26 14:39:01,328 (model:870) WARNING: All labels are zero
2025-01-26 14:41:11,877 (model:870) WARNING: All labels are zero
2025-01-26 14:41:23,042 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 73438,  validation: loss=0.07525, DER=0.1741, ACC=0.9648, MI=0.1003, FA=0.04922, CF=0.02464, over 0.00 frames.
2025-01-26 14:41:23,043 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 14:41:29,268 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 73438,  validation: loss=0.07375, DER=0.1733, ACC=0.9656, MI=0.09906, FA=0.05021, CF=0.024, over 0.00 frames.
2025-01-26 14:41:29,269 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 14:43:38,314 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-73500.pt
2025-01-26 14:43:38,861 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-26 14:59:16,540 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 73938, num_updates: 72000, {'loss': 0.11311428248882294, 'DER': 0.2635716745093538, 'ACC': np.float64(0.949305294780323), 'MI': 0.1272236887409618, 'FA': 0.07454378514862849, 'CF': 0.06180420061976357}, batch size: 64, grad_norm: 0.22866541147232056, grad_scale: , lr: 0.00e+00,
2025-01-26 14:59:16,540 (train_accelerate_ddp:702) INFO: [Train] - Epoch 18, batch_idx_train: 73938, num_updates: 72000, {'loss': 0.11505894362926483, 'DER': 0.275492167977083, 'ACC': np.float64(0.9508303571428571), 'MI': 0.12750655208142866, 'FA': 0.08782836594136649, 'CF': 0.060157249954287804}, batch size: 64, grad_norm: 0.22866541147232056, grad_scale: , lr: 0.00e+00,
2025-01-26 14:59:16,541 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 14:59:16,541 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 15:00:27,658 (model:870) WARNING: All labels are zero
2025-01-26 15:00:28,476 (model:870) WARNING: All labels are zero
2025-01-26 15:00:28,872 (model:870) WARNING: All labels are zero
2025-01-26 15:02:39,921 (model:870) WARNING: All labels are zero
2025-01-26 15:02:56,618 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 73938,  validation: loss=0.07499, DER=0.1736, ACC=0.9649, MI=0.09795, FA=0.05078, CF=0.02489, over 0.00 frames.
2025-01-26 15:02:56,619 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 15:02:57,364 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 18, batch_idx_train: 73938,  validation: loss=0.07355, DER=0.1726, ACC=0.9656, MI=0.09676, FA=0.05144, CF=0.02441, over 0.00 frames.
2025-01-26 15:02:57,364 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 15:06:57,964 (train_accelerate_ddp:713) INFO: end of epoch 18, batch_idx: 4113 batch_idx_train: 74051, {'loss': 0.1157243400812149, 'DER': 0.25132042253521125, 'ACC': np.float64(0.9500152337939316), 'MI': 0.1386443661971831, 'FA': 0.05710827464788732, 'CF': 0.055567781690140844}, batch size: 64, grad_norm: 0.24218326807022095, grad_scale: , lr: 0.00e+00,
2025-01-26 15:06:57,964 (train_accelerate_ddp:713) INFO: end of epoch 18, batch_idx: 4113 batch_idx_train: 74051, {'loss': 0.1207270473241806, 'DER': 0.2924988903683977, 'ACC': np.float64(0.94325), 'MI': 0.14918996893031514, 'FA': 0.08316688859298713, 'CF': 0.06014203284509543}, batch size: 64, grad_norm: 0.24218326807022095, grad_scale: , lr: 0.00e+00,
2025-01-26 15:06:57,967 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-18.pt
2025-01-26 15:06:58,425 (train_accelerate_ddp:561) INFO:  end of epoch 18, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-18.pt
2025-01-26 15:07:01,862 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 74052, num_updates: 72000, {'loss': 0.1089910939335823, 'DER': 0.2686370378509037, 'ACC': np.float64(0.94875), 'MI': 0.1596440147228479, 'FA': 0.06229742350162061, 'CF': 0.0466955996264352}, batch size: 64, grad_norm: 0.18304923176765442, grad_scale: , lr: 0.00e+00,
2025-01-26 15:07:01,864 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 74052, num_updates: 72000, {'loss': 0.12487606704235077, 'DER': 0.2619097807757167, 'ACC': np.float64(0.9476785714285715), 'MI': 0.15066399662731872, 'FA': 0.06434443507588533, 'CF': 0.04690134907251265}, batch size: 64, grad_norm: 0.18304923176765442, grad_scale: , lr: 0.00e+00,
2025-01-26 15:24:40,341 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 74552, num_updates: 72500, {'loss': 0.12255538254976273, 'DER': 0.2693536633219351, 'ACC': np.float64(0.9476428571428571), 'MI': 0.15185828802062895, 'FA': 0.05813106115813667, 'CF': 0.05936431414316946}, batch size: 64, grad_norm: 0.32008159160614014, grad_scale: , lr: 0.00e+00,
2025-01-26 15:24:40,341 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 74552, num_updates: 72500, {'loss': 0.132089763879776, 'DER': 0.289767995240928, 'ACC': np.float64(0.9429597201106369), 'MI': 0.15734681737061273, 'FA': 0.051695419393218325, 'CF': 0.08072575847709697}, batch size: 64, grad_norm: 0.32008159160614014, grad_scale: , lr: 0.00e+00,
2025-01-26 15:24:40,342 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 15:24:40,342 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 15:25:49,445 (model:870) WARNING: All labels are zero
2025-01-26 15:25:50,242 (model:870) WARNING: All labels are zero
2025-01-26 15:25:51,527 (model:870) WARNING: All labels are zero
2025-01-26 15:28:00,152 (model:870) WARNING: All labels are zero
2025-01-26 15:28:13,607 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 74552,  validation: loss=0.07501, DER=0.174, ACC=0.9649, MI=0.1, FA=0.04913, CF=0.02479, over 0.00 frames.
2025-01-26 15:28:13,608 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 15:28:17,274 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 74552,  validation: loss=0.07353, DER=0.1729, ACC=0.9657, MI=0.09887, FA=0.04994, CF=0.02412, over 0.00 frames.
2025-01-26 15:28:17,274 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 15:44:05,944 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-75000.pt
2025-01-26 15:44:06,488 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-26 15:44:06,516 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-01-26 15:46:01,067 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 75052, num_updates: 73000, {'loss': 0.10740958899259567, 'DER': 0.2302158273381295, 'ACC': np.float64(0.9579107142857143), 'MI': 0.13060770895478738, 'FA': 0.054103059016201674, 'CF': 0.04550505936714044}, batch size: 64, grad_norm: 0.23892450332641602, grad_scale: , lr: 0.00e+00,
2025-01-26 15:46:01,068 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 15:46:01,068 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 75052, num_updates: 73000, {'loss': 0.13187414407730103, 'DER': 0.311560755689137, 'ACC': np.float64(0.9395982142857143), 'MI': 0.2009446114212108, 'FA': 0.05909188492915415, 'CF': 0.051524259338772006}, batch size: 64, grad_norm: 0.23892450332641602, grad_scale: , lr: 0.00e+00,
2025-01-26 15:46:01,068 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 15:47:11,424 (model:870) WARNING: All labels are zero
2025-01-26 15:47:12,262 (model:870) WARNING: All labels are zero
2025-01-26 15:47:14,696 (model:870) WARNING: All labels are zero
2025-01-26 15:49:25,705 (model:870) WARNING: All labels are zero
2025-01-26 15:49:36,104 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 75052,  validation: loss=0.07491, DER=0.1737, ACC=0.9649, MI=0.09933, FA=0.04952, CF=0.02483, over 0.00 frames.
2025-01-26 15:49:36,104 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 15:49:43,066 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 75052,  validation: loss=0.07353, DER=0.173, ACC=0.9656, MI=0.0983, FA=0.05039, CF=0.02429, over 0.00 frames.
2025-01-26 15:49:43,066 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 16:07:30,141 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 75552, num_updates: 73500, {'loss': 0.11290467530488968, 'DER': 0.2690985015966593, 'ACC': np.float64(0.9514553571428571), 'MI': 0.13663718987963644, 'FA': 0.0676737902235323, 'CF': 0.06478752149349054}, batch size: 64, grad_norm: 0.17674657702445984, grad_scale: , lr: 0.00e+00,
2025-01-26 16:07:30,142 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 16:07:30,143 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 75552, num_updates: 73500, {'loss': 0.09481421858072281, 'DER': 0.21962120788870887, 'ACC': np.float64(0.9604196428571429), 'MI': 0.1302866081904017, 'FA': 0.06128834013073356, 'CF': 0.028046259567573607}, batch size: 64, grad_norm: 0.17674657702445984, grad_scale: , lr: 0.00e+00,
2025-01-26 16:07:30,144 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 16:08:39,598 (model:870) WARNING: All labels are zero
2025-01-26 16:08:40,396 (model:870) WARNING: All labels are zero
2025-01-26 16:08:42,437 (model:870) WARNING: All labels are zero
2025-01-26 16:10:53,440 (model:870) WARNING: All labels are zero
2025-01-26 16:11:04,493 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 75552,  validation: loss=0.07503, DER=0.1738, ACC=0.9649, MI=0.1001, FA=0.04915, CF=0.02454, over 0.00 frames.
2025-01-26 16:11:04,493 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 16:11:10,809 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 75552,  validation: loss=0.07353, DER=0.1731, ACC=0.9656, MI=0.09901, FA=0.05021, CF=0.02384, over 0.00 frames.
2025-01-26 16:11:10,809 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 16:28:55,877 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 76052, num_updates: 74000, {'loss': 0.10761626809835434, 'DER': 0.2636509464228425, 'ACC': np.float64(0.9538694204817983), 'MI': 0.11690728264356753, 'FA': 0.07962784728906, 'CF': 0.06711581649021495}, batch size: 64, grad_norm: 0.18583764135837555, grad_scale: , lr: 0.00e+00,
2025-01-26 16:28:55,877 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 76052, num_updates: 74000, {'loss': 0.11881548911333084, 'DER': 0.2911652846187418, 'ACC': np.float64(0.9492358470259022), 'MI': 0.1506328324708523, 'FA': 0.07880790572978365, 'CF': 0.06172454641810587}, batch size: 64, grad_norm: 0.18583764135837555, grad_scale: , lr: 0.00e+00,
2025-01-26 16:28:55,877 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 16:28:55,877 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 16:30:05,090 (model:870) WARNING: All labels are zero
2025-01-26 16:30:05,890 (model:870) WARNING: All labels are zero
2025-01-26 16:30:06,254 (model:870) WARNING: All labels are zero
2025-01-26 16:32:14,119 (model:870) WARNING: All labels are zero
2025-01-26 16:32:29,496 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 76052,  validation: loss=0.07501, DER=0.1742, ACC=0.9648, MI=0.0965, FA=0.0527, CF=0.02497, over 0.00 frames.
2025-01-26 16:32:29,496 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 16:32:31,049 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 76052,  validation: loss=0.07355, DER=0.1729, ACC=0.9656, MI=0.09543, FA=0.05315, CF=0.02435, over 0.00 frames.
2025-01-26 16:32:31,049 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 16:48:18,238 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-76500.pt
2025-01-26 16:48:19,422 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-26 16:50:13,535 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 76552, num_updates: 74500, {'loss': 0.11248338222503662, 'DER': 0.2500140837135936, 'ACC': np.float64(0.9536373204278248), 'MI': 0.16151202749140894, 'FA': 0.04816630049011323, 'CF': 0.04033575573207143}, batch size: 64, grad_norm: 0.24322724342346191, grad_scale: , lr: 0.00e+00,
2025-01-26 16:50:13,536 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 16:50:13,538 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 76552, num_updates: 74500, {'loss': 0.12446089088916779, 'DER': 0.2930394294807568, 'ACC': np.float64(0.9467635959447468), 'MI': 0.16473153769081159, 'FA': 0.07131490540460894, 'CF': 0.05699298638533624}, batch size: 64, grad_norm: 0.24322724342346191, grad_scale: , lr: 0.00e+00,
2025-01-26 16:50:13,538 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 16:51:22,696 (model:870) WARNING: All labels are zero
2025-01-26 16:51:23,499 (model:870) WARNING: All labels are zero
2025-01-26 16:51:25,410 (model:870) WARNING: All labels are zero
2025-01-26 16:53:35,546 (model:870) WARNING: All labels are zero
2025-01-26 16:53:46,937 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 76552,  validation: loss=0.07506, DER=0.174, ACC=0.9649, MI=0.1001, FA=0.04923, CF=0.02464, over 0.00 frames.
2025-01-26 16:53:46,937 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 16:53:52,766 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 76552,  validation: loss=0.07365, DER=0.173, ACC=0.9656, MI=0.0989, FA=0.0501, CF=0.02405, over 0.00 frames.
2025-01-26 16:53:52,766 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 17:11:35,240 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 77052, num_updates: 75000, {'loss': 0.10154731571674347, 'DER': 0.25605515587529976, 'ACC': np.float64(0.9558544545642539), 'MI': 0.14292565947242206, 'FA': 0.07482014388489208, 'CF': 0.03830935251798561}, batch size: 64, grad_norm: 0.1643040031194687, grad_scale: , lr: 0.00e+00,
2025-01-26 17:11:35,240 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 77052, num_updates: 75000, {'loss': 0.1095435619354248, 'DER': 0.2520576699994476, 'ACC': np.float64(0.9525535714285714), 'MI': 0.14721316908799648, 'FA': 0.06335966414406452, 'CF': 0.041484836767386624}, batch size: 64, grad_norm: 0.1643040031194687, grad_scale: , lr: 0.00e+00,
2025-01-26 17:11:35,241 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 17:11:35,241 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 17:12:44,096 (model:870) WARNING: All labels are zero
2025-01-26 17:12:44,898 (model:870) WARNING: All labels are zero
2025-01-26 17:12:46,904 (model:870) WARNING: All labels are zero
2025-01-26 17:14:56,971 (model:870) WARNING: All labels are zero
2025-01-26 17:15:08,265 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 77052,  validation: loss=0.07523, DER=0.1745, ACC=0.9648, MI=0.1017, FA=0.04846, CF=0.02439, over 0.00 frames.
2025-01-26 17:15:08,266 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 17:15:14,208 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 77052,  validation: loss=0.07385, DER=0.1737, ACC=0.9655, MI=0.1005, FA=0.04931, CF=0.02392, over 0.00 frames.
2025-01-26 17:15:14,209 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 17:32:55,327 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 77552, num_updates: 75500, {'loss': 0.09123252332210541, 'DER': 0.24483592829228956, 'ACC': np.float64(0.9584642857142857), 'MI': 0.12027789839339992, 'FA': 0.08082625147323368, 'CF': 0.043731778425655975}, batch size: 64, grad_norm: 0.16361822187900543, grad_scale: , lr: 0.00e+00,
2025-01-26 17:32:55,327 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 77552, num_updates: 75500, {'loss': 0.0844716876745224, 'DER': 0.19853593611357587, 'ACC': np.float64(0.9640803571428571), 'MI': 0.11207852706299912, 'FA': 0.06188997338065661, 'CF': 0.024567435669920142}, batch size: 64, grad_norm: 0.16361822187900543, grad_scale: , lr: 0.00e+00,
2025-01-26 17:32:55,327 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 17:32:55,327 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 17:34:05,734 (model:870) WARNING: All labels are zero
2025-01-26 17:34:06,533 (model:870) WARNING: All labels are zero
2025-01-26 17:34:07,464 (model:870) WARNING: All labels are zero
2025-01-26 17:36:18,381 (model:870) WARNING: All labels are zero
2025-01-26 17:36:32,875 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 77552,  validation: loss=0.07511, DER=0.1736, ACC=0.9649, MI=0.09702, FA=0.05159, CF=0.02498, over 0.00 frames.
2025-01-26 17:36:32,876 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 17:36:35,790 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 77552,  validation: loss=0.07357, DER=0.1727, ACC=0.9657, MI=0.09618, FA=0.05234, CF=0.02418, over 0.00 frames.
2025-01-26 17:36:35,790 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 17:52:23,798 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-78000.pt
2025-01-26 17:52:24,352 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-26 17:54:15,464 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 78052, num_updates: 76000, {'loss': 0.10117999464273453, 'DER': 0.23659797023846585, 'ACC': np.float64(0.9600446428571429), 'MI': 0.10167486457879335, 'FA': 0.09289583463047132, 'CF': 0.04202727102920117}, batch size: 64, grad_norm: 0.20859216153621674, grad_scale: , lr: 0.00e+00,
2025-01-26 17:54:15,464 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 17:54:15,464 (train_accelerate_ddp:702) INFO: [Train] - Epoch 19, batch_idx_train: 78052, num_updates: 76000, {'loss': 0.10053754597902298, 'DER': 0.2575209087504681, 'ACC': np.float64(0.9568839285714286), 'MI': 0.10217201348146299, 'FA': 0.11147172637623268, 'CF': 0.04387716889277244}, batch size: 64, grad_norm: 0.20859216153621674, grad_scale: , lr: 0.00e+00,
2025-01-26 17:54:15,464 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 17:55:24,716 (model:870) WARNING: All labels are zero
2025-01-26 17:55:25,524 (model:870) WARNING: All labels are zero
2025-01-26 17:55:25,799 (model:870) WARNING: All labels are zero
2025-01-26 17:57:33,693 (model:870) WARNING: All labels are zero
2025-01-26 17:57:50,380 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 78052,  validation: loss=0.07508, DER=0.1738, ACC=0.9649, MI=0.09914, FA=0.04978, CF=0.02485, over 0.00 frames.
2025-01-26 17:57:50,381 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 17:57:50,672 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 19, batch_idx_train: 78052,  validation: loss=0.07373, DER=0.1733, ACC=0.9656, MI=0.0982, FA=0.05076, CF=0.02432, over 0.00 frames.
2025-01-26 17:57:50,673 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 18:01:48,954 (train_accelerate_ddp:713) INFO: end of epoch 19, batch_idx: 4113 batch_idx_train: 78165, {'loss': 0.12486231327056885, 'DER': 0.28132644740418594, 'ACC': np.float64(0.9446875), 'MI': 0.164773036151128, 'FA': 0.06110356075020386, 'CF': 0.05544985050285404}, batch size: 64, grad_norm: 0.27196091413497925, grad_scale: , lr: 0.00e+00,
2025-01-26 18:01:48,954 (train_accelerate_ddp:713) INFO: end of epoch 19, batch_idx: 4113 batch_idx_train: 78165, {'loss': 0.11017297953367233, 'DER': 0.25923059915984964, 'ACC': np.float64(0.9491517857142857), 'MI': 0.14636303338492151, 'FA': 0.05731815166924607, 'CF': 0.05554941410568207}, batch size: 64, grad_norm: 0.27196091413497925, grad_scale: , lr: 0.00e+00,
2025-01-26 18:01:48,956 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-19.pt
2025-01-26 18:01:49,387 (train_accelerate_ddp:561) INFO:  end of epoch 19, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-19.pt
2025-01-26 18:01:52,722 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 78166, num_updates: 76000, {'loss': 0.09589240700006485, 'DER': 0.2392294220665499, 'ACC': np.float64(0.9586383239247676), 'MI': 0.1373029772329247, 'FA': 0.07297139521307647, 'CF': 0.028955049620548744}, batch size: 64, grad_norm: 0.14272063970565796, grad_scale: , lr: 0.00e+00,
2025-01-26 18:01:52,724 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 78166, num_updates: 76000, {'loss': 0.09081566333770752, 'DER': 0.2068385313382609, 'ACC': np.float64(0.9634196428571429), 'MI': 0.11429601586443122, 'FA': 0.05318190012619434, 'CF': 0.03936061534763536}, batch size: 64, grad_norm: 0.14272063970565796, grad_scale: , lr: 0.00e+00,
2025-01-26 18:19:29,933 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 78666, num_updates: 76500, {'loss': 0.11951585859060287, 'DER': 0.27579386880562573, 'ACC': np.float64(0.9497857142857143), 'MI': 0.19261619602241511, 'FA': 0.049994506098230966, 'CF': 0.03318316668497967}, batch size: 64, grad_norm: 0.19760604202747345, grad_scale: , lr: 0.00e+00,
2025-01-26 18:19:29,933 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 78666, num_updates: 76500, {'loss': 0.10514134168624878, 'DER': 0.2432462791350744, 'ACC': np.float64(0.9515446428571429), 'MI': 0.14007301319853974, 'FA': 0.04161752316764954, 'CF': 0.06155574276888515}, batch size: 64, grad_norm: 0.19760604202747345, grad_scale: , lr: 0.00e+00,
2025-01-26 18:19:29,934 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 18:19:29,934 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 18:20:39,436 (model:870) WARNING: All labels are zero
2025-01-26 18:20:40,252 (model:870) WARNING: All labels are zero
2025-01-26 18:20:42,002 (model:870) WARNING: All labels are zero
2025-01-26 18:22:52,108 (model:870) WARNING: All labels are zero
2025-01-26 18:23:04,565 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 78666,  validation: loss=0.07509, DER=0.1739, ACC=0.9649, MI=0.1002, FA=0.04913, CF=0.02455, over 0.00 frames.
2025-01-26 18:23:04,566 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 18:23:09,437 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 78666,  validation: loss=0.07364, DER=0.1732, ACC=0.9656, MI=0.09914, FA=0.05012, CF=0.02394, over 0.00 frames.
2025-01-26 18:23:09,437 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 18:40:52,585 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 79166, num_updates: 77000, {'loss': 0.1178346499800682, 'DER': 0.27217054711421806, 'ACC': np.float64(0.9498907737533375), 'MI': 0.14339361026055808, 'FA': 0.07891848171471488, 'CF': 0.04985845513894506}, batch size: 64, grad_norm: 0.20245641469955444, grad_scale: , lr: 0.00e+00,
2025-01-26 18:40:52,585 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 18:40:52,587 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 79166, num_updates: 77000, {'loss': 0.10360539704561234, 'DER': 0.23905687152057636, 'ACC': np.float64(0.9564732142857143), 'MI': 0.16570243423207073, 'FA': 0.04633773605501583, 'CF': 0.027016701233489794}, batch size: 64, grad_norm: 0.20245641469955444, grad_scale: , lr: 0.00e+00,
2025-01-26 18:40:52,587 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 18:42:02,034 (model:870) WARNING: All labels are zero
2025-01-26 18:42:02,849 (model:870) WARNING: All labels are zero
2025-01-26 18:42:04,729 (model:870) WARNING: All labels are zero
2025-01-26 18:44:15,040 (model:870) WARNING: All labels are zero
2025-01-26 18:44:26,713 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 79166,  validation: loss=0.0749, DER=0.1733, ACC=0.9649, MI=0.1001, FA=0.04886, CF=0.02441, over 0.00 frames.
2025-01-26 18:44:26,714 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 18:44:32,304 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 79166,  validation: loss=0.07351, DER=0.1727, ACC=0.9657, MI=0.09903, FA=0.04993, CF=0.02375, over 0.00 frames.
2025-01-26 18:44:32,304 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 18:56:17,776 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-79500.pt
2025-01-26 18:56:19,029 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-26 18:56:19,070 (checkpoint:362) INFO: currently, remove unused epoch-*.pt
2025-01-26 19:02:18,191 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 79666, num_updates: 77500, {'loss': 0.13480183482170105, 'DER': 0.3172, 'ACC': np.float64(0.9411048297675094), 'MI': 0.20411428571428572, 'FA': 0.06, 'CF': 0.053085714285714285}, batch size: 64, grad_norm: 0.21964296698570251, grad_scale: , lr: 0.00e+00,
2025-01-26 19:02:18,191 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 79666, num_updates: 77500, {'loss': 0.10006659477949142, 'DER': 0.23444055944055944, 'ACC': np.float64(0.959800706131154), 'MI': 0.12680652680652682, 'FA': 0.08065268065268065, 'CF': 0.026981351981351983}, batch size: 64, grad_norm: 0.21964296698570251, grad_scale: , lr: 0.00e+00,
2025-01-26 19:02:18,191 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 19:02:18,191 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 19:03:27,328 (model:870) WARNING: All labels are zero
2025-01-26 19:03:28,126 (model:870) WARNING: All labels are zero
2025-01-26 19:03:28,805 (model:870) WARNING: All labels are zero
2025-01-26 19:05:36,938 (model:870) WARNING: All labels are zero
2025-01-26 19:05:52,007 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 79666,  validation: loss=0.07506, DER=0.1736, ACC=0.9649, MI=0.09885, FA=0.04994, CF=0.02477, over 0.00 frames.
2025-01-26 19:05:52,008 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 19:05:53,940 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 79666,  validation: loss=0.07351, DER=0.1726, ACC=0.9657, MI=0.09761, FA=0.05092, CF=0.02402, over 0.00 frames.
2025-01-26 19:05:53,940 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 19:23:29,511 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 80166, num_updates: 78000, {'loss': 0.10279086232185364, 'DER': 0.24350501367365543, 'ACC': np.float64(0.9539375), 'MI': 0.12665223336371922, 'FA': 0.06643117593436645, 'CF': 0.05042160437556974}, batch size: 64, grad_norm: 0.20602741837501526, grad_scale: , lr: 0.00e+00,
2025-01-26 19:23:29,512 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 19:23:29,512 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 80166, num_updates: 78000, {'loss': 0.11289717257022858, 'DER': 0.26740817981693893, 'ACC': np.float64(0.9494910714285715), 'MI': 0.1286641177152126, 'FA': 0.07843818792723903, 'CF': 0.060305874174487316}, batch size: 64, grad_norm: 0.20602741837501526, grad_scale: , lr: 0.00e+00,
2025-01-26 19:23:29,512 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 19:24:39,356 (model:870) WARNING: All labels are zero
2025-01-26 19:24:40,161 (model:870) WARNING: All labels are zero
2025-01-26 19:24:40,681 (model:870) WARNING: All labels are zero
2025-01-26 19:26:49,788 (model:870) WARNING: All labels are zero
2025-01-26 19:27:05,385 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 80166,  validation: loss=0.07504, DER=0.1739, ACC=0.9649, MI=0.09876, FA=0.05042, CF=0.0247, over 0.00 frames.
2025-01-26 19:27:05,386 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 19:27:07,106 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 80166,  validation: loss=0.07371, DER=0.1733, ACC=0.9656, MI=0.0977, FA=0.05129, CF=0.02429, over 0.00 frames.
2025-01-26 19:27:07,106 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 19:44:48,817 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 80666, num_updates: 78500, {'loss': 0.11808104813098907, 'DER': 0.2464583977729663, 'ACC': np.float64(0.9545535714285714), 'MI': 0.10634085988246211, 'FA': 0.07169811320754717, 'CF': 0.068419424682957}, batch size: 64, grad_norm: 0.215119406580925, grad_scale: , lr: 0.00e+00,
2025-01-26 19:44:48,817 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 80666, num_updates: 78500, {'loss': 0.11883669346570969, 'DER': 0.28330729747824146, 'ACC': np.float64(0.9486160714285714), 'MI': 0.17914528007141264, 'FA': 0.0663914304842669, 'CF': 0.03777058692256193}, batch size: 64, grad_norm: 0.215119406580925, grad_scale: , lr: 0.00e+00,
2025-01-26 19:44:48,818 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 19:44:48,818 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 19:45:57,799 (model:870) WARNING: All labels are zero
2025-01-26 19:45:58,598 (model:870) WARNING: All labels are zero
2025-01-26 19:45:59,303 (model:870) WARNING: All labels are zero
2025-01-26 19:48:07,479 (model:870) WARNING: All labels are zero
2025-01-26 19:48:22,188 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 80666,  validation: loss=0.07502, DER=0.1744, ACC=0.9649, MI=0.09946, FA=0.05021, CF=0.02469, over 0.00 frames.
2025-01-26 19:48:22,188 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 19:48:24,466 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 80666,  validation: loss=0.07353, DER=0.1729, ACC=0.9657, MI=0.09815, FA=0.05075, CF=0.02402, over 0.00 frames.
2025-01-26 19:48:24,467 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 20:00:07,225 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/checkpoint-81000.pt
2025-01-26 20:00:08,410 (checkpoint:473) INFO: currently, remove unused checkpoint-*.pt
2025-01-26 20:06:03,111 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 81166, num_updates: 79000, {'loss': 0.10693828761577606, 'DER': 0.2658522396742292, 'ACC': np.float64(0.9496021220159151), 'MI': 0.13769633507853404, 'FA': 0.06905177428737638, 'CF': 0.05910413030831879}, batch size: 64, grad_norm: 0.19253869354724884, grad_scale: , lr: 0.00e+00,
2025-01-26 20:06:03,111 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 20:06:03,112 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 81166, num_updates: 79000, {'loss': 0.1144995391368866, 'DER': 0.2760071465621578, 'ACC': np.float64(0.9495446428571429), 'MI': 0.15197971298484236, 'FA': 0.0743472998674428, 'CF': 0.04968013370987263}, batch size: 64, grad_norm: 0.19253869354724884, grad_scale: , lr: 0.00e+00,
2025-01-26 20:06:03,112 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 20:07:12,294 (model:870) WARNING: All labels are zero
2025-01-26 20:07:13,099 (model:870) WARNING: All labels are zero
2025-01-26 20:07:13,371 (model:870) WARNING: All labels are zero
2025-01-26 20:09:20,743 (model:870) WARNING: All labels are zero
2025-01-26 20:09:36,975 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 81166,  validation: loss=0.07508, DER=0.1738, ACC=0.9649, MI=0.09985, FA=0.04918, CF=0.02472, over 0.00 frames.
2025-01-26 20:09:36,976 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 20:09:37,693 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 81166,  validation: loss=0.07349, DER=0.1729, ACC=0.9657, MI=0.09881, FA=0.05029, CF=0.02383, over 0.00 frames.
2025-01-26 20:09:37,693 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 20:27:15,002 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 81666, num_updates: 79500, {'loss': 0.09345507621765137, 'DER': 0.22701804076103688, 'ACC': np.float64(0.9624107142857143), 'MI': 0.11064589618865833, 'FA': 0.08416969398436057, 'CF': 0.03220245058801798}, batch size: 64, grad_norm: 0.23324815928936005, grad_scale: , lr: 0.00e+00,
2025-01-26 20:27:15,002 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 20:27:15,004 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 81666, num_updates: 79500, {'loss': 0.10987170785665512, 'DER': 0.27195567605799836, 'ACC': np.float64(0.952125), 'MI': 0.17340563479900978, 'FA': 0.05446186490628315, 'CF': 0.04408817635270541}, batch size: 64, grad_norm: 0.23324815928936005, grad_scale: , lr: 0.00e+00,
2025-01-26 20:27:15,004 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 20:28:24,576 (model:870) WARNING: All labels are zero
2025-01-26 20:28:25,380 (model:870) WARNING: All labels are zero
2025-01-26 20:28:27,016 (model:870) WARNING: All labels are zero
2025-01-26 20:30:37,554 (model:870) WARNING: All labels are zero
2025-01-26 20:30:49,671 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 81666,  validation: loss=0.07501, DER=0.1737, ACC=0.9649, MI=0.1003, FA=0.04885, CF=0.02448, over 0.00 frames.
2025-01-26 20:30:49,672 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 20:30:54,842 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 81666,  validation: loss=0.07354, DER=0.1726, ACC=0.9657, MI=0.09923, FA=0.04975, CF=0.02359, over 0.00 frames.
2025-01-26 20:30:54,843 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 20:48:27,854 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 82166, num_updates: 80000, {'loss': 0.0990808755159378, 'DER': 0.22427346355407338, 'ACC': np.float64(0.9598214285714286), 'MI': 0.11261314911862792, 'FA': 0.06794902334444974, 'CF': 0.04371129109099571}, batch size: 64, grad_norm: 0.17709030210971832, grad_scale: , lr: 0.00e+00,
2025-01-26 20:48:27,854 (train_accelerate_ddp:702) INFO: [Train] - Epoch 20, batch_idx_train: 82166, num_updates: 80000, {'loss': 0.09910756349563599, 'DER': 0.21163934426229508, 'ACC': np.float64(0.9604821428571428), 'MI': 0.1251912568306011, 'FA': 0.05622950819672131, 'CF': 0.03021857923497268}, batch size: 64, grad_norm: 0.17709030210971832, grad_scale: , lr: 0.00e+00,
2025-01-26 20:48:27,855 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 20:48:27,855 (train_accelerate_ddp:720) INFO: Computing validation loss
2025-01-26 20:49:36,846 (model:870) WARNING: All labels are zero
2025-01-26 20:49:37,644 (model:870) WARNING: All labels are zero
2025-01-26 20:49:38,191 (model:870) WARNING: All labels are zero
2025-01-26 20:51:45,558 (model:870) WARNING: All labels are zero
2025-01-26 20:52:00,994 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 82166,  validation: loss=0.07514, DER=0.1742, ACC=0.9648, MI=0.0999, FA=0.04964, CF=0.02464, over 0.00 frames.
2025-01-26 20:52:00,995 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 20:52:02,472 (train_accelerate_ddp:728) INFO: [Eval] - Epoch 20, batch_idx_train: 82166,  validation: loss=0.07363, DER=0.1731, ACC=0.9657, MI=0.0988, FA=0.05045, CF=0.02388, over 0.00 frames.
2025-01-26 20:52:02,472 (train_accelerate_ddp:732) INFO: Maximum memory allocated so far is 15788MB
2025-01-26 20:55:58,282 (train_accelerate_ddp:713) INFO: end of epoch 20, batch_idx: 4113 batch_idx_train: 82279, {'loss': 0.09073852747678757, 'DER': 0.20799117538914083, 'ACC': np.float64(0.965125), 'MI': 0.10791763696531438, 'FA': 0.06869714425787474, 'CF': 0.03137639416595171}, batch size: 64, grad_norm: 0.20347487926483154, grad_scale: , lr: 0.00e+00,
2025-01-26 20:55:58,282 (train_accelerate_ddp:713) INFO: end of epoch 20, batch_idx: 4113 batch_idx_train: 82279, {'loss': 0.11143478006124496, 'DER': 0.27785411656933473, 'ACC': np.float64(0.9498149798773735), 'MI': 0.1845299438909882, 'FA': 0.052043971143936794, 'CF': 0.04128020153440971}, batch size: 64, grad_norm: 0.20347487926483154, grad_scale: , lr: 0.00e+00,
2025-01-26 20:55:58,285 (train_accelerate_ddp:1066) INFO: Done!
2025-01-26 20:55:58,285 (checkpoint:75) INFO: Saving checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-20.pt
2025-01-26 20:55:58,692 (train_accelerate_ddp:561) INFO:  end of epoch 20, Saved checkpoint to /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/epoch-20.pt
2025-01-26 20:55:58,693 (train_accelerate_ddp:1066) INFO: Done!
pgpu17:609268:609368 [1] NCCL INFO [Service thread] Connection closed by localRank 1
[rank0]:[W126 20:55:59.970470528 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
pgpu17:609267:609370 [0] NCCL INFO [Service thread] Connection closed by localRank 0
pgpu17:609268:3320086 [1] NCCL INFO comm 0x555565c0fad0 rank 1 nranks 2 cudaDev 1 busId cb000 - Abort COMPLETE
pgpu17:609267:3320088 [0] NCCL INFO comm 0x555568d53c70 rank 0 nranks 2 cudaDev 0 busId 9b000 - Abort COMPLETE
2025-01-26 20:56:07,031 (infer:252) INFO: infer data_cfg: TSVADDataConfig(data_dir='/mntcephfs/lab_data/maduo/datasets/alimeeting', ts_len=6000, rs_len=10, segment_shift=1, spk_path='/mntcephfs/lab_data/maduo/model_hub/ts_vad/spk_embed/alimeeting/SpeakerEmbedding', speech_encoder_type='CAM++', speaker_embedding_name_dir='cam++_zh-cn_200k_feature_dir', speaker_embed_dim=192, noise_ratio=0.8, zero_ratio=0.3, sample_rate=16000, max_num_speaker=4, dataset_name='alimeeting', embed_input=False, embed_len=1, embed_shift=0.4, label_rate=25, random_channel=False, random_mask_speaker_prob=0.0, random_mask_speaker_step=0, musan_path='/mntcephfs/lee_dataset/asr/musan', rir_path='/mntcephfs/lee_dataset/asr/RIRS_NOISES')
2025-01-26 20:56:07,031 (infer:253) INFO: currently, it will infer Eval set.
  0%|          | 0/25 [00:00<?, ?it/s]100%|██████████| 25/25 [00:00<00:00, 323.73it/s]
2025-01-26 20:56:07,255 (ts_vad_dataset:152) INFO: model expect fbank as input , fbank_input should be True !!!
2025-01-26 20:56:07,255 (ts_vad_dataset:160) INFO: loaded sentence=15141, shortest sent=5120.0, longest sent=160000.0, rs_len=10, segment_shift=1,  rir=False, musan=False, noise_ratio=0.8, zero_ratio=0.3
2025-01-26 20:56:08,166 (infer:275) INFO: Device: cuda:0
2025-01-26 20:56:08,167 (infer:292) INFO: infer model_cfg: TSVADConfig(speech_encoder_path='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/zh/modelscope/speech_campplus_sv_zh-cn_16k-common/campplus_cn_common.bin', speech_encoder_type='CAM++', freeze_speech_encoder_updates=4000, num_attention_head=4, num_transformer_layer=2, transformer_embed_dim=384, transformer_ffn_embed_dim=1536, speaker_embed_dim=192, dropout=0.1, use_spk_embed=True, feature_grad_mult=0.1, whisper_n_mels=80, select_encoder_layer_nums=6, wavlm_fuse_feat_post_norm=False, speech_encoder_config='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/wav-bert2.0/config.json', single_backend_type='mamba2', multi_backend_type='transformer', d_state=256, expand=4)
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/model.py:898: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loadedState = torch.load(model_path, map_location=device)
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
2025-01-26 20:56:09,148 (infer:201) INFO: params.model_file: /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/best-valid-der.pt
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py:203: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  torch.load(params.model_file, map_location=device)["model"]
self.wavlm_fuse_feat_post_norm: False
Traceback (most recent call last):
  File "/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py", line 474, in <module>
    main(args)
  File "/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py", line 296, in main
    load_model(
  File "/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py", line 202, in load_model
    model.load_state_dict(
  File "/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/nn/modules/module.py", line 2215, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for TSVADModel:
	size mismatch for backend_down.0.weight: copying a param with shape torch.Size([384, 5376, 5]) from checkpoint, the shape in current model is torch.Size([384, 3072, 5]).
	size mismatch for fc.weight: copying a param with shape torch.Size([7, 384]) from checkpoint, the shape in current model is torch.Size([4, 384]).
	size mismatch for fc.bias: copying a param with shape torch.Size([7]) from checkpoint, the shape in current model is torch.Size([4]).
2025-01-26 20:56:13,727 (infer:252) INFO: infer data_cfg: TSVADDataConfig(data_dir='/mntcephfs/lab_data/maduo/datasets/alimeeting', ts_len=6000, rs_len=10, segment_shift=1, spk_path='/mntcephfs/lab_data/maduo/model_hub/ts_vad/spk_embed/alimeeting/SpeakerEmbedding', speech_encoder_type='CAM++', speaker_embedding_name_dir='cam++_zh-cn_200k_feature_dir', speaker_embed_dim=192, noise_ratio=0.8, zero_ratio=0.3, sample_rate=16000, max_num_speaker=4, dataset_name='alimeeting', embed_input=False, embed_len=1, embed_shift=0.4, label_rate=25, random_channel=False, random_mask_speaker_prob=0.0, random_mask_speaker_step=0, musan_path='/mntcephfs/lee_dataset/asr/musan', rir_path='/mntcephfs/lee_dataset/asr/RIRS_NOISES')
2025-01-26 20:56:13,727 (infer:253) INFO: currently, it will infer Test set.
  0%|          | 0/60 [00:00<?, ?it/s] 45%|████▌     | 27/60 [00:00<00:00, 259.81it/s] 88%|████████▊ | 53/60 [00:00<00:00, 259.46it/s]100%|██████████| 60/60 [00:00<00:00, 268.21it/s]
2025-01-26 20:56:13,990 (ts_vad_dataset:152) INFO: model expect fbank as input , fbank_input should be True !!!
2025-01-26 20:56:13,991 (ts_vad_dataset:160) INFO: loaded sentence=38807, shortest sent=640.0, longest sent=160000.0, rs_len=10, segment_shift=1,  rir=False, musan=False, noise_ratio=0.8, zero_ratio=0.3
2025-01-26 20:56:14,879 (infer:275) INFO: Device: cuda:0
2025-01-26 20:56:14,880 (infer:292) INFO: infer model_cfg: TSVADConfig(speech_encoder_path='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/zh/modelscope/speech_campplus_sv_zh-cn_16k-common/campplus_cn_common.bin', speech_encoder_type='CAM++', freeze_speech_encoder_updates=4000, num_attention_head=4, num_transformer_layer=2, transformer_embed_dim=384, transformer_ffn_embed_dim=1536, speaker_embed_dim=192, dropout=0.1, use_spk_embed=True, feature_grad_mult=0.1, whisper_n_mels=80, select_encoder_layer_nums=6, wavlm_fuse_feat_post_norm=False, speech_encoder_config='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/wav-bert2.0/config.json', single_backend_type='mamba2', multi_backend_type='transformer', d_state=256, expand=4)
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/model.py:898: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loadedState = torch.load(model_path, map_location=device)
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
2025-01-26 20:56:15,758 (infer:201) INFO: params.model_file: /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/best-valid-der.pt
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py:203: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  torch.load(params.model_file, map_location=device)["model"]
self.wavlm_fuse_feat_post_norm: False
Traceback (most recent call last):
  File "/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py", line 474, in <module>
    main(args)
  File "/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py", line 296, in main
    load_model(
  File "/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py", line 202, in load_model
    model.load_state_dict(
  File "/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/nn/modules/module.py", line 2215, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for TSVADModel:
	size mismatch for backend_down.0.weight: copying a param with shape torch.Size([384, 5376, 5]) from checkpoint, the shape in current model is torch.Size([384, 3072, 5]).
	size mismatch for fc.weight: copying a param with shape torch.Size([7, 384]) from checkpoint, the shape in current model is torch.Size([4, 384]).
	size mismatch for fc.bias: copying a param with shape torch.Size([7]) from checkpoint, the shape in current model is torch.Size([4]).
2025-01-26 20:56:19,932 (infer:252) INFO: infer data_cfg: TSVADDataConfig(data_dir='/mntcephfs/lab_data/maduo/datasets/alimeeting', ts_len=6000, rs_len=10, segment_shift=1, spk_path='/mntcephfs/lab_data/maduo/model_hub/ts_vad/spk_embed/alimeeting/SpeakerEmbedding', speech_encoder_type='CAM++', speaker_embedding_name_dir='cam++_zh-cn_200k_feature_dir', speaker_embed_dim=192, noise_ratio=0.8, zero_ratio=0.3, sample_rate=16000, max_num_speaker=4, dataset_name='alimeeting', embed_input=False, embed_len=1, embed_shift=0.4, label_rate=25, random_channel=False, random_mask_speaker_prob=0.0, random_mask_speaker_step=0, musan_path='/mntcephfs/lee_dataset/asr/musan', rir_path='/mntcephfs/lee_dataset/asr/RIRS_NOISES')
2025-01-26 20:56:19,932 (infer:253) INFO: currently, it will infer Eval set.
  0%|          | 0/25 [00:00<?, ?it/s]100%|██████████| 25/25 [00:00<00:00, 387.76it/s]
2025-01-26 20:56:20,004 (ts_vad_dataset:152) INFO: model expect fbank as input , fbank_input should be True !!!
2025-01-26 20:56:20,004 (ts_vad_dataset:160) INFO: loaded sentence=15141, shortest sent=5120.0, longest sent=160000.0, rs_len=10, segment_shift=1,  rir=False, musan=False, noise_ratio=0.8, zero_ratio=0.3
2025-01-26 20:56:21,209 (infer:275) INFO: Device: cuda:0
2025-01-26 20:56:21,209 (infer:292) INFO: infer model_cfg: TSVADConfig(speech_encoder_path='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/zh/modelscope/speech_campplus_sv_zh-cn_16k-common/campplus_cn_common.bin', speech_encoder_type='CAM++', freeze_speech_encoder_updates=4000, num_attention_head=4, num_transformer_layer=2, transformer_embed_dim=384, transformer_ffn_embed_dim=1536, speaker_embed_dim=192, dropout=0.1, use_spk_embed=True, feature_grad_mult=0.1, whisper_n_mels=80, select_encoder_layer_nums=6, wavlm_fuse_feat_post_norm=False, speech_encoder_config='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/wav-bert2.0/config.json', single_backend_type='mamba2', multi_backend_type='transformer', d_state=256, expand=4)
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/model.py:898: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loadedState = torch.load(model_path, map_location=device)
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
2025-01-26 20:56:22,299 (infer:201) INFO: params.model_file: /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/best-valid-der.pt
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py:203: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  torch.load(params.model_file, map_location=device)["model"]
self.wavlm_fuse_feat_post_norm: False
Traceback (most recent call last):
  File "/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py", line 474, in <module>
    main(args)
  File "/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py", line 296, in main
    load_model(
  File "/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py", line 202, in load_model
    model.load_state_dict(
  File "/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/nn/modules/module.py", line 2215, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for TSVADModel:
	size mismatch for backend_down.0.weight: copying a param with shape torch.Size([384, 5376, 5]) from checkpoint, the shape in current model is torch.Size([384, 3072, 5]).
	size mismatch for fc.weight: copying a param with shape torch.Size([7, 384]) from checkpoint, the shape in current model is torch.Size([4, 384]).
	size mismatch for fc.bias: copying a param with shape torch.Size([7]) from checkpoint, the shape in current model is torch.Size([4]).
2025-01-26 20:56:26,442 (infer:252) INFO: infer data_cfg: TSVADDataConfig(data_dir='/mntcephfs/lab_data/maduo/datasets/alimeeting', ts_len=6000, rs_len=10, segment_shift=1, spk_path='/mntcephfs/lab_data/maduo/model_hub/ts_vad/spk_embed/alimeeting/SpeakerEmbedding', speech_encoder_type='CAM++', speaker_embedding_name_dir='cam++_zh-cn_200k_feature_dir', speaker_embed_dim=192, noise_ratio=0.8, zero_ratio=0.3, sample_rate=16000, max_num_speaker=4, dataset_name='alimeeting', embed_input=False, embed_len=1, embed_shift=0.4, label_rate=25, random_channel=False, random_mask_speaker_prob=0.0, random_mask_speaker_step=0, musan_path='/mntcephfs/lee_dataset/asr/musan', rir_path='/mntcephfs/lee_dataset/asr/RIRS_NOISES')
2025-01-26 20:56:26,442 (infer:253) INFO: currently, it will infer Test set.
  0%|          | 0/60 [00:00<?, ?it/s] 60%|██████    | 36/60 [00:00<00:00, 354.19it/s]100%|██████████| 60/60 [00:00<00:00, 362.20it/s]
2025-01-26 20:56:26,623 (ts_vad_dataset:152) INFO: model expect fbank as input , fbank_input should be True !!!
2025-01-26 20:56:26,624 (ts_vad_dataset:160) INFO: loaded sentence=38807, shortest sent=640.0, longest sent=160000.0, rs_len=10, segment_shift=1,  rir=False, musan=False, noise_ratio=0.8, zero_ratio=0.3
2025-01-26 20:56:27,330 (infer:275) INFO: Device: cuda:0
2025-01-26 20:56:27,331 (infer:292) INFO: infer model_cfg: TSVADConfig(speech_encoder_path='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/zh/modelscope/speech_campplus_sv_zh-cn_16k-common/campplus_cn_common.bin', speech_encoder_type='CAM++', freeze_speech_encoder_updates=4000, num_attention_head=4, num_transformer_layer=2, transformer_embed_dim=384, transformer_ffn_embed_dim=1536, speaker_embed_dim=192, dropout=0.1, use_spk_embed=True, feature_grad_mult=0.1, whisper_n_mels=80, select_encoder_layer_nums=6, wavlm_fuse_feat_post_norm=False, speech_encoder_config='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/wav-bert2.0/config.json', single_backend_type='mamba2', multi_backend_type='transformer', d_state=256, expand=4)
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/model.py:898: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loadedState = torch.load(model_path, map_location=device)
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
2025-01-26 20:56:28,230 (infer:201) INFO: params.model_file: /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/best-valid-der.pt
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py:203: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  torch.load(params.model_file, map_location=device)["model"]
self.wavlm_fuse_feat_post_norm: False
Traceback (most recent call last):
  File "/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py", line 474, in <module>
    main(args)
  File "/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py", line 296, in main
    load_model(
  File "/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py", line 202, in load_model
    model.load_state_dict(
  File "/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/nn/modules/module.py", line 2215, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for TSVADModel:
	size mismatch for backend_down.0.weight: copying a param with shape torch.Size([384, 5376, 5]) from checkpoint, the shape in current model is torch.Size([384, 3072, 5]).
	size mismatch for fc.weight: copying a param with shape torch.Size([7, 384]) from checkpoint, the shape in current model is torch.Size([4, 384]).
	size mismatch for fc.bias: copying a param with shape torch.Size([7]) from checkpoint, the shape in current model is torch.Size([4]).
2025-01-26 20:56:32,456 (infer:252) INFO: infer data_cfg: TSVADDataConfig(data_dir='/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/datasets/aishell-4/data_processed', ts_len=6000, rs_len=10, segment_shift=1, spk_path='/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/model_hub/ts_vad/spk_embed/aishell_4/SpeakerEmbedding/', speech_encoder_type='CAM++', speaker_embedding_name_dir='cam++_zh-cn_200k_feature_dir', speaker_embed_dim=192, noise_ratio=0.8, zero_ratio=0.3, sample_rate=16000, max_num_speaker=4, dataset_name='alimeeting', embed_input=False, embed_len=1, embed_shift=0.4, label_rate=25, random_channel=False, random_mask_speaker_prob=0.0, random_mask_speaker_step=0, musan_path='/mntcephfs/lee_dataset/asr/musan', rir_path='/mntcephfs/lee_dataset/asr/RIRS_NOISES')
2025-01-26 20:56:32,456 (infer:253) INFO: currently, it will infer test set.
  0%|          | 0/116 [00:00<?, ?it/s] 21%|██        | 24/116 [00:00<00:00, 239.61it/s] 45%|████▍     | 52/116 [00:00<00:00, 251.32it/s] 67%|██████▋   | 78/116 [00:00<00:00, 242.61it/s] 89%|████████▉ | 103/116 [00:00<00:00, 222.07it/s]100%|██████████| 116/116 [00:00<00:00, 236.25it/s]
2025-01-26 20:56:33,000 (ts_vad_dataset:152) INFO: model expect fbank as input , fbank_input should be True !!!
2025-01-26 20:56:33,001 (ts_vad_dataset:160) INFO: loaded sentence=45820, shortest sent=1280.0, longest sent=160000.0, rs_len=10, segment_shift=1,  rir=False, musan=False, noise_ratio=0.8, zero_ratio=0.3
2025-01-26 20:56:33,621 (infer:275) INFO: Device: cuda:0
2025-01-26 20:56:33,622 (infer:292) INFO: infer model_cfg: TSVADConfig(speech_encoder_path='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/zh/modelscope/speech_campplus_sv_zh-cn_16k-common/campplus_cn_common.bin', speech_encoder_type='CAM++', freeze_speech_encoder_updates=4000, num_attention_head=4, num_transformer_layer=2, transformer_embed_dim=384, transformer_ffn_embed_dim=1536, speaker_embed_dim=192, dropout=0.1, use_spk_embed=True, feature_grad_mult=0.1, whisper_n_mels=80, select_encoder_layer_nums=6, wavlm_fuse_feat_post_norm=False, speech_encoder_config='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/wav-bert2.0/config.json', single_backend_type='mamba2', multi_backend_type='transformer', d_state=256, expand=4)
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/model.py:898: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loadedState = torch.load(model_path, map_location=device)
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
2025-01-26 20:56:34,456 (infer:201) INFO: params.model_file: /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/best-valid-der.pt
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py:203: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  torch.load(params.model_file, map_location=device)["model"]
self.wavlm_fuse_feat_post_norm: False
Traceback (most recent call last):
  File "/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py", line 474, in <module>
    main(args)
  File "/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py", line 296, in main
    load_model(
  File "/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py", line 202, in load_model
    model.load_state_dict(
  File "/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/nn/modules/module.py", line 2215, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for TSVADModel:
	size mismatch for backend_down.0.weight: copying a param with shape torch.Size([384, 5376, 5]) from checkpoint, the shape in current model is torch.Size([384, 3072, 5]).
	size mismatch for fc.weight: copying a param with shape torch.Size([7, 384]) from checkpoint, the shape in current model is torch.Size([4, 384]).
	size mismatch for fc.bias: copying a param with shape torch.Size([7]) from checkpoint, the shape in current model is torch.Size([4]).
2025-01-26 20:56:38,703 (infer:252) INFO: infer data_cfg: TSVADDataConfig(data_dir='/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/datasets/aishell-4/data_processed', ts_len=6000, rs_len=10, segment_shift=1, spk_path='/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/model_hub/ts_vad/spk_embed/aishell_4/SpeakerEmbedding/', speech_encoder_type='CAM++', speaker_embedding_name_dir='cam++_zh-cn_200k_feature_dir', speaker_embed_dim=192, noise_ratio=0.8, zero_ratio=0.3, sample_rate=16000, max_num_speaker=4, dataset_name='alimeeting', embed_input=False, embed_len=1, embed_shift=0.4, label_rate=25, random_channel=False, random_mask_speaker_prob=0.0, random_mask_speaker_step=0, musan_path='/mntcephfs/lee_dataset/asr/musan', rir_path='/mntcephfs/lee_dataset/asr/RIRS_NOISES')
2025-01-26 20:56:38,703 (infer:253) INFO: currently, it will infer test set.
  0%|          | 0/116 [00:00<?, ?it/s] 28%|██▊       | 32/116 [00:00<00:00, 318.05it/s] 58%|█████▊    | 67/116 [00:00<00:00, 334.60it/s] 87%|████████▋ | 101/116 [00:00<00:00, 330.83it/s]100%|██████████| 116/116 [00:00<00:00, 329.49it/s]
2025-01-26 20:56:39,087 (ts_vad_dataset:152) INFO: model expect fbank as input , fbank_input should be True !!!
2025-01-26 20:56:39,088 (ts_vad_dataset:160) INFO: loaded sentence=45820, shortest sent=1280.0, longest sent=160000.0, rs_len=10, segment_shift=1,  rir=False, musan=False, noise_ratio=0.8, zero_ratio=0.3
2025-01-26 20:56:39,803 (infer:275) INFO: Device: cuda:0
2025-01-26 20:56:39,803 (infer:292) INFO: infer model_cfg: TSVADConfig(speech_encoder_path='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/zh/modelscope/speech_campplus_sv_zh-cn_16k-common/campplus_cn_common.bin', speech_encoder_type='CAM++', freeze_speech_encoder_updates=4000, num_attention_head=4, num_transformer_layer=2, transformer_embed_dim=384, transformer_ffn_embed_dim=1536, speaker_embed_dim=192, dropout=0.1, use_spk_embed=True, feature_grad_mult=0.1, whisper_n_mels=80, select_encoder_layer_nums=6, wavlm_fuse_feat_post_norm=False, speech_encoder_config='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/wav-bert2.0/config.json', single_backend_type='mamba2', multi_backend_type='transformer', d_state=256, expand=4)
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/model.py:898: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loadedState = torch.load(model_path, map_location=device)
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
2025-01-26 20:56:41,162 (infer:201) INFO: params.model_file: /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/best-valid-der.pt
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py:203: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  torch.load(params.model_file, map_location=device)["model"]
self.wavlm_fuse_feat_post_norm: False
Traceback (most recent call last):
  File "/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py", line 474, in <module>
    main(args)
  File "/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py", line 296, in main
    load_model(
  File "/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py", line 202, in load_model
    model.load_state_dict(
  File "/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/nn/modules/module.py", line 2215, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for TSVADModel:
	size mismatch for backend_down.0.weight: copying a param with shape torch.Size([384, 5376, 5]) from checkpoint, the shape in current model is torch.Size([384, 3072, 5]).
	size mismatch for fc.weight: copying a param with shape torch.Size([7, 384]) from checkpoint, the shape in current model is torch.Size([4, 384]).
	size mismatch for fc.bias: copying a param with shape torch.Size([7]) from checkpoint, the shape in current model is torch.Size([4]).
2025-01-26 20:56:45,419 (infer:252) INFO: infer data_cfg: TSVADDataConfig(data_dir='/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/datasets/ami/ami_version1.6.2/data_processed/data/ami', ts_len=6000, rs_len=10, segment_shift=1, spk_path='/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/model_hub/ts_vad/spk_embed/ami/SpeakerEmbedding/', speech_encoder_type='CAM++', speaker_embedding_name_dir='cam++_zh-cn_200k_feature_dir', speaker_embed_dim=192, noise_ratio=0.8, zero_ratio=0.3, sample_rate=16000, max_num_speaker=4, dataset_name='alimeeting', embed_input=False, embed_len=1, embed_shift=0.4, label_rate=25, random_channel=False, random_mask_speaker_prob=0.0, random_mask_speaker_step=0, musan_path='/mntcephfs/lee_dataset/asr/musan', rir_path='/mntcephfs/lee_dataset/asr/RIRS_NOISES')
2025-01-26 20:56:45,419 (infer:253) INFO: currently, it will infer test set.
  0%|          | 0/63 [00:00<?, ?it/s] 32%|███▏      | 20/63 [00:00<00:00, 166.13it/s] 86%|████████▌ | 54/63 [00:00<00:00, 260.01it/s]100%|██████████| 63/63 [00:00<00:00, 244.42it/s]
2025-01-26 20:56:45,742 (ts_vad_dataset:152) INFO: model expect fbank as input , fbank_input should be True !!!
2025-01-26 20:56:45,743 (ts_vad_dataset:160) INFO: loaded sentence=32631, shortest sent=2560.0, longest sent=160000.0, rs_len=10, segment_shift=1,  rir=False, musan=False, noise_ratio=0.8, zero_ratio=0.3
2025-01-26 20:56:46,418 (infer:275) INFO: Device: cuda:0
2025-01-26 20:56:46,419 (infer:292) INFO: infer model_cfg: TSVADConfig(speech_encoder_path='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/zh/modelscope/speech_campplus_sv_zh-cn_16k-common/campplus_cn_common.bin', speech_encoder_type='CAM++', freeze_speech_encoder_updates=4000, num_attention_head=4, num_transformer_layer=2, transformer_embed_dim=384, transformer_ffn_embed_dim=1536, speaker_embed_dim=192, dropout=0.1, use_spk_embed=True, feature_grad_mult=0.1, whisper_n_mels=80, select_encoder_layer_nums=6, wavlm_fuse_feat_post_norm=False, speech_encoder_config='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/wav-bert2.0/config.json', single_backend_type='mamba2', multi_backend_type='transformer', d_state=256, expand=4)
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/model.py:898: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loadedState = torch.load(model_path, map_location=device)
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
2025-01-26 20:56:47,092 (infer:201) INFO: params.model_file: /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/best-valid-der.pt
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py:203: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  torch.load(params.model_file, map_location=device)["model"]
self.wavlm_fuse_feat_post_norm: False
Traceback (most recent call last):
  File "/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py", line 474, in <module>
    main(args)
  File "/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py", line 296, in main
    load_model(
  File "/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py", line 202, in load_model
    model.load_state_dict(
  File "/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/nn/modules/module.py", line 2215, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for TSVADModel:
	size mismatch for backend_down.0.weight: copying a param with shape torch.Size([384, 5376, 5]) from checkpoint, the shape in current model is torch.Size([384, 3072, 5]).
	size mismatch for fc.weight: copying a param with shape torch.Size([7, 384]) from checkpoint, the shape in current model is torch.Size([4, 384]).
	size mismatch for fc.bias: copying a param with shape torch.Size([7]) from checkpoint, the shape in current model is torch.Size([4]).
2025-01-26 20:56:51,404 (infer:252) INFO: infer data_cfg: TSVADDataConfig(data_dir='/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/datasets/ami/ami_version1.6.2/data_processed/data/ami', ts_len=6000, rs_len=10, segment_shift=1, spk_path='/mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/model_hub/ts_vad/spk_embed/ami/SpeakerEmbedding/', speech_encoder_type='CAM++', speaker_embedding_name_dir='cam++_zh-cn_200k_feature_dir', speaker_embed_dim=192, noise_ratio=0.8, zero_ratio=0.3, sample_rate=16000, max_num_speaker=4, dataset_name='alimeeting', embed_input=False, embed_len=1, embed_shift=0.4, label_rate=25, random_channel=False, random_mask_speaker_prob=0.0, random_mask_speaker_step=0, musan_path='/mntcephfs/lee_dataset/asr/musan', rir_path='/mntcephfs/lee_dataset/asr/RIRS_NOISES')
2025-01-26 20:56:51,405 (infer:253) INFO: currently, it will infer test set.
  0%|          | 0/63 [00:00<?, ?it/s] 59%|█████▊    | 37/63 [00:00<00:00, 367.87it/s]100%|██████████| 63/63 [00:00<00:00, 359.60it/s]
2025-01-26 20:56:51,596 (ts_vad_dataset:152) INFO: model expect fbank as input , fbank_input should be True !!!
2025-01-26 20:56:51,597 (ts_vad_dataset:160) INFO: loaded sentence=32631, shortest sent=2560.0, longest sent=160000.0, rs_len=10, segment_shift=1,  rir=False, musan=False, noise_ratio=0.8, zero_ratio=0.3
2025-01-26 20:56:52,468 (infer:275) INFO: Device: cuda:0
2025-01-26 20:56:52,468 (infer:292) INFO: infer model_cfg: TSVADConfig(speech_encoder_path='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/zh/modelscope/speech_campplus_sv_zh-cn_16k-common/campplus_cn_common.bin', speech_encoder_type='CAM++', freeze_speech_encoder_updates=4000, num_attention_head=4, num_transformer_layer=2, transformer_embed_dim=384, transformer_ffn_embed_dim=1536, speaker_embed_dim=192, dropout=0.1, use_spk_embed=True, feature_grad_mult=0.1, whisper_n_mels=80, select_encoder_layer_nums=6, wavlm_fuse_feat_post_norm=False, speech_encoder_config='/mntcephfs/lab_data/maduo/model_hub/speaker_pretrain_model/wav-bert2.0/config.json', single_backend_type='mamba2', multi_backend_type='transformer', d_state=256, expand=4)
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/model.py:898: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loadedState = torch.load(model_path, map_location=device)
/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
2025-01-26 20:56:53,137 (infer:201) INFO: params.model_file: /mntcephfs/data/haizhouli/Lab-projects/maduo/huawei_diarization/exp/speaker_diarization/ts_vad2/alimeeting_ami_aishell_4_ts_vad2_two_gpus_freeze_with_musan_rirs_cam++_200k_zh_cn_epoch20_front_fix_seed_lr1e4_single_backend_2layer_mamba2_multi_backend_transformer_d_state256_rs_len10/best-valid-der.pt
/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py:203: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  torch.load(params.model_file, map_location=device)["model"]
self.wavlm_fuse_feat_post_norm: False
Traceback (most recent call last):
  File "/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py", line 474, in <module>
    main(args)
  File "/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py", line 296, in main
    load_model(
  File "/mntnfs/lee_data1/maduo/codebase/speaker_diarization/egs/multi_datasets/ts_vad2/infer.py", line 202, in load_model
    model.load_state_dict(
  File "/mntnfs/lee_data1/maduo/anaconda3/envs/dia_pt2.4/lib/python3.11/site-packages/torch/nn/modules/module.py", line 2215, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for TSVADModel:
	size mismatch for backend_down.0.weight: copying a param with shape torch.Size([384, 5376, 5]) from checkpoint, the shape in current model is torch.Size([384, 3072, 5]).
	size mismatch for fc.weight: copying a param with shape torch.Size([7, 384]) from checkpoint, the shape in current model is torch.Size([4, 384]).
	size mismatch for fc.bias: copying a param with shape torch.Size([7]) from checkpoint, the shape in current model is torch.Size([4]).
